diff --git a/node_modules/@aws-amplify/pubsub/CHANGELOG.md b/node_modules/@aws-amplify/pubsub/CHANGELOG.md
index bd967d2..028a164 100644
--- a/node_modules/@aws-amplify/pubsub/CHANGELOG.md
+++ b/node_modules/@aws-amplify/pubsub/CHANGELOG.md
@@ -3,6 +3,364 @@
 All notable changes to this project will be documented in this file.
 See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
 
+# [3.3.0](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.28...@aws-amplify/pubsub@3.3.0) (2021-05-06)
+
+
+### Features
+
+* **@aws-amplify/datastore:** DataStore - Multi-Auth ([#8008](https://github.com/aws-amplify/amplify-js/issues/8008)) ([dedd564](https://github.com/aws-amplify/amplify-js/commit/dedd5641dfcfce209433088fe9570874cd810997))
+
+
+
+
+
+## [3.2.28](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.27...@aws-amplify/pubsub@3.2.28) (2021-04-15)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.27](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.26...@aws-amplify/pubsub@3.2.27) (2021-03-25)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.26](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.25...@aws-amplify/pubsub@3.2.26) (2021-03-18)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.25](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.24...@aws-amplify/pubsub@3.2.25) (2021-03-12)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.24](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.23...@aws-amplify/pubsub@3.2.24) (2021-03-08)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.23](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.22...@aws-amplify/pubsub@3.2.23) (2021-03-03)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.22](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.21...@aws-amplify/pubsub@3.2.22) (2021-02-25)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.21](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.20...@aws-amplify/pubsub@3.2.21) (2021-02-18)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.20](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.19...@aws-amplify/pubsub@3.2.20) (2021-02-15)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.19](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.18...@aws-amplify/pubsub@3.2.19) (2021-02-09)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.18](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.17...@aws-amplify/pubsub@3.2.18) (2021-02-03)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.17](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.16...@aws-amplify/pubsub@3.2.17) (2021-02-01)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.16](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.15...@aws-amplify/pubsub@3.2.16) (2021-01-29)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.15](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.14...@aws-amplify/pubsub@3.2.15) (2021-01-07)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.14](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.13...@aws-amplify/pubsub@3.2.14) (2020-12-17)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.13](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.12...@aws-amplify/pubsub@3.2.13) (2020-12-10)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.12](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.11...@aws-amplify/pubsub@3.2.12) (2020-11-30)
+
+
+### Bug Fixes
+
+* **@aws-amplify/pubsub:** AppSyncRealTimeProvider - fix unhandled promise rejection ([#7225](https://github.com/aws-amplify/amplify-js/issues/7225)) ([ba8a73f](https://github.com/aws-amplify/amplify-js/commit/ba8a73f41db6411b91b208fea3202408c55f029b))
+
+
+
+
+
+## [3.2.11](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.10...@aws-amplify/pubsub@3.2.11) (2020-11-23)
+
+
+### Bug Fixes
+
+* **@aws-amplify/pubsub:** Subscriptions are prevented in Node for SSR ([#7236](https://github.com/aws-amplify/amplify-js/issues/7236)) ([c7b82f2](https://github.com/aws-amplify/amplify-js/commit/c7b82f2a8914cad917f448eca2d7dc3360a3f50c))
+
+
+
+
+
+## [3.2.10](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.9...@aws-amplify/pubsub@3.2.10) (2020-11-20)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.9](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.8...@aws-amplify/pubsub@3.2.9) (2020-11-13)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.8](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.7...@aws-amplify/pubsub@3.2.8) (2020-11-03)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.7](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.6...@aws-amplify/pubsub@3.2.7) (2020-10-31)
+
+
+### Bug Fixes
+
+* **amazon-cognito-identity-js:** update random implementation ([#7090](https://github.com/aws-amplify/amplify-js/issues/7090)) ([7048453](https://github.com/aws-amplify/amplify-js/commit/70484532da8a9953384b00b223b2b3ba0c0e845e))
+
+
+
+
+
+## [3.2.6](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.5...@aws-amplify/pubsub@3.2.6) (2020-10-29)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.5](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.4...@aws-amplify/pubsub@3.2.5) (2020-10-15)
+
+
+### Bug Fixes
+
+* **@aws-amplify/pubsub:** Block subscriptions for SSR, not Node ([#6937](https://github.com/aws-amplify/amplify-js/issues/6937)) ([e1d122b](https://github.com/aws-amplify/amplify-js/commit/e1d122bec0fb67eab0a696ee6e0ffa976631e4f0))
+
+
+
+
+
+## [3.2.4](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.3...@aws-amplify/pubsub@3.2.4) (2020-10-01)
+
+
+### Bug Fixes
+
+* **@aws-amplify/datastore:** add token to currentAuthenticatedUser for OIDC  ([#6858](https://github.com/aws-amplify/amplify-js/issues/6858)) ([61f7478](https://github.com/aws-amplify/amplify-js/commit/61f7478609fce7dd2f25c562aeb887d3f3db4a67))
+
+
+
+
+
+## [3.2.3](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.2...@aws-amplify/pubsub@3.2.3) (2020-09-25)
+
+
+### Bug Fixes
+
+* Add files with Amplify.register to sideEffects array ([#6867](https://github.com/aws-amplify/amplify-js/issues/6867)) ([58ddbf8](https://github.com/aws-amplify/amplify-js/commit/58ddbf8811e44695d97b6ab8be8f7cd2a2242921))
+
+
+
+
+
+## [3.2.2](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.1...@aws-amplify/pubsub@3.2.2) (2020-09-16)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.2.1](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.2.0...@aws-amplify/pubsub@3.2.1) (2020-09-15)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+# [3.2.0](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.1.1...@aws-amplify/pubsub@3.2.0) (2020-09-10)
+
+
+### Features
+
+* **@aws-amplify/datastore:** Add SSR support for DataStore ([#6726](https://github.com/aws-amplify/amplify-js/issues/6726)) ([e56aba6](https://github.com/aws-amplify/amplify-js/commit/e56aba642acc7eb3482f0e69454a530409d1b3ac))
+
+
+
+
+
+## [3.1.1](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.1.0...@aws-amplify/pubsub@3.1.1) (2020-09-03)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+# [3.1.0](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.25...@aws-amplify/pubsub@3.1.0) (2020-09-03)
+
+
+### Features
+
+* **SSR:** withSSRContext ([#6146](https://github.com/aws-amplify/amplify-js/issues/6146)) ([1cb1afd](https://github.com/aws-amplify/amplify-js/commit/1cb1afd1e56135908dceb2ef6403f0b3e78067fe))
+
+
+
+
+
+## [3.0.25](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.24...@aws-amplify/pubsub@3.0.25) (2020-09-01)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.0.24](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.23...@aws-amplify/pubsub@3.0.24) (2020-08-19)
+
+
+### Bug Fixes
+
+* **@aws-amplify/pubsub:** fix undefined observer ([#6436](https://github.com/aws-amplify/amplify-js/issues/6436)) ([c1256bb](https://github.com/aws-amplify/amplify-js/commit/c1256bba99f32616f0d89877ca100b27fca4eb64))
+
+
+
+
+
+## [3.0.23](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.22...@aws-amplify/pubsub@3.0.23) (2020-08-06)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.0.22](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.21...@aws-amplify/pubsub@3.0.22) (2020-07-27)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.0.21](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.20...@aws-amplify/pubsub@3.0.21) (2020-07-22)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.0.20](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.19...@aws-amplify/pubsub@3.0.20) (2020-07-09)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.0.19](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.18...@aws-amplify/pubsub@3.0.19) (2020-07-07)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.0.18](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.17...@aws-amplify/pubsub@3.0.18) (2020-06-18)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
+## [3.0.17](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.16...@aws-amplify/pubsub@3.0.17) (2020-06-09)
+
+**Note:** Version bump only for package @aws-amplify/pubsub
+
+
+
+
+
 ## [3.0.16](https://github.com/aws-amplify/amplify-js/compare/@aws-amplify/pubsub@3.0.15...@aws-amplify/pubsub@3.0.16) (2020-06-04)
 
 **Note:** Version bump only for package @aws-amplify/pubsub
diff --git a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js
index 0d0b0bc..533a7d9 100644
--- a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js
+++ b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js
@@ -97,9 +97,9 @@ return /******/ (function(modules) { // webpackBootstrap
 /******/ ({
 
 /***/ "../../node_modules/base64-js/index.js":
-/*!********************************************************!*\
-  !*** /root/amplify-js/node_modules/base64-js/index.js ***!
-  \********************************************************/
+/*!*************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/base64-js/index.js ***!
+  \*************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -231,9 +231,7 @@ function fromByteArray (uint8) {
 
   // go through the array every three bytes, we'll deal with trailing stuff later
   for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
-    parts.push(encodeChunk(
-      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)
-    ))
+    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
   }
 
   // pad the end with zeros, but make sure to not forget the extra bytes
@@ -260,121 +258,10 @@ function fromByteArray (uint8) {
 
 /***/ }),
 
-/***/ "../../node_modules/ieee754/index.js":
-/*!******************************************************!*\
-  !*** /root/amplify-js/node_modules/ieee754/index.js ***!
-  \******************************************************/
-/*! no static exports found */
-/***/ (function(module, exports) {
-
-exports.read = function (buffer, offset, isLE, mLen, nBytes) {
-  var e, m
-  var eLen = (nBytes * 8) - mLen - 1
-  var eMax = (1 << eLen) - 1
-  var eBias = eMax >> 1
-  var nBits = -7
-  var i = isLE ? (nBytes - 1) : 0
-  var d = isLE ? -1 : 1
-  var s = buffer[offset + i]
-
-  i += d
-
-  e = s & ((1 << (-nBits)) - 1)
-  s >>= (-nBits)
-  nBits += eLen
-  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}
-
-  m = e & ((1 << (-nBits)) - 1)
-  e >>= (-nBits)
-  nBits += mLen
-  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}
-
-  if (e === 0) {
-    e = 1 - eBias
-  } else if (e === eMax) {
-    return m ? NaN : ((s ? -1 : 1) * Infinity)
-  } else {
-    m = m + Math.pow(2, mLen)
-    e = e - eBias
-  }
-  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
-}
-
-exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
-  var e, m, c
-  var eLen = (nBytes * 8) - mLen - 1
-  var eMax = (1 << eLen) - 1
-  var eBias = eMax >> 1
-  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
-  var i = isLE ? 0 : (nBytes - 1)
-  var d = isLE ? 1 : -1
-  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0
-
-  value = Math.abs(value)
-
-  if (isNaN(value) || value === Infinity) {
-    m = isNaN(value) ? 1 : 0
-    e = eMax
-  } else {
-    e = Math.floor(Math.log(value) / Math.LN2)
-    if (value * (c = Math.pow(2, -e)) < 1) {
-      e--
-      c *= 2
-    }
-    if (e + eBias >= 1) {
-      value += rt / c
-    } else {
-      value += rt * Math.pow(2, 1 - eBias)
-    }
-    if (value * c >= 2) {
-      e++
-      c /= 2
-    }
-
-    if (e + eBias >= eMax) {
-      m = 0
-      e = eMax
-    } else if (e + eBias >= 1) {
-      m = ((value * c) - 1) * Math.pow(2, mLen)
-      e = e + eBias
-    } else {
-      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
-      e = 0
-    }
-  }
-
-  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}
-
-  e = (e << mLen) | m
-  eLen += mLen
-  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}
-
-  buffer[offset + i - d] |= s * 128
-}
-
-
-/***/ }),
-
-/***/ "../../node_modules/isarray/index.js":
-/*!******************************************************!*\
-  !*** /root/amplify-js/node_modules/isarray/index.js ***!
-  \******************************************************/
-/*! no static exports found */
-/***/ (function(module, exports) {
-
-var toString = {}.toString;
-
-module.exports = Array.isArray || function (arr) {
-  return toString.call(arr) == '[object Array]';
-};
-
-
-/***/ }),
-
-/***/ "../../node_modules/node-libs-browser/node_modules/buffer/index.js":
-/*!************************************************************************************!*\
-  !*** /root/amplify-js/node_modules/node-libs-browser/node_modules/buffer/index.js ***!
-  \************************************************************************************/
+/***/ "../../node_modules/buffer/index.js":
+/*!**********************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/buffer/index.js ***!
+  \**********************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -2169,2943 +2056,3055 @@ function isnan (val) {
   return val !== val // eslint-disable-line no-self-compare
 }
 
-/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../webpack/buildin/global.js */ "../../node_modules/webpack/buildin/global.js")))
+/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "../../node_modules/webpack/buildin/global.js")))
 
 /***/ }),
 
-/***/ "../../node_modules/paho-mqtt/paho-mqtt.js":
-/*!************************************************************!*\
-  !*** /root/amplify-js/node_modules/paho-mqtt/paho-mqtt.js ***!
-  \************************************************************/
+/***/ "../../node_modules/ieee754/index.js":
+/*!***********************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/ieee754/index.js ***!
+  \***********************************************************************************************************************/
 /*! no static exports found */
-/***/ (function(module, exports, __webpack_require__) {
-
-/* WEBPACK VAR INJECTION */(function(global) {/*******************************************************************************
- * Copyright (c) 2013 IBM Corp.
- *
- * All rights reserved. This program and the accompanying materials
- * are made available under the terms of the Eclipse Public License v1.0
- * and Eclipse Distribution License v1.0 which accompany this distribution.
- *
- * The Eclipse Public License is available at
- *    http://www.eclipse.org/legal/epl-v10.html
- * and the Eclipse Distribution License is available at
- *   http://www.eclipse.org/org/documents/edl-v10.php.
- *
- * Contributors:
- *    Andrew Banks - initial API and implementation and initial documentation
- *******************************************************************************/
+/***/ (function(module, exports) {
 
+/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
+exports.read = function (buffer, offset, isLE, mLen, nBytes) {
+  var e, m
+  var eLen = (nBytes * 8) - mLen - 1
+  var eMax = (1 << eLen) - 1
+  var eBias = eMax >> 1
+  var nBits = -7
+  var i = isLE ? (nBytes - 1) : 0
+  var d = isLE ? -1 : 1
+  var s = buffer[offset + i]
 
-// Only expose a single object name in the global namespace.
-// Everything must go through this module. Global Paho module
-// only has a single public function, client, which returns
-// a Paho client object given connection details.
+  i += d
 
-/**
- * Send and receive messages using web browsers.
- * <p>
- * This programming interface lets a JavaScript client application use the MQTT V3.1 or
- * V3.1.1 protocol to connect to an MQTT-supporting messaging server.
- *
- * The function supported includes:
- * <ol>
- * <li>Connecting to and disconnecting from a server. The server is identified by its host name and port number.
- * <li>Specifying options that relate to the communications link with the server,
- * for example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.
- * <li>Subscribing to and receiving messages from MQTT Topics.
- * <li>Publishing messages to MQTT Topics.
- * </ol>
- * <p>
- * The API consists of two main objects:
- * <dl>
- * <dt><b>{@link Paho.Client}</b></dt>
- * <dd>This contains methods that provide the functionality of the API,
- * including provision of callbacks that notify the application when a message
- * arrives from or is delivered to the messaging server,
- * or when the status of its connection to the messaging server changes.</dd>
- * <dt><b>{@link Paho.Message}</b></dt>
- * <dd>This encapsulates the payload of the message along with various attributes
- * associated with its delivery, in particular the destination to which it has
- * been (or is about to be) sent.</dd>
- * </dl>
- * <p>
- * The programming interface validates parameters passed to it, and will throw
- * an Error containing an error message intended for developer use, if it detects
- * an error with any parameter.
- * <p>
- * Example:
- *
- * <code><pre>
-var client = new Paho.MQTT.Client(location.hostname, Number(location.port), "clientId");
-client.onConnectionLost = onConnectionLost;
-client.onMessageArrived = onMessageArrived;
-client.connect({onSuccess:onConnect});
+  e = s & ((1 << (-nBits)) - 1)
+  s >>= (-nBits)
+  nBits += eLen
+  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}
 
-function onConnect() {
-  // Once a connection has been made, make a subscription and send a message.
-  console.log("onConnect");
-  client.subscribe("/World");
-  var message = new Paho.MQTT.Message("Hello");
-  message.destinationName = "/World";
-  client.send(message);
-};
-function onConnectionLost(responseObject) {
-  if (responseObject.errorCode !== 0)
-	console.log("onConnectionLost:"+responseObject.errorMessage);
-};
-function onMessageArrived(message) {
-  console.log("onMessageArrived:"+message.payloadString);
-  client.disconnect();
-};
- * </pre></code>
- * @namespace Paho
- */
+  m = e & ((1 << (-nBits)) - 1)
+  e >>= (-nBits)
+  nBits += mLen
+  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}
 
-/* jshint shadow:true */
-(function ExportLibrary(root, factory) {
-	if(true){
-		module.exports = factory();
-	} else {}
-})(this, function LibraryFactory(){
+  if (e === 0) {
+    e = 1 - eBias
+  } else if (e === eMax) {
+    return m ? NaN : ((s ? -1 : 1) * Infinity)
+  } else {
+    m = m + Math.pow(2, mLen)
+    e = e - eBias
+  }
+  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
+}
 
+exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
+  var e, m, c
+  var eLen = (nBytes * 8) - mLen - 1
+  var eMax = (1 << eLen) - 1
+  var eBias = eMax >> 1
+  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
+  var i = isLE ? 0 : (nBytes - 1)
+  var d = isLE ? 1 : -1
+  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0
 
-	var PahoMQTT = (function (global) {
+  value = Math.abs(value)
 
-	// Private variables below, these are only visible inside the function closure
-	// which is used to define the module.
-	var version = "@VERSION@-@BUILDLEVEL@";
+  if (isNaN(value) || value === Infinity) {
+    m = isNaN(value) ? 1 : 0
+    e = eMax
+  } else {
+    e = Math.floor(Math.log(value) / Math.LN2)
+    if (value * (c = Math.pow(2, -e)) < 1) {
+      e--
+      c *= 2
+    }
+    if (e + eBias >= 1) {
+      value += rt / c
+    } else {
+      value += rt * Math.pow(2, 1 - eBias)
+    }
+    if (value * c >= 2) {
+      e++
+      c /= 2
+    }
 
-	/**
-	 * @private
-	 */
-	var localStorage = global.localStorage || (function () {
-		var data = {};
-
-		return {
-			setItem: function (key, item) { data[key] = item; },
-			getItem: function (key) { return data[key]; },
-			removeItem: function (key) { delete data[key]; },
-		};
-	})();
+    if (e + eBias >= eMax) {
+      m = 0
+      e = eMax
+    } else if (e + eBias >= 1) {
+      m = ((value * c) - 1) * Math.pow(2, mLen)
+      e = e + eBias
+    } else {
+      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
+      e = 0
+    }
+  }
 
-		/**
-	 * Unique message type identifiers, with associated
-	 * associated integer values.
-	 * @private
-	 */
-		var MESSAGE_TYPE = {
-			CONNECT: 1,
-			CONNACK: 2,
-			PUBLISH: 3,
-			PUBACK: 4,
-			PUBREC: 5,
-			PUBREL: 6,
-			PUBCOMP: 7,
-			SUBSCRIBE: 8,
-			SUBACK: 9,
-			UNSUBSCRIBE: 10,
-			UNSUBACK: 11,
-			PINGREQ: 12,
-			PINGRESP: 13,
-			DISCONNECT: 14
-		};
+  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}
 
-		// Collection of utility methods used to simplify module code
-		// and promote the DRY pattern.
+  e = (e << mLen) | m
+  eLen += mLen
+  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}
 
-		/**
-	 * Validate an object's parameter names to ensure they
-	 * match a list of expected variables name for this option
-	 * type. Used to ensure option object passed into the API don't
-	 * contain erroneous parameters.
-	 * @param {Object} obj - User options object
-	 * @param {Object} keys - valid keys and types that may exist in obj.
-	 * @throws {Error} Invalid option parameter found.
-	 * @private
-	 */
-		var validate = function(obj, keys) {
-			for (var key in obj) {
-				if (obj.hasOwnProperty(key)) {
-					if (keys.hasOwnProperty(key)) {
-						if (typeof obj[key] !== keys[key])
-							throw new Error(format(ERROR.INVALID_TYPE, [typeof obj[key], key]));
-					} else {
-						var errorStr = "Unknown property, " + key + ". Valid properties are:";
-						for (var validKey in keys)
-							if (keys.hasOwnProperty(validKey))
-								errorStr = errorStr+" "+validKey;
-						throw new Error(errorStr);
-					}
-				}
-			}
-		};
+  buffer[offset + i - d] |= s * 128
+}
 
-		/**
-	 * Return a new function which runs the user function bound
-	 * to a fixed scope.
-	 * @param {function} User function
-	 * @param {object} Function scope
-	 * @return {function} User function bound to another scope
-	 * @private
-	 */
-		var scope = function (f, scope) {
-			return function () {
-				return f.apply(scope, arguments);
-			};
-		};
 
-		/**
-	 * Unique message type identifiers, with associated
-	 * associated integer values.
-	 * @private
-	 */
-		var ERROR = {
-			OK: {code:0, text:"AMQJSC0000I OK."},
-			CONNECT_TIMEOUT: {code:1, text:"AMQJSC0001E Connect timed out."},
-			SUBSCRIBE_TIMEOUT: {code:2, text:"AMQJS0002E Subscribe timed out."},
-			UNSUBSCRIBE_TIMEOUT: {code:3, text:"AMQJS0003E Unsubscribe timed out."},
-			PING_TIMEOUT: {code:4, text:"AMQJS0004E Ping timed out."},
-			INTERNAL_ERROR: {code:5, text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},
-			CONNACK_RETURNCODE: {code:6, text:"AMQJS0006E Bad Connack return code:{0} {1}."},
-			SOCKET_ERROR: {code:7, text:"AMQJS0007E Socket error:{0}."},
-			SOCKET_CLOSE: {code:8, text:"AMQJS0008I Socket closed."},
-			MALFORMED_UTF: {code:9, text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},
-			UNSUPPORTED: {code:10, text:"AMQJS0010E {0} is not supported by this browser."},
-			INVALID_STATE: {code:11, text:"AMQJS0011E Invalid state {0}."},
-			INVALID_TYPE: {code:12, text:"AMQJS0012E Invalid type {0} for {1}."},
-			INVALID_ARGUMENT: {code:13, text:"AMQJS0013E Invalid argument {0} for {1}."},
-			UNSUPPORTED_OPERATION: {code:14, text:"AMQJS0014E Unsupported operation."},
-			INVALID_STORED_DATA: {code:15, text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},
-			INVALID_MQTT_MESSAGE_TYPE: {code:16, text:"AMQJS0016E Invalid MQTT message type {0}."},
-			MALFORMED_UNICODE: {code:17, text:"AMQJS0017E Malformed Unicode string:{0} {1}."},
-			BUFFER_FULL: {code:18, text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."},
-		};
+/***/ }),
 
-		/** CONNACK RC Meaning. */
-		var CONNACK_RC = {
-			0:"Connection Accepted",
-			1:"Connection Refused: unacceptable protocol version",
-			2:"Connection Refused: identifier rejected",
-			3:"Connection Refused: server unavailable",
-			4:"Connection Refused: bad user name or password",
-			5:"Connection Refused: not authorized"
-		};
+/***/ "../../node_modules/isarray/index.js":
+/*!***********************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/isarray/index.js ***!
+  \***********************************************************************************************************************/
+/*! no static exports found */
+/***/ (function(module, exports) {
 
-	/**
-	 * Format an error message text.
-	 * @private
-	 * @param {error} ERROR value above.
-	 * @param {substitutions} [array] substituted into the text.
-	 * @return the text with the substitutions made.
-	 */
-		var format = function(error, substitutions) {
-			var text = error.text;
-			if (substitutions) {
-				var field,start;
-				for (var i=0; i<substitutions.length; i++) {
-					field = "{"+i+"}";
-					start = text.indexOf(field);
-					if(start > 0) {
-						var part1 = text.substring(0,start);
-						var part2 = text.substring(start+field.length);
-						text = part1+substitutions[i]+part2;
-					}
-				}
-			}
-			return text;
-		};
+var toString = {}.toString;
 
-		//MQTT protocol and version          6    M    Q    I    s    d    p    3
-		var MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];
-		//MQTT proto/version for 311         4    M    Q    T    T    4
-		var MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];
+module.exports = Array.isArray || function (arr) {
+  return toString.call(arr) == '[object Array]';
+};
 
-		/**
-	 * Construct an MQTT wire protocol message.
-	 * @param type MQTT packet type.
-	 * @param options optional wire message attributes.
-	 *
-	 * Optional properties
-	 *
-	 * messageIdentifier: message ID in the range [0..65535]
-	 * payloadMessage:	Application Message - PUBLISH only
-	 * connectStrings:	array of 0 or more Strings to be put into the CONNECT payload
-	 * topics:			array of strings (SUBSCRIBE, UNSUBSCRIBE)
-	 * requestQoS:		array of QoS values [0..2]
-	 *
-	 * "Flag" properties
-	 * cleanSession:	true if present / false if absent (CONNECT)
-	 * willMessage:  	true if present / false if absent (CONNECT)
-	 * isRetained:		true if present / false if absent (CONNECT)
-	 * userName:		true if present / false if absent (CONNECT)
-	 * password:		true if present / false if absent (CONNECT)
-	 * keepAliveInterval:	integer [0..65535]  (CONNECT)
-	 *
-	 * @private
-	 * @ignore
-	 */
-		var WireMessage = function (type, options) {
-			this.type = type;
-			for (var name in options) {
-				if (options.hasOwnProperty(name)) {
-					this[name] = options[name];
-				}
-			}
-		};
 
-		WireMessage.prototype.encode = function() {
-		// Compute the first byte of the fixed header
-			var first = ((this.type & 0x0f) << 4);
+/***/ }),
 
-			/*
-		 * Now calculate the length of the variable header + payload by adding up the lengths
-		 * of all the component parts
-		 */
+/***/ "../../node_modules/node-libs-browser/node_modules/punycode/punycode.js":
+/*!**********************************************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/node-libs-browser/node_modules/punycode/punycode.js ***!
+  \**********************************************************************************************************************************************************/
+/*! no static exports found */
+/***/ (function(module, exports, __webpack_require__) {
 
-			var remLength = 0;
-			var topicStrLength = [];
-			var destinationNameLength = 0;
-			var willMessagePayloadBytes;
+/* WEBPACK VAR INJECTION */(function(module, global) {var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */
+;(function(root) {
 
-			// if the message contains a messageIdentifier then we need two bytes for that
-			if (this.messageIdentifier !== undefined)
-				remLength += 2;
+	/** Detect free variables */
+	var freeExports =  true && exports &&
+		!exports.nodeType && exports;
+	var freeModule =  true && module &&
+		!module.nodeType && module;
+	var freeGlobal = typeof global == 'object' && global;
+	if (
+		freeGlobal.global === freeGlobal ||
+		freeGlobal.window === freeGlobal ||
+		freeGlobal.self === freeGlobal
+	) {
+		root = freeGlobal;
+	}
 
-			switch(this.type) {
-			// If this a Connect then we need to include 12 bytes for its header
-			case MESSAGE_TYPE.CONNECT:
-				switch(this.mqttVersion) {
-				case 3:
-					remLength += MqttProtoIdentifierv3.length + 3;
-					break;
-				case 4:
-					remLength += MqttProtoIdentifierv4.length + 3;
-					break;
-				}
+	/**
+	 * The `punycode` object.
+	 * @name punycode
+	 * @type Object
+	 */
+	var punycode,
 
-				remLength += UTF8Length(this.clientId) + 2;
-				if (this.willMessage !== undefined) {
-					remLength += UTF8Length(this.willMessage.destinationName) + 2;
-					// Will message is always a string, sent as UTF-8 characters with a preceding length.
-					willMessagePayloadBytes = this.willMessage.payloadBytes;
-					if (!(willMessagePayloadBytes instanceof Uint8Array))
-						willMessagePayloadBytes = new Uint8Array(payloadBytes);
-					remLength += willMessagePayloadBytes.byteLength +2;
-				}
-				if (this.userName !== undefined)
-					remLength += UTF8Length(this.userName) + 2;
-				if (this.password !== undefined)
-					remLength += UTF8Length(this.password) + 2;
-				break;
+	/** Highest positive signed 32-bit float value */
+	maxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1
 
-			// Subscribe, Unsubscribe can both contain topic strings
-			case MESSAGE_TYPE.SUBSCRIBE:
-				first |= 0x02; // Qos = 1;
-				for ( var i = 0; i < this.topics.length; i++) {
-					topicStrLength[i] = UTF8Length(this.topics[i]);
-					remLength += topicStrLength[i] + 2;
-				}
-				remLength += this.requestedQos.length; // 1 byte for each topic's Qos
-				// QoS on Subscribe only
-				break;
-
-			case MESSAGE_TYPE.UNSUBSCRIBE:
-				first |= 0x02; // Qos = 1;
-				for ( var i = 0; i < this.topics.length; i++) {
-					topicStrLength[i] = UTF8Length(this.topics[i]);
-					remLength += topicStrLength[i] + 2;
-				}
-				break;
+	/** Bootstring parameters */
+	base = 36,
+	tMin = 1,
+	tMax = 26,
+	skew = 38,
+	damp = 700,
+	initialBias = 72,
+	initialN = 128, // 0x80
+	delimiter = '-', // '\x2D'
 
-			case MESSAGE_TYPE.PUBREL:
-				first |= 0x02; // Qos = 1;
-				break;
+	/** Regular expressions */
+	regexPunycode = /^xn--/,
+	regexNonASCII = /[^\x20-\x7E]/, // unprintable ASCII chars + non-ASCII chars
+	regexSeparators = /[\x2E\u3002\uFF0E\uFF61]/g, // RFC 3490 separators
 
-			case MESSAGE_TYPE.PUBLISH:
-				if (this.payloadMessage.duplicate) first |= 0x08;
-				first  = first |= (this.payloadMessage.qos << 1);
-				if (this.payloadMessage.retained) first |= 0x01;
-				destinationNameLength = UTF8Length(this.payloadMessage.destinationName);
-				remLength += destinationNameLength + 2;
-				var payloadBytes = this.payloadMessage.payloadBytes;
-				remLength += payloadBytes.byteLength;
-				if (payloadBytes instanceof ArrayBuffer)
-					payloadBytes = new Uint8Array(payloadBytes);
-				else if (!(payloadBytes instanceof Uint8Array))
-					payloadBytes = new Uint8Array(payloadBytes.buffer);
-				break;
+	/** Error messages */
+	errors = {
+		'overflow': 'Overflow: input needs wider integers to process',
+		'not-basic': 'Illegal input >= 0x80 (not a basic code point)',
+		'invalid-input': 'Invalid input'
+	},
 
-			case MESSAGE_TYPE.DISCONNECT:
-				break;
+	/** Convenience shortcuts */
+	baseMinusTMin = base - tMin,
+	floor = Math.floor,
+	stringFromCharCode = String.fromCharCode,
 
-			default:
-				break;
-			}
+	/** Temporary variable */
+	key;
 
-			// Now we can allocate a buffer for the message
+	/*--------------------------------------------------------------------------*/
 
-			var mbi = encodeMBI(remLength);  // Convert the length to MQTT MBI format
-			var pos = mbi.length + 1;        // Offset of start of variable header
-			var buffer = new ArrayBuffer(remLength + pos);
-			var byteStream = new Uint8Array(buffer);    // view it as a sequence of bytes
+	/**
+	 * A generic error utility function.
+	 * @private
+	 * @param {String} type The error type.
+	 * @returns {Error} Throws a `RangeError` with the applicable error message.
+	 */
+	function error(type) {
+		throw new RangeError(errors[type]);
+	}
 
-			//Write the fixed header into the buffer
-			byteStream[0] = first;
-			byteStream.set(mbi,1);
+	/**
+	 * A generic `Array#map` utility function.
+	 * @private
+	 * @param {Array} array The array to iterate over.
+	 * @param {Function} callback The function that gets called for every array
+	 * item.
+	 * @returns {Array} A new array of values returned by the callback function.
+	 */
+	function map(array, fn) {
+		var length = array.length;
+		var result = [];
+		while (length--) {
+			result[length] = fn(array[length]);
+		}
+		return result;
+	}
 
-			// If this is a PUBLISH then the variable header starts with a topic
-			if (this.type == MESSAGE_TYPE.PUBLISH)
-				pos = writeString(this.payloadMessage.destinationName, destinationNameLength, byteStream, pos);
-			// If this is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time
+	/**
+	 * A simple `Array#map`-like wrapper to work with domain name strings or email
+	 * addresses.
+	 * @private
+	 * @param {String} domain The domain name or email address.
+	 * @param {Function} callback The function that gets called for every
+	 * character.
+	 * @returns {Array} A new string of characters returned by the callback
+	 * function.
+	 */
+	function mapDomain(string, fn) {
+		var parts = string.split('@');
+		var result = '';
+		if (parts.length > 1) {
+			// In email addresses, only the domain name should be punycoded. Leave
+			// the local part (i.e. everything up to `@`) intact.
+			result = parts[0] + '@';
+			string = parts[1];
+		}
+		// Avoid `split(regex)` for IE8 compatibility. See #17.
+		string = string.replace(regexSeparators, '\x2E');
+		var labels = string.split('.');
+		var encoded = map(labels, fn).join('.');
+		return result + encoded;
+	}
 
-			else if (this.type == MESSAGE_TYPE.CONNECT) {
-				switch (this.mqttVersion) {
-				case 3:
-					byteStream.set(MqttProtoIdentifierv3, pos);
-					pos += MqttProtoIdentifierv3.length;
-					break;
-				case 4:
-					byteStream.set(MqttProtoIdentifierv4, pos);
-					pos += MqttProtoIdentifierv4.length;
-					break;
-				}
-				var connectFlags = 0;
-				if (this.cleanSession)
-					connectFlags = 0x02;
-				if (this.willMessage !== undefined ) {
-					connectFlags |= 0x04;
-					connectFlags |= (this.willMessage.qos<<3);
-					if (this.willMessage.retained) {
-						connectFlags |= 0x20;
-					}
+	/**
+	 * Creates an array containing the numeric code points of each Unicode
+	 * character in the string. While JavaScript uses UCS-2 internally,
+	 * this function will convert a pair of surrogate halves (each of which
+	 * UCS-2 exposes as separate characters) into a single code point,
+	 * matching UTF-16.
+	 * @see `punycode.ucs2.encode`
+	 * @see <https://mathiasbynens.be/notes/javascript-encoding>
+	 * @memberOf punycode.ucs2
+	 * @name decode
+	 * @param {String} string The Unicode input string (UCS-2).
+	 * @returns {Array} The new array of code points.
+	 */
+	function ucs2decode(string) {
+		var output = [],
+		    counter = 0,
+		    length = string.length,
+		    value,
+		    extra;
+		while (counter < length) {
+			value = string.charCodeAt(counter++);
+			if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
+				// high surrogate, and there is a next character
+				extra = string.charCodeAt(counter++);
+				if ((extra & 0xFC00) == 0xDC00) { // low surrogate
+					output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
+				} else {
+					// unmatched surrogate; only append this code unit, in case the next
+					// code unit is the high surrogate of a surrogate pair
+					output.push(value);
+					counter--;
 				}
-				if (this.userName !== undefined)
-					connectFlags |= 0x80;
-				if (this.password !== undefined)
-					connectFlags |= 0x40;
-				byteStream[pos++] = connectFlags;
-				pos = writeUint16 (this.keepAliveInterval, byteStream, pos);
+			} else {
+				output.push(value);
 			}
+		}
+		return output;
+	}
 
-			// Output the messageIdentifier - if there is one
-			if (this.messageIdentifier !== undefined)
-				pos = writeUint16 (this.messageIdentifier, byteStream, pos);
-
-			switch(this.type) {
-			case MESSAGE_TYPE.CONNECT:
-				pos = writeString(this.clientId, UTF8Length(this.clientId), byteStream, pos);
-				if (this.willMessage !== undefined) {
-					pos = writeString(this.willMessage.destinationName, UTF8Length(this.willMessage.destinationName), byteStream, pos);
-					pos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);
-					byteStream.set(willMessagePayloadBytes, pos);
-					pos += willMessagePayloadBytes.byteLength;
-
-				}
-				if (this.userName !== undefined)
-					pos = writeString(this.userName, UTF8Length(this.userName), byteStream, pos);
-				if (this.password !== undefined)
-					pos = writeString(this.password, UTF8Length(this.password), byteStream, pos);
-				break;
-
-			case MESSAGE_TYPE.PUBLISH:
-				// PUBLISH has a text or binary payload, if text do not add a 2 byte length field, just the UTF characters.
-				byteStream.set(payloadBytes, pos);
-
-				break;
-
-				//    	    case MESSAGE_TYPE.PUBREC:
-				//    	    case MESSAGE_TYPE.PUBREL:
-				//    	    case MESSAGE_TYPE.PUBCOMP:
-				//    	    	break;
-
-			case MESSAGE_TYPE.SUBSCRIBE:
-				// SUBSCRIBE has a list of topic strings and request QoS
-				for (var i=0; i<this.topics.length; i++) {
-					pos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);
-					byteStream[pos++] = this.requestedQos[i];
-				}
-				break;
-
-			case MESSAGE_TYPE.UNSUBSCRIBE:
-				// UNSUBSCRIBE has a list of topic strings
-				for (var i=0; i<this.topics.length; i++)
-					pos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);
-				break;
-
-			default:
-				// Do nothing.
+	/**
+	 * Creates a string based on an array of numeric code points.
+	 * @see `punycode.ucs2.decode`
+	 * @memberOf punycode.ucs2
+	 * @name encode
+	 * @param {Array} codePoints The array of numeric code points.
+	 * @returns {String} The new Unicode string (UCS-2).
+	 */
+	function ucs2encode(array) {
+		return map(array, function(value) {
+			var output = '';
+			if (value > 0xFFFF) {
+				value -= 0x10000;
+				output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
+				value = 0xDC00 | value & 0x3FF;
 			}
+			output += stringFromCharCode(value);
+			return output;
+		}).join('');
+	}
 
-			return buffer;
-		};
+	/**
+	 * Converts a basic code point into a digit/integer.
+	 * @see `digitToBasic()`
+	 * @private
+	 * @param {Number} codePoint The basic numeric code point value.
+	 * @returns {Number} The numeric value of a basic code point (for use in
+	 * representing integers) in the range `0` to `base - 1`, or `base` if
+	 * the code point does not represent a value.
+	 */
+	function basicToDigit(codePoint) {
+		if (codePoint - 48 < 10) {
+			return codePoint - 22;
+		}
+		if (codePoint - 65 < 26) {
+			return codePoint - 65;
+		}
+		if (codePoint - 97 < 26) {
+			return codePoint - 97;
+		}
+		return base;
+	}
 
-		function decodeMessage(input,pos) {
-			var startingPos = pos;
-			var first = input[pos];
-			var type = first >> 4;
-			var messageInfo = first &= 0x0f;
-			pos += 1;
+	/**
+	 * Converts a digit/integer into a basic code point.
+	 * @see `basicToDigit()`
+	 * @private
+	 * @param {Number} digit The numeric value of a basic code point.
+	 * @returns {Number} The basic code point whose value (when used for
+	 * representing integers) is `digit`, which needs to be in the range
+	 * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is
+	 * used; else, the lowercase form is used. The behavior is undefined
+	 * if `flag` is non-zero and `digit` has no uppercase form.
+	 */
+	function digitToBasic(digit, flag) {
+		//  0..25 map to ASCII a..z or A..Z
+		// 26..35 map to ASCII 0..9
+		return digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);
+	}
 
+	/**
+	 * Bias adaptation function as per section 3.4 of RFC 3492.
+	 * https://tools.ietf.org/html/rfc3492#section-3.4
+	 * @private
+	 */
+	function adapt(delta, numPoints, firstTime) {
+		var k = 0;
+		delta = firstTime ? floor(delta / damp) : delta >> 1;
+		delta += floor(delta / numPoints);
+		for (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {
+			delta = floor(delta / baseMinusTMin);
+		}
+		return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));
+	}
 
-			// Decode the remaining length (MBI format)
+	/**
+	 * Converts a Punycode string of ASCII-only symbols to a string of Unicode
+	 * symbols.
+	 * @memberOf punycode
+	 * @param {String} input The Punycode string of ASCII-only symbols.
+	 * @returns {String} The resulting string of Unicode symbols.
+	 */
+	function decode(input) {
+		// Don't use UCS-2
+		var output = [],
+		    inputLength = input.length,
+		    out,
+		    i = 0,
+		    n = initialN,
+		    bias = initialBias,
+		    basic,
+		    j,
+		    index,
+		    oldi,
+		    w,
+		    k,
+		    digit,
+		    t,
+		    /** Cached calculation results */
+		    baseMinusT;
 
-			var digit;
-			var remLength = 0;
-			var multiplier = 1;
-			do {
-				if (pos == input.length) {
-					return [null,startingPos];
-				}
-				digit = input[pos++];
-				remLength += ((digit & 0x7F) * multiplier);
-				multiplier *= 128;
-			} while ((digit & 0x80) !== 0);
+		// Handle the basic code points: let `basic` be the number of input code
+		// points before the last delimiter, or `0` if there is none, then copy
+		// the first basic code points to the output.
 
-			var endPos = pos+remLength;
-			if (endPos > input.length) {
-				return [null,startingPos];
+		basic = input.lastIndexOf(delimiter);
+		if (basic < 0) {
+			basic = 0;
+		}
+
+		for (j = 0; j < basic; ++j) {
+			// if it's not a basic code point
+			if (input.charCodeAt(j) >= 0x80) {
+				error('not-basic');
 			}
+			output.push(input.charCodeAt(j));
+		}
 
-			var wireMessage = new WireMessage(type);
-			switch(type) {
-			case MESSAGE_TYPE.CONNACK:
-				var connectAcknowledgeFlags = input[pos++];
-				if (connectAcknowledgeFlags & 0x01)
-					wireMessage.sessionPresent = true;
-				wireMessage.returnCode = input[pos++];
-				break;
+		// Main decoding loop: start just after the last delimiter if any basic code
+		// points were copied; start at the beginning otherwise.
 
-			case MESSAGE_TYPE.PUBLISH:
-				var qos = (messageInfo >> 1) & 0x03;
+		for (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {
 
-				var len = readUint16(input, pos);
-				pos += 2;
-				var topicName = parseUTF8(input, pos, len);
-				pos += len;
-				// If QoS 1 or 2 there will be a messageIdentifier
-				if (qos > 0) {
-					wireMessage.messageIdentifier = readUint16(input, pos);
-					pos += 2;
+			// `index` is the index of the next character to be consumed.
+			// Decode a generalized variable-length integer into `delta`,
+			// which gets added to `i`. The overflow checking is easier
+			// if we increase `i` as we go, then subtract off its starting
+			// value at the end to obtain `delta`.
+			for (oldi = i, w = 1, k = base; /* no condition */; k += base) {
+
+				if (index >= inputLength) {
+					error('invalid-input');
 				}
 
-				var message = new Message(input.subarray(pos, endPos));
-				if ((messageInfo & 0x01) == 0x01)
-					message.retained = true;
-				if ((messageInfo & 0x08) == 0x08)
-					message.duplicate =  true;
-				message.qos = qos;
-				message.destinationName = topicName;
-				wireMessage.payloadMessage = message;
-				break;
+				digit = basicToDigit(input.charCodeAt(index++));
 
-			case  MESSAGE_TYPE.PUBACK:
-			case  MESSAGE_TYPE.PUBREC:
-			case  MESSAGE_TYPE.PUBREL:
-			case  MESSAGE_TYPE.PUBCOMP:
-			case  MESSAGE_TYPE.UNSUBACK:
-				wireMessage.messageIdentifier = readUint16(input, pos);
-				break;
+				if (digit >= base || digit > floor((maxInt - i) / w)) {
+					error('overflow');
+				}
 
-			case  MESSAGE_TYPE.SUBACK:
-				wireMessage.messageIdentifier = readUint16(input, pos);
-				pos += 2;
-				wireMessage.returnCode = input.subarray(pos, endPos);
-				break;
+				i += digit * w;
+				t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);
+
+				if (digit < t) {
+					break;
+				}
+
+				baseMinusT = base - t;
+				if (w > floor(maxInt / baseMinusT)) {
+					error('overflow');
+				}
+
+				w *= baseMinusT;
 
-			default:
-				break;
 			}
 
-			return [wireMessage,endPos];
-		}
+			out = output.length + 1;
+			bias = adapt(i - oldi, out, oldi == 0);
 
-		function writeUint16(input, buffer, offset) {
-			buffer[offset++] = input >> 8;      //MSB
-			buffer[offset++] = input % 256;     //LSB
-			return offset;
-		}
+			// `i` was supposed to wrap around from `out` to `0`,
+			// incrementing `n` each time, so we'll fix that now:
+			if (floor(i / out) > maxInt - n) {
+				error('overflow');
+			}
 
-		function writeString(input, utf8Length, buffer, offset) {
-			offset = writeUint16(utf8Length, buffer, offset);
-			stringToUTF8(input, buffer, offset);
-			return offset + utf8Length;
-		}
+			n += floor(i / out);
+			i %= out;
+
+			// Insert `n` at position `i` of the output
+			output.splice(i++, 0, n);
 
-		function readUint16(buffer, offset) {
-			return 256*buffer[offset] + buffer[offset+1];
 		}
 
-		/**
-	 * Encodes an MQTT Multi-Byte Integer
-	 * @private
+		return ucs2encode(output);
+	}
+
+	/**
+	 * Converts a string of Unicode symbols (e.g. a domain name label) to a
+	 * Punycode string of ASCII-only symbols.
+	 * @memberOf punycode
+	 * @param {String} input The string of Unicode symbols.
+	 * @returns {String} The resulting Punycode string of ASCII-only symbols.
 	 */
-		function encodeMBI(number) {
-			var output = new Array(1);
-			var numBytes = 0;
+	function encode(input) {
+		var n,
+		    delta,
+		    handledCPCount,
+		    basicLength,
+		    bias,
+		    j,
+		    m,
+		    q,
+		    k,
+		    t,
+		    currentValue,
+		    output = [],
+		    /** `inputLength` will hold the number of code points in `input`. */
+		    inputLength,
+		    /** Cached calculation results */
+		    handledCPCountPlusOne,
+		    baseMinusT,
+		    qMinusT;
 
-			do {
-				var digit = number % 128;
-				number = number >> 7;
-				if (number > 0) {
-					digit |= 0x80;
-				}
-				output[numBytes++] = digit;
-			} while ( (number > 0) && (numBytes<4) );
+		// Convert the input in UCS-2 to Unicode
+		input = ucs2decode(input);
 
-			return output;
-		}
+		// Cache the length
+		inputLength = input.length;
 
-		/**
-	 * Takes a String and calculates its length in bytes when encoded in UTF8.
-	 * @private
-	 */
-		function UTF8Length(input) {
-			var output = 0;
-			for (var i = 0; i<input.length; i++)
-			{
-				var charCode = input.charCodeAt(i);
-				if (charCode > 0x7FF)
-				{
-					// Surrogate pair means its a 4 byte character
-					if (0xD800 <= charCode && charCode <= 0xDBFF)
-					{
-						i++;
-						output++;
-					}
-					output +=3;
-				}
-				else if (charCode > 0x7F)
-					output +=2;
-				else
-					output++;
+		// Initialize the state
+		n = initialN;
+		delta = 0;
+		bias = initialBias;
+
+		// Handle the basic code points
+		for (j = 0; j < inputLength; ++j) {
+			currentValue = input[j];
+			if (currentValue < 0x80) {
+				output.push(stringFromCharCode(currentValue));
 			}
-			return output;
 		}
 
-		/**
-	 * Takes a String and writes it into an array as UTF8 encoded bytes.
-	 * @private
-	 */
-		function stringToUTF8(input, output, start) {
-			var pos = start;
-			for (var i = 0; i<input.length; i++) {
-				var charCode = input.charCodeAt(i);
-
-				// Check for a surrogate pair.
-				if (0xD800 <= charCode && charCode <= 0xDBFF) {
-					var lowCharCode = input.charCodeAt(++i);
-					if (isNaN(lowCharCode)) {
-						throw new Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));
-					}
-					charCode = ((charCode - 0xD800)<<10) + (lowCharCode - 0xDC00) + 0x10000;
+		handledCPCount = basicLength = output.length;
 
-				}
+		// `handledCPCount` is the number of code points that have been handled;
+		// `basicLength` is the number of basic code points.
 
-				if (charCode <= 0x7F) {
-					output[pos++] = charCode;
-				} else if (charCode <= 0x7FF) {
-					output[pos++] = charCode>>6  & 0x1F | 0xC0;
-					output[pos++] = charCode     & 0x3F | 0x80;
-				} else if (charCode <= 0xFFFF) {
-					output[pos++] = charCode>>12 & 0x0F | 0xE0;
-					output[pos++] = charCode>>6  & 0x3F | 0x80;
-					output[pos++] = charCode     & 0x3F | 0x80;
-				} else {
-					output[pos++] = charCode>>18 & 0x07 | 0xF0;
-					output[pos++] = charCode>>12 & 0x3F | 0x80;
-					output[pos++] = charCode>>6  & 0x3F | 0x80;
-					output[pos++] = charCode     & 0x3F | 0x80;
-				}
-			}
-			return output;
+		// Finish the basic string - if it is not empty - with a delimiter
+		if (basicLength) {
+			output.push(delimiter);
 		}
 
-		function parseUTF8(input, offset, length) {
-			var output = "";
-			var utf16;
-			var pos = offset;
-
-			while (pos < offset+length)
-			{
-				var byte1 = input[pos++];
-				if (byte1 < 128)
-					utf16 = byte1;
-				else
-				{
-					var byte2 = input[pos++]-128;
-					if (byte2 < 0)
-						throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),""]));
-					if (byte1 < 0xE0)             // 2 byte character
-						utf16 = 64*(byte1-0xC0) + byte2;
-					else
-					{
-						var byte3 = input[pos++]-128;
-						if (byte3 < 0)
-							throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));
-						if (byte1 < 0xF0)        // 3 byte character
-							utf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;
-						else
-						{
-							var byte4 = input[pos++]-128;
-							if (byte4 < 0)
-								throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));
-							if (byte1 < 0xF8)        // 4 byte character
-								utf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;
-							else                     // longer encodings are not supported
-								throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));
-						}
-					}
-				}
+		// Main encoding loop:
+		while (handledCPCount < inputLength) {
 
-				if (utf16 > 0xFFFF)   // 4 byte character - express as a surrogate pair
-				{
-					utf16 -= 0x10000;
-					output += String.fromCharCode(0xD800 + (utf16 >> 10)); // lead character
-					utf16 = 0xDC00 + (utf16 & 0x3FF);  // trail character
+			// All non-basic code points < n have been handled already. Find the next
+			// larger one:
+			for (m = maxInt, j = 0; j < inputLength; ++j) {
+				currentValue = input[j];
+				if (currentValue >= n && currentValue < m) {
+					m = currentValue;
 				}
-				output += String.fromCharCode(utf16);
 			}
-			return output;
-		}
 
-		/**
-	 * Repeat keepalive requests, monitor responses.
-	 * @ignore
-	 */
-		var Pinger = function(client, keepAliveInterval) {
-			this._client = client;
-			this._keepAliveInterval = keepAliveInterval*1000;
-			this.isReset = false;
+			// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,
+			// but guard against overflow
+			handledCPCountPlusOne = handledCPCount + 1;
+			if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {
+				error('overflow');
+			}
 
-			var pingReq = new WireMessage(MESSAGE_TYPE.PINGREQ).encode();
+			delta += (m - n) * handledCPCountPlusOne;
+			n = m;
 
-			var doTimeout = function (pinger) {
-				return function () {
-					return doPing.apply(pinger);
-				};
-			};
+			for (j = 0; j < inputLength; ++j) {
+				currentValue = input[j];
 
-			/** @ignore */
-			var doPing = function() {
-				if (!this.isReset) {
-					this._client._trace("Pinger.doPing", "Timed out");
-					this._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));
-				} else {
-					this.isReset = false;
-					this._client._trace("Pinger.doPing", "send PINGREQ");
-					this._client.socket.send(pingReq);
-					this.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);
+				if (currentValue < n && ++delta > maxInt) {
+					error('overflow');
 				}
-			};
-
-			this.reset = function() {
-				this.isReset = true;
-				clearTimeout(this.timeout);
-				if (this._keepAliveInterval > 0)
-					this.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);
-			};
 
-			this.cancel = function() {
-				clearTimeout(this.timeout);
-			};
-		};
+				if (currentValue == n) {
+					// Represent delta as a generalized variable-length integer
+					for (q = delta, k = base; /* no condition */; k += base) {
+						t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);
+						if (q < t) {
+							break;
+						}
+						qMinusT = q - t;
+						baseMinusT = base - t;
+						output.push(
+							stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))
+						);
+						q = floor(qMinusT / baseMinusT);
+					}
 
-		/**
-	 * Monitor request completion.
-	 * @ignore
-	 */
-		var Timeout = function(client, timeoutSeconds, action, args) {
-			if (!timeoutSeconds)
-				timeoutSeconds = 30;
+					output.push(stringFromCharCode(digitToBasic(q, 0)));
+					bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
+					delta = 0;
+					++handledCPCount;
+				}
+			}
 
-			var doTimeout = function (action, client, args) {
-				return function () {
-					return action.apply(client, args);
-				};
-			};
-			this.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);
+			++delta;
+			++n;
 
-			this.cancel = function() {
-				clearTimeout(this.timeout);
-			};
-		};
+		}
+		return output.join('');
+	}
 
 	/**
-	 * Internal implementation of the Websockets MQTT V3.1 client.
-	 *
-	 * @name Paho.ClientImpl @constructor
-	 * @param {String} host the DNS nameof the webSocket host.
-	 * @param {Number} port the port number for that host.
-	 * @param {String} clientId the MQ client identifier.
+	 * Converts a Punycode string representing a domain name or an email address
+	 * to Unicode. Only the Punycoded parts of the input will be converted, i.e.
+	 * it doesn't matter if you call it on a string that has already been
+	 * converted to Unicode.
+	 * @memberOf punycode
+	 * @param {String} input The Punycoded domain name or email address to
+	 * convert to Unicode.
+	 * @returns {String} The Unicode representation of the given Punycode
+	 * string.
 	 */
-		var ClientImpl = function (uri, host, port, path, clientId) {
-		// Check dependencies are satisfied in this browser.
-			if (!("WebSocket" in global && global.WebSocket !== null)) {
-				throw new Error(format(ERROR.UNSUPPORTED, ["WebSocket"]));
-			}
-			if (!("ArrayBuffer" in global && global.ArrayBuffer !== null)) {
-				throw new Error(format(ERROR.UNSUPPORTED, ["ArrayBuffer"]));
-			}
-			this._trace("Paho.Client", uri, host, port, path, clientId);
-
-			this.host = host;
-			this.port = port;
-			this.path = path;
-			this.uri = uri;
-			this.clientId = clientId;
-			this._wsuri = null;
+	function toUnicode(input) {
+		return mapDomain(input, function(string) {
+			return regexPunycode.test(string)
+				? decode(string.slice(4).toLowerCase())
+				: string;
+		});
+	}
 
-			// Local storagekeys are qualified with the following string.
-			// The conditional inclusion of path in the key is for backward
-			// compatibility to when the path was not configurable and assumed to
-			// be /mqtt
-			this._localKey=host+":"+port+(path!="/mqtt"?":"+path:"")+":"+clientId+":";
-
-			// Create private instance-only message queue
-			// Internal queue of messages to be sent, in sending order.
-			this._msg_queue = [];
-			this._buffered_msg_queue = [];
-
-			// Messages we have sent and are expecting a response for, indexed by their respective message ids.
-			this._sentMessages = {};
+	/**
+	 * Converts a Unicode string representing a domain name or an email address to
+	 * Punycode. Only the non-ASCII parts of the domain name will be converted,
+	 * i.e. it doesn't matter if you call it with a domain that's already in
+	 * ASCII.
+	 * @memberOf punycode
+	 * @param {String} input The domain name or email address to convert, as a
+	 * Unicode string.
+	 * @returns {String} The Punycode representation of the given domain name or
+	 * email address.
+	 */
+	function toASCII(input) {
+		return mapDomain(input, function(string) {
+			return regexNonASCII.test(string)
+				? 'xn--' + encode(string)
+				: string;
+		});
+	}
 
-			// Messages we have received and acknowleged and are expecting a confirm message for
-			// indexed by their respective message ids.
-			this._receivedMessages = {};
+	/*--------------------------------------------------------------------------*/
 
-			// Internal list of callbacks to be executed when messages
-			// have been successfully sent over web socket, e.g. disconnect
-			// when it doesn't have to wait for ACK, just message is dispatched.
-			this._notify_msg_sent = {};
+	/** Define the public API */
+	punycode = {
+		/**
+		 * A string representing the current Punycode.js version number.
+		 * @memberOf punycode
+		 * @type String
+		 */
+		'version': '1.4.1',
+		/**
+		 * An object of methods to convert from JavaScript's internal character
+		 * representation (UCS-2) to Unicode code points, and back.
+		 * @see <https://mathiasbynens.be/notes/javascript-encoding>
+		 * @memberOf punycode
+		 * @type Object
+		 */
+		'ucs2': {
+			'decode': ucs2decode,
+			'encode': ucs2encode
+		},
+		'decode': decode,
+		'encode': encode,
+		'toASCII': toASCII,
+		'toUnicode': toUnicode
+	};
 
-			// Unique identifier for SEND messages, incrementing
-			// counter as messages are sent.
-			this._message_identifier = 1;
+	/** Expose `punycode` */
+	// Some AMD build optimizers, like r.js, check for specific condition patterns
+	// like the following:
+	if (
+		true
+	) {
+		!(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {
+			return punycode;
+		}).call(exports, __webpack_require__, exports, module),
+				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
+	} else {}
 
-			// Used to determine the transmission sequence of stored sent messages.
-			this._sequence = 0;
+}(this));
 
+/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../webpack/buildin/module.js */ "../../node_modules/webpack/buildin/module.js")(module), __webpack_require__(/*! ./../../../webpack/buildin/global.js */ "../../node_modules/webpack/buildin/global.js")))
 
-			// Load the local state, if any, from the saved version, only restore state relevant to this client.
-			for (var key in localStorage)
-				if (   key.indexOf("Sent:"+this._localKey) === 0 || key.indexOf("Received:"+this._localKey) === 0)
-					this.restore(key);
-		};
+/***/ }),
 
-		// Messaging Client public instance members.
-		ClientImpl.prototype.host = null;
-		ClientImpl.prototype.port = null;
-		ClientImpl.prototype.path = null;
-		ClientImpl.prototype.uri = null;
-		ClientImpl.prototype.clientId = null;
+/***/ "../../node_modules/paho-mqtt/paho-mqtt.js":
+/*!*****************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/paho-mqtt/paho-mqtt.js ***!
+  \*****************************************************************************************************************************/
+/*! no static exports found */
+/***/ (function(module, exports, __webpack_require__) {
 
-		// Messaging Client private instance members.
-		ClientImpl.prototype.socket = null;
-		/* true once we have received an acknowledgement to a CONNECT packet. */
-		ClientImpl.prototype.connected = false;
-		/* The largest message identifier allowed, may not be larger than 2**16 but
-		 * if set smaller reduces the maximum number of outbound messages allowed.
-		 */
-		ClientImpl.prototype.maxMessageIdentifier = 65536;
-		ClientImpl.prototype.connectOptions = null;
-		ClientImpl.prototype.hostIndex = null;
-		ClientImpl.prototype.onConnected = null;
-		ClientImpl.prototype.onConnectionLost = null;
-		ClientImpl.prototype.onMessageDelivered = null;
-		ClientImpl.prototype.onMessageArrived = null;
-		ClientImpl.prototype.traceFunction = null;
-		ClientImpl.prototype._msg_queue = null;
-		ClientImpl.prototype._buffered_msg_queue = null;
-		ClientImpl.prototype._connectTimeout = null;
-		/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */
-		ClientImpl.prototype.sendPinger = null;
-		/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */
-		ClientImpl.prototype.receivePinger = null;
-		ClientImpl.prototype._reconnectInterval = 1; // Reconnect Delay, starts at 1 second
-		ClientImpl.prototype._reconnecting = false;
-		ClientImpl.prototype._reconnectTimeout = null;
-		ClientImpl.prototype.disconnectedPublishing = false;
-		ClientImpl.prototype.disconnectedBufferSize = 5000;
+/* WEBPACK VAR INJECTION */(function(global) {/*******************************************************************************
+ * Copyright (c) 2013 IBM Corp.
+ *
+ * All rights reserved. This program and the accompanying materials
+ * are made available under the terms of the Eclipse Public License v1.0
+ * and Eclipse Distribution License v1.0 which accompany this distribution.
+ *
+ * The Eclipse Public License is available at
+ *    http://www.eclipse.org/legal/epl-v10.html
+ * and the Eclipse Distribution License is available at
+ *   http://www.eclipse.org/org/documents/edl-v10.php.
+ *
+ * Contributors:
+ *    Andrew Banks - initial API and implementation and initial documentation
+ *******************************************************************************/
 
-		ClientImpl.prototype.receiveBuffer = null;
 
-		ClientImpl.prototype._traceBuffer = null;
-		ClientImpl.prototype._MAX_TRACE_ENTRIES = 100;
+// Only expose a single object name in the global namespace.
+// Everything must go through this module. Global Paho module
+// only has a single public function, client, which returns
+// a Paho client object given connection details.
 
-		ClientImpl.prototype.connect = function (connectOptions) {
-			var connectOptionsMasked = this._traceMask(connectOptions, "password");
-			this._trace("Client.connect", connectOptionsMasked, this.socket, this.connected);
+/**
+ * Send and receive messages using web browsers.
+ * <p>
+ * This programming interface lets a JavaScript client application use the MQTT V3.1 or
+ * V3.1.1 protocol to connect to an MQTT-supporting messaging server.
+ *
+ * The function supported includes:
+ * <ol>
+ * <li>Connecting to and disconnecting from a server. The server is identified by its host name and port number.
+ * <li>Specifying options that relate to the communications link with the server,
+ * for example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.
+ * <li>Subscribing to and receiving messages from MQTT Topics.
+ * <li>Publishing messages to MQTT Topics.
+ * </ol>
+ * <p>
+ * The API consists of two main objects:
+ * <dl>
+ * <dt><b>{@link Paho.Client}</b></dt>
+ * <dd>This contains methods that provide the functionality of the API,
+ * including provision of callbacks that notify the application when a message
+ * arrives from or is delivered to the messaging server,
+ * or when the status of its connection to the messaging server changes.</dd>
+ * <dt><b>{@link Paho.Message}</b></dt>
+ * <dd>This encapsulates the payload of the message along with various attributes
+ * associated with its delivery, in particular the destination to which it has
+ * been (or is about to be) sent.</dd>
+ * </dl>
+ * <p>
+ * The programming interface validates parameters passed to it, and will throw
+ * an Error containing an error message intended for developer use, if it detects
+ * an error with any parameter.
+ * <p>
+ * Example:
+ *
+ * <code><pre>
+var client = new Paho.MQTT.Client(location.hostname, Number(location.port), "clientId");
+client.onConnectionLost = onConnectionLost;
+client.onMessageArrived = onMessageArrived;
+client.connect({onSuccess:onConnect});
 
-			if (this.connected)
-				throw new Error(format(ERROR.INVALID_STATE, ["already connected"]));
-			if (this.socket)
-				throw new Error(format(ERROR.INVALID_STATE, ["already connected"]));
+function onConnect() {
+  // Once a connection has been made, make a subscription and send a message.
+  console.log("onConnect");
+  client.subscribe("/World");
+  var message = new Paho.MQTT.Message("Hello");
+  message.destinationName = "/World";
+  client.send(message);
+};
+function onConnectionLost(responseObject) {
+  if (responseObject.errorCode !== 0)
+	console.log("onConnectionLost:"+responseObject.errorMessage);
+};
+function onMessageArrived(message) {
+  console.log("onMessageArrived:"+message.payloadString);
+  client.disconnect();
+};
+ * </pre></code>
+ * @namespace Paho
+ */
 
-			if (this._reconnecting) {
-			// connect() function is called while reconnect is in progress.
-			// Terminate the auto reconnect process to use new connect options.
-				this._reconnectTimeout.cancel();
-				this._reconnectTimeout = null;
-				this._reconnecting = false;
-			}
+/* jshint shadow:true */
+(function ExportLibrary(root, factory) {
+	if(true){
+		module.exports = factory();
+	} else {}
+})(this, function LibraryFactory(){
 
-			this.connectOptions = connectOptions;
-			this._reconnectInterval = 1;
-			this._reconnecting = false;
-			if (connectOptions.uris) {
-				this.hostIndex = 0;
-				this._doConnect(connectOptions.uris[0]);
-			} else {
-				this._doConnect(this.uri);
-			}
 
-		};
+	var PahoMQTT = (function (global) {
 
-		ClientImpl.prototype.subscribe = function (filter, subscribeOptions) {
-			this._trace("Client.subscribe", filter, subscribeOptions);
+	// Private variables below, these are only visible inside the function closure
+	// which is used to define the module.
+	var version = "@VERSION@-@BUILDLEVEL@";
 
-			if (!this.connected)
-				throw new Error(format(ERROR.INVALID_STATE, ["not connected"]));
+	/**
+	 * @private
+	 */
+	var localStorage = global.localStorage || (function () {
+		var data = {};
 
-            var wireMessage = new WireMessage(MESSAGE_TYPE.SUBSCRIBE);
-            wireMessage.topics = filter.constructor === Array ? filter : [filter];
-            if (subscribeOptions.qos === undefined)
-                subscribeOptions.qos = 0;
-            wireMessage.requestedQos = [];
-            for (var i = 0; i < wireMessage.topics.length; i++)
-                wireMessage.requestedQos[i] = subscribeOptions.qos;
+		return {
+			setItem: function (key, item) { data[key] = item; },
+			getItem: function (key) { return data[key]; },
+			removeItem: function (key) { delete data[key]; },
+		};
+	})();
 
-			if (subscribeOptions.onSuccess) {
-				wireMessage.onSuccess = function(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};
-			}
-
-			if (subscribeOptions.onFailure) {
-				wireMessage.onFailure = function(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};
-			}
-
-			if (subscribeOptions.timeout) {
-				wireMessage.timeOut = new Timeout(this, subscribeOptions.timeout, subscribeOptions.onFailure,
-					[{invocationContext:subscribeOptions.invocationContext,
-						errorCode:ERROR.SUBSCRIBE_TIMEOUT.code,
-						errorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);
-			}
-
-			// All subscriptions return a SUBACK.
-			this._requires_ack(wireMessage);
-			this._schedule_message(wireMessage);
+		/**
+	 * Unique message type identifiers, with associated
+	 * associated integer values.
+	 * @private
+	 */
+		var MESSAGE_TYPE = {
+			CONNECT: 1,
+			CONNACK: 2,
+			PUBLISH: 3,
+			PUBACK: 4,
+			PUBREC: 5,
+			PUBREL: 6,
+			PUBCOMP: 7,
+			SUBSCRIBE: 8,
+			SUBACK: 9,
+			UNSUBSCRIBE: 10,
+			UNSUBACK: 11,
+			PINGREQ: 12,
+			PINGRESP: 13,
+			DISCONNECT: 14
 		};
 
-		/** @ignore */
-		ClientImpl.prototype.unsubscribe = function(filter, unsubscribeOptions) {
-			this._trace("Client.unsubscribe", filter, unsubscribeOptions);
-
-			if (!this.connected)
-				throw new Error(format(ERROR.INVALID_STATE, ["not connected"]));
-
-            var wireMessage = new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);
-            wireMessage.topics = filter.constructor === Array ? filter : [filter];
+		// Collection of utility methods used to simplify module code
+		// and promote the DRY pattern.
 
-			if (unsubscribeOptions.onSuccess) {
-				wireMessage.callback = function() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};
-			}
-			if (unsubscribeOptions.timeout) {
-				wireMessage.timeOut = new Timeout(this, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,
-					[{invocationContext:unsubscribeOptions.invocationContext,
-						errorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,
-						errorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);
+		/**
+	 * Validate an object's parameter names to ensure they
+	 * match a list of expected variables name for this option
+	 * type. Used to ensure option object passed into the API don't
+	 * contain erroneous parameters.
+	 * @param {Object} obj - User options object
+	 * @param {Object} keys - valid keys and types that may exist in obj.
+	 * @throws {Error} Invalid option parameter found.
+	 * @private
+	 */
+		var validate = function(obj, keys) {
+			for (var key in obj) {
+				if (obj.hasOwnProperty(key)) {
+					if (keys.hasOwnProperty(key)) {
+						if (typeof obj[key] !== keys[key])
+							throw new Error(format(ERROR.INVALID_TYPE, [typeof obj[key], key]));
+					} else {
+						var errorStr = "Unknown property, " + key + ". Valid properties are:";
+						for (var validKey in keys)
+							if (keys.hasOwnProperty(validKey))
+								errorStr = errorStr+" "+validKey;
+						throw new Error(errorStr);
+					}
+				}
 			}
+		};
 
-			// All unsubscribes return a SUBACK.
-			this._requires_ack(wireMessage);
-			this._schedule_message(wireMessage);
+		/**
+	 * Return a new function which runs the user function bound
+	 * to a fixed scope.
+	 * @param {function} User function
+	 * @param {object} Function scope
+	 * @return {function} User function bound to another scope
+	 * @private
+	 */
+		var scope = function (f, scope) {
+			return function () {
+				return f.apply(scope, arguments);
+			};
 		};
 
-		ClientImpl.prototype.send = function (message) {
-			this._trace("Client.send", message);
+		/**
+	 * Unique message type identifiers, with associated
+	 * associated integer values.
+	 * @private
+	 */
+		var ERROR = {
+			OK: {code:0, text:"AMQJSC0000I OK."},
+			CONNECT_TIMEOUT: {code:1, text:"AMQJSC0001E Connect timed out."},
+			SUBSCRIBE_TIMEOUT: {code:2, text:"AMQJS0002E Subscribe timed out."},
+			UNSUBSCRIBE_TIMEOUT: {code:3, text:"AMQJS0003E Unsubscribe timed out."},
+			PING_TIMEOUT: {code:4, text:"AMQJS0004E Ping timed out."},
+			INTERNAL_ERROR: {code:5, text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},
+			CONNACK_RETURNCODE: {code:6, text:"AMQJS0006E Bad Connack return code:{0} {1}."},
+			SOCKET_ERROR: {code:7, text:"AMQJS0007E Socket error:{0}."},
+			SOCKET_CLOSE: {code:8, text:"AMQJS0008I Socket closed."},
+			MALFORMED_UTF: {code:9, text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},
+			UNSUPPORTED: {code:10, text:"AMQJS0010E {0} is not supported by this browser."},
+			INVALID_STATE: {code:11, text:"AMQJS0011E Invalid state {0}."},
+			INVALID_TYPE: {code:12, text:"AMQJS0012E Invalid type {0} for {1}."},
+			INVALID_ARGUMENT: {code:13, text:"AMQJS0013E Invalid argument {0} for {1}."},
+			UNSUPPORTED_OPERATION: {code:14, text:"AMQJS0014E Unsupported operation."},
+			INVALID_STORED_DATA: {code:15, text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},
+			INVALID_MQTT_MESSAGE_TYPE: {code:16, text:"AMQJS0016E Invalid MQTT message type {0}."},
+			MALFORMED_UNICODE: {code:17, text:"AMQJS0017E Malformed Unicode string:{0} {1}."},
+			BUFFER_FULL: {code:18, text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."},
+		};
 
-			var wireMessage = new WireMessage(MESSAGE_TYPE.PUBLISH);
-			wireMessage.payloadMessage = message;
+		/** CONNACK RC Meaning. */
+		var CONNACK_RC = {
+			0:"Connection Accepted",
+			1:"Connection Refused: unacceptable protocol version",
+			2:"Connection Refused: identifier rejected",
+			3:"Connection Refused: server unavailable",
+			4:"Connection Refused: bad user name or password",
+			5:"Connection Refused: not authorized"
+		};
 
-			if (this.connected) {
-			// Mark qos 1 & 2 message as "ACK required"
-			// For qos 0 message, invoke onMessageDelivered callback if there is one.
-			// Then schedule the message.
-				if (message.qos > 0) {
-					this._requires_ack(wireMessage);
-				} else if (this.onMessageDelivered) {
-					this._notify_msg_sent[wireMessage] = this.onMessageDelivered(wireMessage.payloadMessage);
-				}
-				this._schedule_message(wireMessage);
-			} else {
-			// Currently disconnected, will not schedule this message
-			// Check if reconnecting is in progress and disconnected publish is enabled.
-				if (this._reconnecting && this.disconnectedPublishing) {
-				// Check the limit which include the "required ACK" messages
-					var messageCount = Object.keys(this._sentMessages).length + this._buffered_msg_queue.length;
-					if (messageCount > this.disconnectedBufferSize) {
-						throw new Error(format(ERROR.BUFFER_FULL, [this.disconnectedBufferSize]));
-					} else {
-						if (message.qos > 0) {
-						// Mark this message as "ACK required"
-							this._requires_ack(wireMessage);
-						} else {
-							wireMessage.sequence = ++this._sequence;
-							// Add messages in fifo order to array, by adding to start
-							this._buffered_msg_queue.unshift(wireMessage);
-						}
+	/**
+	 * Format an error message text.
+	 * @private
+	 * @param {error} ERROR value above.
+	 * @param {substitutions} [array] substituted into the text.
+	 * @return the text with the substitutions made.
+	 */
+		var format = function(error, substitutions) {
+			var text = error.text;
+			if (substitutions) {
+				var field,start;
+				for (var i=0; i<substitutions.length; i++) {
+					field = "{"+i+"}";
+					start = text.indexOf(field);
+					if(start > 0) {
+						var part1 = text.substring(0,start);
+						var part2 = text.substring(start+field.length);
+						text = part1+substitutions[i]+part2;
 					}
-				} else {
-					throw new Error(format(ERROR.INVALID_STATE, ["not connected"]));
 				}
 			}
+			return text;
 		};
 
-		ClientImpl.prototype.disconnect = function () {
-			this._trace("Client.disconnect");
+		//MQTT protocol and version          6    M    Q    I    s    d    p    3
+		var MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];
+		//MQTT proto/version for 311         4    M    Q    T    T    4
+		var MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];
 
-			if (this._reconnecting) {
-			// disconnect() function is called while reconnect is in progress.
-			// Terminate the auto reconnect process.
-				this._reconnectTimeout.cancel();
-				this._reconnectTimeout = null;
-				this._reconnecting = false;
+		/**
+	 * Construct an MQTT wire protocol message.
+	 * @param type MQTT packet type.
+	 * @param options optional wire message attributes.
+	 *
+	 * Optional properties
+	 *
+	 * messageIdentifier: message ID in the range [0..65535]
+	 * payloadMessage:	Application Message - PUBLISH only
+	 * connectStrings:	array of 0 or more Strings to be put into the CONNECT payload
+	 * topics:			array of strings (SUBSCRIBE, UNSUBSCRIBE)
+	 * requestQoS:		array of QoS values [0..2]
+	 *
+	 * "Flag" properties
+	 * cleanSession:	true if present / false if absent (CONNECT)
+	 * willMessage:  	true if present / false if absent (CONNECT)
+	 * isRetained:		true if present / false if absent (CONNECT)
+	 * userName:		true if present / false if absent (CONNECT)
+	 * password:		true if present / false if absent (CONNECT)
+	 * keepAliveInterval:	integer [0..65535]  (CONNECT)
+	 *
+	 * @private
+	 * @ignore
+	 */
+		var WireMessage = function (type, options) {
+			this.type = type;
+			for (var name in options) {
+				if (options.hasOwnProperty(name)) {
+					this[name] = options[name];
+				}
 			}
+		};
 
-			if (!this.socket)
-				throw new Error(format(ERROR.INVALID_STATE, ["not connecting or connected"]));
+		WireMessage.prototype.encode = function() {
+		// Compute the first byte of the fixed header
+			var first = ((this.type & 0x0f) << 4);
 
-			var wireMessage = new WireMessage(MESSAGE_TYPE.DISCONNECT);
+			/*
+		 * Now calculate the length of the variable header + payload by adding up the lengths
+		 * of all the component parts
+		 */
 
-			// Run the disconnected call back as soon as the message has been sent,
-			// in case of a failure later on in the disconnect processing.
-			// as a consequence, the _disconected call back may be run several times.
-			this._notify_msg_sent[wireMessage] = scope(this._disconnected, this);
+			var remLength = 0;
+			var topicStrLength = [];
+			var destinationNameLength = 0;
+			var willMessagePayloadBytes;
 
-			this._schedule_message(wireMessage);
-		};
+			// if the message contains a messageIdentifier then we need two bytes for that
+			if (this.messageIdentifier !== undefined)
+				remLength += 2;
 
-		ClientImpl.prototype.getTraceLog = function () {
-			if ( this._traceBuffer !== null ) {
-				this._trace("Client.getTraceLog", new Date());
-				this._trace("Client.getTraceLog in flight messages", this._sentMessages.length);
-				for (var key in this._sentMessages)
-					this._trace("_sentMessages ",key, this._sentMessages[key]);
-				for (var key in this._receivedMessages)
-					this._trace("_receivedMessages ",key, this._receivedMessages[key]);
-
-				return this._traceBuffer;
-			}
-		};
+			switch(this.type) {
+			// If this a Connect then we need to include 12 bytes for its header
+			case MESSAGE_TYPE.CONNECT:
+				switch(this.mqttVersion) {
+				case 3:
+					remLength += MqttProtoIdentifierv3.length + 3;
+					break;
+				case 4:
+					remLength += MqttProtoIdentifierv4.length + 3;
+					break;
+				}
 
-		ClientImpl.prototype.startTrace = function () {
-			if ( this._traceBuffer === null ) {
-				this._traceBuffer = [];
-			}
-			this._trace("Client.startTrace", new Date(), version);
-		};
+				remLength += UTF8Length(this.clientId) + 2;
+				if (this.willMessage !== undefined) {
+					remLength += UTF8Length(this.willMessage.destinationName) + 2;
+					// Will message is always a string, sent as UTF-8 characters with a preceding length.
+					willMessagePayloadBytes = this.willMessage.payloadBytes;
+					if (!(willMessagePayloadBytes instanceof Uint8Array))
+						willMessagePayloadBytes = new Uint8Array(payloadBytes);
+					remLength += willMessagePayloadBytes.byteLength +2;
+				}
+				if (this.userName !== undefined)
+					remLength += UTF8Length(this.userName) + 2;
+				if (this.password !== undefined)
+					remLength += UTF8Length(this.password) + 2;
+				break;
 
-		ClientImpl.prototype.stopTrace = function () {
-			delete this._traceBuffer;
-		};
+			// Subscribe, Unsubscribe can both contain topic strings
+			case MESSAGE_TYPE.SUBSCRIBE:
+				first |= 0x02; // Qos = 1;
+				for ( var i = 0; i < this.topics.length; i++) {
+					topicStrLength[i] = UTF8Length(this.topics[i]);
+					remLength += topicStrLength[i] + 2;
+				}
+				remLength += this.requestedQos.length; // 1 byte for each topic's Qos
+				// QoS on Subscribe only
+				break;
 
-		ClientImpl.prototype._doConnect = function (wsurl) {
-		// When the socket is open, this client will send the CONNECT WireMessage using the saved parameters.
-			if (this.connectOptions.useSSL) {
-				var uriParts = wsurl.split(":");
-				uriParts[0] = "wss";
-				wsurl = uriParts.join(":");
-			}
-			this._wsuri = wsurl;
-			this.connected = false;
+			case MESSAGE_TYPE.UNSUBSCRIBE:
+				first |= 0x02; // Qos = 1;
+				for ( var i = 0; i < this.topics.length; i++) {
+					topicStrLength[i] = UTF8Length(this.topics[i]);
+					remLength += topicStrLength[i] + 2;
+				}
+				break;
 
+			case MESSAGE_TYPE.PUBREL:
+				first |= 0x02; // Qos = 1;
+				break;
 
+			case MESSAGE_TYPE.PUBLISH:
+				if (this.payloadMessage.duplicate) first |= 0x08;
+				first  = first |= (this.payloadMessage.qos << 1);
+				if (this.payloadMessage.retained) first |= 0x01;
+				destinationNameLength = UTF8Length(this.payloadMessage.destinationName);
+				remLength += destinationNameLength + 2;
+				var payloadBytes = this.payloadMessage.payloadBytes;
+				remLength += payloadBytes.byteLength;
+				if (payloadBytes instanceof ArrayBuffer)
+					payloadBytes = new Uint8Array(payloadBytes);
+				else if (!(payloadBytes instanceof Uint8Array))
+					payloadBytes = new Uint8Array(payloadBytes.buffer);
+				break;
 
-			if (this.connectOptions.mqttVersion < 4) {
-				this.socket = new WebSocket(wsurl, ["mqttv3.1"]);
-			} else {
-				this.socket = new WebSocket(wsurl, ["mqtt"]);
-			}
-			this.socket.binaryType = "arraybuffer";
-			this.socket.onopen = scope(this._on_socket_open, this);
-			this.socket.onmessage = scope(this._on_socket_message, this);
-			this.socket.onerror = scope(this._on_socket_error, this);
-			this.socket.onclose = scope(this._on_socket_close, this);
+			case MESSAGE_TYPE.DISCONNECT:
+				break;
 
-			this.sendPinger = new Pinger(this, this.connectOptions.keepAliveInterval);
-			this.receivePinger = new Pinger(this, this.connectOptions.keepAliveInterval);
-			if (this._connectTimeout) {
-				this._connectTimeout.cancel();
-				this._connectTimeout = null;
+			default:
+				break;
 			}
-			this._connectTimeout = new Timeout(this, this.connectOptions.timeout, this._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);
-		};
 
+			// Now we can allocate a buffer for the message
 
-		// Schedule a new message to be sent over the WebSockets
-		// connection. CONNECT messages cause WebSocket connection
-		// to be started. All other messages are queued internally
-		// until this has happened. When WS connection starts, process
-		// all outstanding messages.
-		ClientImpl.prototype._schedule_message = function (message) {
-			// Add messages in fifo order to array, by adding to start
-			this._msg_queue.unshift(message);
-			// Process outstanding messages in the queue if we have an  open socket, and have received CONNACK.
-			if (this.connected) {
-				this._process_queue();
-			}
-		};
+			var mbi = encodeMBI(remLength);  // Convert the length to MQTT MBI format
+			var pos = mbi.length + 1;        // Offset of start of variable header
+			var buffer = new ArrayBuffer(remLength + pos);
+			var byteStream = new Uint8Array(buffer);    // view it as a sequence of bytes
 
-		ClientImpl.prototype.store = function(prefix, wireMessage) {
-			var storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};
+			//Write the fixed header into the buffer
+			byteStream[0] = first;
+			byteStream.set(mbi,1);
 
-			switch(wireMessage.type) {
-			case MESSAGE_TYPE.PUBLISH:
-				if(wireMessage.pubRecReceived)
-					storedMessage.pubRecReceived = true;
+			// If this is a PUBLISH then the variable header starts with a topic
+			if (this.type == MESSAGE_TYPE.PUBLISH)
+				pos = writeString(this.payloadMessage.destinationName, destinationNameLength, byteStream, pos);
+			// If this is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time
 
-				// Convert the payload to a hex string.
-				storedMessage.payloadMessage = {};
-				var hex = "";
-				var messageBytes = wireMessage.payloadMessage.payloadBytes;
-				for (var i=0; i<messageBytes.length; i++) {
-					if (messageBytes[i] <= 0xF)
-						hex = hex+"0"+messageBytes[i].toString(16);
-					else
-						hex = hex+messageBytes[i].toString(16);
+			else if (this.type == MESSAGE_TYPE.CONNECT) {
+				switch (this.mqttVersion) {
+				case 3:
+					byteStream.set(MqttProtoIdentifierv3, pos);
+					pos += MqttProtoIdentifierv3.length;
+					break;
+				case 4:
+					byteStream.set(MqttProtoIdentifierv4, pos);
+					pos += MqttProtoIdentifierv4.length;
+					break;
 				}
-				storedMessage.payloadMessage.payloadHex = hex;
+				var connectFlags = 0;
+				if (this.cleanSession)
+					connectFlags = 0x02;
+				if (this.willMessage !== undefined ) {
+					connectFlags |= 0x04;
+					connectFlags |= (this.willMessage.qos<<3);
+					if (this.willMessage.retained) {
+						connectFlags |= 0x20;
+					}
+				}
+				if (this.userName !== undefined)
+					connectFlags |= 0x80;
+				if (this.password !== undefined)
+					connectFlags |= 0x40;
+				byteStream[pos++] = connectFlags;
+				pos = writeUint16 (this.keepAliveInterval, byteStream, pos);
+			}
 
-				storedMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;
-				storedMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;
-				if (wireMessage.payloadMessage.duplicate)
-					storedMessage.payloadMessage.duplicate = true;
-				if (wireMessage.payloadMessage.retained)
-					storedMessage.payloadMessage.retained = true;
+			// Output the messageIdentifier - if there is one
+			if (this.messageIdentifier !== undefined)
+				pos = writeUint16 (this.messageIdentifier, byteStream, pos);
+
+			switch(this.type) {
+			case MESSAGE_TYPE.CONNECT:
+				pos = writeString(this.clientId, UTF8Length(this.clientId), byteStream, pos);
+				if (this.willMessage !== undefined) {
+					pos = writeString(this.willMessage.destinationName, UTF8Length(this.willMessage.destinationName), byteStream, pos);
+					pos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);
+					byteStream.set(willMessagePayloadBytes, pos);
+					pos += willMessagePayloadBytes.byteLength;
 
-				// Add a sequence number to sent messages.
-				if ( prefix.indexOf("Sent:") === 0 ) {
-					if ( wireMessage.sequence === undefined )
-						wireMessage.sequence = ++this._sequence;
-					storedMessage.sequence = wireMessage.sequence;
 				}
+				if (this.userName !== undefined)
+					pos = writeString(this.userName, UTF8Length(this.userName), byteStream, pos);
+				if (this.password !== undefined)
+					pos = writeString(this.password, UTF8Length(this.password), byteStream, pos);
 				break;
 
-			default:
-				throw Error(format(ERROR.INVALID_STORED_DATA, [prefix+this._localKey+wireMessage.messageIdentifier, storedMessage]));
-			}
-			localStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));
-		};
+			case MESSAGE_TYPE.PUBLISH:
+				// PUBLISH has a text or binary payload, if text do not add a 2 byte length field, just the UTF characters.
+				byteStream.set(payloadBytes, pos);
 
-		ClientImpl.prototype.restore = function(key) {
-			var value = localStorage.getItem(key);
-			var storedMessage = JSON.parse(value);
+				break;
 
-			var wireMessage = new WireMessage(storedMessage.type, storedMessage);
+				//    	    case MESSAGE_TYPE.PUBREC:
+				//    	    case MESSAGE_TYPE.PUBREL:
+				//    	    case MESSAGE_TYPE.PUBCOMP:
+				//    	    	break;
 
-			switch(storedMessage.type) {
-			case MESSAGE_TYPE.PUBLISH:
-				// Replace the payload message with a Message object.
-				var hex = storedMessage.payloadMessage.payloadHex;
-				var buffer = new ArrayBuffer((hex.length)/2);
-				var byteStream = new Uint8Array(buffer);
-				var i = 0;
-				while (hex.length >= 2) {
-					var x = parseInt(hex.substring(0, 2), 16);
-					hex = hex.substring(2, hex.length);
-					byteStream[i++] = x;
+			case MESSAGE_TYPE.SUBSCRIBE:
+				// SUBSCRIBE has a list of topic strings and request QoS
+				for (var i=0; i<this.topics.length; i++) {
+					pos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);
+					byteStream[pos++] = this.requestedQos[i];
 				}
-				var payloadMessage = new Message(byteStream);
-
-				payloadMessage.qos = storedMessage.payloadMessage.qos;
-				payloadMessage.destinationName = storedMessage.payloadMessage.destinationName;
-				if (storedMessage.payloadMessage.duplicate)
-					payloadMessage.duplicate = true;
-				if (storedMessage.payloadMessage.retained)
-					payloadMessage.retained = true;
-				wireMessage.payloadMessage = payloadMessage;
+				break;
 
+			case MESSAGE_TYPE.UNSUBSCRIBE:
+				// UNSUBSCRIBE has a list of topic strings
+				for (var i=0; i<this.topics.length; i++)
+					pos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);
 				break;
 
 			default:
-				throw Error(format(ERROR.INVALID_STORED_DATA, [key, value]));
+				// Do nothing.
 			}
 
-			if (key.indexOf("Sent:"+this._localKey) === 0) {
-				wireMessage.payloadMessage.duplicate = true;
-				this._sentMessages[wireMessage.messageIdentifier] = wireMessage;
-			} else if (key.indexOf("Received:"+this._localKey) === 0) {
-				this._receivedMessages[wireMessage.messageIdentifier] = wireMessage;
-			}
+			return buffer;
 		};
 
-		ClientImpl.prototype._process_queue = function () {
-			var message = null;
+		function decodeMessage(input,pos) {
+			var startingPos = pos;
+			var first = input[pos];
+			var type = first >> 4;
+			var messageInfo = first &= 0x0f;
+			pos += 1;
 
-			// Send all queued messages down socket connection
-			while ((message = this._msg_queue.pop())) {
-				this._socket_send(message);
-				// Notify listeners that message was successfully sent
-				if (this._notify_msg_sent[message]) {
-					this._notify_msg_sent[message]();
-					delete this._notify_msg_sent[message];
-				}
-			}
-		};
 
-		/**
-	 * Expect an ACK response for this message. Add message to the set of in progress
-	 * messages and set an unused identifier in this message.
-	 * @ignore
-	 */
-		ClientImpl.prototype._requires_ack = function (wireMessage) {
-			var messageCount = Object.keys(this._sentMessages).length;
-			if (messageCount > this.maxMessageIdentifier)
-				throw Error ("Too many messages:"+messageCount);
+			// Decode the remaining length (MBI format)
 
-			while(this._sentMessages[this._message_identifier] !== undefined) {
-				this._message_identifier++;
-			}
-			wireMessage.messageIdentifier = this._message_identifier;
-			this._sentMessages[wireMessage.messageIdentifier] = wireMessage;
-			if (wireMessage.type === MESSAGE_TYPE.PUBLISH) {
-				this.store("Sent:", wireMessage);
-			}
-			if (this._message_identifier === this.maxMessageIdentifier) {
-				this._message_identifier = 1;
+			var digit;
+			var remLength = 0;
+			var multiplier = 1;
+			do {
+				if (pos == input.length) {
+					return [null,startingPos];
+				}
+				digit = input[pos++];
+				remLength += ((digit & 0x7F) * multiplier);
+				multiplier *= 128;
+			} while ((digit & 0x80) !== 0);
+
+			var endPos = pos+remLength;
+			if (endPos > input.length) {
+				return [null,startingPos];
 			}
-		};
 
-		/**
-	 * Called when the underlying websocket has been opened.
-	 * @ignore
-	 */
-		ClientImpl.prototype._on_socket_open = function () {
-		// Create the CONNECT message object.
-			var wireMessage = new WireMessage(MESSAGE_TYPE.CONNECT, this.connectOptions);
-			wireMessage.clientId = this.clientId;
-			this._socket_send(wireMessage);
-		};
+			var wireMessage = new WireMessage(type);
+			switch(type) {
+			case MESSAGE_TYPE.CONNACK:
+				var connectAcknowledgeFlags = input[pos++];
+				if (connectAcknowledgeFlags & 0x01)
+					wireMessage.sessionPresent = true;
+				wireMessage.returnCode = input[pos++];
+				break;
 
-		/**
-	 * Called when the underlying websocket has received a complete packet.
-	 * @ignore
-	 */
-		ClientImpl.prototype._on_socket_message = function (event) {
-			this._trace("Client._on_socket_message", event.data);
-			var messages = this._deframeMessages(event.data);
-			for (var i = 0; i < messages.length; i+=1) {
-				this._handleMessage(messages[i]);
-			}
-		};
+			case MESSAGE_TYPE.PUBLISH:
+				var qos = (messageInfo >> 1) & 0x03;
 
-		ClientImpl.prototype._deframeMessages = function(data) {
-			var byteArray = new Uint8Array(data);
-			var messages = [];
-			if (this.receiveBuffer) {
-				var newData = new Uint8Array(this.receiveBuffer.length+byteArray.length);
-				newData.set(this.receiveBuffer);
-				newData.set(byteArray,this.receiveBuffer.length);
-				byteArray = newData;
-				delete this.receiveBuffer;
-			}
-			try {
-				var offset = 0;
-				while(offset < byteArray.length) {
-					var result = decodeMessage(byteArray,offset);
-					var wireMessage = result[0];
-					offset = result[1];
-					if (wireMessage !== null) {
-						messages.push(wireMessage);
-					} else {
-						break;
-					}
-				}
-				if (offset < byteArray.length) {
-					this.receiveBuffer = byteArray.subarray(offset);
+				var len = readUint16(input, pos);
+				pos += 2;
+				var topicName = parseUTF8(input, pos, len);
+				pos += len;
+				// If QoS 1 or 2 there will be a messageIdentifier
+				if (qos > 0) {
+					wireMessage.messageIdentifier = readUint16(input, pos);
+					pos += 2;
 				}
-			} catch (error) {
-				var errorStack = ((error.hasOwnProperty("stack") == "undefined") ? error.stack.toString() : "No Error Stack Available");
-				this._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));
-				return;
-			}
-			return messages;
-		};
 
-		ClientImpl.prototype._handleMessage = function(wireMessage) {
+				var message = new Message(input.subarray(pos, endPos));
+				if ((messageInfo & 0x01) == 0x01)
+					message.retained = true;
+				if ((messageInfo & 0x08) == 0x08)
+					message.duplicate =  true;
+				message.qos = qos;
+				message.destinationName = topicName;
+				wireMessage.payloadMessage = message;
+				break;
 
-			this._trace("Client._handleMessage", wireMessage);
+			case  MESSAGE_TYPE.PUBACK:
+			case  MESSAGE_TYPE.PUBREC:
+			case  MESSAGE_TYPE.PUBREL:
+			case  MESSAGE_TYPE.PUBCOMP:
+			case  MESSAGE_TYPE.UNSUBACK:
+				wireMessage.messageIdentifier = readUint16(input, pos);
+				break;
 
-			try {
-				switch(wireMessage.type) {
-				case MESSAGE_TYPE.CONNACK:
-					this._connectTimeout.cancel();
-					if (this._reconnectTimeout)
-						this._reconnectTimeout.cancel();
+			case  MESSAGE_TYPE.SUBACK:
+				wireMessage.messageIdentifier = readUint16(input, pos);
+				pos += 2;
+				wireMessage.returnCode = input.subarray(pos, endPos);
+				break;
 
-					// If we have started using clean session then clear up the local state.
-					if (this.connectOptions.cleanSession) {
-						for (var key in this._sentMessages) {
-							var sentMessage = this._sentMessages[key];
-							localStorage.removeItem("Sent:"+this._localKey+sentMessage.messageIdentifier);
-						}
-						this._sentMessages = {};
+			default:
+				break;
+			}
 
-						for (var key in this._receivedMessages) {
-							var receivedMessage = this._receivedMessages[key];
-							localStorage.removeItem("Received:"+this._localKey+receivedMessage.messageIdentifier);
-						}
-						this._receivedMessages = {};
-					}
-					// Client connected and ready for business.
-					if (wireMessage.returnCode === 0) {
+			return [wireMessage,endPos];
+		}
 
-						this.connected = true;
-						// Jump to the end of the list of uris and stop looking for a good host.
+		function writeUint16(input, buffer, offset) {
+			buffer[offset++] = input >> 8;      //MSB
+			buffer[offset++] = input % 256;     //LSB
+			return offset;
+		}
 
-						if (this.connectOptions.uris)
-							this.hostIndex = this.connectOptions.uris.length;
+		function writeString(input, utf8Length, buffer, offset) {
+			offset = writeUint16(utf8Length, buffer, offset);
+			stringToUTF8(input, buffer, offset);
+			return offset + utf8Length;
+		}
 
-					} else {
-						this._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));
-						break;
-					}
+		function readUint16(buffer, offset) {
+			return 256*buffer[offset] + buffer[offset+1];
+		}
 
-					// Resend messages.
-					var sequencedMessages = [];
-					for (var msgId in this._sentMessages) {
-						if (this._sentMessages.hasOwnProperty(msgId))
-							sequencedMessages.push(this._sentMessages[msgId]);
-					}
+		/**
+	 * Encodes an MQTT Multi-Byte Integer
+	 * @private
+	 */
+		function encodeMBI(number) {
+			var output = new Array(1);
+			var numBytes = 0;
 
-					// Also schedule qos 0 buffered messages if any
-					if (this._buffered_msg_queue.length > 0) {
-						var msg = null;
-						while ((msg = this._buffered_msg_queue.pop())) {
-							sequencedMessages.push(msg);
-							if (this.onMessageDelivered)
-								this._notify_msg_sent[msg] = this.onMessageDelivered(msg.payloadMessage);
-						}
-					}
+			do {
+				var digit = number % 128;
+				number = number >> 7;
+				if (number > 0) {
+					digit |= 0x80;
+				}
+				output[numBytes++] = digit;
+			} while ( (number > 0) && (numBytes<4) );
 
-					// Sort sentMessages into the original sent order.
-					var sequencedMessages = sequencedMessages.sort(function(a,b) {return a.sequence - b.sequence;} );
-					for (var i=0, len=sequencedMessages.length; i<len; i++) {
-						var sentMessage = sequencedMessages[i];
-						if (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {
-							var pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});
-							this._schedule_message(pubRelMessage);
-						} else {
-							this._schedule_message(sentMessage);
-						}
-					}
+			return output;
+		}
 
-					// Execute the connectOptions.onSuccess callback if there is one.
-					// Will also now return if this connection was the result of an automatic
-					// reconnect and which URI was successfully connected to.
-					if (this.connectOptions.onSuccess) {
-						this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});
+		/**
+	 * Takes a String and calculates its length in bytes when encoded in UTF8.
+	 * @private
+	 */
+		function UTF8Length(input) {
+			var output = 0;
+			for (var i = 0; i<input.length; i++)
+			{
+				var charCode = input.charCodeAt(i);
+				if (charCode > 0x7FF)
+				{
+					// Surrogate pair means its a 4 byte character
+					if (0xD800 <= charCode && charCode <= 0xDBFF)
+					{
+						i++;
+						output++;
 					}
+					output +=3;
+				}
+				else if (charCode > 0x7F)
+					output +=2;
+				else
+					output++;
+			}
+			return output;
+		}
 
-					var reconnected = false;
-					if (this._reconnecting) {
-						reconnected = true;
-						this._reconnectInterval = 1;
-						this._reconnecting = false;
-					}
-
-					// Execute the onConnected callback if there is one.
-					this._connected(reconnected, this._wsuri);
-
-					// Process all queued messages now that the connection is established.
-					this._process_queue();
-					break;
-
-				case MESSAGE_TYPE.PUBLISH:
-					this._receivePublish(wireMessage);
-					break;
-
-				case MESSAGE_TYPE.PUBACK:
-					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
-					// If this is a re flow of a PUBACK after we have restarted receivedMessage will not exist.
-					if (sentMessage) {
-						delete this._sentMessages[wireMessage.messageIdentifier];
-						localStorage.removeItem("Sent:"+this._localKey+wireMessage.messageIdentifier);
-						if (this.onMessageDelivered)
-							this.onMessageDelivered(sentMessage.payloadMessage);
-					}
-					break;
-
-				case MESSAGE_TYPE.PUBREC:
-					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
-					// If this is a re flow of a PUBREC after we have restarted receivedMessage will not exist.
-					if (sentMessage) {
-						sentMessage.pubRecReceived = true;
-						var pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});
-						this.store("Sent:", sentMessage);
-						this._schedule_message(pubRelMessage);
-					}
-					break;
+		/**
+	 * Takes a String and writes it into an array as UTF8 encoded bytes.
+	 * @private
+	 */
+		function stringToUTF8(input, output, start) {
+			var pos = start;
+			for (var i = 0; i<input.length; i++) {
+				var charCode = input.charCodeAt(i);
 
-				case MESSAGE_TYPE.PUBREL:
-					var receivedMessage = this._receivedMessages[wireMessage.messageIdentifier];
-					localStorage.removeItem("Received:"+this._localKey+wireMessage.messageIdentifier);
-					// If this is a re flow of a PUBREL after we have restarted receivedMessage will not exist.
-					if (receivedMessage) {
-						this._receiveMessage(receivedMessage);
-						delete this._receivedMessages[wireMessage.messageIdentifier];
+				// Check for a surrogate pair.
+				if (0xD800 <= charCode && charCode <= 0xDBFF) {
+					var lowCharCode = input.charCodeAt(++i);
+					if (isNaN(lowCharCode)) {
+						throw new Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));
 					}
-					// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.
-					var pubCompMessage = new WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});
-					this._schedule_message(pubCompMessage);
+					charCode = ((charCode - 0xD800)<<10) + (lowCharCode - 0xDC00) + 0x10000;
 
+				}
 
-					break;
+				if (charCode <= 0x7F) {
+					output[pos++] = charCode;
+				} else if (charCode <= 0x7FF) {
+					output[pos++] = charCode>>6  & 0x1F | 0xC0;
+					output[pos++] = charCode     & 0x3F | 0x80;
+				} else if (charCode <= 0xFFFF) {
+					output[pos++] = charCode>>12 & 0x0F | 0xE0;
+					output[pos++] = charCode>>6  & 0x3F | 0x80;
+					output[pos++] = charCode     & 0x3F | 0x80;
+				} else {
+					output[pos++] = charCode>>18 & 0x07 | 0xF0;
+					output[pos++] = charCode>>12 & 0x3F | 0x80;
+					output[pos++] = charCode>>6  & 0x3F | 0x80;
+					output[pos++] = charCode     & 0x3F | 0x80;
+				}
+			}
+			return output;
+		}
 
-				case MESSAGE_TYPE.PUBCOMP:
-					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
-					delete this._sentMessages[wireMessage.messageIdentifier];
-					localStorage.removeItem("Sent:"+this._localKey+wireMessage.messageIdentifier);
-					if (this.onMessageDelivered)
-						this.onMessageDelivered(sentMessage.payloadMessage);
-					break;
+		function parseUTF8(input, offset, length) {
+			var output = "";
+			var utf16;
+			var pos = offset;
 
-				case MESSAGE_TYPE.SUBACK:
-					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
-					if (sentMessage) {
-						if(sentMessage.timeOut)
-							sentMessage.timeOut.cancel();
-						// This will need to be fixed when we add multiple topic support
-						if (wireMessage.returnCode[0] === 0x80) {
-							if (sentMessage.onFailure) {
-								sentMessage.onFailure(wireMessage.returnCode);
-							}
-						} else if (sentMessage.onSuccess) {
-							sentMessage.onSuccess(wireMessage.returnCode);
+			while (pos < offset+length)
+			{
+				var byte1 = input[pos++];
+				if (byte1 < 128)
+					utf16 = byte1;
+				else
+				{
+					var byte2 = input[pos++]-128;
+					if (byte2 < 0)
+						throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),""]));
+					if (byte1 < 0xE0)             // 2 byte character
+						utf16 = 64*(byte1-0xC0) + byte2;
+					else
+					{
+						var byte3 = input[pos++]-128;
+						if (byte3 < 0)
+							throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));
+						if (byte1 < 0xF0)        // 3 byte character
+							utf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;
+						else
+						{
+							var byte4 = input[pos++]-128;
+							if (byte4 < 0)
+								throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));
+							if (byte1 < 0xF8)        // 4 byte character
+								utf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;
+							else                     // longer encodings are not supported
+								throw new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));
 						}
-						delete this._sentMessages[wireMessage.messageIdentifier];
 					}
-					break;
+				}
 
-				case MESSAGE_TYPE.UNSUBACK:
-					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
-					if (sentMessage) {
-						if (sentMessage.timeOut)
-							sentMessage.timeOut.cancel();
-						if (sentMessage.callback) {
-							sentMessage.callback();
-						}
-						delete this._sentMessages[wireMessage.messageIdentifier];
-					}
+				if (utf16 > 0xFFFF)   // 4 byte character - express as a surrogate pair
+				{
+					utf16 -= 0x10000;
+					output += String.fromCharCode(0xD800 + (utf16 >> 10)); // lead character
+					utf16 = 0xDC00 + (utf16 & 0x3FF);  // trail character
+				}
+				output += String.fromCharCode(utf16);
+			}
+			return output;
+		}
 
-					break;
+		/**
+	 * Repeat keepalive requests, monitor responses.
+	 * @ignore
+	 */
+		var Pinger = function(client, keepAliveInterval) {
+			this._client = client;
+			this._keepAliveInterval = keepAliveInterval*1000;
+			this.isReset = false;
 
-				case MESSAGE_TYPE.PINGRESP:
-				/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */
-					this.sendPinger.reset();
-					break;
+			var pingReq = new WireMessage(MESSAGE_TYPE.PINGREQ).encode();
 
-				case MESSAGE_TYPE.DISCONNECT:
-				// Clients do not expect to receive disconnect packets.
-					this._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));
-					break;
+			var doTimeout = function (pinger) {
+				return function () {
+					return doPing.apply(pinger);
+				};
+			};
 
-				default:
-					this._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));
+			/** @ignore */
+			var doPing = function() {
+				if (!this.isReset) {
+					this._client._trace("Pinger.doPing", "Timed out");
+					this._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));
+				} else {
+					this.isReset = false;
+					this._client._trace("Pinger.doPing", "send PINGREQ");
+					this._client.socket.send(pingReq);
+					this.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);
 				}
-			} catch (error) {
-				var errorStack = ((error.hasOwnProperty("stack") == "undefined") ? error.stack.toString() : "No Error Stack Available");
-				this._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));
-				return;
-			}
-		};
+			};
 
-		/** @ignore */
-		ClientImpl.prototype._on_socket_error = function (error) {
-			if (!this._reconnecting) {
-				this._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));
-			}
-		};
+			this.reset = function() {
+				this.isReset = true;
+				clearTimeout(this.timeout);
+				if (this._keepAliveInterval > 0)
+					this.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);
+			};
 
-		/** @ignore */
-		ClientImpl.prototype._on_socket_close = function () {
-			if (!this._reconnecting) {
-				this._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));
-			}
+			this.cancel = function() {
+				clearTimeout(this.timeout);
+			};
 		};
 
-		/** @ignore */
-		ClientImpl.prototype._socket_send = function (wireMessage) {
+		/**
+	 * Monitor request completion.
+	 * @ignore
+	 */
+		var Timeout = function(client, timeoutSeconds, action, args) {
+			if (!timeoutSeconds)
+				timeoutSeconds = 30;
 
-			if (wireMessage.type == 1) {
-				var wireMessageMasked = this._traceMask(wireMessage, "password");
-				this._trace("Client._socket_send", wireMessageMasked);
-			}
-			else this._trace("Client._socket_send", wireMessage);
+			var doTimeout = function (action, client, args) {
+				return function () {
+					return action.apply(client, args);
+				};
+			};
+			this.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);
 
-			this.socket.send(wireMessage.encode());
-			/* We have proved to the server we are alive. */
-			this.sendPinger.reset();
+			this.cancel = function() {
+				clearTimeout(this.timeout);
+			};
 		};
 
-		/** @ignore */
-		ClientImpl.prototype._receivePublish = function (wireMessage) {
-			switch(wireMessage.payloadMessage.qos) {
-			case "undefined":
-			case 0:
-				this._receiveMessage(wireMessage);
-				break;
+	/**
+	 * Internal implementation of the Websockets MQTT V3.1 client.
+	 *
+	 * @name Paho.ClientImpl @constructor
+	 * @param {String} host the DNS nameof the webSocket host.
+	 * @param {Number} port the port number for that host.
+	 * @param {String} clientId the MQ client identifier.
+	 */
+		var ClientImpl = function (uri, host, port, path, clientId) {
+		// Check dependencies are satisfied in this browser.
+			if (!("WebSocket" in global && global.WebSocket !== null)) {
+				throw new Error(format(ERROR.UNSUPPORTED, ["WebSocket"]));
+			}
+			if (!("ArrayBuffer" in global && global.ArrayBuffer !== null)) {
+				throw new Error(format(ERROR.UNSUPPORTED, ["ArrayBuffer"]));
+			}
+			this._trace("Paho.Client", uri, host, port, path, clientId);
 
-			case 1:
-				var pubAckMessage = new WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});
-				this._schedule_message(pubAckMessage);
-				this._receiveMessage(wireMessage);
-				break;
+			this.host = host;
+			this.port = port;
+			this.path = path;
+			this.uri = uri;
+			this.clientId = clientId;
+			this._wsuri = null;
 
-			case 2:
-				this._receivedMessages[wireMessage.messageIdentifier] = wireMessage;
-				this.store("Received:", wireMessage);
-				var pubRecMessage = new WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});
-				this._schedule_message(pubRecMessage);
+			// Local storagekeys are qualified with the following string.
+			// The conditional inclusion of path in the key is for backward
+			// compatibility to when the path was not configurable and assumed to
+			// be /mqtt
+			this._localKey=host+":"+port+(path!="/mqtt"?":"+path:"")+":"+clientId+":";
 
-				break;
+			// Create private instance-only message queue
+			// Internal queue of messages to be sent, in sending order.
+			this._msg_queue = [];
+			this._buffered_msg_queue = [];
 
-			default:
-				throw Error("Invaild qos=" + wireMessage.payloadMessage.qos);
-			}
-		};
+			// Messages we have sent and are expecting a response for, indexed by their respective message ids.
+			this._sentMessages = {};
 
-		/** @ignore */
-		ClientImpl.prototype._receiveMessage = function (wireMessage) {
-			if (this.onMessageArrived) {
-				this.onMessageArrived(wireMessage.payloadMessage);
-			}
-		};
+			// Messages we have received and acknowleged and are expecting a confirm message for
+			// indexed by their respective message ids.
+			this._receivedMessages = {};
 
-		/**
-	 * Client has connected.
-	 * @param {reconnect} [boolean] indicate if this was a result of reconnect operation.
-	 * @param {uri} [string] fully qualified WebSocket URI of the server.
-	 */
-		ClientImpl.prototype._connected = function (reconnect, uri) {
-		// Execute the onConnected callback if there is one.
-			if (this.onConnected)
-				this.onConnected(reconnect, uri);
-		};
+			// Internal list of callbacks to be executed when messages
+			// have been successfully sent over web socket, e.g. disconnect
+			// when it doesn't have to wait for ACK, just message is dispatched.
+			this._notify_msg_sent = {};
 
-		/**
-	 * Attempts to reconnect the client to the server.
-   * For each reconnect attempt, will double the reconnect interval
-   * up to 128 seconds.
-	 */
-		ClientImpl.prototype._reconnect = function () {
-			this._trace("Client._reconnect");
-			if (!this.connected) {
-				this._reconnecting = true;
-				this.sendPinger.cancel();
-				this.receivePinger.cancel();
-				if (this._reconnectInterval < 128)
-					this._reconnectInterval = this._reconnectInterval * 2;
-				if (this.connectOptions.uris) {
-					this.hostIndex = 0;
-					this._doConnect(this.connectOptions.uris[0]);
-				} else {
-					this._doConnect(this.uri);
-				}
-			}
+			// Unique identifier for SEND messages, incrementing
+			// counter as messages are sent.
+			this._message_identifier = 1;
+
+			// Used to determine the transmission sequence of stored sent messages.
+			this._sequence = 0;
+
+
+			// Load the local state, if any, from the saved version, only restore state relevant to this client.
+			for (var key in localStorage)
+				if (   key.indexOf("Sent:"+this._localKey) === 0 || key.indexOf("Received:"+this._localKey) === 0)
+					this.restore(key);
 		};
 
-		/**
-	 * Client has disconnected either at its own request or because the server
-	 * or network disconnected it. Remove all non-durable state.
-	 * @param {errorCode} [number] the error number.
-	 * @param {errorText} [string] the error text.
-	 * @ignore
-	 */
-		ClientImpl.prototype._disconnected = function (errorCode, errorText) {
-			this._trace("Client._disconnected", errorCode, errorText);
+		// Messaging Client public instance members.
+		ClientImpl.prototype.host = null;
+		ClientImpl.prototype.port = null;
+		ClientImpl.prototype.path = null;
+		ClientImpl.prototype.uri = null;
+		ClientImpl.prototype.clientId = null;
 
-			if (errorCode !== undefined && this._reconnecting) {
-				//Continue automatic reconnect process
-				this._reconnectTimeout = new Timeout(this, this._reconnectInterval, this._reconnect);
-				return;
-			}
+		// Messaging Client private instance members.
+		ClientImpl.prototype.socket = null;
+		/* true once we have received an acknowledgement to a CONNECT packet. */
+		ClientImpl.prototype.connected = false;
+		/* The largest message identifier allowed, may not be larger than 2**16 but
+		 * if set smaller reduces the maximum number of outbound messages allowed.
+		 */
+		ClientImpl.prototype.maxMessageIdentifier = 65536;
+		ClientImpl.prototype.connectOptions = null;
+		ClientImpl.prototype.hostIndex = null;
+		ClientImpl.prototype.onConnected = null;
+		ClientImpl.prototype.onConnectionLost = null;
+		ClientImpl.prototype.onMessageDelivered = null;
+		ClientImpl.prototype.onMessageArrived = null;
+		ClientImpl.prototype.traceFunction = null;
+		ClientImpl.prototype._msg_queue = null;
+		ClientImpl.prototype._buffered_msg_queue = null;
+		ClientImpl.prototype._connectTimeout = null;
+		/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */
+		ClientImpl.prototype.sendPinger = null;
+		/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */
+		ClientImpl.prototype.receivePinger = null;
+		ClientImpl.prototype._reconnectInterval = 1; // Reconnect Delay, starts at 1 second
+		ClientImpl.prototype._reconnecting = false;
+		ClientImpl.prototype._reconnectTimeout = null;
+		ClientImpl.prototype.disconnectedPublishing = false;
+		ClientImpl.prototype.disconnectedBufferSize = 5000;
 
-			this.sendPinger.cancel();
-			this.receivePinger.cancel();
-			if (this._connectTimeout) {
-				this._connectTimeout.cancel();
-				this._connectTimeout = null;
-			}
+		ClientImpl.prototype.receiveBuffer = null;
 
-			// Clear message buffers.
-			this._msg_queue = [];
-			this._buffered_msg_queue = [];
-			this._notify_msg_sent = {};
+		ClientImpl.prototype._traceBuffer = null;
+		ClientImpl.prototype._MAX_TRACE_ENTRIES = 100;
 
-			if (this.socket) {
-			// Cancel all socket callbacks so that they cannot be driven again by this socket.
-				this.socket.onopen = null;
-				this.socket.onmessage = null;
-				this.socket.onerror = null;
-				this.socket.onclose = null;
-				if (this.socket.readyState === 1)
-					this.socket.close();
-				delete this.socket;
-			}
+		ClientImpl.prototype.connect = function (connectOptions) {
+			var connectOptionsMasked = this._traceMask(connectOptions, "password");
+			this._trace("Client.connect", connectOptionsMasked, this.socket, this.connected);
 
-			if (this.connectOptions.uris && this.hostIndex < this.connectOptions.uris.length-1) {
-			// Try the next host.
-				this.hostIndex++;
-				this._doConnect(this.connectOptions.uris[this.hostIndex]);
-			} else {
+			if (this.connected)
+				throw new Error(format(ERROR.INVALID_STATE, ["already connected"]));
+			if (this.socket)
+				throw new Error(format(ERROR.INVALID_STATE, ["already connected"]));
 
-				if (errorCode === undefined) {
-					errorCode = ERROR.OK.code;
-					errorText = format(ERROR.OK);
-				}
+			if (this._reconnecting) {
+			// connect() function is called while reconnect is in progress.
+			// Terminate the auto reconnect process to use new connect options.
+				this._reconnectTimeout.cancel();
+				this._reconnectTimeout = null;
+				this._reconnecting = false;
+			}
 
-				// Run any application callbacks last as they may attempt to reconnect and hence create a new socket.
-				if (this.connected) {
-					this.connected = false;
-					// Execute the connectionLostCallback if there is one, and we were connected.
-					if (this.onConnectionLost) {
-						this.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:this.connectOptions.reconnect, uri:this._wsuri});
-					}
-					if (errorCode !== ERROR.OK.code && this.connectOptions.reconnect) {
-					// Start automatic reconnect process for the very first time since last successful connect.
-						this._reconnectInterval = 1;
-						this._reconnect();
-						return;
-					}
-				} else {
-				// Otherwise we never had a connection, so indicate that the connect has failed.
-					if (this.connectOptions.mqttVersion === 4 && this.connectOptions.mqttVersionExplicit === false) {
-						this._trace("Failed to connect V4, dropping back to V3");
-						this.connectOptions.mqttVersion = 3;
-						if (this.connectOptions.uris) {
-							this.hostIndex = 0;
-							this._doConnect(this.connectOptions.uris[0]);
-						} else {
-							this._doConnect(this.uri);
-						}
-					} else if(this.connectOptions.onFailure) {
-						this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});
-					}
-				}
+			this.connectOptions = connectOptions;
+			this._reconnectInterval = 1;
+			this._reconnecting = false;
+			if (connectOptions.uris) {
+				this.hostIndex = 0;
+				this._doConnect(connectOptions.uris[0]);
+			} else {
+				this._doConnect(this.uri);
 			}
+
 		};
 
-		/** @ignore */
-		ClientImpl.prototype._trace = function () {
-		// Pass trace message back to client's callback function
-			if (this.traceFunction) {
-				var args = Array.prototype.slice.call(arguments);
-				for (var i in args)
-				{
-					if (typeof args[i] !== "undefined")
-						args.splice(i, 1, JSON.stringify(args[i]));
-				}
-				var record = args.join("");
-				this.traceFunction ({severity: "Debug", message: record	});
-			}
+		ClientImpl.prototype.subscribe = function (filter, subscribeOptions) {
+			this._trace("Client.subscribe", filter, subscribeOptions);
 
-			//buffer style trace
-			if ( this._traceBuffer !== null ) {
-				for (var i = 0, max = arguments.length; i < max; i++) {
-					if ( this._traceBuffer.length == this._MAX_TRACE_ENTRIES ) {
-						this._traceBuffer.shift();
-					}
-					if (i === 0) this._traceBuffer.push(arguments[i]);
-					else if (typeof arguments[i] === "undefined" ) this._traceBuffer.push(arguments[i]);
-					else this._traceBuffer.push("  "+JSON.stringify(arguments[i]));
-				}
+			if (!this.connected)
+				throw new Error(format(ERROR.INVALID_STATE, ["not connected"]));
+
+            var wireMessage = new WireMessage(MESSAGE_TYPE.SUBSCRIBE);
+            wireMessage.topics = filter.constructor === Array ? filter : [filter];
+            if (subscribeOptions.qos === undefined)
+                subscribeOptions.qos = 0;
+            wireMessage.requestedQos = [];
+            for (var i = 0; i < wireMessage.topics.length; i++)
+                wireMessage.requestedQos[i] = subscribeOptions.qos;
+
+			if (subscribeOptions.onSuccess) {
+				wireMessage.onSuccess = function(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};
 			}
-		};
 
-		/** @ignore */
-		ClientImpl.prototype._traceMask = function (traceObject, masked) {
-			var traceObjectMasked = {};
-			for (var attr in traceObject) {
-				if (traceObject.hasOwnProperty(attr)) {
-					if (attr == masked)
-						traceObjectMasked[attr] = "******";
-					else
-						traceObjectMasked[attr] = traceObject[attr];
-				}
+			if (subscribeOptions.onFailure) {
+				wireMessage.onFailure = function(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};
 			}
-			return traceObjectMasked;
+
+			if (subscribeOptions.timeout) {
+				wireMessage.timeOut = new Timeout(this, subscribeOptions.timeout, subscribeOptions.onFailure,
+					[{invocationContext:subscribeOptions.invocationContext,
+						errorCode:ERROR.SUBSCRIBE_TIMEOUT.code,
+						errorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);
+			}
+
+			// All subscriptions return a SUBACK.
+			this._requires_ack(wireMessage);
+			this._schedule_message(wireMessage);
 		};
 
-		// ------------------------------------------------------------------------
-		// Public Programming interface.
-		// ------------------------------------------------------------------------
+		/** @ignore */
+		ClientImpl.prototype.unsubscribe = function(filter, unsubscribeOptions) {
+			this._trace("Client.unsubscribe", filter, unsubscribeOptions);
 
-		/**
-	 * The JavaScript application communicates to the server using a {@link Paho.Client} object.
-	 * <p>
-	 * Most applications will create just one Client object and then call its connect() method,
-	 * however applications can create more than one Client object if they wish.
-	 * In this case the combination of host, port and clientId attributes must be different for each Client object.
-	 * <p>
-	 * The send, subscribe and unsubscribe methods are implemented as asynchronous JavaScript methods
-	 * (even though the underlying protocol exchange might be synchronous in nature).
-	 * This means they signal their completion by calling back to the application,
-	 * via Success or Failure callback functions provided by the application on the method in question.
-	 * Such callbacks are called at most once per method invocation and do not persist beyond the lifetime
-	 * of the script that made the invocation.
-	 * <p>
-	 * In contrast there are some callback functions, most notably <i>onMessageArrived</i>,
-	 * that are defined on the {@link Paho.Client} object.
-	 * These may get called multiple times, and aren't directly related to specific method invocations made by the client.
-	 *
-	 * @name Paho.Client
-	 *
-	 * @constructor
-	 *
-	 * @param {string} host - the address of the messaging server, as a fully qualified WebSocket URI, as a DNS name or dotted decimal IP address.
-	 * @param {number} port - the port number to connect to - only required if host is not a URI
-	 * @param {string} path - the path on the host to connect to - only used if host is not a URI. Default: '/mqtt'.
-	 * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters in length.
-	 *
-	 * @property {string} host - <i>read only</i> the server's DNS hostname or dotted decimal IP address.
-	 * @property {number} port - <i>read only</i> the server's port.
-	 * @property {string} path - <i>read only</i> the server's path.
-	 * @property {string} clientId - <i>read only</i> used when connecting to the server.
-	 * @property {function} onConnectionLost - called when a connection has been lost.
-	 *                            after a connect() method has succeeded.
-	 *                            Establish the call back used when a connection has been lost. The connection may be
-	 *                            lost because the client initiates a disconnect or because the server or network
-	 *                            cause the client to be disconnected. The disconnect call back may be called without
-	 *                            the connectionComplete call back being invoked if, for example the client fails to
-	 *                            connect.
-	 *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:
-	 *                            <ol>
-	 *                            <li>errorCode
-	 *                            <li>errorMessage
-	 *                            </ol>
-	 * @property {function} onMessageDelivered - called when a message has been delivered.
-	 *                            All processing that this Client will ever do has been completed. So, for example,
-	 *                            in the case of a Qos=2 message sent by this client, the PubComp flow has been received from the server
-	 *                            and the message has been removed from persistent storage before this callback is invoked.
-	 *                            Parameters passed to the onMessageDelivered callback are:
-	 *                            <ol>
-	 *                            <li>{@link Paho.Message} that was delivered.
-	 *                            </ol>
-	 * @property {function} onMessageArrived - called when a message has arrived in this Paho.client.
-	 *                            Parameters passed to the onMessageArrived callback are:
-	 *                            <ol>
-	 *                            <li>{@link Paho.Message} that has arrived.
-	 *                            </ol>
-	 * @property {function} onConnected - called when a connection is successfully made to the server.
-	 *                                  after a connect() method.
-	 *                                  Parameters passed to the onConnected callback are:
-	 *                                  <ol>
-	 *                                  <li>reconnect (boolean) - If true, the connection was the result of a reconnect.</li>
-	 *                                  <li>URI (string) - The URI used to connect to the server.</li>
-	 *                                  </ol>
-	 * @property {boolean} disconnectedPublishing - if set, will enable disconnected publishing in
-	 *                                            in the event that the connection to the server is lost.
-	 * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected
-	 *                                             buffer will hold before rejecting new messages. Default size: 5000 messages
-	 * @property {function} trace - called whenever trace is called. TODO
-	 */
-		var Client = function (host, port, path, clientId) {
+			if (!this.connected)
+				throw new Error(format(ERROR.INVALID_STATE, ["not connected"]));
 
-			var uri;
+            var wireMessage = new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);
+            wireMessage.topics = filter.constructor === Array ? filter : [filter];
 
-			if (typeof host !== "string")
-				throw new Error(format(ERROR.INVALID_TYPE, [typeof host, "host"]));
+			if (unsubscribeOptions.onSuccess) {
+				wireMessage.callback = function() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};
+			}
+			if (unsubscribeOptions.timeout) {
+				wireMessage.timeOut = new Timeout(this, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,
+					[{invocationContext:unsubscribeOptions.invocationContext,
+						errorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,
+						errorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);
+			}
 
-			if (arguments.length == 2) {
-			// host: must be full ws:// uri
-			// port: clientId
-				clientId = port;
-				uri = host;
-				var match = uri.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);
-				if (match) {
-					host = match[4]||match[2];
-					port = parseInt(match[7]);
-					path = match[8];
-				} else {
-					throw new Error(format(ERROR.INVALID_ARGUMENT,[host,"host"]));
+			// All unsubscribes return a SUBACK.
+			this._requires_ack(wireMessage);
+			this._schedule_message(wireMessage);
+		};
+
+		ClientImpl.prototype.send = function (message) {
+			this._trace("Client.send", message);
+
+			var wireMessage = new WireMessage(MESSAGE_TYPE.PUBLISH);
+			wireMessage.payloadMessage = message;
+
+			if (this.connected) {
+			// Mark qos 1 & 2 message as "ACK required"
+			// For qos 0 message, invoke onMessageDelivered callback if there is one.
+			// Then schedule the message.
+				if (message.qos > 0) {
+					this._requires_ack(wireMessage);
+				} else if (this.onMessageDelivered) {
+					this._notify_msg_sent[wireMessage] = this.onMessageDelivered(wireMessage.payloadMessage);
 				}
+				this._schedule_message(wireMessage);
 			} else {
-				if (arguments.length == 3) {
-					clientId = path;
-					path = "/mqtt";
+			// Currently disconnected, will not schedule this message
+			// Check if reconnecting is in progress and disconnected publish is enabled.
+				if (this._reconnecting && this.disconnectedPublishing) {
+				// Check the limit which include the "required ACK" messages
+					var messageCount = Object.keys(this._sentMessages).length + this._buffered_msg_queue.length;
+					if (messageCount > this.disconnectedBufferSize) {
+						throw new Error(format(ERROR.BUFFER_FULL, [this.disconnectedBufferSize]));
+					} else {
+						if (message.qos > 0) {
+						// Mark this message as "ACK required"
+							this._requires_ack(wireMessage);
+						} else {
+							wireMessage.sequence = ++this._sequence;
+							// Add messages in fifo order to array, by adding to start
+							this._buffered_msg_queue.unshift(wireMessage);
+						}
+					}
+				} else {
+					throw new Error(format(ERROR.INVALID_STATE, ["not connected"]));
 				}
-				if (typeof port !== "number" || port < 0)
-					throw new Error(format(ERROR.INVALID_TYPE, [typeof port, "port"]));
-				if (typeof path !== "string")
-					throw new Error(format(ERROR.INVALID_TYPE, [typeof path, "path"]));
+			}
+		};
 
-				var ipv6AddSBracket = (host.indexOf(":") !== -1 && host.slice(0,1) !== "[" && host.slice(-1) !== "]");
-				uri = "ws://"+(ipv6AddSBracket?"["+host+"]":host)+":"+port+path;
+		ClientImpl.prototype.disconnect = function () {
+			this._trace("Client.disconnect");
+
+			if (this._reconnecting) {
+			// disconnect() function is called while reconnect is in progress.
+			// Terminate the auto reconnect process.
+				this._reconnectTimeout.cancel();
+				this._reconnectTimeout = null;
+				this._reconnecting = false;
 			}
 
-			var clientIdLength = 0;
-			for (var i = 0; i<clientId.length; i++) {
-				var charCode = clientId.charCodeAt(i);
-				if (0xD800 <= charCode && charCode <= 0xDBFF)  {
-					i++; // Surrogate pair.
-				}
-				clientIdLength++;
+			if (!this.socket)
+				throw new Error(format(ERROR.INVALID_STATE, ["not connecting or connected"]));
+
+			var wireMessage = new WireMessage(MESSAGE_TYPE.DISCONNECT);
+
+			// Run the disconnected call back as soon as the message has been sent,
+			// in case of a failure later on in the disconnect processing.
+			// as a consequence, the _disconected call back may be run several times.
+			this._notify_msg_sent[wireMessage] = scope(this._disconnected, this);
+
+			this._schedule_message(wireMessage);
+		};
+
+		ClientImpl.prototype.getTraceLog = function () {
+			if ( this._traceBuffer !== null ) {
+				this._trace("Client.getTraceLog", new Date());
+				this._trace("Client.getTraceLog in flight messages", this._sentMessages.length);
+				for (var key in this._sentMessages)
+					this._trace("_sentMessages ",key, this._sentMessages[key]);
+				for (var key in this._receivedMessages)
+					this._trace("_receivedMessages ",key, this._receivedMessages[key]);
+
+				return this._traceBuffer;
 			}
-			if (typeof clientId !== "string" || clientIdLength > 65535)
-				throw new Error(format(ERROR.INVALID_ARGUMENT, [clientId, "clientId"]));
+		};
 
-			var client = new ClientImpl(uri, host, port, path, clientId);
+		ClientImpl.prototype.startTrace = function () {
+			if ( this._traceBuffer === null ) {
+				this._traceBuffer = [];
+			}
+			this._trace("Client.startTrace", new Date(), version);
+		};
 
-			//Public Properties
-			Object.defineProperties(this,{
-				"host":{
-					get: function() { return host; },
-					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
-				},
-				"port":{
-					get: function() { return port; },
-					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
-				},
-				"path":{
-					get: function() { return path; },
-					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
-				},
-				"uri":{
-					get: function() { return uri; },
-					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
-				},
-				"clientId":{
-					get: function() { return client.clientId; },
-					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
-				},
-				"onConnected":{
-					get: function() { return client.onConnected; },
-					set: function(newOnConnected) {
-						if (typeof newOnConnected === "function")
-							client.onConnected = newOnConnected;
-						else
-							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnected, "onConnected"]));
-					}
-				},
-				"disconnectedPublishing":{
-					get: function() { return client.disconnectedPublishing; },
-					set: function(newDisconnectedPublishing) {
-						client.disconnectedPublishing = newDisconnectedPublishing;
-					}
-				},
-				"disconnectedBufferSize":{
-					get: function() { return client.disconnectedBufferSize; },
-					set: function(newDisconnectedBufferSize) {
-						client.disconnectedBufferSize = newDisconnectedBufferSize;
-					}
-				},
-				"onConnectionLost":{
-					get: function() { return client.onConnectionLost; },
-					set: function(newOnConnectionLost) {
-						if (typeof newOnConnectionLost === "function")
-							client.onConnectionLost = newOnConnectionLost;
-						else
-							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnectionLost, "onConnectionLost"]));
-					}
-				},
-				"onMessageDelivered":{
-					get: function() { return client.onMessageDelivered; },
-					set: function(newOnMessageDelivered) {
-						if (typeof newOnMessageDelivered === "function")
-							client.onMessageDelivered = newOnMessageDelivered;
-						else
-							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageDelivered, "onMessageDelivered"]));
-					}
-				},
-				"onMessageArrived":{
-					get: function() { return client.onMessageArrived; },
-					set: function(newOnMessageArrived) {
-						if (typeof newOnMessageArrived === "function")
-							client.onMessageArrived = newOnMessageArrived;
-						else
-							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageArrived, "onMessageArrived"]));
-					}
-				},
-				"trace":{
-					get: function() { return client.traceFunction; },
-					set: function(trace) {
-						if(typeof trace === "function"){
-							client.traceFunction = trace;
-						}else{
-							throw new Error(format(ERROR.INVALID_TYPE, [typeof trace, "onTrace"]));
-						}
-					}
-				},
-			});
-
-			/**
-		 * Connect this Messaging client to its server.
-		 *
-		 * @name Paho.Client#connect
-		 * @function
-		 * @param {object} connectOptions - Attributes used with the connection.
-		 * @param {number} connectOptions.timeout - If the connect has not succeeded within this
-		 *                    number of seconds, it is deemed to have failed.
-		 *                    The default is 30 seconds.
-		 * @param {string} connectOptions.userName - Authentication username for this connection.
-		 * @param {string} connectOptions.password - Authentication password for this connection.
-		 * @param {Paho.Message} connectOptions.willMessage - sent by the server when the client
-		 *                    disconnects abnormally.
-		 * @param {number} connectOptions.keepAliveInterval - the server disconnects this client if
-		 *                    there is no activity for this number of seconds.
-		 *                    The default value of 60 seconds is assumed if not set.
-		 * @param {boolean} connectOptions.cleanSession - if true(default) the client and server
-		 *                    persistent state is deleted on successful connect.
-		 * @param {boolean} connectOptions.useSSL - if present and true, use an SSL Websocket connection.
-		 * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.
-		 * @param {function} connectOptions.onSuccess - called when the connect acknowledgement
-		 *                    has been received from the server.
-		 * A single response object parameter is passed to the onSuccess callback containing the following fields:
-		 * <ol>
-		 * <li>invocationContext as passed in to the onSuccess method in the connectOptions.
-		 * </ol>
-	 * @param {function} connectOptions.onFailure - called when the connect request has failed or timed out.
-		 * A single response object parameter is passed to the onFailure callback containing the following fields:
-		 * <ol>
-		 * <li>invocationContext as passed in to the onFailure method in the connectOptions.
-		 * <li>errorCode a number indicating the nature of the error.
-		 * <li>errorMessage text describing the error.
-		 * </ol>
-	 * @param {array} connectOptions.hosts - If present this contains either a set of hostnames or fully qualified
-		 * WebSocket URIs (ws://iot.eclipse.org:80/ws), that are tried in order in place
-		 * of the host and port paramater on the construtor. The hosts are tried one at at time in order until
-		 * one of then succeeds.
-	 * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, this property
-		 * is not used.
-	 * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect
-	 * to the server if the connection is lost.
-	 *<ul>
-	 *<li>If set to false, the client will not attempt to automatically reconnect to the server in the event that the
-	 * connection is lost.</li>
-	 *<li>If set to true, in the event that the connection is lost, the client will attempt to reconnect to the server.
-	 * It will initially wait 1 second before it attempts to reconnect, for every failed reconnect attempt, the delay
-	 * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.</li>
-	 *</ul>
-	 * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.
-	 *<ul>
-	 *<li>3 - MQTT V3.1</li>
-	 *<li>4 - MQTT V3.1.1</li>
-	 *</ul>
-	 * @param {boolean} connectOptions.mqttVersionExplicit - If set to true, will force the connection to use the
-	 * selected MQTT Version or will fail to connect.
-	 * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris
-	 * (e.g. ws://iot.eclipse.org:80/ws), that are tried in order in place of the host and port parameter of the construtor.
-	 * The uris are tried one at a time in order until one of them succeeds. Do not use this in conjunction with hosts as
-	 * the hosts array will be converted to uris and will overwrite this property.
-		 * @throws {InvalidState} If the client is not in disconnected state. The client must have received connectionLost
-		 * or disconnected before calling connect for a second or subsequent time.
-		 */
-			this.connect = function (connectOptions) {
-				connectOptions = connectOptions || {} ;
-				validate(connectOptions,  {timeout:"number",
-					userName:"string",
-					password:"string",
-					willMessage:"object",
-					keepAliveInterval:"number",
-					cleanSession:"boolean",
-					useSSL:"boolean",
-					invocationContext:"object",
-					onSuccess:"function",
-					onFailure:"function",
-					hosts:"object",
-					ports:"object",
-					reconnect:"boolean",
-					mqttVersion:"number",
-					mqttVersionExplicit:"boolean",
-					uris: "object"});
-
-				// If no keep alive interval is set, assume 60 seconds.
-				if (connectOptions.keepAliveInterval === undefined)
-					connectOptions.keepAliveInterval = 60;
+		ClientImpl.prototype.stopTrace = function () {
+			delete this._traceBuffer;
+		};
 
-				if (connectOptions.mqttVersion > 4 || connectOptions.mqttVersion < 3) {
-					throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, "connectOptions.mqttVersion"]));
-				}
+		ClientImpl.prototype._doConnect = function (wsurl) {
+		// When the socket is open, this client will send the CONNECT WireMessage using the saved parameters.
+			if (this.connectOptions.useSSL) {
+				var uriParts = wsurl.split(":");
+				uriParts[0] = "wss";
+				wsurl = uriParts.join(":");
+			}
+			this._wsuri = wsurl;
+			this.connected = false;
 
-				if (connectOptions.mqttVersion === undefined) {
-					connectOptions.mqttVersionExplicit = false;
-					connectOptions.mqttVersion = 4;
-				} else {
-					connectOptions.mqttVersionExplicit = true;
-				}
 
-				//Check that if password is set, so is username
-				if (connectOptions.password !== undefined && connectOptions.userName === undefined)
-					throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, "connectOptions.password"]));
 
-				if (connectOptions.willMessage) {
-					if (!(connectOptions.willMessage instanceof Message))
-						throw new Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, "connectOptions.willMessage"]));
-					// The will message must have a payload that can be represented as a string.
-					// Cause the willMessage to throw an exception if this is not the case.
-					connectOptions.willMessage.stringPayload = null;
-
-					if (typeof connectOptions.willMessage.destinationName === "undefined")
-						throw new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.willMessage.destinationName, "connectOptions.willMessage.destinationName"]));
-				}
-				if (typeof connectOptions.cleanSession === "undefined")
-					connectOptions.cleanSession = true;
-				if (connectOptions.hosts) {
+			if (this.connectOptions.mqttVersion < 4) {
+				this.socket = new WebSocket(wsurl, ["mqttv3.1"]);
+			} else {
+				this.socket = new WebSocket(wsurl, ["mqtt"]);
+			}
+			this.socket.binaryType = "arraybuffer";
+			this.socket.onopen = scope(this._on_socket_open, this);
+			this.socket.onmessage = scope(this._on_socket_message, this);
+			this.socket.onerror = scope(this._on_socket_error, this);
+			this.socket.onclose = scope(this._on_socket_close, this);
 
-					if (!(connectOptions.hosts instanceof Array) )
-						throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, "connectOptions.hosts"]));
-					if (connectOptions.hosts.length <1 )
-						throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, "connectOptions.hosts"]));
+			this.sendPinger = new Pinger(this, this.connectOptions.keepAliveInterval);
+			this.receivePinger = new Pinger(this, this.connectOptions.keepAliveInterval);
+			if (this._connectTimeout) {
+				this._connectTimeout.cancel();
+				this._connectTimeout = null;
+			}
+			this._connectTimeout = new Timeout(this, this.connectOptions.timeout, this._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);
+		};
 
-					var usingURIs = false;
-					for (var i = 0; i<connectOptions.hosts.length; i++) {
-						if (typeof connectOptions.hosts[i] !== "string")
-							throw new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.hosts[i], "connectOptions.hosts["+i+"]"]));
-						if (/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(connectOptions.hosts[i])) {
-							if (i === 0) {
-								usingURIs = true;
-							} else if (!usingURIs) {
-								throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], "connectOptions.hosts["+i+"]"]));
-							}
-						} else if (usingURIs) {
-							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], "connectOptions.hosts["+i+"]"]));
-						}
-					}
 
-					if (!usingURIs) {
-						if (!connectOptions.ports)
-							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, "connectOptions.ports"]));
-						if (!(connectOptions.ports instanceof Array) )
-							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, "connectOptions.ports"]));
-						if (connectOptions.hosts.length !== connectOptions.ports.length)
-							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, "connectOptions.ports"]));
+		// Schedule a new message to be sent over the WebSockets
+		// connection. CONNECT messages cause WebSocket connection
+		// to be started. All other messages are queued internally
+		// until this has happened. When WS connection starts, process
+		// all outstanding messages.
+		ClientImpl.prototype._schedule_message = function (message) {
+			// Add messages in fifo order to array, by adding to start
+			this._msg_queue.unshift(message);
+			// Process outstanding messages in the queue if we have an  open socket, and have received CONNACK.
+			if (this.connected) {
+				this._process_queue();
+			}
+		};
 
-						connectOptions.uris = [];
+		ClientImpl.prototype.store = function(prefix, wireMessage) {
+			var storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};
 
-						for (var i = 0; i<connectOptions.hosts.length; i++) {
-							if (typeof connectOptions.ports[i] !== "number" || connectOptions.ports[i] < 0)
-								throw new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.ports[i], "connectOptions.ports["+i+"]"]));
-							var host = connectOptions.hosts[i];
-							var port = connectOptions.ports[i];
+			switch(wireMessage.type) {
+			case MESSAGE_TYPE.PUBLISH:
+				if(wireMessage.pubRecReceived)
+					storedMessage.pubRecReceived = true;
 
-							var ipv6 = (host.indexOf(":") !== -1);
-							uri = "ws://"+(ipv6?"["+host+"]":host)+":"+port+path;
-							connectOptions.uris.push(uri);
-						}
-					} else {
-						connectOptions.uris = connectOptions.hosts;
-					}
+				// Convert the payload to a hex string.
+				storedMessage.payloadMessage = {};
+				var hex = "";
+				var messageBytes = wireMessage.payloadMessage.payloadBytes;
+				for (var i=0; i<messageBytes.length; i++) {
+					if (messageBytes[i] <= 0xF)
+						hex = hex+"0"+messageBytes[i].toString(16);
+					else
+						hex = hex+messageBytes[i].toString(16);
 				}
+				storedMessage.payloadMessage.payloadHex = hex;
 
-				client.connect(connectOptions);
-			};
-
-			/**
-		 * Subscribe for messages, request receipt of a copy of messages sent to the destinations described by the filter.
-		 *
-		 * @name Paho.Client#subscribe
-		 * @function
-		 * @param {string} filter describing the destinations to receive messages from.
-		 * <br>
-		 * @param {object} subscribeOptions - used to control the subscription
-		 *
-		 * @param {number} subscribeOptions.qos - the maximum qos of any publications sent
-		 *                                  as a result of making this subscription.
-		 * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback
-		 *                                  or onFailure callback.
-		 * @param {function} subscribeOptions.onSuccess - called when the subscribe acknowledgement
-		 *                                  has been received from the server.
-		 *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:
-		 *                                  <ol>
-		 *                                  <li>invocationContext if set in the subscribeOptions.
-		 *                                  </ol>
-		 * @param {function} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.
-		 *                                  A single response object parameter is passed to the onFailure callback containing the following fields:
-		 *                                  <ol>
-		 *                                  <li>invocationContext - if set in the subscribeOptions.
-		 *                                  <li>errorCode - a number indicating the nature of the error.
-		 *                                  <li>errorMessage - text describing the error.
-		 *                                  </ol>
-		 * @param {number} subscribeOptions.timeout - which, if present, determines the number of
-		 *                                  seconds after which the onFailure calback is called.
-		 *                                  The presence of a timeout does not prevent the onSuccess
-		 *                                  callback from being called when the subscribe completes.
-		 * @throws {InvalidState} if the client is not in connected state.
-		 */
-			this.subscribe = function (filter, subscribeOptions) {
-				if (typeof filter !== "string" && filter.constructor !== Array)
-					throw new Error("Invalid argument:"+filter);
-				subscribeOptions = subscribeOptions || {} ;
-				validate(subscribeOptions,  {qos:"number",
-					invocationContext:"object",
-					onSuccess:"function",
-					onFailure:"function",
-					timeout:"number"
-				});
-				if (subscribeOptions.timeout && !subscribeOptions.onFailure)
-					throw new Error("subscribeOptions.timeout specified with no onFailure callback.");
-				if (typeof subscribeOptions.qos !== "undefined" && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))
-					throw new Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, "subscribeOptions.qos"]));
-				client.subscribe(filter, subscribeOptions);
-			};
-
-		/**
-		 * Unsubscribe for messages, stop receiving messages sent to destinations described by the filter.
-		 *
-		 * @name Paho.Client#unsubscribe
-		 * @function
-		 * @param {string} filter - describing the destinations to receive messages from.
-		 * @param {object} unsubscribeOptions - used to control the subscription
-		 * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback
-											  or onFailure callback.
-		 * @param {function} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received from the server.
-		 *                                    A single response object parameter is passed to the
-		 *                                    onSuccess callback containing the following fields:
-		 *                                    <ol>
-		 *                                    <li>invocationContext - if set in the unsubscribeOptions.
-		 *                                    </ol>
-		 * @param {function} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.
-		 *                                    A single response object parameter is passed to the onFailure callback containing the following fields:
-		 *                                    <ol>
-		 *                                    <li>invocationContext - if set in the unsubscribeOptions.
-		 *                                    <li>errorCode - a number indicating the nature of the error.
-		 *                                    <li>errorMessage - text describing the error.
-		 *                                    </ol>
-		 * @param {number} unsubscribeOptions.timeout - which, if present, determines the number of seconds
-		 *                                    after which the onFailure callback is called. The presence of
-		 *                                    a timeout does not prevent the onSuccess callback from being
-		 *                                    called when the unsubscribe completes
-		 * @throws {InvalidState} if the client is not in connected state.
-		 */
-			this.unsubscribe = function (filter, unsubscribeOptions) {
-				if (typeof filter !== "string" && filter.constructor !== Array)
-					throw new Error("Invalid argument:"+filter);
-				unsubscribeOptions = unsubscribeOptions || {} ;
-				validate(unsubscribeOptions,  {invocationContext:"object",
-					onSuccess:"function",
-					onFailure:"function",
-					timeout:"number"
-				});
-				if (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)
-					throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");
-				client.unsubscribe(filter, unsubscribeOptions);
-			};
-
-			/**
-		 * Send a message to the consumers of the destination in the Message.
-		 *
-		 * @name Paho.Client#send
-		 * @function
-		 * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the destination to which the message is to be sent.
-		 * 					   - If it is the only parameter, used as Paho.Message object.
-		 * @param {String|ArrayBuffer} payload - The message data to be sent.
-		 * @param {number} qos The Quality of Service used to deliver the message.
-		 * 		<dl>
-		 * 			<dt>0 Best effort (default).
-		 *     			<dt>1 At least once.
-		 *     			<dt>2 Exactly once.
-		 * 		</dl>
-		 * @param {Boolean} retained If true, the message is to be retained by the server and delivered
-		 *                     to both current and future subscriptions.
-		 *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.
-		 *                     A received message has the retained boolean set to true if the message was published
-		 *                     with the retained boolean set to true
-		 *                     and the subscrption was made after the message has been published.
-		 * @throws {InvalidState} if the client is not connected.
-		 */
-			this.send = function (topic,payload,qos,retained) {
-				var message ;
+				storedMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;
+				storedMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;
+				if (wireMessage.payloadMessage.duplicate)
+					storedMessage.payloadMessage.duplicate = true;
+				if (wireMessage.payloadMessage.retained)
+					storedMessage.payloadMessage.retained = true;
 
-				if(arguments.length === 0){
-					throw new Error("Invalid argument."+"length");
+				// Add a sequence number to sent messages.
+				if ( prefix.indexOf("Sent:") === 0 ) {
+					if ( wireMessage.sequence === undefined )
+						wireMessage.sequence = ++this._sequence;
+					storedMessage.sequence = wireMessage.sequence;
+				}
+				break;
 
-				}else if(arguments.length == 1) {
+			default:
+				throw Error(format(ERROR.INVALID_STORED_DATA, [prefix+this._localKey+wireMessage.messageIdentifier, storedMessage]));
+			}
+			localStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));
+		};
 
-					if (!(topic instanceof Message) && (typeof topic !== "string"))
-						throw new Error("Invalid argument:"+ typeof topic);
+		ClientImpl.prototype.restore = function(key) {
+			var value = localStorage.getItem(key);
+			var storedMessage = JSON.parse(value);
 
-					message = topic;
-					if (typeof message.destinationName === "undefined")
-						throw new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,"Message.destinationName"]));
-					client.send(message);
+			var wireMessage = new WireMessage(storedMessage.type, storedMessage);
 
-				}else {
-				//parameter checking in Message object
-					message = new Message(payload);
-					message.destinationName = topic;
-					if(arguments.length >= 3)
-						message.qos = qos;
-					if(arguments.length >= 4)
-						message.retained = retained;
-					client.send(message);
+			switch(storedMessage.type) {
+			case MESSAGE_TYPE.PUBLISH:
+				// Replace the payload message with a Message object.
+				var hex = storedMessage.payloadMessage.payloadHex;
+				var buffer = new ArrayBuffer((hex.length)/2);
+				var byteStream = new Uint8Array(buffer);
+				var i = 0;
+				while (hex.length >= 2) {
+					var x = parseInt(hex.substring(0, 2), 16);
+					hex = hex.substring(2, hex.length);
+					byteStream[i++] = x;
 				}
-			};
-
-			/**
-		 * Publish a message to the consumers of the destination in the Message.
-		 * Synonym for Paho.Mqtt.Client#send
-		 *
-		 * @name Paho.Client#publish
-		 * @function
-		 * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the topic to which the message is to be published.
-		 * 					   - If it is the only parameter, used as Paho.Message object.
-		 * @param {String|ArrayBuffer} payload - The message data to be published.
-		 * @param {number} qos The Quality of Service used to deliver the message.
-		 * 		<dl>
-		 * 			<dt>0 Best effort (default).
-		 *     			<dt>1 At least once.
-		 *     			<dt>2 Exactly once.
-		 * 		</dl>
-		 * @param {Boolean} retained If true, the message is to be retained by the server and delivered
-		 *                     to both current and future subscriptions.
-		 *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.
-		 *                     A received message has the retained boolean set to true if the message was published
-		 *                     with the retained boolean set to true
-		 *                     and the subscrption was made after the message has been published.
-		 * @throws {InvalidState} if the client is not connected.
-		 */
-			this.publish = function(topic,payload,qos,retained) {
-				var message ;
-
-				if(arguments.length === 0){
-					throw new Error("Invalid argument."+"length");
-
-				}else if(arguments.length == 1) {
+				var payloadMessage = new Message(byteStream);
 
-					if (!(topic instanceof Message) && (typeof topic !== "string"))
-						throw new Error("Invalid argument:"+ typeof topic);
+				payloadMessage.qos = storedMessage.payloadMessage.qos;
+				payloadMessage.destinationName = storedMessage.payloadMessage.destinationName;
+				if (storedMessage.payloadMessage.duplicate)
+					payloadMessage.duplicate = true;
+				if (storedMessage.payloadMessage.retained)
+					payloadMessage.retained = true;
+				wireMessage.payloadMessage = payloadMessage;
 
-					message = topic;
-					if (typeof message.destinationName === "undefined")
-						throw new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,"Message.destinationName"]));
-					client.send(message);
+				break;
 
-				}else {
-					//parameter checking in Message object
-					message = new Message(payload);
-					message.destinationName = topic;
-					if(arguments.length >= 3)
-						message.qos = qos;
-					if(arguments.length >= 4)
-						message.retained = retained;
-					client.send(message);
-				}
-			};
+			default:
+				throw Error(format(ERROR.INVALID_STORED_DATA, [key, value]));
+			}
 
-			/**
-		 * Normal disconnect of this Messaging client from its server.
-		 *
-		 * @name Paho.Client#disconnect
-		 * @function
-		 * @throws {InvalidState} if the client is already disconnected.
-		 */
-			this.disconnect = function () {
-				client.disconnect();
-			};
+			if (key.indexOf("Sent:"+this._localKey) === 0) {
+				wireMessage.payloadMessage.duplicate = true;
+				this._sentMessages[wireMessage.messageIdentifier] = wireMessage;
+			} else if (key.indexOf("Received:"+this._localKey) === 0) {
+				this._receivedMessages[wireMessage.messageIdentifier] = wireMessage;
+			}
+		};
 
-			/**
-		 * Get the contents of the trace log.
-		 *
-		 * @name Paho.Client#getTraceLog
-		 * @function
-		 * @return {Object[]} tracebuffer containing the time ordered trace records.
-		 */
-			this.getTraceLog = function () {
-				return client.getTraceLog();
-			};
+		ClientImpl.prototype._process_queue = function () {
+			var message = null;
 
-			/**
-		 * Start tracing.
-		 *
-		 * @name Paho.Client#startTrace
-		 * @function
-		 */
-			this.startTrace = function () {
-				client.startTrace();
-			};
+			// Send all queued messages down socket connection
+			while ((message = this._msg_queue.pop())) {
+				this._socket_send(message);
+				// Notify listeners that message was successfully sent
+				if (this._notify_msg_sent[message]) {
+					this._notify_msg_sent[message]();
+					delete this._notify_msg_sent[message];
+				}
+			}
+		};
 
-			/**
-		 * Stop tracing.
-		 *
-		 * @name Paho.Client#stopTrace
-		 * @function
-		 */
-			this.stopTrace = function () {
-				client.stopTrace();
-			};
+		/**
+	 * Expect an ACK response for this message. Add message to the set of in progress
+	 * messages and set an unused identifier in this message.
+	 * @ignore
+	 */
+		ClientImpl.prototype._requires_ack = function (wireMessage) {
+			var messageCount = Object.keys(this._sentMessages).length;
+			if (messageCount > this.maxMessageIdentifier)
+				throw Error ("Too many messages:"+messageCount);
 
-			this.isConnected = function() {
-				return client.connected;
-			};
+			while(this._sentMessages[this._message_identifier] !== undefined) {
+				this._message_identifier++;
+			}
+			wireMessage.messageIdentifier = this._message_identifier;
+			this._sentMessages[wireMessage.messageIdentifier] = wireMessage;
+			if (wireMessage.type === MESSAGE_TYPE.PUBLISH) {
+				this.store("Sent:", wireMessage);
+			}
+			if (this._message_identifier === this.maxMessageIdentifier) {
+				this._message_identifier = 1;
+			}
 		};
 
 		/**
-	 * An application message, sent or received.
-	 * <p>
-	 * All attributes may be null, which implies the default values.
-	 *
-	 * @name Paho.Message
-	 * @constructor
-	 * @param {String|ArrayBuffer} payload The message data to be sent.
-	 * <p>
-	 * @property {string} payloadString <i>read only</i> The payload as a string if the payload consists of valid UTF-8 characters.
-	 * @property {ArrayBuffer} payloadBytes <i>read only</i> The payload as an ArrayBuffer.
-	 * <p>
-	 * @property {string} destinationName <b>mandatory</b> The name of the destination to which the message is to be sent
-	 *                    (for messages about to be sent) or the name of the destination from which the message has been received.
-	 *                    (for messages received by the onMessage function).
-	 * <p>
-	 * @property {number} qos The Quality of Service used to deliver the message.
-	 * <dl>
-	 *     <dt>0 Best effort (default).
-	 *     <dt>1 At least once.
-	 *     <dt>2 Exactly once.
-	 * </dl>
-	 * <p>
-	 * @property {Boolean} retained If true, the message is to be retained by the server and delivered
-	 *                     to both current and future subscriptions.
-	 *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.
-	 *                     A received message has the retained boolean set to true if the message was published
-	 *                     with the retained boolean set to true
-	 *                     and the subscrption was made after the message has been published.
-	 * <p>
-	 * @property {Boolean} duplicate <i>read only</i> If true, this message might be a duplicate of one which has already been received.
-	 *                     This is only set on messages received from the server.
-	 *
+	 * Called when the underlying websocket has been opened.
+	 * @ignore
 	 */
-		var Message = function (newPayload) {
-			var payload;
-			if (   typeof newPayload === "string" ||
-		newPayload instanceof ArrayBuffer ||
-		(ArrayBuffer.isView(newPayload) && !(newPayload instanceof DataView))
-			) {
-				payload = newPayload;
-			} else {
-				throw (format(ERROR.INVALID_ARGUMENT, [newPayload, "newPayload"]));
+		ClientImpl.prototype._on_socket_open = function () {
+		// Create the CONNECT message object.
+			var wireMessage = new WireMessage(MESSAGE_TYPE.CONNECT, this.connectOptions);
+			wireMessage.clientId = this.clientId;
+			this._socket_send(wireMessage);
+		};
+
+		/**
+	 * Called when the underlying websocket has received a complete packet.
+	 * @ignore
+	 */
+		ClientImpl.prototype._on_socket_message = function (event) {
+			this._trace("Client._on_socket_message", event.data);
+			var messages = this._deframeMessages(event.data);
+			for (var i = 0; i < messages.length; i+=1) {
+				this._handleMessage(messages[i]);
 			}
+		};
 
-			var destinationName;
-			var qos = 0;
-			var retained = false;
-			var duplicate = false;
+		ClientImpl.prototype._deframeMessages = function(data) {
+			var byteArray = new Uint8Array(data);
+			var messages = [];
+			if (this.receiveBuffer) {
+				var newData = new Uint8Array(this.receiveBuffer.length+byteArray.length);
+				newData.set(this.receiveBuffer);
+				newData.set(byteArray,this.receiveBuffer.length);
+				byteArray = newData;
+				delete this.receiveBuffer;
+			}
+			try {
+				var offset = 0;
+				while(offset < byteArray.length) {
+					var result = decodeMessage(byteArray,offset);
+					var wireMessage = result[0];
+					offset = result[1];
+					if (wireMessage !== null) {
+						messages.push(wireMessage);
+					} else {
+						break;
+					}
+				}
+				if (offset < byteArray.length) {
+					this.receiveBuffer = byteArray.subarray(offset);
+				}
+			} catch (error) {
+				var errorStack = ((error.hasOwnProperty("stack") == "undefined") ? error.stack.toString() : "No Error Stack Available");
+				this._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));
+				return;
+			}
+			return messages;
+		};
 
-			Object.defineProperties(this,{
-				"payloadString":{
-					enumerable : true,
-					get : function () {
-						if (typeof payload === "string")
-							return payload;
-						else
-							return parseUTF8(payload, 0, payload.length);
+		ClientImpl.prototype._handleMessage = function(wireMessage) {
+
+			this._trace("Client._handleMessage", wireMessage);
+
+			try {
+				switch(wireMessage.type) {
+				case MESSAGE_TYPE.CONNACK:
+					this._connectTimeout.cancel();
+					if (this._reconnectTimeout)
+						this._reconnectTimeout.cancel();
+
+					// If we have started using clean session then clear up the local state.
+					if (this.connectOptions.cleanSession) {
+						for (var key in this._sentMessages) {
+							var sentMessage = this._sentMessages[key];
+							localStorage.removeItem("Sent:"+this._localKey+sentMessage.messageIdentifier);
+						}
+						this._sentMessages = {};
+
+						for (var key in this._receivedMessages) {
+							var receivedMessage = this._receivedMessages[key];
+							localStorage.removeItem("Received:"+this._localKey+receivedMessage.messageIdentifier);
+						}
+						this._receivedMessages = {};
+					}
+					// Client connected and ready for business.
+					if (wireMessage.returnCode === 0) {
+
+						this.connected = true;
+						// Jump to the end of the list of uris and stop looking for a good host.
+
+						if (this.connectOptions.uris)
+							this.hostIndex = this.connectOptions.uris.length;
+
+					} else {
+						this._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));
+						break;
+					}
+
+					// Resend messages.
+					var sequencedMessages = [];
+					for (var msgId in this._sentMessages) {
+						if (this._sentMessages.hasOwnProperty(msgId))
+							sequencedMessages.push(this._sentMessages[msgId]);
+					}
+
+					// Also schedule qos 0 buffered messages if any
+					if (this._buffered_msg_queue.length > 0) {
+						var msg = null;
+						while ((msg = this._buffered_msg_queue.pop())) {
+							sequencedMessages.push(msg);
+							if (this.onMessageDelivered)
+								this._notify_msg_sent[msg] = this.onMessageDelivered(msg.payloadMessage);
+						}
 					}
-				},
-				"payloadBytes":{
-					enumerable: true,
-					get: function() {
-						if (typeof payload === "string") {
-							var buffer = new ArrayBuffer(UTF8Length(payload));
-							var byteStream = new Uint8Array(buffer);
-							stringToUTF8(payload, byteStream, 0);
 
-							return byteStream;
+					// Sort sentMessages into the original sent order.
+					var sequencedMessages = sequencedMessages.sort(function(a,b) {return a.sequence - b.sequence;} );
+					for (var i=0, len=sequencedMessages.length; i<len; i++) {
+						var sentMessage = sequencedMessages[i];
+						if (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {
+							var pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});
+							this._schedule_message(pubRelMessage);
 						} else {
-							return payload;
+							this._schedule_message(sentMessage);
 						}
 					}
-				},
-				"destinationName":{
-					enumerable: true,
-					get: function() { return destinationName; },
-					set: function(newDestinationName) {
-						if (typeof newDestinationName === "string")
-							destinationName = newDestinationName;
-						else
-							throw new Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, "newDestinationName"]));
+
+					// Execute the connectOptions.onSuccess callback if there is one.
+					// Will also now return if this connection was the result of an automatic
+					// reconnect and which URI was successfully connected to.
+					if (this.connectOptions.onSuccess) {
+						this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});
 					}
-				},
-				"qos":{
-					enumerable: true,
-					get: function() { return qos; },
-					set: function(newQos) {
-						if (newQos === 0 || newQos === 1 || newQos === 2 )
-							qos = newQos;
-						else
-							throw new Error("Invalid argument:"+newQos);
+
+					var reconnected = false;
+					if (this._reconnecting) {
+						reconnected = true;
+						this._reconnectInterval = 1;
+						this._reconnecting = false;
 					}
-				},
-				"retained":{
-					enumerable: true,
-					get: function() { return retained; },
-					set: function(newRetained) {
-						if (typeof newRetained === "boolean")
-							retained = newRetained;
-						else
-							throw new Error(format(ERROR.INVALID_ARGUMENT, [newRetained, "newRetained"]));
+
+					// Execute the onConnected callback if there is one.
+					this._connected(reconnected, this._wsuri);
+
+					// Process all queued messages now that the connection is established.
+					this._process_queue();
+					break;
+
+				case MESSAGE_TYPE.PUBLISH:
+					this._receivePublish(wireMessage);
+					break;
+
+				case MESSAGE_TYPE.PUBACK:
+					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
+					// If this is a re flow of a PUBACK after we have restarted receivedMessage will not exist.
+					if (sentMessage) {
+						delete this._sentMessages[wireMessage.messageIdentifier];
+						localStorage.removeItem("Sent:"+this._localKey+wireMessage.messageIdentifier);
+						if (this.onMessageDelivered)
+							this.onMessageDelivered(sentMessage.payloadMessage);
 					}
-				},
-				"topic":{
-					enumerable: true,
-					get: function() { return destinationName; },
-					set: function(newTopic) {destinationName=newTopic;}
-				},
-				"duplicate":{
-					enumerable: true,
-					get: function() { return duplicate; },
-					set: function(newDuplicate) {duplicate=newDuplicate;}
-				}
-			});
-		};
+					break;
 
-		// Module contents.
-		return {
-			Client: Client,
-			Message: Message
-		};
-	// eslint-disable-next-line no-nested-ternary
-	})(typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {});
-	return PahoMQTT;
-});
+				case MESSAGE_TYPE.PUBREC:
+					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
+					// If this is a re flow of a PUBREC after we have restarted receivedMessage will not exist.
+					if (sentMessage) {
+						sentMessage.pubRecReceived = true;
+						var pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});
+						this.store("Sent:", sentMessage);
+						this._schedule_message(pubRelMessage);
+					}
+					break;
 
-/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "../../node_modules/webpack/buildin/global.js")))
+				case MESSAGE_TYPE.PUBREL:
+					var receivedMessage = this._receivedMessages[wireMessage.messageIdentifier];
+					localStorage.removeItem("Received:"+this._localKey+wireMessage.messageIdentifier);
+					// If this is a re flow of a PUBREL after we have restarted receivedMessage will not exist.
+					if (receivedMessage) {
+						this._receiveMessage(receivedMessage);
+						delete this._receivedMessages[wireMessage.messageIdentifier];
+					}
+					// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.
+					var pubCompMessage = new WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});
+					this._schedule_message(pubCompMessage);
 
-/***/ }),
 
-/***/ "../../node_modules/punycode/punycode.js":
-/*!**********************************************************!*\
-  !*** /root/amplify-js/node_modules/punycode/punycode.js ***!
-  \**********************************************************/
-/*! no static exports found */
-/***/ (function(module, exports, __webpack_require__) {
+					break;
 
-/* WEBPACK VAR INJECTION */(function(module, global) {var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */
-;(function(root) {
+				case MESSAGE_TYPE.PUBCOMP:
+					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
+					delete this._sentMessages[wireMessage.messageIdentifier];
+					localStorage.removeItem("Sent:"+this._localKey+wireMessage.messageIdentifier);
+					if (this.onMessageDelivered)
+						this.onMessageDelivered(sentMessage.payloadMessage);
+					break;
 
-	/** Detect free variables */
-	var freeExports =  true && exports &&
-		!exports.nodeType && exports;
-	var freeModule =  true && module &&
-		!module.nodeType && module;
-	var freeGlobal = typeof global == 'object' && global;
-	if (
-		freeGlobal.global === freeGlobal ||
-		freeGlobal.window === freeGlobal ||
-		freeGlobal.self === freeGlobal
-	) {
-		root = freeGlobal;
-	}
+				case MESSAGE_TYPE.SUBACK:
+					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
+					if (sentMessage) {
+						if(sentMessage.timeOut)
+							sentMessage.timeOut.cancel();
+						// This will need to be fixed when we add multiple topic support
+						if (wireMessage.returnCode[0] === 0x80) {
+							if (sentMessage.onFailure) {
+								sentMessage.onFailure(wireMessage.returnCode);
+							}
+						} else if (sentMessage.onSuccess) {
+							sentMessage.onSuccess(wireMessage.returnCode);
+						}
+						delete this._sentMessages[wireMessage.messageIdentifier];
+					}
+					break;
 
-	/**
-	 * The `punycode` object.
-	 * @name punycode
-	 * @type Object
-	 */
-	var punycode,
+				case MESSAGE_TYPE.UNSUBACK:
+					var sentMessage = this._sentMessages[wireMessage.messageIdentifier];
+					if (sentMessage) {
+						if (sentMessage.timeOut)
+							sentMessage.timeOut.cancel();
+						if (sentMessage.callback) {
+							sentMessage.callback();
+						}
+						delete this._sentMessages[wireMessage.messageIdentifier];
+					}
 
-	/** Highest positive signed 32-bit float value */
-	maxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1
+					break;
 
-	/** Bootstring parameters */
-	base = 36,
-	tMin = 1,
-	tMax = 26,
-	skew = 38,
-	damp = 700,
-	initialBias = 72,
-	initialN = 128, // 0x80
-	delimiter = '-', // '\x2D'
+				case MESSAGE_TYPE.PINGRESP:
+				/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */
+					this.sendPinger.reset();
+					break;
 
-	/** Regular expressions */
-	regexPunycode = /^xn--/,
-	regexNonASCII = /[^\x20-\x7E]/, // unprintable ASCII chars + non-ASCII chars
-	regexSeparators = /[\x2E\u3002\uFF0E\uFF61]/g, // RFC 3490 separators
+				case MESSAGE_TYPE.DISCONNECT:
+				// Clients do not expect to receive disconnect packets.
+					this._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));
+					break;
+
+				default:
+					this._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));
+				}
+			} catch (error) {
+				var errorStack = ((error.hasOwnProperty("stack") == "undefined") ? error.stack.toString() : "No Error Stack Available");
+				this._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));
+				return;
+			}
+		};
+
+		/** @ignore */
+		ClientImpl.prototype._on_socket_error = function (error) {
+			if (!this._reconnecting) {
+				this._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));
+			}
+		};
+
+		/** @ignore */
+		ClientImpl.prototype._on_socket_close = function () {
+			if (!this._reconnecting) {
+				this._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));
+			}
+		};
+
+		/** @ignore */
+		ClientImpl.prototype._socket_send = function (wireMessage) {
+
+			if (wireMessage.type == 1) {
+				var wireMessageMasked = this._traceMask(wireMessage, "password");
+				this._trace("Client._socket_send", wireMessageMasked);
+			}
+			else this._trace("Client._socket_send", wireMessage);
+
+			this.socket.send(wireMessage.encode());
+			/* We have proved to the server we are alive. */
+			this.sendPinger.reset();
+		};
+
+		/** @ignore */
+		ClientImpl.prototype._receivePublish = function (wireMessage) {
+			switch(wireMessage.payloadMessage.qos) {
+			case "undefined":
+			case 0:
+				this._receiveMessage(wireMessage);
+				break;
+
+			case 1:
+				var pubAckMessage = new WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});
+				this._schedule_message(pubAckMessage);
+				this._receiveMessage(wireMessage);
+				break;
 
-	/** Error messages */
-	errors = {
-		'overflow': 'Overflow: input needs wider integers to process',
-		'not-basic': 'Illegal input >= 0x80 (not a basic code point)',
-		'invalid-input': 'Invalid input'
-	},
+			case 2:
+				this._receivedMessages[wireMessage.messageIdentifier] = wireMessage;
+				this.store("Received:", wireMessage);
+				var pubRecMessage = new WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});
+				this._schedule_message(pubRecMessage);
 
-	/** Convenience shortcuts */
-	baseMinusTMin = base - tMin,
-	floor = Math.floor,
-	stringFromCharCode = String.fromCharCode,
+				break;
 
-	/** Temporary variable */
-	key;
+			default:
+				throw Error("Invaild qos=" + wireMessage.payloadMessage.qos);
+			}
+		};
 
-	/*--------------------------------------------------------------------------*/
+		/** @ignore */
+		ClientImpl.prototype._receiveMessage = function (wireMessage) {
+			if (this.onMessageArrived) {
+				this.onMessageArrived(wireMessage.payloadMessage);
+			}
+		};
 
-	/**
-	 * A generic error utility function.
-	 * @private
-	 * @param {String} type The error type.
-	 * @returns {Error} Throws a `RangeError` with the applicable error message.
+		/**
+	 * Client has connected.
+	 * @param {reconnect} [boolean] indicate if this was a result of reconnect operation.
+	 * @param {uri} [string] fully qualified WebSocket URI of the server.
 	 */
-	function error(type) {
-		throw new RangeError(errors[type]);
-	}
+		ClientImpl.prototype._connected = function (reconnect, uri) {
+		// Execute the onConnected callback if there is one.
+			if (this.onConnected)
+				this.onConnected(reconnect, uri);
+		};
 
-	/**
-	 * A generic `Array#map` utility function.
-	 * @private
-	 * @param {Array} array The array to iterate over.
-	 * @param {Function} callback The function that gets called for every array
-	 * item.
-	 * @returns {Array} A new array of values returned by the callback function.
+		/**
+	 * Attempts to reconnect the client to the server.
+   * For each reconnect attempt, will double the reconnect interval
+   * up to 128 seconds.
 	 */
-	function map(array, fn) {
-		var length = array.length;
-		var result = [];
-		while (length--) {
-			result[length] = fn(array[length]);
-		}
-		return result;
-	}
+		ClientImpl.prototype._reconnect = function () {
+			this._trace("Client._reconnect");
+			if (!this.connected) {
+				this._reconnecting = true;
+				this.sendPinger.cancel();
+				this.receivePinger.cancel();
+				if (this._reconnectInterval < 128)
+					this._reconnectInterval = this._reconnectInterval * 2;
+				if (this.connectOptions.uris) {
+					this.hostIndex = 0;
+					this._doConnect(this.connectOptions.uris[0]);
+				} else {
+					this._doConnect(this.uri);
+				}
+			}
+		};
 
-	/**
-	 * A simple `Array#map`-like wrapper to work with domain name strings or email
-	 * addresses.
-	 * @private
-	 * @param {String} domain The domain name or email address.
-	 * @param {Function} callback The function that gets called for every
-	 * character.
-	 * @returns {Array} A new string of characters returned by the callback
-	 * function.
+		/**
+	 * Client has disconnected either at its own request or because the server
+	 * or network disconnected it. Remove all non-durable state.
+	 * @param {errorCode} [number] the error number.
+	 * @param {errorText} [string] the error text.
+	 * @ignore
 	 */
-	function mapDomain(string, fn) {
-		var parts = string.split('@');
-		var result = '';
-		if (parts.length > 1) {
-			// In email addresses, only the domain name should be punycoded. Leave
-			// the local part (i.e. everything up to `@`) intact.
-			result = parts[0] + '@';
-			string = parts[1];
-		}
-		// Avoid `split(regex)` for IE8 compatibility. See #17.
-		string = string.replace(regexSeparators, '\x2E');
-		var labels = string.split('.');
-		var encoded = map(labels, fn).join('.');
-		return result + encoded;
-	}
+		ClientImpl.prototype._disconnected = function (errorCode, errorText) {
+			this._trace("Client._disconnected", errorCode, errorText);
 
-	/**
-	 * Creates an array containing the numeric code points of each Unicode
-	 * character in the string. While JavaScript uses UCS-2 internally,
-	 * this function will convert a pair of surrogate halves (each of which
-	 * UCS-2 exposes as separate characters) into a single code point,
-	 * matching UTF-16.
-	 * @see `punycode.ucs2.encode`
-	 * @see <https://mathiasbynens.be/notes/javascript-encoding>
-	 * @memberOf punycode.ucs2
-	 * @name decode
-	 * @param {String} string The Unicode input string (UCS-2).
-	 * @returns {Array} The new array of code points.
-	 */
-	function ucs2decode(string) {
-		var output = [],
-		    counter = 0,
-		    length = string.length,
-		    value,
-		    extra;
-		while (counter < length) {
-			value = string.charCodeAt(counter++);
-			if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
-				// high surrogate, and there is a next character
-				extra = string.charCodeAt(counter++);
-				if ((extra & 0xFC00) == 0xDC00) { // low surrogate
-					output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
+			if (errorCode !== undefined && this._reconnecting) {
+				//Continue automatic reconnect process
+				this._reconnectTimeout = new Timeout(this, this._reconnectInterval, this._reconnect);
+				return;
+			}
+
+			this.sendPinger.cancel();
+			this.receivePinger.cancel();
+			if (this._connectTimeout) {
+				this._connectTimeout.cancel();
+				this._connectTimeout = null;
+			}
+
+			// Clear message buffers.
+			this._msg_queue = [];
+			this._buffered_msg_queue = [];
+			this._notify_msg_sent = {};
+
+			if (this.socket) {
+			// Cancel all socket callbacks so that they cannot be driven again by this socket.
+				this.socket.onopen = null;
+				this.socket.onmessage = null;
+				this.socket.onerror = null;
+				this.socket.onclose = null;
+				if (this.socket.readyState === 1)
+					this.socket.close();
+				delete this.socket;
+			}
+
+			if (this.connectOptions.uris && this.hostIndex < this.connectOptions.uris.length-1) {
+			// Try the next host.
+				this.hostIndex++;
+				this._doConnect(this.connectOptions.uris[this.hostIndex]);
+			} else {
+
+				if (errorCode === undefined) {
+					errorCode = ERROR.OK.code;
+					errorText = format(ERROR.OK);
+				}
+
+				// Run any application callbacks last as they may attempt to reconnect and hence create a new socket.
+				if (this.connected) {
+					this.connected = false;
+					// Execute the connectionLostCallback if there is one, and we were connected.
+					if (this.onConnectionLost) {
+						this.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:this.connectOptions.reconnect, uri:this._wsuri});
+					}
+					if (errorCode !== ERROR.OK.code && this.connectOptions.reconnect) {
+					// Start automatic reconnect process for the very first time since last successful connect.
+						this._reconnectInterval = 1;
+						this._reconnect();
+						return;
+					}
 				} else {
-					// unmatched surrogate; only append this code unit, in case the next
-					// code unit is the high surrogate of a surrogate pair
-					output.push(value);
-					counter--;
+				// Otherwise we never had a connection, so indicate that the connect has failed.
+					if (this.connectOptions.mqttVersion === 4 && this.connectOptions.mqttVersionExplicit === false) {
+						this._trace("Failed to connect V4, dropping back to V3");
+						this.connectOptions.mqttVersion = 3;
+						if (this.connectOptions.uris) {
+							this.hostIndex = 0;
+							this._doConnect(this.connectOptions.uris[0]);
+						} else {
+							this._doConnect(this.uri);
+						}
+					} else if(this.connectOptions.onFailure) {
+						this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});
+					}
 				}
-			} else {
-				output.push(value);
 			}
-		}
-		return output;
-	}
+		};
 
-	/**
-	 * Creates a string based on an array of numeric code points.
-	 * @see `punycode.ucs2.decode`
-	 * @memberOf punycode.ucs2
-	 * @name encode
-	 * @param {Array} codePoints The array of numeric code points.
-	 * @returns {String} The new Unicode string (UCS-2).
-	 */
-	function ucs2encode(array) {
-		return map(array, function(value) {
-			var output = '';
-			if (value > 0xFFFF) {
-				value -= 0x10000;
-				output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
-				value = 0xDC00 | value & 0x3FF;
+		/** @ignore */
+		ClientImpl.prototype._trace = function () {
+		// Pass trace message back to client's callback function
+			if (this.traceFunction) {
+				var args = Array.prototype.slice.call(arguments);
+				for (var i in args)
+				{
+					if (typeof args[i] !== "undefined")
+						args.splice(i, 1, JSON.stringify(args[i]));
+				}
+				var record = args.join("");
+				this.traceFunction ({severity: "Debug", message: record	});
+			}
+
+			//buffer style trace
+			if ( this._traceBuffer !== null ) {
+				for (var i = 0, max = arguments.length; i < max; i++) {
+					if ( this._traceBuffer.length == this._MAX_TRACE_ENTRIES ) {
+						this._traceBuffer.shift();
+					}
+					if (i === 0) this._traceBuffer.push(arguments[i]);
+					else if (typeof arguments[i] === "undefined" ) this._traceBuffer.push(arguments[i]);
+					else this._traceBuffer.push("  "+JSON.stringify(arguments[i]));
+				}
+			}
+		};
+
+		/** @ignore */
+		ClientImpl.prototype._traceMask = function (traceObject, masked) {
+			var traceObjectMasked = {};
+			for (var attr in traceObject) {
+				if (traceObject.hasOwnProperty(attr)) {
+					if (attr == masked)
+						traceObjectMasked[attr] = "******";
+					else
+						traceObjectMasked[attr] = traceObject[attr];
+				}
 			}
-			output += stringFromCharCode(value);
-			return output;
-		}).join('');
-	}
+			return traceObjectMasked;
+		};
 
-	/**
-	 * Converts a basic code point into a digit/integer.
-	 * @see `digitToBasic()`
-	 * @private
-	 * @param {Number} codePoint The basic numeric code point value.
-	 * @returns {Number} The numeric value of a basic code point (for use in
-	 * representing integers) in the range `0` to `base - 1`, or `base` if
-	 * the code point does not represent a value.
-	 */
-	function basicToDigit(codePoint) {
-		if (codePoint - 48 < 10) {
-			return codePoint - 22;
-		}
-		if (codePoint - 65 < 26) {
-			return codePoint - 65;
-		}
-		if (codePoint - 97 < 26) {
-			return codePoint - 97;
-		}
-		return base;
-	}
+		// ------------------------------------------------------------------------
+		// Public Programming interface.
+		// ------------------------------------------------------------------------
 
-	/**
-	 * Converts a digit/integer into a basic code point.
-	 * @see `basicToDigit()`
-	 * @private
-	 * @param {Number} digit The numeric value of a basic code point.
-	 * @returns {Number} The basic code point whose value (when used for
-	 * representing integers) is `digit`, which needs to be in the range
-	 * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is
-	 * used; else, the lowercase form is used. The behavior is undefined
-	 * if `flag` is non-zero and `digit` has no uppercase form.
+		/**
+	 * The JavaScript application communicates to the server using a {@link Paho.Client} object.
+	 * <p>
+	 * Most applications will create just one Client object and then call its connect() method,
+	 * however applications can create more than one Client object if they wish.
+	 * In this case the combination of host, port and clientId attributes must be different for each Client object.
+	 * <p>
+	 * The send, subscribe and unsubscribe methods are implemented as asynchronous JavaScript methods
+	 * (even though the underlying protocol exchange might be synchronous in nature).
+	 * This means they signal their completion by calling back to the application,
+	 * via Success or Failure callback functions provided by the application on the method in question.
+	 * Such callbacks are called at most once per method invocation and do not persist beyond the lifetime
+	 * of the script that made the invocation.
+	 * <p>
+	 * In contrast there are some callback functions, most notably <i>onMessageArrived</i>,
+	 * that are defined on the {@link Paho.Client} object.
+	 * These may get called multiple times, and aren't directly related to specific method invocations made by the client.
+	 *
+	 * @name Paho.Client
+	 *
+	 * @constructor
+	 *
+	 * @param {string} host - the address of the messaging server, as a fully qualified WebSocket URI, as a DNS name or dotted decimal IP address.
+	 * @param {number} port - the port number to connect to - only required if host is not a URI
+	 * @param {string} path - the path on the host to connect to - only used if host is not a URI. Default: '/mqtt'.
+	 * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters in length.
+	 *
+	 * @property {string} host - <i>read only</i> the server's DNS hostname or dotted decimal IP address.
+	 * @property {number} port - <i>read only</i> the server's port.
+	 * @property {string} path - <i>read only</i> the server's path.
+	 * @property {string} clientId - <i>read only</i> used when connecting to the server.
+	 * @property {function} onConnectionLost - called when a connection has been lost.
+	 *                            after a connect() method has succeeded.
+	 *                            Establish the call back used when a connection has been lost. The connection may be
+	 *                            lost because the client initiates a disconnect or because the server or network
+	 *                            cause the client to be disconnected. The disconnect call back may be called without
+	 *                            the connectionComplete call back being invoked if, for example the client fails to
+	 *                            connect.
+	 *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:
+	 *                            <ol>
+	 *                            <li>errorCode
+	 *                            <li>errorMessage
+	 *                            </ol>
+	 * @property {function} onMessageDelivered - called when a message has been delivered.
+	 *                            All processing that this Client will ever do has been completed. So, for example,
+	 *                            in the case of a Qos=2 message sent by this client, the PubComp flow has been received from the server
+	 *                            and the message has been removed from persistent storage before this callback is invoked.
+	 *                            Parameters passed to the onMessageDelivered callback are:
+	 *                            <ol>
+	 *                            <li>{@link Paho.Message} that was delivered.
+	 *                            </ol>
+	 * @property {function} onMessageArrived - called when a message has arrived in this Paho.client.
+	 *                            Parameters passed to the onMessageArrived callback are:
+	 *                            <ol>
+	 *                            <li>{@link Paho.Message} that has arrived.
+	 *                            </ol>
+	 * @property {function} onConnected - called when a connection is successfully made to the server.
+	 *                                  after a connect() method.
+	 *                                  Parameters passed to the onConnected callback are:
+	 *                                  <ol>
+	 *                                  <li>reconnect (boolean) - If true, the connection was the result of a reconnect.</li>
+	 *                                  <li>URI (string) - The URI used to connect to the server.</li>
+	 *                                  </ol>
+	 * @property {boolean} disconnectedPublishing - if set, will enable disconnected publishing in
+	 *                                            in the event that the connection to the server is lost.
+	 * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected
+	 *                                             buffer will hold before rejecting new messages. Default size: 5000 messages
+	 * @property {function} trace - called whenever trace is called. TODO
 	 */
-	function digitToBasic(digit, flag) {
-		//  0..25 map to ASCII a..z or A..Z
-		// 26..35 map to ASCII 0..9
-		return digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);
-	}
+		var Client = function (host, port, path, clientId) {
 
-	/**
-	 * Bias adaptation function as per section 3.4 of RFC 3492.
-	 * https://tools.ietf.org/html/rfc3492#section-3.4
-	 * @private
-	 */
-	function adapt(delta, numPoints, firstTime) {
-		var k = 0;
-		delta = firstTime ? floor(delta / damp) : delta >> 1;
-		delta += floor(delta / numPoints);
-		for (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {
-			delta = floor(delta / baseMinusTMin);
-		}
-		return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));
-	}
+			var uri;
 
-	/**
-	 * Converts a Punycode string of ASCII-only symbols to a string of Unicode
-	 * symbols.
-	 * @memberOf punycode
-	 * @param {String} input The Punycode string of ASCII-only symbols.
-	 * @returns {String} The resulting string of Unicode symbols.
-	 */
-	function decode(input) {
-		// Don't use UCS-2
-		var output = [],
-		    inputLength = input.length,
-		    out,
-		    i = 0,
-		    n = initialN,
-		    bias = initialBias,
-		    basic,
-		    j,
-		    index,
-		    oldi,
-		    w,
-		    k,
-		    digit,
-		    t,
-		    /** Cached calculation results */
-		    baseMinusT;
+			if (typeof host !== "string")
+				throw new Error(format(ERROR.INVALID_TYPE, [typeof host, "host"]));
 
-		// Handle the basic code points: let `basic` be the number of input code
-		// points before the last delimiter, or `0` if there is none, then copy
-		// the first basic code points to the output.
+			if (arguments.length == 2) {
+			// host: must be full ws:// uri
+			// port: clientId
+				clientId = port;
+				uri = host;
+				var match = uri.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);
+				if (match) {
+					host = match[4]||match[2];
+					port = parseInt(match[7]);
+					path = match[8];
+				} else {
+					throw new Error(format(ERROR.INVALID_ARGUMENT,[host,"host"]));
+				}
+			} else {
+				if (arguments.length == 3) {
+					clientId = path;
+					path = "/mqtt";
+				}
+				if (typeof port !== "number" || port < 0)
+					throw new Error(format(ERROR.INVALID_TYPE, [typeof port, "port"]));
+				if (typeof path !== "string")
+					throw new Error(format(ERROR.INVALID_TYPE, [typeof path, "path"]));
 
-		basic = input.lastIndexOf(delimiter);
-		if (basic < 0) {
-			basic = 0;
-		}
+				var ipv6AddSBracket = (host.indexOf(":") !== -1 && host.slice(0,1) !== "[" && host.slice(-1) !== "]");
+				uri = "ws://"+(ipv6AddSBracket?"["+host+"]":host)+":"+port+path;
+			}
 
-		for (j = 0; j < basic; ++j) {
-			// if it's not a basic code point
-			if (input.charCodeAt(j) >= 0x80) {
-				error('not-basic');
+			var clientIdLength = 0;
+			for (var i = 0; i<clientId.length; i++) {
+				var charCode = clientId.charCodeAt(i);
+				if (0xD800 <= charCode && charCode <= 0xDBFF)  {
+					i++; // Surrogate pair.
+				}
+				clientIdLength++;
 			}
-			output.push(input.charCodeAt(j));
-		}
+			if (typeof clientId !== "string" || clientIdLength > 65535)
+				throw new Error(format(ERROR.INVALID_ARGUMENT, [clientId, "clientId"]));
 
-		// Main decoding loop: start just after the last delimiter if any basic code
-		// points were copied; start at the beginning otherwise.
+			var client = new ClientImpl(uri, host, port, path, clientId);
+
+			//Public Properties
+			Object.defineProperties(this,{
+				"host":{
+					get: function() { return host; },
+					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
+				},
+				"port":{
+					get: function() { return port; },
+					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
+				},
+				"path":{
+					get: function() { return path; },
+					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
+				},
+				"uri":{
+					get: function() { return uri; },
+					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
+				},
+				"clientId":{
+					get: function() { return client.clientId; },
+					set: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }
+				},
+				"onConnected":{
+					get: function() { return client.onConnected; },
+					set: function(newOnConnected) {
+						if (typeof newOnConnected === "function")
+							client.onConnected = newOnConnected;
+						else
+							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnected, "onConnected"]));
+					}
+				},
+				"disconnectedPublishing":{
+					get: function() { return client.disconnectedPublishing; },
+					set: function(newDisconnectedPublishing) {
+						client.disconnectedPublishing = newDisconnectedPublishing;
+					}
+				},
+				"disconnectedBufferSize":{
+					get: function() { return client.disconnectedBufferSize; },
+					set: function(newDisconnectedBufferSize) {
+						client.disconnectedBufferSize = newDisconnectedBufferSize;
+					}
+				},
+				"onConnectionLost":{
+					get: function() { return client.onConnectionLost; },
+					set: function(newOnConnectionLost) {
+						if (typeof newOnConnectionLost === "function")
+							client.onConnectionLost = newOnConnectionLost;
+						else
+							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnectionLost, "onConnectionLost"]));
+					}
+				},
+				"onMessageDelivered":{
+					get: function() { return client.onMessageDelivered; },
+					set: function(newOnMessageDelivered) {
+						if (typeof newOnMessageDelivered === "function")
+							client.onMessageDelivered = newOnMessageDelivered;
+						else
+							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageDelivered, "onMessageDelivered"]));
+					}
+				},
+				"onMessageArrived":{
+					get: function() { return client.onMessageArrived; },
+					set: function(newOnMessageArrived) {
+						if (typeof newOnMessageArrived === "function")
+							client.onMessageArrived = newOnMessageArrived;
+						else
+							throw new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageArrived, "onMessageArrived"]));
+					}
+				},
+				"trace":{
+					get: function() { return client.traceFunction; },
+					set: function(trace) {
+						if(typeof trace === "function"){
+							client.traceFunction = trace;
+						}else{
+							throw new Error(format(ERROR.INVALID_TYPE, [typeof trace, "onTrace"]));
+						}
+					}
+				},
+			});
 
-		for (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {
+			/**
+		 * Connect this Messaging client to its server.
+		 *
+		 * @name Paho.Client#connect
+		 * @function
+		 * @param {object} connectOptions - Attributes used with the connection.
+		 * @param {number} connectOptions.timeout - If the connect has not succeeded within this
+		 *                    number of seconds, it is deemed to have failed.
+		 *                    The default is 30 seconds.
+		 * @param {string} connectOptions.userName - Authentication username for this connection.
+		 * @param {string} connectOptions.password - Authentication password for this connection.
+		 * @param {Paho.Message} connectOptions.willMessage - sent by the server when the client
+		 *                    disconnects abnormally.
+		 * @param {number} connectOptions.keepAliveInterval - the server disconnects this client if
+		 *                    there is no activity for this number of seconds.
+		 *                    The default value of 60 seconds is assumed if not set.
+		 * @param {boolean} connectOptions.cleanSession - if true(default) the client and server
+		 *                    persistent state is deleted on successful connect.
+		 * @param {boolean} connectOptions.useSSL - if present and true, use an SSL Websocket connection.
+		 * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.
+		 * @param {function} connectOptions.onSuccess - called when the connect acknowledgement
+		 *                    has been received from the server.
+		 * A single response object parameter is passed to the onSuccess callback containing the following fields:
+		 * <ol>
+		 * <li>invocationContext as passed in to the onSuccess method in the connectOptions.
+		 * </ol>
+	 * @param {function} connectOptions.onFailure - called when the connect request has failed or timed out.
+		 * A single response object parameter is passed to the onFailure callback containing the following fields:
+		 * <ol>
+		 * <li>invocationContext as passed in to the onFailure method in the connectOptions.
+		 * <li>errorCode a number indicating the nature of the error.
+		 * <li>errorMessage text describing the error.
+		 * </ol>
+	 * @param {array} connectOptions.hosts - If present this contains either a set of hostnames or fully qualified
+		 * WebSocket URIs (ws://iot.eclipse.org:80/ws), that are tried in order in place
+		 * of the host and port paramater on the construtor. The hosts are tried one at at time in order until
+		 * one of then succeeds.
+	 * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, this property
+		 * is not used.
+	 * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect
+	 * to the server if the connection is lost.
+	 *<ul>
+	 *<li>If set to false, the client will not attempt to automatically reconnect to the server in the event that the
+	 * connection is lost.</li>
+	 *<li>If set to true, in the event that the connection is lost, the client will attempt to reconnect to the server.
+	 * It will initially wait 1 second before it attempts to reconnect, for every failed reconnect attempt, the delay
+	 * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.</li>
+	 *</ul>
+	 * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.
+	 *<ul>
+	 *<li>3 - MQTT V3.1</li>
+	 *<li>4 - MQTT V3.1.1</li>
+	 *</ul>
+	 * @param {boolean} connectOptions.mqttVersionExplicit - If set to true, will force the connection to use the
+	 * selected MQTT Version or will fail to connect.
+	 * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris
+	 * (e.g. ws://iot.eclipse.org:80/ws), that are tried in order in place of the host and port parameter of the construtor.
+	 * The uris are tried one at a time in order until one of them succeeds. Do not use this in conjunction with hosts as
+	 * the hosts array will be converted to uris and will overwrite this property.
+		 * @throws {InvalidState} If the client is not in disconnected state. The client must have received connectionLost
+		 * or disconnected before calling connect for a second or subsequent time.
+		 */
+			this.connect = function (connectOptions) {
+				connectOptions = connectOptions || {} ;
+				validate(connectOptions,  {timeout:"number",
+					userName:"string",
+					password:"string",
+					willMessage:"object",
+					keepAliveInterval:"number",
+					cleanSession:"boolean",
+					useSSL:"boolean",
+					invocationContext:"object",
+					onSuccess:"function",
+					onFailure:"function",
+					hosts:"object",
+					ports:"object",
+					reconnect:"boolean",
+					mqttVersion:"number",
+					mqttVersionExplicit:"boolean",
+					uris: "object"});
 
-			// `index` is the index of the next character to be consumed.
-			// Decode a generalized variable-length integer into `delta`,
-			// which gets added to `i`. The overflow checking is easier
-			// if we increase `i` as we go, then subtract off its starting
-			// value at the end to obtain `delta`.
-			for (oldi = i, w = 1, k = base; /* no condition */; k += base) {
+				// If no keep alive interval is set, assume 60 seconds.
+				if (connectOptions.keepAliveInterval === undefined)
+					connectOptions.keepAliveInterval = 60;
 
-				if (index >= inputLength) {
-					error('invalid-input');
+				if (connectOptions.mqttVersion > 4 || connectOptions.mqttVersion < 3) {
+					throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, "connectOptions.mqttVersion"]));
 				}
 
-				digit = basicToDigit(input.charCodeAt(index++));
-
-				if (digit >= base || digit > floor((maxInt - i) / w)) {
-					error('overflow');
+				if (connectOptions.mqttVersion === undefined) {
+					connectOptions.mqttVersionExplicit = false;
+					connectOptions.mqttVersion = 4;
+				} else {
+					connectOptions.mqttVersionExplicit = true;
 				}
 
-				i += digit * w;
-				t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);
+				//Check that if password is set, so is username
+				if (connectOptions.password !== undefined && connectOptions.userName === undefined)
+					throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, "connectOptions.password"]));
 
-				if (digit < t) {
-					break;
-				}
+				if (connectOptions.willMessage) {
+					if (!(connectOptions.willMessage instanceof Message))
+						throw new Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, "connectOptions.willMessage"]));
+					// The will message must have a payload that can be represented as a string.
+					// Cause the willMessage to throw an exception if this is not the case.
+					connectOptions.willMessage.stringPayload = null;
 
-				baseMinusT = base - t;
-				if (w > floor(maxInt / baseMinusT)) {
-					error('overflow');
+					if (typeof connectOptions.willMessage.destinationName === "undefined")
+						throw new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.willMessage.destinationName, "connectOptions.willMessage.destinationName"]));
 				}
+				if (typeof connectOptions.cleanSession === "undefined")
+					connectOptions.cleanSession = true;
+				if (connectOptions.hosts) {
 
-				w *= baseMinusT;
-
-			}
-
-			out = output.length + 1;
-			bias = adapt(i - oldi, out, oldi == 0);
-
-			// `i` was supposed to wrap around from `out` to `0`,
-			// incrementing `n` each time, so we'll fix that now:
-			if (floor(i / out) > maxInt - n) {
-				error('overflow');
-			}
+					if (!(connectOptions.hosts instanceof Array) )
+						throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, "connectOptions.hosts"]));
+					if (connectOptions.hosts.length <1 )
+						throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, "connectOptions.hosts"]));
 
-			n += floor(i / out);
-			i %= out;
+					var usingURIs = false;
+					for (var i = 0; i<connectOptions.hosts.length; i++) {
+						if (typeof connectOptions.hosts[i] !== "string")
+							throw new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.hosts[i], "connectOptions.hosts["+i+"]"]));
+						if (/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(connectOptions.hosts[i])) {
+							if (i === 0) {
+								usingURIs = true;
+							} else if (!usingURIs) {
+								throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], "connectOptions.hosts["+i+"]"]));
+							}
+						} else if (usingURIs) {
+							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], "connectOptions.hosts["+i+"]"]));
+						}
+					}
 
-			// Insert `n` at position `i` of the output
-			output.splice(i++, 0, n);
+					if (!usingURIs) {
+						if (!connectOptions.ports)
+							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, "connectOptions.ports"]));
+						if (!(connectOptions.ports instanceof Array) )
+							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, "connectOptions.ports"]));
+						if (connectOptions.hosts.length !== connectOptions.ports.length)
+							throw new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, "connectOptions.ports"]));
 
-		}
+						connectOptions.uris = [];
 
-		return ucs2encode(output);
-	}
+						for (var i = 0; i<connectOptions.hosts.length; i++) {
+							if (typeof connectOptions.ports[i] !== "number" || connectOptions.ports[i] < 0)
+								throw new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.ports[i], "connectOptions.ports["+i+"]"]));
+							var host = connectOptions.hosts[i];
+							var port = connectOptions.ports[i];
 
-	/**
-	 * Converts a string of Unicode symbols (e.g. a domain name label) to a
-	 * Punycode string of ASCII-only symbols.
-	 * @memberOf punycode
-	 * @param {String} input The string of Unicode symbols.
-	 * @returns {String} The resulting Punycode string of ASCII-only symbols.
-	 */
-	function encode(input) {
-		var n,
-		    delta,
-		    handledCPCount,
-		    basicLength,
-		    bias,
-		    j,
-		    m,
-		    q,
-		    k,
-		    t,
-		    currentValue,
-		    output = [],
-		    /** `inputLength` will hold the number of code points in `input`. */
-		    inputLength,
-		    /** Cached calculation results */
-		    handledCPCountPlusOne,
-		    baseMinusT,
-		    qMinusT;
+							var ipv6 = (host.indexOf(":") !== -1);
+							uri = "ws://"+(ipv6?"["+host+"]":host)+":"+port+path;
+							connectOptions.uris.push(uri);
+						}
+					} else {
+						connectOptions.uris = connectOptions.hosts;
+					}
+				}
 
-		// Convert the input in UCS-2 to Unicode
-		input = ucs2decode(input);
+				client.connect(connectOptions);
+			};
 
-		// Cache the length
-		inputLength = input.length;
+			/**
+		 * Subscribe for messages, request receipt of a copy of messages sent to the destinations described by the filter.
+		 *
+		 * @name Paho.Client#subscribe
+		 * @function
+		 * @param {string} filter describing the destinations to receive messages from.
+		 * <br>
+		 * @param {object} subscribeOptions - used to control the subscription
+		 *
+		 * @param {number} subscribeOptions.qos - the maximum qos of any publications sent
+		 *                                  as a result of making this subscription.
+		 * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback
+		 *                                  or onFailure callback.
+		 * @param {function} subscribeOptions.onSuccess - called when the subscribe acknowledgement
+		 *                                  has been received from the server.
+		 *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:
+		 *                                  <ol>
+		 *                                  <li>invocationContext if set in the subscribeOptions.
+		 *                                  </ol>
+		 * @param {function} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.
+		 *                                  A single response object parameter is passed to the onFailure callback containing the following fields:
+		 *                                  <ol>
+		 *                                  <li>invocationContext - if set in the subscribeOptions.
+		 *                                  <li>errorCode - a number indicating the nature of the error.
+		 *                                  <li>errorMessage - text describing the error.
+		 *                                  </ol>
+		 * @param {number} subscribeOptions.timeout - which, if present, determines the number of
+		 *                                  seconds after which the onFailure calback is called.
+		 *                                  The presence of a timeout does not prevent the onSuccess
+		 *                                  callback from being called when the subscribe completes.
+		 * @throws {InvalidState} if the client is not in connected state.
+		 */
+			this.subscribe = function (filter, subscribeOptions) {
+				if (typeof filter !== "string" && filter.constructor !== Array)
+					throw new Error("Invalid argument:"+filter);
+				subscribeOptions = subscribeOptions || {} ;
+				validate(subscribeOptions,  {qos:"number",
+					invocationContext:"object",
+					onSuccess:"function",
+					onFailure:"function",
+					timeout:"number"
+				});
+				if (subscribeOptions.timeout && !subscribeOptions.onFailure)
+					throw new Error("subscribeOptions.timeout specified with no onFailure callback.");
+				if (typeof subscribeOptions.qos !== "undefined" && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))
+					throw new Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, "subscribeOptions.qos"]));
+				client.subscribe(filter, subscribeOptions);
+			};
 
-		// Initialize the state
-		n = initialN;
-		delta = 0;
-		bias = initialBias;
+		/**
+		 * Unsubscribe for messages, stop receiving messages sent to destinations described by the filter.
+		 *
+		 * @name Paho.Client#unsubscribe
+		 * @function
+		 * @param {string} filter - describing the destinations to receive messages from.
+		 * @param {object} unsubscribeOptions - used to control the subscription
+		 * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback
+											  or onFailure callback.
+		 * @param {function} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received from the server.
+		 *                                    A single response object parameter is passed to the
+		 *                                    onSuccess callback containing the following fields:
+		 *                                    <ol>
+		 *                                    <li>invocationContext - if set in the unsubscribeOptions.
+		 *                                    </ol>
+		 * @param {function} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.
+		 *                                    A single response object parameter is passed to the onFailure callback containing the following fields:
+		 *                                    <ol>
+		 *                                    <li>invocationContext - if set in the unsubscribeOptions.
+		 *                                    <li>errorCode - a number indicating the nature of the error.
+		 *                                    <li>errorMessage - text describing the error.
+		 *                                    </ol>
+		 * @param {number} unsubscribeOptions.timeout - which, if present, determines the number of seconds
+		 *                                    after which the onFailure callback is called. The presence of
+		 *                                    a timeout does not prevent the onSuccess callback from being
+		 *                                    called when the unsubscribe completes
+		 * @throws {InvalidState} if the client is not in connected state.
+		 */
+			this.unsubscribe = function (filter, unsubscribeOptions) {
+				if (typeof filter !== "string" && filter.constructor !== Array)
+					throw new Error("Invalid argument:"+filter);
+				unsubscribeOptions = unsubscribeOptions || {} ;
+				validate(unsubscribeOptions,  {invocationContext:"object",
+					onSuccess:"function",
+					onFailure:"function",
+					timeout:"number"
+				});
+				if (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)
+					throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");
+				client.unsubscribe(filter, unsubscribeOptions);
+			};
 
-		// Handle the basic code points
-		for (j = 0; j < inputLength; ++j) {
-			currentValue = input[j];
-			if (currentValue < 0x80) {
-				output.push(stringFromCharCode(currentValue));
-			}
-		}
+			/**
+		 * Send a message to the consumers of the destination in the Message.
+		 *
+		 * @name Paho.Client#send
+		 * @function
+		 * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the destination to which the message is to be sent.
+		 * 					   - If it is the only parameter, used as Paho.Message object.
+		 * @param {String|ArrayBuffer} payload - The message data to be sent.
+		 * @param {number} qos The Quality of Service used to deliver the message.
+		 * 		<dl>
+		 * 			<dt>0 Best effort (default).
+		 *     			<dt>1 At least once.
+		 *     			<dt>2 Exactly once.
+		 * 		</dl>
+		 * @param {Boolean} retained If true, the message is to be retained by the server and delivered
+		 *                     to both current and future subscriptions.
+		 *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.
+		 *                     A received message has the retained boolean set to true if the message was published
+		 *                     with the retained boolean set to true
+		 *                     and the subscrption was made after the message has been published.
+		 * @throws {InvalidState} if the client is not connected.
+		 */
+			this.send = function (topic,payload,qos,retained) {
+				var message ;
 
-		handledCPCount = basicLength = output.length;
+				if(arguments.length === 0){
+					throw new Error("Invalid argument."+"length");
 
-		// `handledCPCount` is the number of code points that have been handled;
-		// `basicLength` is the number of basic code points.
+				}else if(arguments.length == 1) {
 
-		// Finish the basic string - if it is not empty - with a delimiter
-		if (basicLength) {
-			output.push(delimiter);
-		}
+					if (!(topic instanceof Message) && (typeof topic !== "string"))
+						throw new Error("Invalid argument:"+ typeof topic);
 
-		// Main encoding loop:
-		while (handledCPCount < inputLength) {
+					message = topic;
+					if (typeof message.destinationName === "undefined")
+						throw new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,"Message.destinationName"]));
+					client.send(message);
 
-			// All non-basic code points < n have been handled already. Find the next
-			// larger one:
-			for (m = maxInt, j = 0; j < inputLength; ++j) {
-				currentValue = input[j];
-				if (currentValue >= n && currentValue < m) {
-					m = currentValue;
+				}else {
+				//parameter checking in Message object
+					message = new Message(payload);
+					message.destinationName = topic;
+					if(arguments.length >= 3)
+						message.qos = qos;
+					if(arguments.length >= 4)
+						message.retained = retained;
+					client.send(message);
 				}
-			}
+			};
 
-			// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,
-			// but guard against overflow
-			handledCPCountPlusOne = handledCPCount + 1;
-			if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {
-				error('overflow');
-			}
+			/**
+		 * Publish a message to the consumers of the destination in the Message.
+		 * Synonym for Paho.Mqtt.Client#send
+		 *
+		 * @name Paho.Client#publish
+		 * @function
+		 * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the topic to which the message is to be published.
+		 * 					   - If it is the only parameter, used as Paho.Message object.
+		 * @param {String|ArrayBuffer} payload - The message data to be published.
+		 * @param {number} qos The Quality of Service used to deliver the message.
+		 * 		<dl>
+		 * 			<dt>0 Best effort (default).
+		 *     			<dt>1 At least once.
+		 *     			<dt>2 Exactly once.
+		 * 		</dl>
+		 * @param {Boolean} retained If true, the message is to be retained by the server and delivered
+		 *                     to both current and future subscriptions.
+		 *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.
+		 *                     A received message has the retained boolean set to true if the message was published
+		 *                     with the retained boolean set to true
+		 *                     and the subscrption was made after the message has been published.
+		 * @throws {InvalidState} if the client is not connected.
+		 */
+			this.publish = function(topic,payload,qos,retained) {
+				var message ;
 
-			delta += (m - n) * handledCPCountPlusOne;
-			n = m;
+				if(arguments.length === 0){
+					throw new Error("Invalid argument."+"length");
 
-			for (j = 0; j < inputLength; ++j) {
-				currentValue = input[j];
+				}else if(arguments.length == 1) {
 
-				if (currentValue < n && ++delta > maxInt) {
-					error('overflow');
-				}
+					if (!(topic instanceof Message) && (typeof topic !== "string"))
+						throw new Error("Invalid argument:"+ typeof topic);
 
-				if (currentValue == n) {
-					// Represent delta as a generalized variable-length integer
-					for (q = delta, k = base; /* no condition */; k += base) {
-						t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);
-						if (q < t) {
-							break;
-						}
-						qMinusT = q - t;
-						baseMinusT = base - t;
-						output.push(
-							stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))
-						);
-						q = floor(qMinusT / baseMinusT);
-					}
+					message = topic;
+					if (typeof message.destinationName === "undefined")
+						throw new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,"Message.destinationName"]));
+					client.send(message);
 
-					output.push(stringFromCharCode(digitToBasic(q, 0)));
-					bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
-					delta = 0;
-					++handledCPCount;
+				}else {
+					//parameter checking in Message object
+					message = new Message(payload);
+					message.destinationName = topic;
+					if(arguments.length >= 3)
+						message.qos = qos;
+					if(arguments.length >= 4)
+						message.retained = retained;
+					client.send(message);
 				}
-			}
+			};
+
+			/**
+		 * Normal disconnect of this Messaging client from its server.
+		 *
+		 * @name Paho.Client#disconnect
+		 * @function
+		 * @throws {InvalidState} if the client is already disconnected.
+		 */
+			this.disconnect = function () {
+				client.disconnect();
+			};
+
+			/**
+		 * Get the contents of the trace log.
+		 *
+		 * @name Paho.Client#getTraceLog
+		 * @function
+		 * @return {Object[]} tracebuffer containing the time ordered trace records.
+		 */
+			this.getTraceLog = function () {
+				return client.getTraceLog();
+			};
 
-			++delta;
-			++n;
+			/**
+		 * Start tracing.
+		 *
+		 * @name Paho.Client#startTrace
+		 * @function
+		 */
+			this.startTrace = function () {
+				client.startTrace();
+			};
 
-		}
-		return output.join('');
-	}
+			/**
+		 * Stop tracing.
+		 *
+		 * @name Paho.Client#stopTrace
+		 * @function
+		 */
+			this.stopTrace = function () {
+				client.stopTrace();
+			};
 
-	/**
-	 * Converts a Punycode string representing a domain name or an email address
-	 * to Unicode. Only the Punycoded parts of the input will be converted, i.e.
-	 * it doesn't matter if you call it on a string that has already been
-	 * converted to Unicode.
-	 * @memberOf punycode
-	 * @param {String} input The Punycoded domain name or email address to
-	 * convert to Unicode.
-	 * @returns {String} The Unicode representation of the given Punycode
-	 * string.
-	 */
-	function toUnicode(input) {
-		return mapDomain(input, function(string) {
-			return regexPunycode.test(string)
-				? decode(string.slice(4).toLowerCase())
-				: string;
-		});
-	}
+			this.isConnected = function() {
+				return client.connected;
+			};
+		};
 
-	/**
-	 * Converts a Unicode string representing a domain name or an email address to
-	 * Punycode. Only the non-ASCII parts of the domain name will be converted,
-	 * i.e. it doesn't matter if you call it with a domain that's already in
-	 * ASCII.
-	 * @memberOf punycode
-	 * @param {String} input The domain name or email address to convert, as a
-	 * Unicode string.
-	 * @returns {String} The Punycode representation of the given domain name or
-	 * email address.
+		/**
+	 * An application message, sent or received.
+	 * <p>
+	 * All attributes may be null, which implies the default values.
+	 *
+	 * @name Paho.Message
+	 * @constructor
+	 * @param {String|ArrayBuffer} payload The message data to be sent.
+	 * <p>
+	 * @property {string} payloadString <i>read only</i> The payload as a string if the payload consists of valid UTF-8 characters.
+	 * @property {ArrayBuffer} payloadBytes <i>read only</i> The payload as an ArrayBuffer.
+	 * <p>
+	 * @property {string} destinationName <b>mandatory</b> The name of the destination to which the message is to be sent
+	 *                    (for messages about to be sent) or the name of the destination from which the message has been received.
+	 *                    (for messages received by the onMessage function).
+	 * <p>
+	 * @property {number} qos The Quality of Service used to deliver the message.
+	 * <dl>
+	 *     <dt>0 Best effort (default).
+	 *     <dt>1 At least once.
+	 *     <dt>2 Exactly once.
+	 * </dl>
+	 * <p>
+	 * @property {Boolean} retained If true, the message is to be retained by the server and delivered
+	 *                     to both current and future subscriptions.
+	 *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.
+	 *                     A received message has the retained boolean set to true if the message was published
+	 *                     with the retained boolean set to true
+	 *                     and the subscrption was made after the message has been published.
+	 * <p>
+	 * @property {Boolean} duplicate <i>read only</i> If true, this message might be a duplicate of one which has already been received.
+	 *                     This is only set on messages received from the server.
+	 *
 	 */
-	function toASCII(input) {
-		return mapDomain(input, function(string) {
-			return regexNonASCII.test(string)
-				? 'xn--' + encode(string)
-				: string;
-		});
-	}
+		var Message = function (newPayload) {
+			var payload;
+			if (   typeof newPayload === "string" ||
+		newPayload instanceof ArrayBuffer ||
+		(ArrayBuffer.isView(newPayload) && !(newPayload instanceof DataView))
+			) {
+				payload = newPayload;
+			} else {
+				throw (format(ERROR.INVALID_ARGUMENT, [newPayload, "newPayload"]));
+			}
 
-	/*--------------------------------------------------------------------------*/
+			var destinationName;
+			var qos = 0;
+			var retained = false;
+			var duplicate = false;
 
-	/** Define the public API */
-	punycode = {
-		/**
-		 * A string representing the current Punycode.js version number.
-		 * @memberOf punycode
-		 * @type String
-		 */
-		'version': '1.4.1',
-		/**
-		 * An object of methods to convert from JavaScript's internal character
-		 * representation (UCS-2) to Unicode code points, and back.
-		 * @see <https://mathiasbynens.be/notes/javascript-encoding>
-		 * @memberOf punycode
-		 * @type Object
-		 */
-		'ucs2': {
-			'decode': ucs2decode,
-			'encode': ucs2encode
-		},
-		'decode': decode,
-		'encode': encode,
-		'toASCII': toASCII,
-		'toUnicode': toUnicode
-	};
+			Object.defineProperties(this,{
+				"payloadString":{
+					enumerable : true,
+					get : function () {
+						if (typeof payload === "string")
+							return payload;
+						else
+							return parseUTF8(payload, 0, payload.length);
+					}
+				},
+				"payloadBytes":{
+					enumerable: true,
+					get: function() {
+						if (typeof payload === "string") {
+							var buffer = new ArrayBuffer(UTF8Length(payload));
+							var byteStream = new Uint8Array(buffer);
+							stringToUTF8(payload, byteStream, 0);
 
-	/** Expose `punycode` */
-	// Some AMD build optimizers, like r.js, check for specific condition patterns
-	// like the following:
-	if (
-		true
-	) {
-		!(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {
-			return punycode;
-		}).call(exports, __webpack_require__, exports, module),
-				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
-	} else {}
+							return byteStream;
+						} else {
+							return payload;
+						}
+					}
+				},
+				"destinationName":{
+					enumerable: true,
+					get: function() { return destinationName; },
+					set: function(newDestinationName) {
+						if (typeof newDestinationName === "string")
+							destinationName = newDestinationName;
+						else
+							throw new Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, "newDestinationName"]));
+					}
+				},
+				"qos":{
+					enumerable: true,
+					get: function() { return qos; },
+					set: function(newQos) {
+						if (newQos === 0 || newQos === 1 || newQos === 2 )
+							qos = newQos;
+						else
+							throw new Error("Invalid argument:"+newQos);
+					}
+				},
+				"retained":{
+					enumerable: true,
+					get: function() { return retained; },
+					set: function(newRetained) {
+						if (typeof newRetained === "boolean")
+							retained = newRetained;
+						else
+							throw new Error(format(ERROR.INVALID_ARGUMENT, [newRetained, "newRetained"]));
+					}
+				},
+				"topic":{
+					enumerable: true,
+					get: function() { return destinationName; },
+					set: function(newTopic) {destinationName=newTopic;}
+				},
+				"duplicate":{
+					enumerable: true,
+					get: function() { return duplicate; },
+					set: function(newDuplicate) {duplicate=newDuplicate;}
+				}
+			});
+		};
 
-}(this));
+		// Module contents.
+		return {
+			Client: Client,
+			Message: Message
+		};
+	// eslint-disable-next-line no-nested-ternary
+	})(typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {});
+	return PahoMQTT;
+});
 
-/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/module.js */ "../../node_modules/webpack/buildin/module.js")(module), __webpack_require__(/*! ./../webpack/buildin/global.js */ "../../node_modules/webpack/buildin/global.js")))
+/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "../../node_modules/webpack/buildin/global.js")))
 
 /***/ }),
 
 /***/ "../../node_modules/querystring-es3/decode.js":
-/*!***************************************************************!*\
-  !*** /root/amplify-js/node_modules/querystring-es3/decode.js ***!
-  \***************************************************************/
+/*!********************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/querystring-es3/decode.js ***!
+  \********************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -5199,9 +5198,9 @@ var isArray = Array.isArray || function (xs) {
 /***/ }),
 
 /***/ "../../node_modules/querystring-es3/encode.js":
-/*!***************************************************************!*\
-  !*** /root/amplify-js/node_modules/querystring-es3/encode.js ***!
-  \***************************************************************/
+/*!********************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/querystring-es3/encode.js ***!
+  \********************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -5296,9 +5295,9 @@ var objectKeys = Object.keys || function (obj) {
 /***/ }),
 
 /***/ "../../node_modules/querystring-es3/index.js":
-/*!**************************************************************!*\
-  !*** /root/amplify-js/node_modules/querystring-es3/index.js ***!
-  \**************************************************************/
+/*!*******************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/querystring-es3/index.js ***!
+  \*******************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -5312,9 +5311,9 @@ exports.encode = exports.stringify = __webpack_require__(/*! ./encode */ "../../
 /***/ }),
 
 /***/ "../../node_modules/url/url.js":
-/*!************************************************!*\
-  !*** /root/amplify-js/node_modules/url/url.js ***!
-  \************************************************/
+/*!*****************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/url/url.js ***!
+  \*****************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -5342,7 +5341,7 @@ exports.encode = exports.stringify = __webpack_require__(/*! ./encode */ "../../
 
 
 
-var punycode = __webpack_require__(/*! punycode */ "../../node_modules/punycode/punycode.js");
+var punycode = __webpack_require__(/*! punycode */ "../../node_modules/node-libs-browser/node_modules/punycode/punycode.js");
 var util = __webpack_require__(/*! ./util */ "../../node_modules/url/util.js");
 
 exports.parse = urlParse;
@@ -6056,9 +6055,9 @@ Url.prototype.parseHost = function() {
 /***/ }),
 
 /***/ "../../node_modules/url/util.js":
-/*!*************************************************!*\
-  !*** /root/amplify-js/node_modules/url/util.js ***!
-  \*************************************************/
+/*!******************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/url/util.js ***!
+  \******************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -6084,9 +6083,9 @@ module.exports = {
 /***/ }),
 
 /***/ "../../node_modules/uuid/index.js":
-/*!***************************************************!*\
-  !*** /root/amplify-js/node_modules/uuid/index.js ***!
-  \***************************************************/
+/*!********************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/uuid/index.js ***!
+  \********************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -6103,9 +6102,9 @@ module.exports = uuid;
 /***/ }),
 
 /***/ "../../node_modules/uuid/lib/bytesToUuid.js":
-/*!*************************************************************!*\
-  !*** /root/amplify-js/node_modules/uuid/lib/bytesToUuid.js ***!
-  \*************************************************************/
+/*!******************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/uuid/lib/bytesToUuid.js ***!
+  \******************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports) {
 
@@ -6140,9 +6139,9 @@ module.exports = bytesToUuid;
 /***/ }),
 
 /***/ "../../node_modules/uuid/lib/rng-browser.js":
-/*!*************************************************************!*\
-  !*** /root/amplify-js/node_modules/uuid/lib/rng-browser.js ***!
-  \*************************************************************/
+/*!******************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/uuid/lib/rng-browser.js ***!
+  \******************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports) {
 
@@ -6185,9 +6184,9 @@ if (getRandomValues) {
 /***/ }),
 
 /***/ "../../node_modules/uuid/v1.js":
-/*!************************************************!*\
-  !*** /root/amplify-js/node_modules/uuid/v1.js ***!
-  \************************************************/
+/*!*****************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/uuid/v1.js ***!
+  \*****************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -6305,9 +6304,9 @@ module.exports = v1;
 /***/ }),
 
 /***/ "../../node_modules/uuid/v4.js":
-/*!************************************************!*\
-  !*** /root/amplify-js/node_modules/uuid/v4.js ***!
-  \************************************************/
+/*!*****************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/uuid/v4.js ***!
+  \*****************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -6409,16 +6408,16 @@ module.exports = function(module) {
 /***/ }),
 
 /***/ "../../node_modules/zen-observable-ts/lib/bundle.esm.js":
-/*!*************************************************************************!*\
-  !*** /root/amplify-js/node_modules/zen-observable-ts/lib/bundle.esm.js ***!
-  \*************************************************************************/
+/*!******************************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/zen-observable-ts/lib/bundle.esm.js ***!
+  \******************************************************************************************************************************************/
 /*! exports provided: default, Observable */
 /***/ (function(module, __webpack_exports__, __webpack_require__) {
 
 "use strict";
 __webpack_require__.r(__webpack_exports__);
 /* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
-/* harmony import */ var zen_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zen-observable */ "../../node_modules/zen-observable/index.js");
+/* harmony import */ var zen_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zen-observable */ "../../node_modules/zen-observable-ts/node_modules/zen-observable/index.js");
 /* harmony import */ var zen_observable__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(zen_observable__WEBPACK_IMPORTED_MODULE_0__);
 
 
@@ -6431,22 +6430,22 @@ var Observable = zen_observable__WEBPACK_IMPORTED_MODULE_0___default.a;
 
 /***/ }),
 
-/***/ "../../node_modules/zen-observable/index.js":
-/*!*************************************************************!*\
-  !*** /root/amplify-js/node_modules/zen-observable/index.js ***!
-  \*************************************************************/
+/***/ "../../node_modules/zen-observable-ts/node_modules/zen-observable/index.js":
+/*!*************************************************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/zen-observable-ts/node_modules/zen-observable/index.js ***!
+  \*************************************************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
-module.exports = __webpack_require__(/*! ./lib/Observable.js */ "../../node_modules/zen-observable/lib/Observable.js").Observable;
+module.exports = __webpack_require__(/*! ./lib/Observable.js */ "../../node_modules/zen-observable-ts/node_modules/zen-observable/lib/Observable.js").Observable;
 
 
 /***/ }),
 
-/***/ "../../node_modules/zen-observable/lib/Observable.js":
-/*!**********************************************************************!*\
-  !*** /root/amplify-js/node_modules/zen-observable/lib/Observable.js ***!
-  \**********************************************************************/
+/***/ "../../node_modules/zen-observable-ts/node_modules/zen-observable/lib/Observable.js":
+/*!**********************************************************************************************************************************************************************!*\
+  !*** /private/var/folders/xq/f88ydp_x56lg2qswdwk3wbq40000gn/T/amplify-release.ETThdED0/node_modules/zen-observable-ts/node_modules/zen-observable/lib/Observable.js ***!
+  \**********************************************************************************************************************************************************************/
 /*! no static exports found */
 /***/ (function(module, exports, __webpack_require__) {
 
@@ -7629,7 +7628,7 @@ __webpack_require__.r(__webpack_exports__);
 /* harmony import */ var url__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_2__);
 /* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid */ "../../node_modules/uuid/index.js");
 /* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_3__);
-/* harmony import */ var buffer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! buffer */ "../../node_modules/node-libs-browser/node_modules/buffer/index.js");
+/* harmony import */ var buffer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! buffer */ "../../node_modules/buffer/index.js");
 /* harmony import */ var buffer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(buffer__WEBPACK_IMPORTED_MODULE_4__);
 /* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aws-amplify/core */ "@aws-amplify/core");
 /* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_aws_amplify_core__WEBPACK_IMPORTED_MODULE_5__);
@@ -8036,6 +8035,11 @@ function (_super) {
           options: options,
           observer: observer,
           subscriptionId: subscriptionId_1
+        })["catch"](function (err) {
+          observer.error({
+            errors: [__assign({}, new graphql__WEBPACK_IMPORTED_MODULE_1__["GraphQLError"](_index__WEBPACK_IMPORTED_MODULE_9__["CONTROL_MSG"].REALTIME_SUBSCRIPTION_INIT_ERROR + ": " + err))]
+          });
+          observer.complete();
         });
 
         return function () {
@@ -8198,7 +8202,7 @@ function (_super) {
             });
             _f = err_2.message, message = _f === void 0 ? '' : _f;
             observer.error({
-              errors: [__assign({}, new graphql__WEBPACK_IMPORTED_MODULE_1__["GraphQLError"]("Connection failed: " + message))]
+              errors: [__assign({}, new graphql__WEBPACK_IMPORTED_MODULE_1__["GraphQLError"](_index__WEBPACK_IMPORTED_MODULE_9__["CONTROL_MSG"].CONNECTION_FAILED + ": " + message))]
             });
             observer.complete();
             subscriptionFailedCallback_1 = (this.subscriptionObserverMap.get(subscriptionId) || {}).subscriptionFailedCallback; // Notify concurrent unsubscription
@@ -8225,7 +8229,11 @@ function (_super) {
                 _this._timeoutStartSubscriptionAck.call(_this, subscriptionId);
               }, START_ACK_TIMEOUT)
             });
-            this.awsRealTimeSocket.send(stringToAWSRealTime);
+
+            if (this.awsRealTimeSocket) {
+              this.awsRealTimeSocket.send(stringToAWSRealTime);
+            }
+
             return [2
             /*return*/
             ];
@@ -8408,7 +8416,7 @@ function (_super) {
         subscriptionState: subscriptionState
       });
       observer.error({
-        errors: [__assign({}, new graphql__WEBPACK_IMPORTED_MODULE_1__["GraphQLError"]("Connection failed: " + JSON.stringify(payload)))]
+        errors: [__assign({}, new graphql__WEBPACK_IMPORTED_MODULE_1__["GraphQLError"](_index__WEBPACK_IMPORTED_MODULE_9__["CONTROL_MSG"].CONNECTION_FAILED + ": " + JSON.stringify(payload)))]
       });
       clearTimeout(startAckTimeoutId);
       observer.complete();
@@ -8424,7 +8432,7 @@ function (_super) {
     this.subscriptionObserverMap.forEach(function (_a) {
       var observer = _a.observer;
 
-      if (!observer.closed) {
+      if (observer && !observer.closed) {
         observer.error({
           errors: [__assign({}, new graphql__WEBPACK_IMPORTED_MODULE_1__["GraphQLError"](msg))]
         });
@@ -8559,7 +8567,9 @@ function (_super) {
 
               this.awsRealTimeSocket = null;
               this.socketStatus = SOCKET_STATUS.CLOSED;
-              throw err_3;
+              return [3
+              /*break*/
+              , 5];
 
             case 5:
               return [2
@@ -8670,6 +8680,12 @@ function (_super) {
                       _this._errorDisconnect(_index__WEBPACK_IMPORTED_MODULE_9__["CONTROL_MSG"].CONNECTION_CLOSED);
                     };
 
+                    _this.awsRealTimeSocket.onclose = function (event) {
+                      logger.debug("WebSocket closed " + event.reason);
+
+                      _this._errorDisconnect(_index__WEBPACK_IMPORTED_MODULE_9__["CONTROL_MSG"].CONNECTION_CLOSED);
+                    };
+
                     res('Cool, connected to AWS AppSyncRealTime');
                     return;
                   }
@@ -8817,7 +8833,7 @@ function (_super) {
   AWSAppSyncRealTimeProvider.prototype._awsRealTimeOPENIDHeader = function (_a) {
     var host = _a.host;
     return __awaiter(this, void 0, void 0, function () {
-      var federatedInfo;
+      var token, federatedInfo, currentUser;
       return __generator(this, function (_b) {
         switch (_b.label) {
           case 0:
@@ -8827,15 +8843,37 @@ function (_super) {
 
           case 1:
             federatedInfo = _b.sent();
+            if (!federatedInfo) return [3
+            /*break*/
+            , 2];
+            token = federatedInfo.token;
+            return [3
+            /*break*/
+            , 4];
+
+          case 2:
+            return [4
+            /*yield*/
+            , _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_7___default.a.currentAuthenticatedUser()];
+
+          case 3:
+            currentUser = _b.sent();
 
-            if (!federatedInfo || !federatedInfo.token) {
+            if (currentUser) {
+              token = currentUser.token;
+            }
+
+            _b.label = 4;
+
+          case 4:
+            if (!token) {
               throw new Error('No federated jwt');
             }
 
             return [2
             /*return*/
             , {
-              Authorization: federatedInfo.token,
+              Authorization: token,
               host: host
             }];
         }
@@ -10212,6 +10250,7 @@ var __generator = undefined && undefined.__generator || function (thisArg, body)
 
 
 
+var isNode = Object(_aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__["browserOrNode"])().isNode;
 var logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__["ConsoleLogger"]('PubSub');
 
 var PubSubClass =
@@ -10227,7 +10266,6 @@ function () {
     logger.debug('PubSub Options', this._options);
     this._pluggables = [];
     this.subscribe = this.subscribe.bind(this);
-    _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__["Amplify"].register(this);
   }
 
   Object.defineProperty(PubSubClass.prototype, "awsAppSyncProvider", {
@@ -10358,6 +10396,10 @@ function () {
   };
 
   PubSubClass.prototype.subscribe = function (topics, options) {
+    if (isNode && this._options && this._options.ssr) {
+      throw new Error('Subscriptions are not supported for Server-Side Rendering (SSR)');
+    }
+
     logger.debug('subscribe options', options);
     var providers = this.getProviders(options);
     return new zen_observable_ts__WEBPACK_IMPORTED_MODULE_0__["default"](function (observer) {
@@ -10399,6 +10441,7 @@ function () {
 
 
 var PubSub = new PubSubClass(null);
+_aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__["Amplify"].register(PubSub);
 
 /***/ }),
 
@@ -10446,8 +10489,10 @@ var CONTROL_MSG;
 
 (function (CONTROL_MSG) {
   CONTROL_MSG["CONNECTION_CLOSED"] = "Connection closed";
-  CONTROL_MSG["TIMEOUT_DISCONNECT"] = "Timeout disconnect";
+  CONTROL_MSG["CONNECTION_FAILED"] = "Connection failed";
+  CONTROL_MSG["REALTIME_SUBSCRIPTION_INIT_ERROR"] = "AppSync Realtime subscription init error";
   CONTROL_MSG["SUBSCRIPTION_ACK"] = "Subscription ack";
+  CONTROL_MSG["TIMEOUT_DISCONNECT"] = "Timeout disconnect";
 })(CONTROL_MSG || (CONTROL_MSG = {}));
 
 
diff --git a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js.map b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js.map
index ae4e343..9dd4958 100644
--- a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js.map
+++ b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.js.map
@@ -1 +1 @@
-{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/base64-js/index.js","webpack:///./node_modules/ieee754/index.js","webpack:///./node_modules/isarray/index.js","webpack:///./node_modules/node-libs-browser/node_modules/buffer/index.js","webpack:///./node_modules/paho-mqtt/paho-mqtt.js","webpack:///./node_modules/punycode/punycode.js","webpack:///./node_modules/querystring-es3/decode.js","webpack:///./node_modules/querystring-es3/encode.js","webpack:///./node_modules/querystring-es3/index.js","webpack:///./node_modules/url/url.js","webpack:///./node_modules/url/util.js","webpack:///./node_modules/uuid/index.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/v1.js","webpack:///./node_modules/uuid/v4.js","webpack:///(webpack)/buildin/global.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/zen-observable-ts/lib/bundle.esm.js","webpack:///./node_modules/zen-observable/index.js","webpack:///./node_modules/zen-observable/lib/Observable.js","webpack:///../../src/Providers/AWSAppSyncProvider.ts","webpack:///../../src/Providers/AWSAppSyncRealTimeProvider.ts","webpack:///../../src/Providers/AWSIotProvider.ts","webpack:///../../src/Providers/MqttOverWSProvider.ts","webpack:///../../src/Providers/PubSubProvider.ts","webpack:///../../src/Providers/index.ts","webpack:///../src/PubSub.ts","webpack:///../src/index.ts","webpack:///external \"@aws-amplify/auth\"","webpack:///external \"@aws-amplify/cache\"","webpack:///external \"@aws-amplify/core\"","webpack:///external \"graphql\""],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFY;;AAEZ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAkC,SAAS;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0CAA0C,UAAU;AACpD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,QAAQ,WAAW;;AAEnB;AACA;AACA,QAAQ,UAAU;;AAElB;AACA;;;;;;;;;;;;ACnFA,iBAAiB;;AAEjB;AACA;AACA;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEY;;AAEZ,aAAa,mBAAO,CAAC,wDAAW;AAChC,cAAc,mBAAO,CAAC,oDAAS;AAC/B,cAAc,mBAAO,CAAC,oDAAS;;AAE/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,mDAAmD;AACxE;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAAgD,EAAE;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,wBAAwB,QAAQ;AAChC;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA,GAAG;AACH;AACA,eAAe,SAAS;AACxB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,YAAY;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,gBAAgB;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;AC5vDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,oBAAoB;;AAEpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI,IAAyD;AAC7D;AACA,EAAE,MAAM,EASN;AACF,CAAC;;;AAGD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,kCAAkC,kBAAkB,EAAE;AACtD,4BAA4B,kBAAkB,EAAE;AAChD,+BAA+B,kBAAkB,EAAE;AACnD;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,SAAS;AACrB,YAAY,OAAO;AACnB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,+BAA+B;AACvC,qBAAqB,8CAA8C;AACnE,uBAAuB,+CAA+C;AACtE,yBAAyB,iDAAiD;AAC1E,kBAAkB,0CAA0C;AAC5D,oBAAoB,yDAAyD,EAAE,gBAAgB,EAAE,EAAE;AACnG,wBAAwB,kDAAkD,EAAE,EAAE,EAAE,GAAG;AACnF,kBAAkB,uCAAuC,EAAE,GAAG;AAC9D,kBAAkB,yCAAyC;AAC3D,mBAAmB,6CAA6C,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG;AAC7E,iBAAiB,2BAA2B,EAAE,oCAAoC;AAClF,mBAAmB,yCAAyC,EAAE,GAAG;AACjE,kBAAkB,wCAAwC,EAAE,MAAM,EAAE,GAAG;AACvE,sBAAsB,4CAA4C,EAAE,MAAM,EAAE,GAAG;AAC/E,2BAA2B,kDAAkD;AAC7E,yBAAyB,6DAA6D,EAAE,QAAQ,EAAE,GAAG;AACrG,+BAA+B,qDAAqD,EAAE,GAAG;AACzF,uBAAuB,oDAAoD,EAAE,EAAE,EAAE,GAAG;AACpF,iBAAiB,wEAAwE,EAAE,GAAG;AAC9F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,MAAM;AAClB,YAAY,cAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,wBAAwB;AACzC,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB,oBAAoB,wBAAwB;AAC5C;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;;AAEA;AACA,kBAAkB;AAClB,oBAAoB,wBAAwB;AAC5C;AACA;AACA;AACA;;AAEA;AACA,kBAAkB;AAClB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,kCAAkC;AAClC,4BAA4B;AAC5B;AACA,2CAA2C;;AAE3C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iCAAiC;AACjC,kCAAkC;AAClC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2DAA2D;AAC3D,sCAAsC;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+BAA+B;AAC1D;;AAEA;AACA,kDAAkD,4BAA4B,2EAA2E;AACzJ;;AAEA;AACA,iDAAiD,4BAA4B,yGAAyG;AACtL;;AAEA;AACA;AACA,OAAO;AACP;AACA,mDAAmD;AACnD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,uCAAuC,8BAA8B,uDAAuD;AAC5H;AACA;AACA;AACA,OAAO;AACP;AACA,qDAAqD;AACrD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB;;AAExB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,qBAAqB;AACvC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mEAAmE,gCAAgC;AACnG,gDAAgD,OAAO;AACvD;AACA;AACA,iEAAiE,gDAAgD;AACjH;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC,wDAAwD;AAC7F;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gEAAgE,gDAAgD;AAChH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,gDAAgD;AACjH;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8DAA8D,gDAAgD;AAC9G;AACA;AACA;;AAEA;AACA;AACA;AACA,8DAA8D,gDAAgD;AAC9G;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,UAAU;AACtB,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,UAAU;AACtB,YAAY,UAAU;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA6B,sGAAsG;AACnI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN,qCAAqC,qGAAqG;AAC1I;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oCAAoC;AAC7D;;AAEA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mEAAmE,kBAAkB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kBAAkB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA,eAAe,SAAS;AACxB;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA,eAAe,OAAO;AACtB;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,sBAAsB,aAAa,EAAE;AACrC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,aAAa,EAAE;AACrC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,aAAa,EAAE;AACrC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,YAAY,EAAE;AACpC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,wBAAwB,EAAE;AAChD,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,2BAA2B,EAAE;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,sCAAsC,EAAE;AAC9D;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,sCAAsC,EAAE;AAC9D;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,gCAAgC,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,kCAAkC,EAAE;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,gCAAgC,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,6BAA6B,EAAE;AACrD;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,aAAa;AAC1B;AACA,aAAa,OAAO;AACpB;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA,yCAAyC;AACzC,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;;AAEpB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,+BAA+B;AACnD;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA,aAAa,OAAO;AACpB;AACA,aAAa,OAAO;AACpB;AACA,aAAa,OAAO;AACpB;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,iCAAiC;AACjC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA;AACA,iDAAiD;AACjD,mCAAmC;AACnC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,oBAAoB;AACjC;AACA,aAAa,mBAAmB;AAChC,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,oBAAoB;AACjC;AACA,aAAa,mBAAmB;AAChC,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,SAAS;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA,eAAe,OAAO;AACtB,eAAe,YAAY;AAC3B;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,wBAAwB,EAAE;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,YAAY,EAAE;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,iBAAiB,EAAE;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,wBAAwB,EAAE;AAChD,8BAA8B;AAC9B,KAAK;AACL;AACA;AACA,sBAAsB,kBAAkB,EAAE;AAC1C,kCAAkC;AAClC;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,2HAA2H;AAC7H;AACA,CAAC;;;;;;;;;;;;;AC11ED;AACA,CAAC;;AAED;AACA,mBAAmB,KAA0B;AAC7C;AACA,kBAAkB,KAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,MAAM;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,MAAM;AAClB,YAAY,SAAS;AACrB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA,KAAK;AACL,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,MAAM;AAClB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mCAAmC;AAClE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB;;AAExB,yCAAyC,qBAAqB;;AAE9D;AACA;AACA;AACA;AACA;AACA,kCAAkC,oBAAoB;;AAEtD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,0BAA0B,iBAAiB;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,cAAc,iBAAiB;AAC/B;;AAEA;AACA;AACA;;AAEA;AACA;AACA,8BAA8B,oBAAoB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE,IAEU;AACZ;AACA,EAAE,mCAAmB;AACrB;AACA,GAAG;AAAA,oGAAC;AACJ,EAAE,MAAM,EAaN;;AAEF,CAAC;;;;;;;;;;;;;;ACphBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,SAAS;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpFa;;AAEb,iCAAiC,mBAAO,CAAC,8DAAU;AACnD,qCAAqC,mBAAO,CAAC,8DAAU;;;;;;;;;;;;;ACHvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb,eAAe,mBAAO,CAAC,yDAAU;AACjC,WAAW,mBAAO,CAAC,8CAAQ;;AAE3B;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gBAAgB,KAAK;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA,2CAA2C,KAAK;AAChD,0CAA0C,KAAK;AAC/C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,kBAAkB,mBAAO,CAAC,gEAAa;;AAEvC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C,OAAO;AAClD;AACA;AACA;AACA;AACA,0CAA0C,OAAO;AACjD;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,0CAA0C,OAAO;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,mBAAmB;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B,QAAQ;AACtC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3tBa;;AAEb;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;ACfA,SAAS,mBAAO,CAAC,2CAAM;AACvB,SAAS,mBAAO,CAAC,2CAAM;;AAEvB;AACA;AACA;;AAEA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACzBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC;;AAEjC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB,QAAQ;AAC9B;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACjCA,UAAU,mBAAO,CAAC,6DAAW;AAC7B,kBAAkB,mBAAO,CAAC,qEAAmB;;AAE7C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC;AACnC;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AC5GA,UAAU,mBAAO,CAAC,6DAAW;AAC7B,kBAAkB,mBAAO,CAAC,qEAAmB;;AAE7C;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AC5BA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;;ACrBA;AAAA;AAAA;AAAA;AAA2C;;AAE3C,iBAAiB,qDAAa;;AAEf,yEAAU,EAAC;AACJ;AACtB;;;;;;;;;;;;ACNA,iBAAiB,mBAAO,CAAC,gFAAqB;;;;;;;;;;;;;ACAjC;;AAEb;AACA;AACA,CAAC;AACD;;AAEA,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE;;AAE3T,6DAA6D,sEAAsE,8DAA8D,oBAAoB;;AAErN;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,yCAAyC;;AAEzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iCAAiC;AACjC;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAuC;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,0EAA0E;AAC1E;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA,4EAA4E,aAAa;AACzF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8EAA8E,gEAAgE;AAC9I;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA;;AAEA,2BAA2B,cAAc;AACzC;AACA;AACA;;AAEA;AACA,WAAW;AACX,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,6EAA6E,eAAe;AAC5F;AACA;;AAEA;AACA;AACA;AACA;;AAEA,yBAAyB,kBAAkB;AAC3C;AACA;AACA;;AAEA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3lBA;AACA;AAEA;AAEA,IAAM,MAAM,GAAG,oEAAf,oBAAe,CAAf;;AAEA;AAAA;AAAA;AAAwC;;AAAxC;AAAA;;AAgDS,yBAAoC,IAApC,GAAoC,EAApC;AAEA,wBAAmC,IAAnC,GAAmC,EAAnC;;AAoIR;;AArLA,wBAAc,mBAAd,uBAAsB;SAAtB;AACC,YAAM,UAAN,eAAM,CAAN;AADqB;gBAAA;;AAAA,GAAtB;;AAIA;AACC;AADD;;AAIa,yCAAb,gCAAuE;;;AACtE,cAAM,UAAN,yBAAM,CAAN;;;AADY;;AAIL,0CAAR,oBAAiC;AAAjC;;AACC,QAAM,eAAe,GAAG,KAAK,CAAL,KAAW,kBAAX,OAAW,EAAX,SACf,cAAM;UAAL,kB;UAAG,S;;AAAO,cAAC,CAAD;AADI,WAElB,cAAI;UAAH,kB;UAAC,S;;AAAO;AAFf,KAAwB,CAAxB;AAIA,mBAAe,CAAf,QAAwB,aAAC;AAAI,kBAAI,CAAJ;AAA7B;AALO;;AAQA,kDAAR,iBAA8B;AAC7B;;AACA;AAFO;;AAKD,8CAAP,cAAoD;AAApD;;AAAsB;AAAA,QAAU,eAAV;AAAA,QAAqB,+BAArB,WAAqB,EAArB;;AACrB,QAAI,SAAS,KAAb,GAAqB;AACpB,UAAM,eAAe,GAAG,KAAK,CAAL,KAAW,kBAAX,OAAW,EAAX,SACf,cAAM;YAAL,kB;YAAG,S;;AAAO,gBAAC,CAAD;AADI,aAElB,cAAI;YAAH,kB;YAAC,S;;AAAO;AAFf,OAAwB,CAAxB;AAIA,qBAAe,CAAf,QAAwB,iBAAK;AAC5B,YAAI,KAAI,CAAJ,oBAAJ,KAAI,CAAJ,EAAqC;AACpC,eAAI,CAAJ,mCAAwC,eAAG;AAC1C,gBAAI,CAAC,GAAG,CAAR,QAAiB;AAChB,iBAAG,CAAH;AACA;AAHF;;AAMA,eAAI,CAAJ;AACA;AATF;;AAYA;AACA;AAnBK;;AA0BS,4CAAhB,oBAA2C;;;;;;AAC3B;AAAA;AAAA,cAAM,gCAAgC;AAAM;AAA5C,aAAM,CAAN;;;AAAT,kBAAM,GAAG,GAAT,IAAS,EAAT;AAEN;AAAA;AAAA,cAAM,uCAAN,QAAM,CAAN;;;AAAA;;AAEA;;;;;;;;AALe;;AAQhB,sEAAsD;AAAtD;;AAAqC;AAAA;AAAiB;;AACrD,QAAM,MAAM,GAAG,8DAAoB,oBAAQ;AAC1C,UAAM,YAAY,GAAI,UAAtB,MAAsB,CAAtB;AACA,YAAM,CAAN,iCAAwC,YAAY,CAAZ,KAAxC,GAAwC,CAAxC;;AAEA,OAAC;AAAA;;;;;;;;AACA;AACA,4BAAY,CAAZ,QAAqB,aAAC;AACrB,sBAAI,CAAC,KAAI,CAAJ,oBAAL,CAAK,CAAL,EAAkC;AACjC,yBAAI,CAAJ,uBAA4B,IAA5B,GAA4B,EAA5B;AACA;;AAED,uBAAI,CAAJ;AALD;AAQQ,qBAA2C,OAAO,CAAlD,gCAAe,wBAAf,IAAsB,gBAAgB,GAAK,OAAO,CAAlD;AAGF,0BAAU,GAAG,MAAM,CAAN,8BAEb,cAAwC;sBAAvC,kB;sBAAC,a;sBAAO,S;;AAAoC,0BAAC,CAAC,CAAF;AAF7C,iBAAa,CAAb,C,CAIN;;AACA,mCAAmB,QAAO,SACtB,KAAK,CAAL,KAAW,iBADW,OACX,EAAX,CADsB,EAA1B,UAA0B,CAAP,CAAnB;AAMM,mBAAG,GAGH,MAAM,CAAN,QACL,YAAY,CAAZ,OAAoB,qBAAU;AAC7B,sBAAM,sBAAsB,GAAG,eAAe,CAAf,KAC9B,aAAC;AAAI,4BAAC,CAAD,uBAAyB,CAAzB;AADN,mBAA+B,CAA/B;;AAIA,8CAA4B;AACnB;AAAA,wBAAkB,6BAAlB;;AAER,wBAAI,CAAC,GAAG,CAAR,QAAQ,CAAR,EAAoB;AACnB,yBAAG,CAAH,QAAG,CAAH,GAAgB;AACf,2BAAG,EADY;AAEf,8BAAM,EAAE;AAFO,uBAAhB;AAIA;;AAED,uBAAG,CAAH,QAAG,CAAH;AACA;;AAED;AAlBD,mBAJK,EAIL,CADK,CAHA,C,CA0BN;;AACA;AAAA;AAAA,kBAAM,OAAO,CAAP,IACL,GAAG,CAAH,IAAQ,cAAkC;sBAA3B,kB;sBAAC,gB;sBAAU,U;sBAAE,Y;sBAAK,kB;;;;;;;;;;AAE5B,gCAAM,GAAN;;;;;;AAEM;AAAA;AAAA,4BAAM,uBAAuB;AACrC,oCAAQ,EAD6B;AAErC,+BAAG;AAFkC,2BAAvB,CAAN;;;AAAT,gCAAM,GAAG,GAAT,IAAS,EAAT;;;;;;;AAKA,kCAAQ,CAAR,MAAe;AAAE,mCAAO,EAAT;AAAgC,iCAAK,EAAE;AAAvC,2BAAf;AACA,kCAAQ,CAAR;AACA;AAAA;AAAA;;;AAGD;AACA;AACA,gCAAM,CAAN,QAAe,iBAAK;AACnB,gCAAI,MAAM,CAAV,WAAI,EAAJ,EAA0B;AACzB,oCAAM,CAAN;;AAEA,mCAAI,CAAJ;AACA;AALF;AAQA;AAAA;AAAA;;;;AAzBF,iBACC,CADK,CAAN;;;AADA;AACA;;;;;;;AAnDA;AAAD;;AAiFA,aAAO;AACN,cAAM,CAAN,qCAA4C,YAAY,CAAZ,KAA5C,GAA4C,CAA5C;AAEA,oBAAY,CAAZ,QAAqB,aAAC;AACrB,cAAM,MAAM,GAAG,KAAI,CAAJ,iBAAf,CAAe,CAAf;;AAEA,cAAI,MAAM,IAAI,MAAM,CAApB,WAAc,EAAd,EAAoC;AACnC,kBAAM,CAAN;;AACA,iBAAI,CAAJ;;AAEA,gBACC,CAAC,KAAK,CAAL,KAAW,KAAI,CAAJ,aAAX,MAAW,EAAX,OAA4C,aAAC;AAAI,sBAAC,KAAD;AADnD,aACE,CADF,EAEE;AACD,mBAAI,CAAJ,WAAgB,MAAM,CAAtB;AACA;AACD;;AAED,eAAI,CAAJ;AAdD;AAHD;AArFD,KAAe,CAAf;AA2GA,WAAO,yDAAU,CAAV,iBAA4B,iBAAK;AACvC,UAAM,KAAK,GAAG,KAAI,CAAJ,iBAAd,KAAc,CAAd;;AACA,UAAM,KAAK,GAAG,KAAI,CAAJ,gBAAd,KAAc,CAAd;;AAEA,WAAK,CAAL,OAAa,MAAM,CAAN,QAAe,KAAK,CAApB,aACZ,mBAAoB;YAAd,kB;YAAC,e;YAAS,W;;AAAS,eACvB,GAAG,CAAE,KAAK,IAAV,OAAG,CAAH,GAAD,GAAC,EADuB;AADb,SAAb,EAAa,CAAb;AAOA;AAXD,KAAO,CAAP;AA5GD;;AA0HD;AAtLA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpBA;;;;;;;;;;;;;;AAYA;AACA;AACA;AACA;AACA;AAEA;AAUA;AACA;AACA;AACA;AAEA,IAAM,MAAM,GAAG,6DAAf,4BAAe,CAAf;AAEA,IAAM,cAAc,GAAI,iCACxB,OAAO,MAAM,CAAb,KAAa,CAAb,KADwB,aAErB,MAAM,CAAN,KAAM,CAAN,CAFqB,iBAErB,CAFqB,GAAxB;;AAKA,IAAM,gBAAgB,GAAG,SAAnB,gBAAmB,uBAA0C;AAClE,uDAAG,CAAH,gBAAoB;AAAE,SAAK,EAAP;AAAS,QAAI,EAAb;AAAe,WAAO;AAAtB,GAApB;AADD;;AAIA,IAAM,YAAY,GAAlB;AAEA,IAAM,mBAAmB,GAAG,WAA5B,GAA4B,CAA5B;AAYA;;AAAA,0BAAkB;AACjB;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AACA;;;;;AAIA;AAlDD,GAAK,aAAa,KAAb,aAAa,GAAlB,EAAkB,CAAlB;;AAqDA;;AAAA,gCAAwB;AACvB;AACA;AACA;AAHD,GAAK,mBAAmB,KAAnB,mBAAmB,GAAxB,EAAwB,CAAxB;;AAMA;;AAAA,0BAAkB;AACjB;AACA;AACA;AAHD,GAAK,aAAa,KAAb,aAAa,GAAlB,EAAkB,CAAlB;;AAMA,IAAM,4BAA4B,GAAG;AACpC,QAAM,EAD8B;AAEpC,sBAFoC;AAGpC,kBAAgB;AAHoB,CAArC;AAMA;;;;AAGA,IAAM,uBAAuB,GAA7B;AAEA;;;;AAGA,IAAM,iBAAiB,GAAvB;AAEA;;;;AAGA,IAAM,0BAA0B,GAAG,SAAnC;;AAEA;AAAA;AAAA;AAAgD;;AAAhD;AAAA;;AAES,yBAA8B,aAAa,CAA3C;AAEA;AACA,oCAAsD,IAAtD,GAAsD,EAAtD;AACA;;AA2rBR;;AAzrBA;AACC;AADD;;AAIA;AACC,UAAM,UAAN,eAAM,CAAN;AADD;;AAIa,iDAAb,mCAA0E;;;AACzE,cAAM,UAAN,yBAAM,CAAN;;;AADY;;AAIb,+EAE2B;AAF3B;;AAIS;AAER,WAAO,8DAAe,oBAAQ;AAC7B,UAAI,CAAJ,wBAA6B;AAC5B,gBAAQ,CAAR,MAAe;AACd,gBAAM,EAAE,C,aAEH,yDAFG,mDAEH,C,CAFG;AADM,SAAf;AASA,gBAAQ,CAAR;AAVD,aAWO;AACN,YAAM,gBAAc,GAAG,+CAAvB;;AACA,aAAI,CAAJ,yCAA8C;AAC7C,iBAAO,EADsC;AAE7C,kBAAQ,EAFqC;AAG7C,wBAAc;AAH+B,SAA9C;;AAMA,eAAO;AAAA;;;;;8CAGL;;;AACA;AAAA;AAAA,oBAAM,uCAAN,gBAAM,CAAN;;;AADA;AACA;;AAEQ,mCAAiB,GACxB,2DADO;;AAGR,sBAAI,CAAJ,mBAAwB;AACvB;AACA;AAAA;AAAA;AACA;;AAED,sBAAI,iBAAiB,KAAK,mBAAmB,CAA7C,WAAyD;AACxD;AADD,yBAEO;AACN,0BAAM,UAAN,8BAAM,CAAN;AACA;;;;;;;;AAED,wBAAM,CAAN,MAAa,+BAAb;;;;;;AAEA;;;;;;;;;;;;AAtBK;AAAP;AAyBA;AA7CF,KAAO,CAAP;AAND;;AAuDA,wBAAc,2BAAd,2BAA0B;SAA1B;AACC,aAAO,CAAC,aAAR;AADyB;gBAAA;;AAAA,GAA1B;;AAIc,kFAAd,cAIC;QAHA,oB;QACA,sB;QACA,kC;;;;;;;;;;;AAGC,kCAAsB,GAQnB,OAAO,CARV,wBACA,kBAAkB,GAOf,OAAO,CARV,oBAEA,KAAK,GAMF,OAAO,CARV,OAGA,SAAS,GAKN,OAAO,CARV,WAIA,MAAM,GAIH,OAAO,CARV,QAKA,MAAM,GAGH,OAAO,CARV,QAMA,KAEG,OAAO,CARV,iBAMA,eAAe,mBAAG;AAAM;AAAT,gBANf,IAOA,KACG,OAAO,CARV,mBAOA,iBAAiB,wBAPjB;AAUK,6BAAiB,GAAwB,mBAAmB,CAA5D;AACA,gBAAI,GAAG;AACZ,mBAAK,EADO;AAEZ,uBAAS;AAFG,aAAP,C,CAIN;;AACA,6DAAiD;AAChD,sBAAQ,EADwC;AAEhD,mBAAK,EAF2C;AAGhD,uBAAS,EAHuC;AAIhD,+BAAiB,EAJ+B;AAKhD,+BAAiB,EAAE;AAL6B,aAAjD;AAUM,sBAAU,GAAG,IAAI,CAAJ,UAAb,IAAa,CAAb;;AAED;AAAA;AAAA,cAAM,iCAAiC;AAC1C,oBAAM,EADoC;AAE1C,oCAAsB,EAFoB;AAG1C,gCAAkB,EAHwB;AAI1C,qBAAO,EAJmC;AAK1C,0BAAY,EAL8B;AAM1C,oBAAM;AANoC,aAAjC,CAAN;;;mDAAD,CAAC,GAAD,IAAC,EAAD,C;AAQC;AAAA;AAAA,cAAM,eAAN;;;AATC,qBAAS,qFASV,GATU,IASV,EATU,2BAUM,mFACC,2DAAS,CADV,WAVf,EAAS,GAAT;AAcA,+BAAmB,GAAG;AAC3B,gBAAE,EADyB;AAE3B,qBAAO,EAAE;AACR,oBAAI,EADI;AAER,0BAAU,EAAE;AACX,+BAAa;AADF;AAFJ,eAFkB;AAU3B,kBAAI,EAAE,aAAa,CAAC;AAVO,aAAtB;AAaA,+BAAmB,GAAG,IAAI,CAAJ,UAAtB,mBAAsB,CAAtB;;;;;;AAGL;AAAA;AAAA,cAAM,oCAAoC;AACzC,oBAAM,EADmC;AAEzC,oCAAsB,EAFmB;AAGzC,gCAAkB,EAHuB;AAIzC,oBAAM;AAJmC,aAApC,CAAN;;;AAAA;;;;;;;;AAOA,kBAAM,CAAN,MAAa;AAAE,iBAAG;AAAL,aAAb;AACQ,iBAAiB,KAAG,CAApB,gBAAO,wBAAP;AACR,oBAAQ,CAAR,MAAe;AACd,oBAAM,EAAE,C,aAEH,yDAAiB,wBAFd,OAEH,C,CAFG;AADM,aAAf;AAOA,oBAAQ,CAAR;AAEQ,2CACP,yDADO,2B,CAGR;;AACA,gBAAI,wCAAJ,YAAsD;AACrD,0CAA0B;AAC1B;;AACD;AAAA;AAAA;;;AAOK,iBAGF,iCAHE,cAGF,CAHE,EACL,0BAA0B,MADrB,4BAEL,yBAAyB,MAFpB,0B,CAKN;;AACA,6DAAiD;AAChD,sBAAQ,EADwC;AAEhD,+BAAiB,EAF+B;AAGhD,uBAAS,EAHuC;AAIhD,mBAAK,EAJ2C;AAKhD,uCAAyB,EALuB;AAMhD,wCAA0B,EANsB;AAOhD,+BAAiB,EAAE,UAAU,CAAC;AAC7B,qBAAI,CAAJ;AAD4B;AAPmB,aAAjD;AAWA;;;;;;;AA/LF,GA+Ee,CA/Ef,CAkMC;;;AACc,2EAAd,0BAA8D;;;;;;;AACrD,yBAAiB,GAAK,iDAAtB,kB,CAGR;;AACA,YAAI,iBAAiB,KAAK,mBAAmB,CAA7C,SAAuD;AACtD;AAAA;AAAA,YAAO,YAAY,oBAAS;AACrB;AAAA,gBACL,cADK;AAAA,gBAEL,uBAFK;AAAA,gBAGL,eAHK;AAAA,gBAIL,WAJK;;AAMN,iBAAI,CAAJ,4CAAiD;AAChD,sBAAQ,EADwC;AAEhD,+BAAiB,EAF+B;AAGhD,uBAAS,EAHuC;AAIhD,mBAAK,EAJ2C;AAKhD,uCAAyB,EALuB;AAMhD,wCAA0B,EAAE;AANoB,aAAjD;AAPD,WAAO,CAAP;AAgBA;;;;;;;AAtBY;;AAyBN,oEAAR,0BAAiD;AAChD,QAAI;AACH,UACC,0BACA,sCAAsC,SAAS,CAD/C,QAEA,sBAAsB,aAAa,CAHpC,OAIE;AACD;AACA,YAAM,kBAAkB,GAAG;AAC1B,YAAE,EADwB;AAE1B,cAAI,EAAE,aAAa,CAAC;AAFM,SAA3B;AAIA,YAAM,mBAAmB,GAAG,IAAI,CAAJ,UAA5B,kBAA4B,CAA5B;AACA;AACA;AAbF,MAcE,YAAY;AACb;AACA,YAAM,CAAN,MAAa;AAAE,WAAG;AAAL,OAAb;AACA;AAlBM;;AAqBA,qEAAR,0BAAkD;AACjD,2CADiD,cACjD,EADiD,CAGjD;;AACA,cAAU,CAAC,iCAAD,IAAC,CAAD,EAAV,IAAU,CAAV;AAJO;;AAOA,gEAAR;AACC,QAAI,oCAAJ,GAA2C;AAC1C;AACA;AACA;;AAED,QAAI,CAAC,KAAL,mBAA6B;AAC5B,0BAAoB,aAAa,CAAjC;AACA;AACA;;AACD,QAAI,wCAAJ,GAA+C;AAC9C;AACA,gBAAU,CAAC,iCAAD,IAAC,CAAD,EAAV,IAAU,CAAV;AAFD,WAGO;AACN,YAAM,CAAN;AACA,kBAAY,CAAC,KAAb,kBAAY,CAAZ;AACA,UAAM,UAAU,GAAG,KAHb,iBAGN,CAHM,CAIN;;AACA,gBAAU,CAAV;AACA,gBAAU,CAAV;AACA,gBAAU,CAAV;AACA;AACA,0BAAoB,aAAa,CAAjC;AACA;AAvBM;;AA0BA,4EAAR,mBAAgE;AAC/D,UAAM,CAAN,MACC,qDAAmD,OAAO,CAD3D;;AAGM;AAAA,QAAE,QAAF;AAAA,QAAE,0BAAF;AAAA,QAAW,aAAX;AAAA,QAAoB,UAApB;;AACA;AAAA,QACL,QADK;AAAA,QACL,kCADK;AAAA,QAEL,QAFK;AAAA,QAEL,6BAFK;AAAA,QAGL,QAHK;AAAA,QAGL,iCAHK;AAAA,QAIL,uBAJK;AAAA,QAKL,+BALK;AAAA,QAML,gCANK;;AASN,UAAM,CAAN,MAAa;AAAE,QAAE,EAAJ;AAAM,cAAQ,EAAd;AAAgB,WAAK,EAArB;AAAuB,eAAS;AAAhC,KAAb;;AAEA,QAAI,IAAI,KAAK,aAAa,CAAtB,uBAA8C,OAAO,CAAzD,MAAgE;AAC/D,oBAAc;AACb,gBAAQ,CAAR;AADD,aAEO;AACN,cAAM,CAAN,MAAa,gCAAb;AACA;;AACD;AACA;;AAED,QAAI,IAAI,KAAK,aAAa,CAA1B,eAA0C;AACzC,YAAM,CAAN,MACC,4BAA0B,IAAI,CAAJ,UAAe;AAAE,aAAK,EAAP;AAAS,iBAAS;AAAlB,OAAf,CAD3B;;AAGA,UAAI,qCAAJ,YAAqD;AACpD,iCAAyB;AACzB;;AACD,kBAAY,CAAZ,iBAAY,CAAZ;AACA,sBAAgB,CACf,kDAAW,CADI,kBAEf;AAAE,aAAK,EAAP;AAAS,iBAAS;AAAlB,OAFe,EAAhB,yCAAgB,CAAhB;AAKA,UAAM,iBAAiB,GAAG,mBAAmB,CAA7C;AACA,2CAAqC;AACpC,gBAAQ,EAD4B;AAEpC,aAAK,EAF+B;AAGpC,iBAAS,EAH2B;AAIpC,yBAAiB,EAJmB;AAKpC,yBAAiB,EALmB;AAMpC,iCAAyB,EANW;AAOpC,kCAA0B;AAPU,OAArC,EAdyC,CAwBzC;;AACA;AACA;;AAED,QAAI,IAAI,KAAK,aAAa,CAA1B,2BAAsD;AACrD,kBAAY,CAAC,KAAb,kBAAY,CAAZ;AACA,gCAA0B,UAAU,CACnC,iCAAiC,kDAAW,CADT,kBACnC,CADmC,EAEnC,KAFD,gBAAoC,CAApC;AAIA;AACA;;AAED,QAAI,IAAI,KAAK,aAAa,CAA1B,WAAsC;AACrC,UAAM,iBAAiB,GAAG,mBAAmB,CAA7C;AACA,2CAAqC;AACpC,gBAAQ,EAD4B;AAEpC,aAAK,EAF+B;AAGpC,iBAAS,EAH2B;AAIpC,yBAAiB,EAJmB;AAKpC,iCAAyB,EALW;AAMpC,kCAA0B,EANU;AAOpC,yBAAiB;AAPmB,OAArC;AAUA,cAAQ,CAAR,MAAe;AACd,cAAM,EAAE,C,aAEH,yDACF,wBAAsB,IAAI,CAAJ,UAHjB,OAGiB,CADpB,C,CAFG;AADM,OAAf;AASA,kBAAY,CAAZ,iBAAY,CAAZ;AAEA,cAAQ,CAAR;;AACA,UAAI,sCAAJ,YAAsD;AACrD,kCAA0B;AAC1B;AACD;AAzFM;;AA4FA,0DAAR,eAAoC;AACnC,UAAM,CAAN,MAAa,uBAAb;AACA,yCAAqC,cAAa;UAAV,sB;;AACvC,UAAI,CAAC,QAAQ,CAAb,QAAsB;AACrB,gBAAQ,CAAR,MAAe;AACd,gBAAM,EAAE,cAAM,yDAAN,GAAM,CAAN;AADM,SAAf;AAGA;AALF;AAOA;;AACA,QAAI,KAAJ,mBAA4B;AAC3B;AACA;;AAED,wBAAoB,aAAa,CAAjC;AAdO;;AAiBA,sEAAR,0BAAmD;AAC5C;AAAA,QAAE,cAAF;AAAA,QAAY,WAAZ;AAAA,QAAmB,eAAnB;;AAEN,QAAI,CAAJ,UAAe;AACd;AACA;;AACD,qDAAiD;AAChD,cAAQ,EADwC;AAEhD,WAAK,EAF2C;AAGhD,eAAS,EAHuC;AAIhD,uBAAiB,EAAE,mBAAmB,CAAC;AAJS,KAAjD;;AAOA,QAAI,QAAQ,IAAI,CAAC,QAAQ,CAAzB,QAAkC;AACjC,cAAQ,CAAR,MAAe;AACd,cAAM,EAAE,C,aAEH,yDACF,0BAAwB,IAAI,CAAJ,UAAe;AAAE,eAAK,EAAP;AAAS,mBAAS;AAAlB,SAAf,CADtB,C,CAFG;AADM,OAAf,EADiC,CAUjC;;AACA,cAAQ,CAAR;AACA;;AACD,UAAM,CAAN,kCAEC,IAAI,CAAJ,UAAe;AAAE,WAAK,EAAP;AAAS,eAAS;AAAlB,KAAf,CAFD;AA1BO;;AAgCA,wEAAR,cAKC;AALD;;QACC,kD;QACA,0C;QACA,kB;QACA,kB;;AAEA,QAAI,sBAAsB,aAAa,CAAvC,OAA+C;AAC9C;AACA;;AACD,WAAO,YAAY,oBAAe;AAAA;;;;;;AACjC,qCAAuB;AAAE,mBAAG,EAAL;AAAO,mBAAG;AAAV,eAAvB;kBAEI,wBAAsB,aAAa,CAAnC,O,EAAA;AAAA;AAAA;;;;;;AAEF,kCAAoB,aAAa,CAAjC;AAEM,sBAAQ,GAAG,+BAAX;AACA,kCAAoB,GAAG,sBAAsB,CAAtB,+HAAvB,UAAuB,CAAvB;AAMA,2BAAa,GAAb;AACe;AACpB;AAAA;AAAA,gBAAM,iCAAiC;AACtC,kCAAkB,EADoB;AAEtC,uBAAO,EAF+B;AAGtC,4BAAY,EAH0B;AAItC,sBAAM,EAJgC;AAKtC,sCAAsB,EALgB;AAMtC,sBAAM;AANgC,eAAjC,CAAN;;;AADK,0BAAY,GAAG,cACpB,GADK,IACL,EADoB,EAAf;AAUA,sBAAQ,GAAG,6CAAM,CAAN,4BAAX,QAAW,CAAX;AAEA,uBAAS,GAAG,6CAAM,CAAN,6BAAZ,QAAY,CAAZ;AACA,4BAAc,GAAM,oBAAoB,GAApB,sCAApB;AAEN;AAAA;AAAA,gBAAM,mCAAmC;AAAE,8BAAc;AAAhB,eAAnC,CAAN;;;AAAA;;AAEA,wCAA0B,cAAQ;oBAAL,Y;AAC5B,sBAAM,CAAN;AACA,mBAAG;AAFJ;AAIA,kCAAoB,aAAa,CAAjC;AACA;;;;;;;AAEA,wCAA0B,cAAQ;oBAAL,Y;AAAU,0BAAG,CAAH,KAAG,CAAH;AAAvC;AACA;;AACA,kBACC,0BACA,sCAAsC,SAAS,CAFhD,MAGE;AACD;AACA;;AACD;AACA,kCAAoB,aAAa,CAAjC;AAEA;;;;;;;;AAlD+B;AAAlC,KAAO,CAAP;AATO;;AAiEM,uEAAd,cAA8D;QAAhB,kC;;;;;AAC7C,kBAAM,CAAN;AACA;AAAA;AAAA,cAAM,kFAAwB,CAC7B,+BAD6B,IAC7B,CAD6B,EAE7B,CAAC;AAAE,4BAAc;AAAhB,aAAD,CAF6B,EAA9B,YAA8B,CAA9B;;;AAAA;;;;;;;;AAFa;;AASA,8DAAd,cAAqD;QAAhB,kC;;;;;;;;;AACpC,kBAAM,CAAN,MAAa,4BAAb;;;;;;AAIC;AAAA;AAAA,cAAO;AACN,qBAAO,YAAY,oBAAS;AAC3B,oBAAM,SAAS,GAAG,8BAAlB,YAAkB,CAAlB;;AACA,yBAAS,CAAT,UAAoB;AACnB,wBAAM,CAAN;AADD;;AAGA,yBAAS,CAAT,UAAoB;AACnB,qBAAG,CAAC,UAAJ,4BAAI,CAAD,CAAH;AADD;;AAGA,yBAAS,CAAT,SAAmB;AAClB,uBAAI,CAAJ;AACA,yBAAO,GAAP;AAFD;AARD,eAAO,CAAP;AADD,aAAO,EAAP;;;AAAA,sB,CAgBA;;;AACA;AAAA;AAAA,cAAO;AACN,qBAAO,YAAY,oBAAS;AAC3B,oBAAI,KAAK,GAAT;;AACA,qBAAI,CAAJ,4BAAiC,iBAAK;AACrC,wBAAM,CAAN,MAAa,qBAAmB,IAAI,CAAJ,UAAhC,KAAgC,CAAhC;AADD;;AAGA,qBAAI,CAAJ,4BAAiC,iBAAK;AACrC,wBAAM,CAAN,MAAa,sBAAoB,KAAK,CAAtC;AACA,qBAAG,CAAC,UAAU,IAAI,CAAJ,UAAd,KAAc,CAAV,CAAD,CAAH;AAFD;;AAKA,qBAAI,CAAJ,8BAAmC,mBAAsB;AACxD,wBAAM,CAAN,MACC,oDAAkD,OAAO,CAAzD,OADD;AAGA,sBAAM,IAAI,GAAG,IAAI,CAAJ,MAAW,OAAO,CAA/B,IAAa,CAAb;AAEC;AAAA,sBACA,UADA;AAAA,sBAEC,+BAFD;AAAA,sBAEC,mEAFD;;AAKD,sBAAI,IAAI,KAAK,aAAa,CAA1B,oBAA+C;AAC9C,yBAAK,GAAL;AACA,yBAAI,CAAJ;AACA,yBAAI,CAAJ,8BAAmC,KAAI,CAAJ,wCAAnC,KAAmC,CAAnC;;AAGA,yBAAI,CAAJ,4BAAiC,eAAG;AACnC,4BAAM,CAAN;;AACA,2BAAI,CAAJ,iBAAsB,kDAAW,CAAjC;AAFD;;AAIA,uBAAG,CAAH,wCAAG,CAAH;AACA;AACA;;AAED,sBAAI,IAAI,KAAK,aAAa,CAA1B,sBAAiD;AAE/C;AAAA,wBACC,+BADD;AAAA,wBACC,qCADD,CACC,CADD;AAAA,wBACU,QADV,CACU,CADV;AAAA,wBACU,0BADV;AAAA,wBACY,QADZ;AAAA,wBACY,iCADZ;AAAA,wBAC4B,QAD5B;AAAA,wBAC4B,gCAD5B;;AAKD,uBAAG,CAAC;AAAE,+BAAS,EAAX;AAAa,+BAAS;AAAtB,qBAAD,CAAH;AACA;AAjCF;;AAoCA,oBAAM,OAAO,GAAG;AACf,sBAAI,EAAE,aAAa,CAAC;AADL,iBAAhB;;AAGA,qBAAI,CAAJ,uBAA4B,IAAI,CAAJ,UAA5B,OAA4B,CAA5B;;AAEA,sCAAmB;AAClB,sBAAI,CAAJ,OAAY;AACX,uBAAG,CACF,UACC,4FAFF,KACC,CADE,CAAH;AAKA;AACD;;AAED,0BAAU,CAAC,UAAU,CAAV,KAAD,KAAC,CAAD,EAAV,uBAAU,CAAV;AA7DD,eAAO,CAAP;AADD,aAAO,EAAP;;;AADA;AACA;;;;;;;;AAkEQ,qBAAS,GAAgB,KAAG,CAA5B,WAAW,SAAS,GAAK,KAAG,CAA5B;;AAER,gBAAI,mBAAmB,CAAnB,SAAJ,SAAI,CAAJ,EAA6C;AAC5C,oBAAM,wEAAN,SAAM,CAAN;AADD,mBAEO,eAAe;AACrB,oBAAM,UAAN,SAAM,CAAN;AADM,mBAEA;AACN;AACA;;;;;;;;;;;;;AAhGW;;AAoGA,qEAAd,cAOC;QANA,0C;QACA,oB;QACA,8B;QACA,kD;QACA,kB;QACA,kB;;;;;;AAEM,yBAAa,GAAG;AACrB,qBAAO,EAAE,mCADY,IACZ,CADY;AAErB,qBAAO,EAAE,gCAFY,IAEZ,CAFY;AAGrB,4BAAc,EAAE,mCAHK,IAGL,CAHK;AAIrB,uCAAyB,EAAE;AAJN,aAAhB;AAOA,mBAAO,GAAG,aAAa,CAAvB,kBAAuB,CAAvB;;AAEN,gBAAI,mBAAJ,YAAmC;AAClC,oBAAM,CAAN,MAAa,8CAAb;AACA;AAAA;AAAA;AACA;;AAEO,gBAAI,GAAK,kEAAT;AAEO;AAAA;AAAA,cAAM,OAAO,CAAC;AAC5B,qBAAO,EADqB;AAE5B,0BAAY,EAFgB;AAG5B,oCAAsB,EAHM;AAI5B,oBAAM,EAJsB;AAK5B,oBAAM,EALsB;AAM5B,kBAAI;AANwB,aAAD,CAAb;;;AAAT,kBAAM,GAAG,GAAT,IAAS,EAAT;AASN;AAAA;AAAA;;;;AAjCa;;AAoCA,+DAAd,cAA4C;QAAN,c;;;;;;AACrB;AAAA;AAAA,cAAM,wDAAI,CAAV,cAAM,EAAN;;;AAAV,mBAAO,GAAG,GAAV,IAAU,EAAV;AACN;AAAA;AAAA,cAAO;AACN,2BAAa,EAAE,OAAO,CAAP,iBADT,WACS,EADT;AAEN,kBAAI;AAFE,aAAP;;;;AAFa;;AAQA,kEAAd,cAA+C;QAAN,c;;;;;;AAClB;AAAA;AAAA,cAAM,yDAAK,CAAL,QAAN,eAAM,CAAN;;;AAAhB,yBAAa,GAAG,GAAhB,IAAgB,EAAhB;;AAEN,gBAAI,kBAAkB,CAAC,aAAa,CAApC,OAA4C;AAC3C,oBAAM,UAAN,kBAAM,CAAN;AACA;;AACD;AAAA;AAAA,cAAO;AACN,2BAAa,EAAE,aAAa,CADtB;AAEN,kBAAI;AAFE,aAAP;;;;AANa;;AAYA,kEAAd,cAAuD;QAAd,kB;QAAQ,c;;;;AAC1C,UAAE,GAAG,IAAL,IAAK,EAAL;AACA,aAAK,GAAG,EAAE,CAAF,wCAAR,EAAQ,CAAR;AAEN;AAAA;AAAA,UAAO;AACN,cAAI,EADE;AAEN,wBAFM;AAGN,uBAAa;AAHP,SAAP;;;AAJa;;AAWA,+DAAd,cAKC;QAJA,oB;QACA,8B;QACA,kD;QACA,kB;;;;;;AAEM,wBAAY,GAAG;AACpB,oBAAM,EADc;AAEpB,qBAAO,EAAE;AAFW,aAAf;AAKgB;AAAA;AAAA,cAAM,KAAN,kBAAM,EAAN;;;AAAhB,yBAAa,GAAG,GAAhB,IAAgB,EAAhB;;AACN,gBAAI,CAAJ,eAAoB;AACnB,oBAAM,UAAN,gBAAM,CAAN;AACA;;AACa;AAAA;AAAA,cAAM,6DAAW,CAAX,WAAuB,uBAAW;AAAI,qBAAC;AAC1D,0BAAU,EAAE,WAAW,CADmC;AAE1D,0BAAU,EAAE,WAAW,CAFmC;AAG1D,6BAAa,EAAE,WAAW,CAAC;AAH+B,eAAD;AAA5C,aAAM,CAAN;;;AAAR,iBAAK,GAAG,GAAR,IAAQ,EAAR;AAMA,mBAAO,GAAG;AACf,iBAAG,EAAE,8BADU;AAEf,kBAAI,EAFW;AAGf,oBAAM,EAHS;AAIf,qBAAO;AAJQ,aAAV;AAOA,yBAAa,GAAG,wDAAM,CAAN,qBAAhB,YAAgB,CAAhB;AACN;AAAA;AAAA,cAAO,aAAa,CAApB;;;;AA7Ba;AAgCd;;;;;AAGA;AACC,WAAO,6DAAW,CAAX,WACA,uBAAW;AAChB,UAAI,CAAJ,aAAkB;AAClB,UAAM,IAAI,GAAG,6DAAW,CAAX,MAAb,WAAa,CAAb;AACA,YAAM,CAAN;AAEA;AANK,gBAQC,eAAG;AACT,YAAM,CAAN;AACA;AAVF,KAAO,CAAP;AADD;;AAcD;AAjsBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChJA;;;;;;;;;;;;;;AAYA;AACA;AAEA,IAAM,YAAY,GAAlB;;AAEA;AAAA;AAAA;AAAoC;;AAApC;;AAgCC;;AA/BA,wBAAc,eAAd,qBAAoB;SAApB;AACC,aAAO,aAAP;AADmB;gBAAA;;AAAA,GAApB;;AAIO,6CAAP;AACC;AADM;;AAIP,wBAAc,eAAd,uBAAsB;SAAtB;AAAA;;AACC,aAAQ;AAAA;;;;;;AACD,wBAAQ,GAAG,aAAX;AAEA,2BAAW,GAAG;AACnB,yBAAO,EADY;AAEnB,wBAAM,EAAE,KAAK;AAFM,iBAAd;AAQF;AAAA;AAAA,kBAAM,6DAAW,CAAjB,GAAM,EAAN;;;AAJE,qBAIF,GAJE,IAIF,EAJE,EACQ,UAAU,MADlB,aAEY,UAAU,MAFtB,iBAGS,aAAa,MAHtB;AAMA,sBAAM,GAAG,wDAAM,CAAN,kBAEd;AAAE,4BAAU,EAAZ;AAAc,4BAAU,EAAxB;AAA0B,+BAAa;AAAvC,iBAFc,EAAT,WAAS,CAAT;AAMN;AAAA;AAAA;;;AAnBO;AAAR,OAAQ,EAAR;AADqB;gBAAA;;AAAA,GAAtB;AAuBD;AAhCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjBA;;;;;;;;;;;;;;AAYA;AACA;AACA;AAEA;AAEA;AAEA,IAAM,MAAM,GAAG,oEAAf,oBAAe,CAAf;AAEM,uCAAsD;AAC3D,MAAM,WAAW,GAAG,MAAM,CAAN,MAApB,GAAoB,CAApB;AACA,MAAM,MAAM,GAAG,WAAW,CAA1B;AACA,MAAM,UAAU,GAAG,KAAK,CAAL,MAAnB,GAAmB,CAAnB;;AAEA,OAAK,IAAI,CAAC,GAAV,GAAgB,CAAC,GAAjB,QAA4B,EAA5B,GAAiC;AAChC,QAAM,IAAI,GAAG,WAAW,CAAxB,CAAwB,CAAxB;AACA,QAAM,KAAK,GAAG,UAAU,CAAxB,CAAwB,CAAxB;AACA,QAAI,IAAI,KAAR,KAAkB,OAAO,UAAU,CAAV,UAAP;AAClB,QAAI,IAAI,KAAJ,OAAgB,IAAI,KAAxB,OAAoC;AACpC;;AACD,SAAO,MAAM,KAAK,UAAU,CAA5B;AACA;;AAOD;AAAA;AAAA;AAAA;AACS,oBAAsC,IAAtC,GAAsC,EAAtC;AAsBR;;AApBM,+BAAN,mCAAmE;;;;AAC9D,eAAO,GAAG,kBAAV,QAAU,CAAV;;AACJ,qBAAa;AACZ;AAAA;AAAA;AACA;;AAED,eAAO,GAAG,aAAa,CAAvB,QAAuB,CAAvB;AAEA;AAEA;AAAA;AAAA;;;AAVK;;AAaN,wBAAI,aAAJ,yBAAc;SAAd;AACC,aAAO,KAAK,CAAL,KAAW,cAAlB,IAAkB,EAAX,CAAP;AADa;gBAAA;;AAAA,GAAd;;AAIA,sDAAe;AACd;AADD;;AAGD;AAvBA;;AAyBA,IAAM,WAAW,GAAG,gCAAgC,MAAM,CAAtC,OAAsC,CAAtC,GAApB;;AAEA;AAAA;AAAA;AAAwC;;AAGvC,uCAA8C;AAAlC;AAAA;AAAkC;;AAA9C,gBACC,kDAAkB;AAAE,cAAQ,EAAE,OAAO,CAAP,YAAoB,+CAAI;AAApC,KAAlB,MADD;;AAFQ,0BAAgB,IAAhB,YAAgB,EAAhB;AA0HE,4BAGN,IAHM,GAGN,EAHM;AAKA,+BAGN,IAHM,GAGN,EAHM;;AA3HT;;AAED,wBAAc,mBAAd,uBAAsB;SAAtB;AACC,aAAO,aAAP;AADqB;gBAAA;;AAAA,GAAtB;AAIA,wBAAc,mBAAd,uBAAsB;SAAtB;AACC,aAAO,aAAP;AADqB;gBAAA;;AAAA,GAAtB;AAIA,wBAAc,mBAAd,2BAA0B;SAA1B;AACC,aAAO,KAAP;AADyB;gBAAA;;AAAA,GAA1B;AAIA,wBAAc,mBAAd,2BAA0B;SAA1B;AACC,aAAO,CAAC,aAAR;AADyB;gBAAA;;AAAA,GAA1B;;AAKU,kDAAV,iBAAgC;AAC/B,WAAO,+BAA6B,KAAK,CAAzC,WAAyC,CAAzC;AADS;;AAIV;AACC;AADD;;AAIO,8CAAP,cAAoD;AAApD;;AAAsB;AAAA,QAAU,eAAV;AAAA,QAAqB,+BAArB,WAAqB,EAArB;;AACrB,QAAI,SAAS,KAAb,GAAqB;AACpB,YAAM,CAAN,eAAsB,IAAI,CAAJ,UAAc;AAAG,iBAAS;AAAZ,SAAd,IAAc,CAAd,QAAtB,CAAsB,CAAtB;AAEA,UAAM,gBAAc,GAApB;;AACA,UAAM,iBAAiB,GAAG,4BAA1B,QAA0B,CAA1B;;AACA,UAAI,CAAJ,mBAAwB;AACvB;AACA;;AACD,uBAAiB,CAAjB,QAA0B,oBAAQ;AACjC,gBAAQ,CAAR,MAAe,+BADkB,SACjC,EADiC,CAEjC;;AACA,aAAI,CAAJ,wBAA6B,2CAAgC;AAC5D,0BAAgB,CAAhB,QAAgB,CAAhB;;AACA,cAAI,gBAAgB,CAAhB,SAAJ,GAAiC;AAChC,4BAAc,CAAd;AACA;AAJF;AAXmB,OAQpB,EARoB,CAmBpB;;AACA,wCApBoB,QAoBpB,EApBoB,CAsBpB;;;AACA,sBAAc,CAAd,QAAuB,iBAAK;AAC3B,aAAI,CAAJ;AADD;AAGA;AA3BK;;AA8BM,2CAAb,cAGuB;QAFtB,Y;QACA,sB;;;;;;;;;AAEA,kBAAM,CAAN;AAGM,kBAAM,GAAG,IAAI,gDAAJ,MAAT,QAAS,CAAT,C,CACN;;AACA,kBAAM,CAAN,mBAA0B,cAGzB;kBAFA,0B;kBACA,sB;;AAEA,mBAAI,CAAJ;AAJD;;AAMA,kBAAM,CAAN,mBAA0B,cAAuB;AAApB;AAAA,kBAAW,mBAAX,WAAW,EAAX;;AAC5B,mBAAI,CAAJ,aAAiB;AAAG,wBAAQ,EAAX;AAAa,yBAAS;AAAtB,iBAAjB,IAAiB,CAAjB;AADD;;AAIA;AAAA;AAAA,cAAM,YAAY,2BAAgB;AACjC,oBAAM,CAAN,QAAe;AACd,sBAAM,EAAE,KAAI,CADE;AAEd,2BAAW,EAFG;AAGd,yBAAS,EAAE;AAAM,gCAAO,CAAP,MAAO,CAAP;AAHH;AAId,yBAAS,EAAE;AAJG,eAAf;AADD,aAAM,CAAN;;;AAAA;;AASA;AAAA;AAAA;;;;AA5BY;;AA+BG,yCAAhB,6BAEmC;AAAlC;AAAA;AAAkC;;;;;;;;AAE3B;AAAA;AAAA,cAAM,gCAAgC,oBAAQ;AACpD,0BAAI,CAAJ,UAAc,gCAAa;AAAE,wBAAQ;AAAV,eAAb,CAAd;AADM,aAAM,CAAN;;;AAAP;AAAA;AAAA,cAAO,GAAP,IAAO,EAAP;;;;AAJe;;AASA,4CAAhB,oBAA2C;;;;;;AAC3B;AAAA;AAAA,cAAM,gCAAgC;AAAM;AAA5C,aAAM,CAAN;;;AAAT,kBAAM,GAAG,GAAT,IAAS,EAAT;;AAEN,gBAAI,MAAM,IAAI,MAAM,CAApB,WAAc,EAAd,EAAoC;AACnC,oBAAM,CAAN;AACA;;AACD;;;;;;;AANe;;AASV,yCAAN,uBAAiD;;;;;;AAC1C,wBAAY,GAAI,UAAhB,MAAgB,CAAhB;AACA,mBAAO,GAAG,IAAI,CAAJ,UAAV,GAAU,CAAV;AAEM;AAAA;AAAA,cAAM,KAAN;;;AAAN,eAAG,GAAG,GAAN,IAAM,EAAN;AAES;AAAA;AAAA,cAAM,aAAa,KAAb,UAA4B;AAAE,iBAAG;AAAL,aAA5B,CAAN;;;AAAT,kBAAM,GAAG,GAAT,IAAS,EAAT;AAEN,kBAAM,CAAN,gCAAuC,YAAY,CAAZ,KAAvC,GAAuC,CAAvC;AACA,wBAAY,CAAZ,QAAqB,iBAAK;AAAI,2BAAM,CAAN;AAA9B;;;;;;;AATK;;AAsBE,4CAAR,sBAA0C;AACzC,QAAI;AACH,UAAM,uBAAqB,GAA3B;;AACA,mCAA6B,2CAAgC;AAC5D,YAAI,cAAc,gBAAlB,KAAkB,CAAlB,EAA0C;AACzC,iCAAqB,CAArB;AACA;AAHF;;AAKA,UAAM,eAAa,GAAG,IAAI,CAAJ,MAAtB,GAAsB,CAAtB;;AAEA,UAAI,6BAAJ,UAAuC;AACtC,uBAAa,CAAb,WAAa,CAAb;AACA;;AAED,6BAAqB,CAArB,QAA8B,6BAAiB;AAC9C,yBAAiB,CAAjB,QAA0B,oBAAQ;AAAI,yBAAQ,CAAR;AAAtC;AADD;AAbD,MAgBE,cAAc;AACf,YAAM,CAAN;AACA;AAnBM;;AAsBR,sEAEmC;AAFnC;;AAEC;AAAA;AAAkC;;AAElC,QAAM,YAAY,GAAI,UAAtB,MAAsB,CAAtB;AACA,UAAM,CAAN,iCAAwC,YAAY,CAAZ,KAAxC,GAAwC,CAAxC;AAEA,WAAO,8DAAe,oBAAQ;AAC7B,kBAAY,CAAZ,QAAqB,iBAAK;AACzB;AACA,YAAI,iBAAiB,GAAG,KAAI,CAAJ,oBAAxB,KAAwB,CAAxB;;AAEA,YAAI,CAAJ,mBAAwB;AACvB,2BAAiB,GAAG,IAApB,GAAoB,EAApB;;AAEA,eAAI,CAAJ;AACA;;AAED,yBAAiB,CAAjB;AAX4B,OAC7B,EAD6B,CAc7B;;AACA;AACQ;AAAA,sDAhBqB,EAgBrB,CAhBqB,CAkB7B;;AACA,UAAI,oBAAoB,GAAG,KAAI,CAAJ,uBAA3B,QAA2B,CAA3B;;AACA,UAAI,CAAJ,sBAA2B;AAC1B,4BAAoB,GAAG,IAAvB,GAAuB,EAAvB;AACA;;AACD,0BAAoB,CAApB;;AACA,WAAI,CAAJ;;AAEA,OAAC;AAAA;;;;;;AACQ,qBAA8B,OAAO,CAArC;;;;AAAM;AAAA;AAAA,kBAAM,KAAN;;;AAAA;;;;;;;;;;AAAN,mBAAG,GAAH;;;;;;AAGE;AAAA;AAAA,kBAAM,uBAAuB;AAAE,qBAAG;AAAL,iBAAvB,CAAN;;;AAAT,sBAAM,GAAG,GAAT,IAAS,EAAT;AACA,4BAAY,CAAZ,QAAqB,iBAAK;AACzB,wBAAM,CAAN;AADD;;;;;;;AAIA,wBAAQ,CAAR;;;;;;;;;;;AATD;AAAD;;AAaA,aAAO;AACN,cAAM,CAAN,qCAA4C,YAAY,CAAZ,KAA5C,GAA4C,CAA5C;;AAEA,oBAAY;AACX,eAAI,CAAJ,2CADW,QACX,EADW,CAEX;;;AACA,cAAI,KAAI,CAAJ,0CAAJ,GAAsD;AACrD,iBAAI,CAAJ;;AACA,iBAAI,CAAJ;AACA;;AAED,sBAAY,CAAZ,QAAqB,iBAAK;AACzB,gBAAM,iBAAiB,GACtB,KAAI,CAAJ,8BACC,IAFF,GAEE,EAFF;AAIA,6BAAiB,CAAjB,QAAiB,CAAjB,CALyB,QAKzB,EALyB,CAOzB;;AACA,gBAAI,iBAAiB,CAAjB,SAAJ,GAAkC;AACjC,mBAAI,CAAJ;;AACA,kBAAI,MAAM,CAAV,WAAI,EAAJ,EAA0B;AACzB,sBAAM,CAAN;AACA;AACD;AAbF;AAeA;;AAED;AA5BD;AAvCD,KAAO,CAAP;AAPD;;AA8ED;AAzOA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtDA;AAEA,IAAM,MAAM,GAAG,oEAAf,wBAAe,CAAf;;AAEA;AAAA;AAAA;AAGC,2CAA0C;AAA9B;AAAA;AAA8B;;AACzC;AACA;;AAED,iEAAuC;AAA7B;AAAA;AAA6B;;AACtC,mBAAY,+BAAmB,KAA/B,OAAY,CAAZ;AAEA,UAAM,CAAN,MAAa,eAAa,KAA1B,eAA0B,EAA1B,EAAoD,KAApD;AAEA,WAAO,KAAP;AALD;;AAQA;AACC;AADD;;AAMA,wBAAc,uBAAd,sBAAqB;SAArB;AACC,0BAAY,KAAZ;AADoB;gBAAA;;AAAA,GAArB;AAgBD;AArCA;;;;;;;;;;;;;;AClBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;AAYA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfA;;;;;;;;;;;;AAYA;;;AACA;AAEA;AAOA;AAEA,IAAM,MAAM,GAAG,oEAAf,QAAe,CAAf;;AAEA;AAAA;AAAA;AAqCC;;;;;AAKA,gCAAkC;AACjC;AACA,UAAM,CAAN,wBAA+B,KAA/B;AACA;AACA,qBAAiB,oBAAjB,IAAiB,CAAjB;AACA,6DAAO,CAAP;AACA;;AA9BD,wBAAY,YAAZ,iCAA8B;AAH9B;;;SAGA;AACC,UAAI,CAAC,KAAL,qBAA+B;AAC9B,mCAA2B,kEAAuB,KAAlD,QAA2B,CAA3B;AACA;;AACD,aAAO,KAAP;AAJ6B;gBAAA;;AAAA,GAA9B;AAUA,wBAAY,YAAZ,yCAAsC;AAHtC;;;SAGA;AACC,UAAI,CAAC,KAAL,6BAAuC;AACtC,2CAAmC,0EAClC,KADD,QAAmC,CAAnC;AAGA;;AACD,aAAO,KAAP;AANqC;gBAAA;;AAAA,GAAtC;;AAsBO,wCAAP;AACC;AADM;AAIP;;;;;;;;AAMA,uDAAgC;AAAhC;;AACC,QAAM,GAAG,GAAG,OAAO,GAAG,OAAO,CAAP,UAAH,UAAnB;AACA,UAAM,CAAN,0BAAiC;AAAE,SAAG;AAAL,KAAjC;AAEA,oBAAgB,MAAM,CAAN,WAAkB,KAAlB,UAAhB,GAAgB,CAAhB;;AAEA,yBAAqB,qBAAS;AAAI,sBAAS,CAAT,UAAoB,KAAI,CAAxB;AAAlC;;AAEA,WAAO,KAAP;AARD;AAWA;;;;;;AAIa,uCAAb,qBAAmD;;;;AAClD,YAAI,SAAS,IAAI,SAAS,CAAT,kBAAjB,UAAuD;AACtD;;AAEM,gBAAM,GAAG,SAAS,CAAT,UAAoB,KAA7B,QAAS,CAAT;AAEN;AAAA;AAAA;AACA;;;;;;;AAPW;;AAUL,4CAAR,wBAAsC;AACrC,QAAI,YAAY,KAAhB,wFAA2D;AAC1D,aAAO,KAAP;AACA;;AACD,QAAI,YAAY,KAAhB,iGAAoE;AACnE,aAAO,KAAP;AACA;;AAED,WAAO,sBACN,qBAAS;AAAI,sBAAS,CAAT;AADd,KAAO,CAAP;AARO;;AAaA,uCAAR,mBAAmD;AAA9B;AAAA;AAA8B;;AAC1C;;AACR,QAAI,CAAJ,cAAmB;AAClB,aAAO,KAAP;AACA;;AAED,QAAM,QAAQ,GAAG,uBAAjB,YAAiB,CAAjB;;AACA,QAAI,CAAJ,UAAe;AACd,YAAM,UAAU,mCAAhB,YAAM,CAAN;AACA;;AAED,WAAO,CAAP,QAAO,CAAP;AAXO;;AAcF,kCAAN,gCAG2B;;;AAE1B;AAAA;AAAA,UAAO,OAAO,CAAP,IACN,+BAA+B,oBAAQ;AACtC,yBAAQ,CAAR;AAFF,SACC,CADM,CAAP;;;AALK;;AAYN,+DAE2B;AAE1B,UAAM,CAAN;AAEA,QAAM,SAAS,GAAG,kBAAlB,OAAkB,CAAlB;AAEA,WAAO,8DAAe,oBAAQ;AAC7B,UAAM,WAAW,GAAG,SAAS,CAAT,IAAc,oBAAQ;AAAI,eAAC;AAC9C,kBAAQ,EADsC;AAE9C,oBAAU,EAAE,QAAQ,CAAR;AAFkC,SAAD;AAA9C,OAAoB,CAApB;AAKA,UAAM,aAAa,GAAG,WAAW,CAAX,IAAgB,cAAyB;YAAtB,sB;YAAU,0B;AAClD,yBAAU,CAAV,UAAqB;AACpB,eAAK,EAAE,OAAO,CADM;AAEpB,cAAI,EAAE,qBAAK;AAAI,2BAAQ,CAAR,KAAc;AAAE,sBAAQ,EAAV;AAAY,mBAAK,EAA/B;AAAc,aAAd;AAFK;AAGpB,eAAK,EAAE,uBAAK;AAAI,2BAAQ,CAAR,MAAe;AAAE,sBAAQ,EAAV;AAAY,mBAAK,EAAhC;AAAe,aAAf;AAAmC;AAH/B,SAArB;AADD,OAAsB,CAAtB;AASA,aAAO;AACN,4BAAa,CAAb,QAAsB,wBAAY;AAAI,6BAAY,CAAZ;AAAtC;AADD;AAfD,KAAO,CAAP;AARD;;AA2BD;AAvJA;;;AAyJO,IAAM,MAAM,GAAG,gBAAf,IAAe,CAAf,C;;;;;;;;;;;;ACnLP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;AAYA;AAEA;AAEA;;AAAA,wBAAgB;AACf;AACA;AACA;AAHD,GAAK,WAAW,KAAX,WAAW,GAAhB,EAAgB,CAAhB;;AAMA;AAEA;;;;AAGA,+G;;;;;;;;;;;AC3BA,+D;;;;;;;;;;;ACAA,gE;;;;;;;;;;;ACAA,+D;;;;;;;;;;;ACAA,qD","file":"aws-amplify-pubsub.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@aws-amplify/auth\"), require(\"@aws-amplify/cache\"), require(\"@aws-amplify/core\"), require(\"graphql\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"aws_amplify_pubsub\", [\"@aws-amplify/auth\", \"@aws-amplify/cache\", \"@aws-amplify/core\", \"graphql\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"aws_amplify_pubsub\"] = factory(require(\"@aws-amplify/auth\"), require(\"@aws-amplify/cache\"), require(\"@aws-amplify/core\"), require(\"graphql\"));\n\telse\n\t\troot[\"aws_amplify_pubsub\"] = factory(root[\"@aws-amplify/auth\"], root[\"@aws-amplify/cache\"], root[\"@aws-amplify/core\"], root[\"graphql\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__aws_amplify_auth__, __WEBPACK_EXTERNAL_MODULE__aws_amplify_cache__, __WEBPACK_EXTERNAL_MODULE__aws_amplify_core__, __WEBPACK_EXTERNAL_MODULE_graphql__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib-esm/index.js\");\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","/*******************************************************************************\n * Copyright (c) 2013 IBM Corp.\n *\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * and Eclipse Distribution License v1.0 which accompany this distribution.\n *\n * The Eclipse Public License is available at\n *    http://www.eclipse.org/legal/epl-v10.html\n * and the Eclipse Distribution License is available at\n *   http://www.eclipse.org/org/documents/edl-v10.php.\n *\n * Contributors:\n *    Andrew Banks - initial API and implementation and initial documentation\n *******************************************************************************/\n\n\n// Only expose a single object name in the global namespace.\n// Everything must go through this module. Global Paho module\n// only has a single public function, client, which returns\n// a Paho client object given connection details.\n\n/**\n * Send and receive messages using web browsers.\n * <p>\n * This programming interface lets a JavaScript client application use the MQTT V3.1 or\n * V3.1.1 protocol to connect to an MQTT-supporting messaging server.\n *\n * The function supported includes:\n * <ol>\n * <li>Connecting to and disconnecting from a server. The server is identified by its host name and port number.\n * <li>Specifying options that relate to the communications link with the server,\n * for example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.\n * <li>Subscribing to and receiving messages from MQTT Topics.\n * <li>Publishing messages to MQTT Topics.\n * </ol>\n * <p>\n * The API consists of two main objects:\n * <dl>\n * <dt><b>{@link Paho.Client}</b></dt>\n * <dd>This contains methods that provide the functionality of the API,\n * including provision of callbacks that notify the application when a message\n * arrives from or is delivered to the messaging server,\n * or when the status of its connection to the messaging server changes.</dd>\n * <dt><b>{@link Paho.Message}</b></dt>\n * <dd>This encapsulates the payload of the message along with various attributes\n * associated with its delivery, in particular the destination to which it has\n * been (or is about to be) sent.</dd>\n * </dl>\n * <p>\n * The programming interface validates parameters passed to it, and will throw\n * an Error containing an error message intended for developer use, if it detects\n * an error with any parameter.\n * <p>\n * Example:\n *\n * <code><pre>\nvar client = new Paho.MQTT.Client(location.hostname, Number(location.port), \"clientId\");\nclient.onConnectionLost = onConnectionLost;\nclient.onMessageArrived = onMessageArrived;\nclient.connect({onSuccess:onConnect});\n\nfunction onConnect() {\n  // Once a connection has been made, make a subscription and send a message.\n  console.log(\"onConnect\");\n  client.subscribe(\"/World\");\n  var message = new Paho.MQTT.Message(\"Hello\");\n  message.destinationName = \"/World\";\n  client.send(message);\n};\nfunction onConnectionLost(responseObject) {\n  if (responseObject.errorCode !== 0)\n\tconsole.log(\"onConnectionLost:\"+responseObject.errorMessage);\n};\nfunction onMessageArrived(message) {\n  console.log(\"onMessageArrived:\"+message.payloadString);\n  client.disconnect();\n};\n * </pre></code>\n * @namespace Paho\n */\n\n/* jshint shadow:true */\n(function ExportLibrary(root, factory) {\n\tif(typeof exports === \"object\" && typeof module === \"object\"){\n\t\tmodule.exports = factory();\n\t} else if (typeof define === \"function\" && define.amd){\n\t\tdefine(factory);\n\t} else if (typeof exports === \"object\"){\n\t\texports = factory();\n\t} else {\n\t\t//if (typeof root.Paho === \"undefined\"){\n\t\t//\troot.Paho = {};\n\t\t//}\n\t\troot.Paho = factory();\n\t}\n})(this, function LibraryFactory(){\n\n\n\tvar PahoMQTT = (function (global) {\n\n\t// Private variables below, these are only visible inside the function closure\n\t// which is used to define the module.\n\tvar version = \"@VERSION@-@BUILDLEVEL@\";\n\n\t/**\n\t * @private\n\t */\n\tvar localStorage = global.localStorage || (function () {\n\t\tvar data = {};\n\n\t\treturn {\n\t\t\tsetItem: function (key, item) { data[key] = item; },\n\t\t\tgetItem: function (key) { return data[key]; },\n\t\t\tremoveItem: function (key) { delete data[key]; },\n\t\t};\n\t})();\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar MESSAGE_TYPE = {\n\t\t\tCONNECT: 1,\n\t\t\tCONNACK: 2,\n\t\t\tPUBLISH: 3,\n\t\t\tPUBACK: 4,\n\t\t\tPUBREC: 5,\n\t\t\tPUBREL: 6,\n\t\t\tPUBCOMP: 7,\n\t\t\tSUBSCRIBE: 8,\n\t\t\tSUBACK: 9,\n\t\t\tUNSUBSCRIBE: 10,\n\t\t\tUNSUBACK: 11,\n\t\t\tPINGREQ: 12,\n\t\t\tPINGRESP: 13,\n\t\t\tDISCONNECT: 14\n\t\t};\n\n\t\t// Collection of utility methods used to simplify module code\n\t\t// and promote the DRY pattern.\n\n\t\t/**\n\t * Validate an object's parameter names to ensure they\n\t * match a list of expected variables name for this option\n\t * type. Used to ensure option object passed into the API don't\n\t * contain erroneous parameters.\n\t * @param {Object} obj - User options object\n\t * @param {Object} keys - valid keys and types that may exist in obj.\n\t * @throws {Error} Invalid option parameter found.\n\t * @private\n\t */\n\t\tvar validate = function(obj, keys) {\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\tif (keys.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (typeof obj[key] !== keys[key])\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof obj[key], key]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar errorStr = \"Unknown property, \" + key + \". Valid properties are:\";\n\t\t\t\t\t\tfor (var validKey in keys)\n\t\t\t\t\t\t\tif (keys.hasOwnProperty(validKey))\n\t\t\t\t\t\t\t\terrorStr = errorStr+\" \"+validKey;\n\t\t\t\t\t\tthrow new Error(errorStr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Return a new function which runs the user function bound\n\t * to a fixed scope.\n\t * @param {function} User function\n\t * @param {object} Function scope\n\t * @return {function} User function bound to another scope\n\t * @private\n\t */\n\t\tvar scope = function (f, scope) {\n\t\t\treturn function () {\n\t\t\t\treturn f.apply(scope, arguments);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar ERROR = {\n\t\t\tOK: {code:0, text:\"AMQJSC0000I OK.\"},\n\t\t\tCONNECT_TIMEOUT: {code:1, text:\"AMQJSC0001E Connect timed out.\"},\n\t\t\tSUBSCRIBE_TIMEOUT: {code:2, text:\"AMQJS0002E Subscribe timed out.\"},\n\t\t\tUNSUBSCRIBE_TIMEOUT: {code:3, text:\"AMQJS0003E Unsubscribe timed out.\"},\n\t\t\tPING_TIMEOUT: {code:4, text:\"AMQJS0004E Ping timed out.\"},\n\t\t\tINTERNAL_ERROR: {code:5, text:\"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}\"},\n\t\t\tCONNACK_RETURNCODE: {code:6, text:\"AMQJS0006E Bad Connack return code:{0} {1}.\"},\n\t\t\tSOCKET_ERROR: {code:7, text:\"AMQJS0007E Socket error:{0}.\"},\n\t\t\tSOCKET_CLOSE: {code:8, text:\"AMQJS0008I Socket closed.\"},\n\t\t\tMALFORMED_UTF: {code:9, text:\"AMQJS0009E Malformed UTF data:{0} {1} {2}.\"},\n\t\t\tUNSUPPORTED: {code:10, text:\"AMQJS0010E {0} is not supported by this browser.\"},\n\t\t\tINVALID_STATE: {code:11, text:\"AMQJS0011E Invalid state {0}.\"},\n\t\t\tINVALID_TYPE: {code:12, text:\"AMQJS0012E Invalid type {0} for {1}.\"},\n\t\t\tINVALID_ARGUMENT: {code:13, text:\"AMQJS0013E Invalid argument {0} for {1}.\"},\n\t\t\tUNSUPPORTED_OPERATION: {code:14, text:\"AMQJS0014E Unsupported operation.\"},\n\t\t\tINVALID_STORED_DATA: {code:15, text:\"AMQJS0015E Invalid data in local storage key={0} value={1}.\"},\n\t\t\tINVALID_MQTT_MESSAGE_TYPE: {code:16, text:\"AMQJS0016E Invalid MQTT message type {0}.\"},\n\t\t\tMALFORMED_UNICODE: {code:17, text:\"AMQJS0017E Malformed Unicode string:{0} {1}.\"},\n\t\t\tBUFFER_FULL: {code:18, text:\"AMQJS0018E Message buffer is full, maximum buffer size: {0}.\"},\n\t\t};\n\n\t\t/** CONNACK RC Meaning. */\n\t\tvar CONNACK_RC = {\n\t\t\t0:\"Connection Accepted\",\n\t\t\t1:\"Connection Refused: unacceptable protocol version\",\n\t\t\t2:\"Connection Refused: identifier rejected\",\n\t\t\t3:\"Connection Refused: server unavailable\",\n\t\t\t4:\"Connection Refused: bad user name or password\",\n\t\t\t5:\"Connection Refused: not authorized\"\n\t\t};\n\n\t/**\n\t * Format an error message text.\n\t * @private\n\t * @param {error} ERROR value above.\n\t * @param {substitutions} [array] substituted into the text.\n\t * @return the text with the substitutions made.\n\t */\n\t\tvar format = function(error, substitutions) {\n\t\t\tvar text = error.text;\n\t\t\tif (substitutions) {\n\t\t\t\tvar field,start;\n\t\t\t\tfor (var i=0; i<substitutions.length; i++) {\n\t\t\t\t\tfield = \"{\"+i+\"}\";\n\t\t\t\t\tstart = text.indexOf(field);\n\t\t\t\t\tif(start > 0) {\n\t\t\t\t\t\tvar part1 = text.substring(0,start);\n\t\t\t\t\t\tvar part2 = text.substring(start+field.length);\n\t\t\t\t\t\ttext = part1+substitutions[i]+part2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn text;\n\t\t};\n\n\t\t//MQTT protocol and version          6    M    Q    I    s    d    p    3\n\t\tvar MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];\n\t\t//MQTT proto/version for 311         4    M    Q    T    T    4\n\t\tvar MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];\n\n\t\t/**\n\t * Construct an MQTT wire protocol message.\n\t * @param type MQTT packet type.\n\t * @param options optional wire message attributes.\n\t *\n\t * Optional properties\n\t *\n\t * messageIdentifier: message ID in the range [0..65535]\n\t * payloadMessage:\tApplication Message - PUBLISH only\n\t * connectStrings:\tarray of 0 or more Strings to be put into the CONNECT payload\n\t * topics:\t\t\tarray of strings (SUBSCRIBE, UNSUBSCRIBE)\n\t * requestQoS:\t\tarray of QoS values [0..2]\n\t *\n\t * \"Flag\" properties\n\t * cleanSession:\ttrue if present / false if absent (CONNECT)\n\t * willMessage:  \ttrue if present / false if absent (CONNECT)\n\t * isRetained:\t\ttrue if present / false if absent (CONNECT)\n\t * userName:\t\ttrue if present / false if absent (CONNECT)\n\t * password:\t\ttrue if present / false if absent (CONNECT)\n\t * keepAliveInterval:\tinteger [0..65535]  (CONNECT)\n\t *\n\t * @private\n\t * @ignore\n\t */\n\t\tvar WireMessage = function (type, options) {\n\t\t\tthis.type = type;\n\t\t\tfor (var name in options) {\n\t\t\t\tif (options.hasOwnProperty(name)) {\n\t\t\t\t\tthis[name] = options[name];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tWireMessage.prototype.encode = function() {\n\t\t// Compute the first byte of the fixed header\n\t\t\tvar first = ((this.type & 0x0f) << 4);\n\n\t\t\t/*\n\t\t * Now calculate the length of the variable header + payload by adding up the lengths\n\t\t * of all the component parts\n\t\t */\n\n\t\t\tvar remLength = 0;\n\t\t\tvar topicStrLength = [];\n\t\t\tvar destinationNameLength = 0;\n\t\t\tvar willMessagePayloadBytes;\n\n\t\t\t// if the message contains a messageIdentifier then we need two bytes for that\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tremLength += 2;\n\n\t\t\tswitch(this.type) {\n\t\t\t// If this a Connect then we need to include 12 bytes for its header\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tswitch(this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tremLength += MqttProtoIdentifierv3.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tremLength += MqttProtoIdentifierv4.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tremLength += UTF8Length(this.clientId) + 2;\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tremLength += UTF8Length(this.willMessage.destinationName) + 2;\n\t\t\t\t\t// Will message is always a string, sent as UTF-8 characters with a preceding length.\n\t\t\t\t\twillMessagePayloadBytes = this.willMessage.payloadBytes;\n\t\t\t\t\tif (!(willMessagePayloadBytes instanceof Uint8Array))\n\t\t\t\t\t\twillMessagePayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\t\tremLength += willMessagePayloadBytes.byteLength +2;\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.userName) + 2;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.password) + 2;\n\t\t\t\tbreak;\n\n\t\t\t// Subscribe, Unsubscribe can both contain topic strings\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tremLength += this.requestedQos.length; // 1 byte for each topic's Qos\n\t\t\t\t// QoS on Subscribe only\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif (this.payloadMessage.duplicate) first |= 0x08;\n\t\t\t\tfirst  = first |= (this.payloadMessage.qos << 1);\n\t\t\t\tif (this.payloadMessage.retained) first |= 0x01;\n\t\t\t\tdestinationNameLength = UTF8Length(this.payloadMessage.destinationName);\n\t\t\t\tremLength += destinationNameLength + 2;\n\t\t\t\tvar payloadBytes = this.payloadMessage.payloadBytes;\n\t\t\t\tremLength += payloadBytes.byteLength;\n\t\t\t\tif (payloadBytes instanceof ArrayBuffer)\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\telse if (!(payloadBytes instanceof Uint8Array))\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes.buffer);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Now we can allocate a buffer for the message\n\n\t\t\tvar mbi = encodeMBI(remLength);  // Convert the length to MQTT MBI format\n\t\t\tvar pos = mbi.length + 1;        // Offset of start of variable header\n\t\t\tvar buffer = new ArrayBuffer(remLength + pos);\n\t\t\tvar byteStream = new Uint8Array(buffer);    // view it as a sequence of bytes\n\n\t\t\t//Write the fixed header into the buffer\n\t\t\tbyteStream[0] = first;\n\t\t\tbyteStream.set(mbi,1);\n\n\t\t\t// If this is a PUBLISH then the variable header starts with a topic\n\t\t\tif (this.type == MESSAGE_TYPE.PUBLISH)\n\t\t\t\tpos = writeString(this.payloadMessage.destinationName, destinationNameLength, byteStream, pos);\n\t\t\t// If this is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time\n\n\t\t\telse if (this.type == MESSAGE_TYPE.CONNECT) {\n\t\t\t\tswitch (this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv3, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv3.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv4, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv4.length;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar connectFlags = 0;\n\t\t\t\tif (this.cleanSession)\n\t\t\t\t\tconnectFlags = 0x02;\n\t\t\t\tif (this.willMessage !== undefined ) {\n\t\t\t\t\tconnectFlags |= 0x04;\n\t\t\t\t\tconnectFlags |= (this.willMessage.qos<<3);\n\t\t\t\t\tif (this.willMessage.retained) {\n\t\t\t\t\t\tconnectFlags |= 0x20;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tconnectFlags |= 0x80;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tconnectFlags |= 0x40;\n\t\t\t\tbyteStream[pos++] = connectFlags;\n\t\t\t\tpos = writeUint16 (this.keepAliveInterval, byteStream, pos);\n\t\t\t}\n\n\t\t\t// Output the messageIdentifier - if there is one\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tpos = writeUint16 (this.messageIdentifier, byteStream, pos);\n\n\t\t\tswitch(this.type) {\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tpos = writeString(this.clientId, UTF8Length(this.clientId), byteStream, pos);\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tpos = writeString(this.willMessage.destinationName, UTF8Length(this.willMessage.destinationName), byteStream, pos);\n\t\t\t\t\tpos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);\n\t\t\t\t\tbyteStream.set(willMessagePayloadBytes, pos);\n\t\t\t\t\tpos += willMessagePayloadBytes.byteLength;\n\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tpos = writeString(this.userName, UTF8Length(this.userName), byteStream, pos);\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tpos = writeString(this.password, UTF8Length(this.password), byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// PUBLISH has a text or binary payload, if text do not add a 2 byte length field, just the UTF characters.\n\t\t\t\tbyteStream.set(payloadBytes, pos);\n\n\t\t\t\tbreak;\n\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREC:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREL:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t//    \t    \tbreak;\n\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\t// SUBSCRIBE has a list of topic strings and request QoS\n\t\t\t\tfor (var i=0; i<this.topics.length; i++) {\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\t\tbyteStream[pos++] = this.requestedQos[i];\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\t// UNSUBSCRIBE has a list of topic strings\n\t\t\t\tfor (var i=0; i<this.topics.length; i++)\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// Do nothing.\n\t\t\t}\n\n\t\t\treturn buffer;\n\t\t};\n\n\t\tfunction decodeMessage(input,pos) {\n\t\t\tvar startingPos = pos;\n\t\t\tvar first = input[pos];\n\t\t\tvar type = first >> 4;\n\t\t\tvar messageInfo = first &= 0x0f;\n\t\t\tpos += 1;\n\n\n\t\t\t// Decode the remaining length (MBI format)\n\n\t\t\tvar digit;\n\t\t\tvar remLength = 0;\n\t\t\tvar multiplier = 1;\n\t\t\tdo {\n\t\t\t\tif (pos == input.length) {\n\t\t\t\t\treturn [null,startingPos];\n\t\t\t\t}\n\t\t\t\tdigit = input[pos++];\n\t\t\t\tremLength += ((digit & 0x7F) * multiplier);\n\t\t\t\tmultiplier *= 128;\n\t\t\t} while ((digit & 0x80) !== 0);\n\n\t\t\tvar endPos = pos+remLength;\n\t\t\tif (endPos > input.length) {\n\t\t\t\treturn [null,startingPos];\n\t\t\t}\n\n\t\t\tvar wireMessage = new WireMessage(type);\n\t\t\tswitch(type) {\n\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\tvar connectAcknowledgeFlags = input[pos++];\n\t\t\t\tif (connectAcknowledgeFlags & 0x01)\n\t\t\t\t\twireMessage.sessionPresent = true;\n\t\t\t\twireMessage.returnCode = input[pos++];\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tvar qos = (messageInfo >> 1) & 0x03;\n\n\t\t\t\tvar len = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\tvar topicName = parseUTF8(input, pos, len);\n\t\t\t\tpos += len;\n\t\t\t\t// If QoS 1 or 2 there will be a messageIdentifier\n\t\t\t\tif (qos > 0) {\n\t\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\t\tpos += 2;\n\t\t\t\t}\n\n\t\t\t\tvar message = new Message(input.subarray(pos, endPos));\n\t\t\t\tif ((messageInfo & 0x01) == 0x01)\n\t\t\t\t\tmessage.retained = true;\n\t\t\t\tif ((messageInfo & 0x08) == 0x08)\n\t\t\t\t\tmessage.duplicate =  true;\n\t\t\t\tmessage.qos = qos;\n\t\t\t\tmessage.destinationName = topicName;\n\t\t\t\twireMessage.payloadMessage = message;\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.PUBACK:\n\t\t\tcase  MESSAGE_TYPE.PUBREC:\n\t\t\tcase  MESSAGE_TYPE.PUBREL:\n\t\t\tcase  MESSAGE_TYPE.PUBCOMP:\n\t\t\tcase  MESSAGE_TYPE.UNSUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.SUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\twireMessage.returnCode = input.subarray(pos, endPos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn [wireMessage,endPos];\n\t\t}\n\n\t\tfunction writeUint16(input, buffer, offset) {\n\t\t\tbuffer[offset++] = input >> 8;      //MSB\n\t\t\tbuffer[offset++] = input % 256;     //LSB\n\t\t\treturn offset;\n\t\t}\n\n\t\tfunction writeString(input, utf8Length, buffer, offset) {\n\t\t\toffset = writeUint16(utf8Length, buffer, offset);\n\t\t\tstringToUTF8(input, buffer, offset);\n\t\t\treturn offset + utf8Length;\n\t\t}\n\n\t\tfunction readUint16(buffer, offset) {\n\t\t\treturn 256*buffer[offset] + buffer[offset+1];\n\t\t}\n\n\t\t/**\n\t * Encodes an MQTT Multi-Byte Integer\n\t * @private\n\t */\n\t\tfunction encodeMBI(number) {\n\t\t\tvar output = new Array(1);\n\t\t\tvar numBytes = 0;\n\n\t\t\tdo {\n\t\t\t\tvar digit = number % 128;\n\t\t\t\tnumber = number >> 7;\n\t\t\t\tif (number > 0) {\n\t\t\t\t\tdigit |= 0x80;\n\t\t\t\t}\n\t\t\t\toutput[numBytes++] = digit;\n\t\t\t} while ( (number > 0) && (numBytes<4) );\n\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and calculates its length in bytes when encoded in UTF8.\n\t * @private\n\t */\n\t\tfunction UTF8Length(input) {\n\t\t\tvar output = 0;\n\t\t\tfor (var i = 0; i<input.length; i++)\n\t\t\t{\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\t\t\t\tif (charCode > 0x7FF)\n\t\t\t\t{\n\t\t\t\t\t// Surrogate pair means its a 4 byte character\n\t\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)\n\t\t\t\t\t{\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\toutput++;\n\t\t\t\t\t}\n\t\t\t\t\toutput +=3;\n\t\t\t\t}\n\t\t\t\telse if (charCode > 0x7F)\n\t\t\t\t\toutput +=2;\n\t\t\t\telse\n\t\t\t\t\toutput++;\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and writes it into an array as UTF8 encoded bytes.\n\t * @private\n\t */\n\t\tfunction stringToUTF8(input, output, start) {\n\t\t\tvar pos = start;\n\t\t\tfor (var i = 0; i<input.length; i++) {\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\n\t\t\t\t// Check for a surrogate pair.\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF) {\n\t\t\t\t\tvar lowCharCode = input.charCodeAt(++i);\n\t\t\t\t\tif (isNaN(lowCharCode)) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));\n\t\t\t\t\t}\n\t\t\t\t\tcharCode = ((charCode - 0xD800)<<10) + (lowCharCode - 0xDC00) + 0x10000;\n\n\t\t\t\t}\n\n\t\t\t\tif (charCode <= 0x7F) {\n\t\t\t\t\toutput[pos++] = charCode;\n\t\t\t\t} else if (charCode <= 0x7FF) {\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x1F | 0xC0;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else if (charCode <= 0xFFFF) {\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x0F | 0xE0;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else {\n\t\t\t\t\toutput[pos++] = charCode>>18 & 0x07 | 0xF0;\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\tfunction parseUTF8(input, offset, length) {\n\t\t\tvar output = \"\";\n\t\t\tvar utf16;\n\t\t\tvar pos = offset;\n\n\t\t\twhile (pos < offset+length)\n\t\t\t{\n\t\t\t\tvar byte1 = input[pos++];\n\t\t\t\tif (byte1 < 128)\n\t\t\t\t\tutf16 = byte1;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar byte2 = input[pos++]-128;\n\t\t\t\t\tif (byte2 < 0)\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),\"\"]));\n\t\t\t\t\tif (byte1 < 0xE0)             // 2 byte character\n\t\t\t\t\t\tutf16 = 64*(byte1-0xC0) + byte2;\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar byte3 = input[pos++]-128;\n\t\t\t\t\t\tif (byte3 < 0)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));\n\t\t\t\t\t\tif (byte1 < 0xF0)        // 3 byte character\n\t\t\t\t\t\t\tutf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar byte4 = input[pos++]-128;\n\t\t\t\t\t\t\tif (byte4 < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t\tif (byte1 < 0xF8)        // 4 byte character\n\t\t\t\t\t\t\t\tutf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;\n\t\t\t\t\t\t\telse                     // longer encodings are not supported\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (utf16 > 0xFFFF)   // 4 byte character - express as a surrogate pair\n\t\t\t\t{\n\t\t\t\t\tutf16 -= 0x10000;\n\t\t\t\t\toutput += String.fromCharCode(0xD800 + (utf16 >> 10)); // lead character\n\t\t\t\t\tutf16 = 0xDC00 + (utf16 & 0x3FF);  // trail character\n\t\t\t\t}\n\t\t\t\toutput += String.fromCharCode(utf16);\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Repeat keepalive requests, monitor responses.\n\t * @ignore\n\t */\n\t\tvar Pinger = function(client, keepAliveInterval) {\n\t\t\tthis._client = client;\n\t\t\tthis._keepAliveInterval = keepAliveInterval*1000;\n\t\t\tthis.isReset = false;\n\n\t\t\tvar pingReq = new WireMessage(MESSAGE_TYPE.PINGREQ).encode();\n\n\t\t\tvar doTimeout = function (pinger) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn doPing.apply(pinger);\n\t\t\t\t};\n\t\t\t};\n\n\t\t\t/** @ignore */\n\t\t\tvar doPing = function() {\n\t\t\t\tif (!this.isReset) {\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"Timed out\");\n\t\t\t\t\tthis._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));\n\t\t\t\t} else {\n\t\t\t\t\tthis.isReset = false;\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"send PINGREQ\");\n\t\t\t\t\tthis._client.socket.send(pingReq);\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.reset = function() {\n\t\t\t\tthis.isReset = true;\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t\tif (this._keepAliveInterval > 0)\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t};\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Monitor request completion.\n\t * @ignore\n\t */\n\t\tvar Timeout = function(client, timeoutSeconds, action, args) {\n\t\t\tif (!timeoutSeconds)\n\t\t\t\ttimeoutSeconds = 30;\n\n\t\t\tvar doTimeout = function (action, client, args) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn action.apply(client, args);\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t/**\n\t * Internal implementation of the Websockets MQTT V3.1 client.\n\t *\n\t * @name Paho.ClientImpl @constructor\n\t * @param {String} host the DNS nameof the webSocket host.\n\t * @param {Number} port the port number for that host.\n\t * @param {String} clientId the MQ client identifier.\n\t */\n\t\tvar ClientImpl = function (uri, host, port, path, clientId) {\n\t\t// Check dependencies are satisfied in this browser.\n\t\t\tif (!(\"WebSocket\" in global && global.WebSocket !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"WebSocket\"]));\n\t\t\t}\n\t\t\tif (!(\"ArrayBuffer\" in global && global.ArrayBuffer !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"ArrayBuffer\"]));\n\t\t\t}\n\t\t\tthis._trace(\"Paho.Client\", uri, host, port, path, clientId);\n\n\t\t\tthis.host = host;\n\t\t\tthis.port = port;\n\t\t\tthis.path = path;\n\t\t\tthis.uri = uri;\n\t\t\tthis.clientId = clientId;\n\t\t\tthis._wsuri = null;\n\n\t\t\t// Local storagekeys are qualified with the following string.\n\t\t\t// The conditional inclusion of path in the key is for backward\n\t\t\t// compatibility to when the path was not configurable and assumed to\n\t\t\t// be /mqtt\n\t\t\tthis._localKey=host+\":\"+port+(path!=\"/mqtt\"?\":\"+path:\"\")+\":\"+clientId+\":\";\n\n\t\t\t// Create private instance-only message queue\n\t\t\t// Internal queue of messages to be sent, in sending order.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\n\t\t\t// Messages we have sent and are expecting a response for, indexed by their respective message ids.\n\t\t\tthis._sentMessages = {};\n\n\t\t\t// Messages we have received and acknowleged and are expecting a confirm message for\n\t\t\t// indexed by their respective message ids.\n\t\t\tthis._receivedMessages = {};\n\n\t\t\t// Internal list of callbacks to be executed when messages\n\t\t\t// have been successfully sent over web socket, e.g. disconnect\n\t\t\t// when it doesn't have to wait for ACK, just message is dispatched.\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\t// Unique identifier for SEND messages, incrementing\n\t\t\t// counter as messages are sent.\n\t\t\tthis._message_identifier = 1;\n\n\t\t\t// Used to determine the transmission sequence of stored sent messages.\n\t\t\tthis._sequence = 0;\n\n\n\t\t\t// Load the local state, if any, from the saved version, only restore state relevant to this client.\n\t\t\tfor (var key in localStorage)\n\t\t\t\tif (   key.indexOf(\"Sent:\"+this._localKey) === 0 || key.indexOf(\"Received:\"+this._localKey) === 0)\n\t\t\t\t\tthis.restore(key);\n\t\t};\n\n\t\t// Messaging Client public instance members.\n\t\tClientImpl.prototype.host = null;\n\t\tClientImpl.prototype.port = null;\n\t\tClientImpl.prototype.path = null;\n\t\tClientImpl.prototype.uri = null;\n\t\tClientImpl.prototype.clientId = null;\n\n\t\t// Messaging Client private instance members.\n\t\tClientImpl.prototype.socket = null;\n\t\t/* true once we have received an acknowledgement to a CONNECT packet. */\n\t\tClientImpl.prototype.connected = false;\n\t\t/* The largest message identifier allowed, may not be larger than 2**16 but\n\t\t * if set smaller reduces the maximum number of outbound messages allowed.\n\t\t */\n\t\tClientImpl.prototype.maxMessageIdentifier = 65536;\n\t\tClientImpl.prototype.connectOptions = null;\n\t\tClientImpl.prototype.hostIndex = null;\n\t\tClientImpl.prototype.onConnected = null;\n\t\tClientImpl.prototype.onConnectionLost = null;\n\t\tClientImpl.prototype.onMessageDelivered = null;\n\t\tClientImpl.prototype.onMessageArrived = null;\n\t\tClientImpl.prototype.traceFunction = null;\n\t\tClientImpl.prototype._msg_queue = null;\n\t\tClientImpl.prototype._buffered_msg_queue = null;\n\t\tClientImpl.prototype._connectTimeout = null;\n\t\t/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */\n\t\tClientImpl.prototype.sendPinger = null;\n\t\t/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */\n\t\tClientImpl.prototype.receivePinger = null;\n\t\tClientImpl.prototype._reconnectInterval = 1; // Reconnect Delay, starts at 1 second\n\t\tClientImpl.prototype._reconnecting = false;\n\t\tClientImpl.prototype._reconnectTimeout = null;\n\t\tClientImpl.prototype.disconnectedPublishing = false;\n\t\tClientImpl.prototype.disconnectedBufferSize = 5000;\n\n\t\tClientImpl.prototype.receiveBuffer = null;\n\n\t\tClientImpl.prototype._traceBuffer = null;\n\t\tClientImpl.prototype._MAX_TRACE_ENTRIES = 100;\n\n\t\tClientImpl.prototype.connect = function (connectOptions) {\n\t\t\tvar connectOptionsMasked = this._traceMask(connectOptions, \"password\");\n\t\t\tthis._trace(\"Client.connect\", connectOptionsMasked, this.socket, this.connected);\n\n\t\t\tif (this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\t\t\tif (this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// connect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process to use new connect options.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tthis.connectOptions = connectOptions;\n\t\t\tthis._reconnectInterval = 1;\n\t\t\tthis._reconnecting = false;\n\t\t\tif (connectOptions.uris) {\n\t\t\t\tthis.hostIndex = 0;\n\t\t\t\tthis._doConnect(connectOptions.uris[0]);\n\t\t\t} else {\n\t\t\t\tthis._doConnect(this.uri);\n\t\t\t}\n\n\t\t};\n\n\t\tClientImpl.prototype.subscribe = function (filter, subscribeOptions) {\n\t\t\tthis._trace(\"Client.subscribe\", filter, subscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.SUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n            if (subscribeOptions.qos === undefined)\n                subscribeOptions.qos = 0;\n            wireMessage.requestedQos = [];\n            for (var i = 0; i < wireMessage.topics.length; i++)\n                wireMessage.requestedQos[i] = subscribeOptions.qos;\n\n\t\t\tif (subscribeOptions.onSuccess) {\n\t\t\t\twireMessage.onSuccess = function(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.onFailure) {\n\t\t\t\twireMessage.onFailure = function(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, subscribeOptions.timeout, subscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:subscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.SUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All subscriptions return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype.unsubscribe = function(filter, unsubscribeOptions) {\n\t\t\tthis._trace(\"Client.unsubscribe\", filter, unsubscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n\n\t\t\tif (unsubscribeOptions.onSuccess) {\n\t\t\t\twireMessage.callback = function() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};\n\t\t\t}\n\t\t\tif (unsubscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:unsubscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All unsubscribes return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.send = function (message) {\n\t\t\tthis._trace(\"Client.send\", message);\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.PUBLISH);\n\t\t\twireMessage.payloadMessage = message;\n\n\t\t\tif (this.connected) {\n\t\t\t// Mark qos 1 & 2 message as \"ACK required\"\n\t\t\t// For qos 0 message, invoke onMessageDelivered callback if there is one.\n\t\t\t// Then schedule the message.\n\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t} else if (this.onMessageDelivered) {\n\t\t\t\t\tthis._notify_msg_sent[wireMessage] = this.onMessageDelivered(wireMessage.payloadMessage);\n\t\t\t\t}\n\t\t\t\tthis._schedule_message(wireMessage);\n\t\t\t} else {\n\t\t\t// Currently disconnected, will not schedule this message\n\t\t\t// Check if reconnecting is in progress and disconnected publish is enabled.\n\t\t\t\tif (this._reconnecting && this.disconnectedPublishing) {\n\t\t\t\t// Check the limit which include the \"required ACK\" messages\n\t\t\t\t\tvar messageCount = Object.keys(this._sentMessages).length + this._buffered_msg_queue.length;\n\t\t\t\t\tif (messageCount > this.disconnectedBufferSize) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.BUFFER_FULL, [this.disconnectedBufferSize]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\t\t// Mark this message as \"ACK required\"\n\t\t\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\t\t\t\t\tthis._buffered_msg_queue.unshift(wireMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.disconnect = function () {\n\t\t\tthis._trace(\"Client.disconnect\");\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// disconnect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tif (!this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connecting or connected\"]));\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.DISCONNECT);\n\n\t\t\t// Run the disconnected call back as soon as the message has been sent,\n\t\t\t// in case of a failure later on in the disconnect processing.\n\t\t\t// as a consequence, the _disconected call back may be run several times.\n\t\t\tthis._notify_msg_sent[wireMessage] = scope(this._disconnected, this);\n\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.getTraceLog = function () {\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tthis._trace(\"Client.getTraceLog\", new Date());\n\t\t\t\tthis._trace(\"Client.getTraceLog in flight messages\", this._sentMessages.length);\n\t\t\t\tfor (var key in this._sentMessages)\n\t\t\t\t\tthis._trace(\"_sentMessages \",key, this._sentMessages[key]);\n\t\t\t\tfor (var key in this._receivedMessages)\n\t\t\t\t\tthis._trace(\"_receivedMessages \",key, this._receivedMessages[key]);\n\n\t\t\t\treturn this._traceBuffer;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.startTrace = function () {\n\t\t\tif ( this._traceBuffer === null ) {\n\t\t\t\tthis._traceBuffer = [];\n\t\t\t}\n\t\t\tthis._trace(\"Client.startTrace\", new Date(), version);\n\t\t};\n\n\t\tClientImpl.prototype.stopTrace = function () {\n\t\t\tdelete this._traceBuffer;\n\t\t};\n\n\t\tClientImpl.prototype._doConnect = function (wsurl) {\n\t\t// When the socket is open, this client will send the CONNECT WireMessage using the saved parameters.\n\t\t\tif (this.connectOptions.useSSL) {\n\t\t\t\tvar uriParts = wsurl.split(\":\");\n\t\t\t\turiParts[0] = \"wss\";\n\t\t\t\twsurl = uriParts.join(\":\");\n\t\t\t}\n\t\t\tthis._wsuri = wsurl;\n\t\t\tthis.connected = false;\n\n\n\n\t\t\tif (this.connectOptions.mqttVersion < 4) {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqttv3.1\"]);\n\t\t\t} else {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqtt\"]);\n\t\t\t}\n\t\t\tthis.socket.binaryType = \"arraybuffer\";\n\t\t\tthis.socket.onopen = scope(this._on_socket_open, this);\n\t\t\tthis.socket.onmessage = scope(this._on_socket_message, this);\n\t\t\tthis.socket.onerror = scope(this._on_socket_error, this);\n\t\t\tthis.socket.onclose = scope(this._on_socket_close, this);\n\n\t\t\tthis.sendPinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tthis.receivePinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\t\t\tthis._connectTimeout = new Timeout(this, this.connectOptions.timeout, this._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);\n\t\t};\n\n\n\t\t// Schedule a new message to be sent over the WebSockets\n\t\t// connection. CONNECT messages cause WebSocket connection\n\t\t// to be started. All other messages are queued internally\n\t\t// until this has happened. When WS connection starts, process\n\t\t// all outstanding messages.\n\t\tClientImpl.prototype._schedule_message = function (message) {\n\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\tthis._msg_queue.unshift(message);\n\t\t\t// Process outstanding messages in the queue if we have an  open socket, and have received CONNACK.\n\t\t\tif (this.connected) {\n\t\t\t\tthis._process_queue();\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.store = function(prefix, wireMessage) {\n\t\t\tvar storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};\n\n\t\t\tswitch(wireMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif(wireMessage.pubRecReceived)\n\t\t\t\t\tstoredMessage.pubRecReceived = true;\n\n\t\t\t\t// Convert the payload to a hex string.\n\t\t\t\tstoredMessage.payloadMessage = {};\n\t\t\t\tvar hex = \"\";\n\t\t\t\tvar messageBytes = wireMessage.payloadMessage.payloadBytes;\n\t\t\t\tfor (var i=0; i<messageBytes.length; i++) {\n\t\t\t\t\tif (messageBytes[i] <= 0xF)\n\t\t\t\t\t\thex = hex+\"0\"+messageBytes[i].toString(16);\n\t\t\t\t\telse\n\t\t\t\t\t\thex = hex+messageBytes[i].toString(16);\n\t\t\t\t}\n\t\t\t\tstoredMessage.payloadMessage.payloadHex = hex;\n\n\t\t\t\tstoredMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;\n\t\t\t\tstoredMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;\n\t\t\t\tif (wireMessage.payloadMessage.duplicate)\n\t\t\t\t\tstoredMessage.payloadMessage.duplicate = true;\n\t\t\t\tif (wireMessage.payloadMessage.retained)\n\t\t\t\t\tstoredMessage.payloadMessage.retained = true;\n\n\t\t\t\t// Add a sequence number to sent messages.\n\t\t\t\tif ( prefix.indexOf(\"Sent:\") === 0 ) {\n\t\t\t\t\tif ( wireMessage.sequence === undefined )\n\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\tstoredMessage.sequence = wireMessage.sequence;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [prefix+this._localKey+wireMessage.messageIdentifier, storedMessage]));\n\t\t\t}\n\t\t\tlocalStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));\n\t\t};\n\n\t\tClientImpl.prototype.restore = function(key) {\n\t\t\tvar value = localStorage.getItem(key);\n\t\t\tvar storedMessage = JSON.parse(value);\n\n\t\t\tvar wireMessage = new WireMessage(storedMessage.type, storedMessage);\n\n\t\t\tswitch(storedMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// Replace the payload message with a Message object.\n\t\t\t\tvar hex = storedMessage.payloadMessage.payloadHex;\n\t\t\t\tvar buffer = new ArrayBuffer((hex.length)/2);\n\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (hex.length >= 2) {\n\t\t\t\t\tvar x = parseInt(hex.substring(0, 2), 16);\n\t\t\t\t\thex = hex.substring(2, hex.length);\n\t\t\t\t\tbyteStream[i++] = x;\n\t\t\t\t}\n\t\t\t\tvar payloadMessage = new Message(byteStream);\n\n\t\t\t\tpayloadMessage.qos = storedMessage.payloadMessage.qos;\n\t\t\t\tpayloadMessage.destinationName = storedMessage.payloadMessage.destinationName;\n\t\t\t\tif (storedMessage.payloadMessage.duplicate)\n\t\t\t\t\tpayloadMessage.duplicate = true;\n\t\t\t\tif (storedMessage.payloadMessage.retained)\n\t\t\t\t\tpayloadMessage.retained = true;\n\t\t\t\twireMessage.payloadMessage = payloadMessage;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [key, value]));\n\t\t\t}\n\n\t\t\tif (key.indexOf(\"Sent:\"+this._localKey) === 0) {\n\t\t\t\twireMessage.payloadMessage.duplicate = true;\n\t\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t} else if (key.indexOf(\"Received:\"+this._localKey) === 0) {\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._process_queue = function () {\n\t\t\tvar message = null;\n\n\t\t\t// Send all queued messages down socket connection\n\t\t\twhile ((message = this._msg_queue.pop())) {\n\t\t\t\tthis._socket_send(message);\n\t\t\t\t// Notify listeners that message was successfully sent\n\t\t\t\tif (this._notify_msg_sent[message]) {\n\t\t\t\t\tthis._notify_msg_sent[message]();\n\t\t\t\t\tdelete this._notify_msg_sent[message];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Expect an ACK response for this message. Add message to the set of in progress\n\t * messages and set an unused identifier in this message.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._requires_ack = function (wireMessage) {\n\t\t\tvar messageCount = Object.keys(this._sentMessages).length;\n\t\t\tif (messageCount > this.maxMessageIdentifier)\n\t\t\t\tthrow Error (\"Too many messages:\"+messageCount);\n\n\t\t\twhile(this._sentMessages[this._message_identifier] !== undefined) {\n\t\t\t\tthis._message_identifier++;\n\t\t\t}\n\t\t\twireMessage.messageIdentifier = this._message_identifier;\n\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\tif (wireMessage.type === MESSAGE_TYPE.PUBLISH) {\n\t\t\t\tthis.store(\"Sent:\", wireMessage);\n\t\t\t}\n\t\t\tif (this._message_identifier === this.maxMessageIdentifier) {\n\t\t\t\tthis._message_identifier = 1;\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has been opened.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_open = function () {\n\t\t// Create the CONNECT message object.\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.CONNECT, this.connectOptions);\n\t\t\twireMessage.clientId = this.clientId;\n\t\t\tthis._socket_send(wireMessage);\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has received a complete packet.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_message = function (event) {\n\t\t\tthis._trace(\"Client._on_socket_message\", event.data);\n\t\t\tvar messages = this._deframeMessages(event.data);\n\t\t\tfor (var i = 0; i < messages.length; i+=1) {\n\t\t\t\tthis._handleMessage(messages[i]);\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._deframeMessages = function(data) {\n\t\t\tvar byteArray = new Uint8Array(data);\n\t\t\tvar messages = [];\n\t\t\tif (this.receiveBuffer) {\n\t\t\t\tvar newData = new Uint8Array(this.receiveBuffer.length+byteArray.length);\n\t\t\t\tnewData.set(this.receiveBuffer);\n\t\t\t\tnewData.set(byteArray,this.receiveBuffer.length);\n\t\t\t\tbyteArray = newData;\n\t\t\t\tdelete this.receiveBuffer;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar offset = 0;\n\t\t\t\twhile(offset < byteArray.length) {\n\t\t\t\t\tvar result = decodeMessage(byteArray,offset);\n\t\t\t\t\tvar wireMessage = result[0];\n\t\t\t\t\toffset = result[1];\n\t\t\t\t\tif (wireMessage !== null) {\n\t\t\t\t\t\tmessages.push(wireMessage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (offset < byteArray.length) {\n\t\t\t\t\tthis.receiveBuffer = byteArray.subarray(offset);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn messages;\n\t\t};\n\n\t\tClientImpl.prototype._handleMessage = function(wireMessage) {\n\n\t\t\tthis._trace(\"Client._handleMessage\", wireMessage);\n\n\t\t\ttry {\n\t\t\t\tswitch(wireMessage.type) {\n\t\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\t\tif (this._reconnectTimeout)\n\t\t\t\t\t\tthis._reconnectTimeout.cancel();\n\n\t\t\t\t\t// If we have started using clean session then clear up the local state.\n\t\t\t\t\tif (this.connectOptions.cleanSession) {\n\t\t\t\t\t\tfor (var key in this._sentMessages) {\n\t\t\t\t\t\t\tvar sentMessage = this._sentMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+sentMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._sentMessages = {};\n\n\t\t\t\t\t\tfor (var key in this._receivedMessages) {\n\t\t\t\t\t\t\tvar receivedMessage = this._receivedMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+receivedMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._receivedMessages = {};\n\t\t\t\t\t}\n\t\t\t\t\t// Client connected and ready for business.\n\t\t\t\t\tif (wireMessage.returnCode === 0) {\n\n\t\t\t\t\t\tthis.connected = true;\n\t\t\t\t\t\t// Jump to the end of the list of uris and stop looking for a good host.\n\n\t\t\t\t\t\tif (this.connectOptions.uris)\n\t\t\t\t\t\t\tthis.hostIndex = this.connectOptions.uris.length;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Resend messages.\n\t\t\t\t\tvar sequencedMessages = [];\n\t\t\t\t\tfor (var msgId in this._sentMessages) {\n\t\t\t\t\t\tif (this._sentMessages.hasOwnProperty(msgId))\n\t\t\t\t\t\t\tsequencedMessages.push(this._sentMessages[msgId]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Also schedule qos 0 buffered messages if any\n\t\t\t\t\tif (this._buffered_msg_queue.length > 0) {\n\t\t\t\t\t\tvar msg = null;\n\t\t\t\t\t\twhile ((msg = this._buffered_msg_queue.pop())) {\n\t\t\t\t\t\t\tsequencedMessages.push(msg);\n\t\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\t\tthis._notify_msg_sent[msg] = this.onMessageDelivered(msg.payloadMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sort sentMessages into the original sent order.\n\t\t\t\t\tvar sequencedMessages = sequencedMessages.sort(function(a,b) {return a.sequence - b.sequence;} );\n\t\t\t\t\tfor (var i=0, len=sequencedMessages.length; i<len; i++) {\n\t\t\t\t\t\tvar sentMessage = sequencedMessages[i];\n\t\t\t\t\t\tif (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {\n\t\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});\n\t\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._schedule_message(sentMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the connectOptions.onSuccess callback if there is one.\n\t\t\t\t\t// Will also now return if this connection was the result of an automatic\n\t\t\t\t\t// reconnect and which URI was successfully connected to.\n\t\t\t\t\tif (this.connectOptions.onSuccess) {\n\t\t\t\t\t\tthis.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar reconnected = false;\n\t\t\t\t\tif (this._reconnecting) {\n\t\t\t\t\t\treconnected = true;\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnecting = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the onConnected callback if there is one.\n\t\t\t\t\tthis._connected(reconnected, this._wsuri);\n\n\t\t\t\t\t// Process all queued messages now that the connection is established.\n\t\t\t\t\tthis._process_queue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t\tthis._receivePublish(wireMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBACK after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREC:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBREC after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tsentMessage.pubRecReceived = true;\n\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\t\tthis.store(\"Sent:\", sentMessage);\n\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\t\tvar receivedMessage = this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t// If this is a re flow of a PUBREL after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (receivedMessage) {\n\t\t\t\t\t\tthis._receiveMessage(receivedMessage);\n\t\t\t\t\t\tdelete this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\t// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.\n\t\t\t\t\tvar pubCompMessage = new WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\tthis._schedule_message(pubCompMessage);\n\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.SUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif(sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\t// This will need to be fixed when we add multiple topic support\n\t\t\t\t\t\tif (wireMessage.returnCode[0] === 0x80) {\n\t\t\t\t\t\t\tif (sentMessage.onFailure) {\n\t\t\t\t\t\t\t\tsentMessage.onFailure(wireMessage.returnCode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (sentMessage.onSuccess) {\n\t\t\t\t\t\t\tsentMessage.onSuccess(wireMessage.returnCode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.UNSUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif (sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\tif (sentMessage.callback) {\n\t\t\t\t\t\t\tsentMessage.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PINGRESP:\n\t\t\t\t/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */\n\t\t\t\t\tthis.sendPinger.reset();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\t// Clients do not expect to receive disconnect packets.\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_error = function (error) {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_close = function () {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._socket_send = function (wireMessage) {\n\n\t\t\tif (wireMessage.type == 1) {\n\t\t\t\tvar wireMessageMasked = this._traceMask(wireMessage, \"password\");\n\t\t\t\tthis._trace(\"Client._socket_send\", wireMessageMasked);\n\t\t\t}\n\t\t\telse this._trace(\"Client._socket_send\", wireMessage);\n\n\t\t\tthis.socket.send(wireMessage.encode());\n\t\t\t/* We have proved to the server we are alive. */\n\t\t\tthis.sendPinger.reset();\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receivePublish = function (wireMessage) {\n\t\t\tswitch(wireMessage.payloadMessage.qos) {\n\t\t\tcase \"undefined\":\n\t\t\tcase 0:\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\tvar pubAckMessage = new WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubAckMessage);\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t\tthis.store(\"Received:\", wireMessage);\n\t\t\t\tvar pubRecMessage = new WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubRecMessage);\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(\"Invaild qos=\" + wireMessage.payloadMessage.qos);\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receiveMessage = function (wireMessage) {\n\t\t\tif (this.onMessageArrived) {\n\t\t\t\tthis.onMessageArrived(wireMessage.payloadMessage);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has connected.\n\t * @param {reconnect} [boolean] indicate if this was a result of reconnect operation.\n\t * @param {uri} [string] fully qualified WebSocket URI of the server.\n\t */\n\t\tClientImpl.prototype._connected = function (reconnect, uri) {\n\t\t// Execute the onConnected callback if there is one.\n\t\t\tif (this.onConnected)\n\t\t\t\tthis.onConnected(reconnect, uri);\n\t\t};\n\n\t\t/**\n\t * Attempts to reconnect the client to the server.\n   * For each reconnect attempt, will double the reconnect interval\n   * up to 128 seconds.\n\t */\n\t\tClientImpl.prototype._reconnect = function () {\n\t\t\tthis._trace(\"Client._reconnect\");\n\t\t\tif (!this.connected) {\n\t\t\t\tthis._reconnecting = true;\n\t\t\t\tthis.sendPinger.cancel();\n\t\t\t\tthis.receivePinger.cancel();\n\t\t\t\tif (this._reconnectInterval < 128)\n\t\t\t\t\tthis._reconnectInterval = this._reconnectInterval * 2;\n\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has disconnected either at its own request or because the server\n\t * or network disconnected it. Remove all non-durable state.\n\t * @param {errorCode} [number] the error number.\n\t * @param {errorText} [string] the error text.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._disconnected = function (errorCode, errorText) {\n\t\t\tthis._trace(\"Client._disconnected\", errorCode, errorText);\n\n\t\t\tif (errorCode !== undefined && this._reconnecting) {\n\t\t\t\t//Continue automatic reconnect process\n\t\t\t\tthis._reconnectTimeout = new Timeout(this, this._reconnectInterval, this._reconnect);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendPinger.cancel();\n\t\t\tthis.receivePinger.cancel();\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\n\t\t\t// Clear message buffers.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\tif (this.socket) {\n\t\t\t// Cancel all socket callbacks so that they cannot be driven again by this socket.\n\t\t\t\tthis.socket.onopen = null;\n\t\t\t\tthis.socket.onmessage = null;\n\t\t\t\tthis.socket.onerror = null;\n\t\t\t\tthis.socket.onclose = null;\n\t\t\t\tif (this.socket.readyState === 1)\n\t\t\t\t\tthis.socket.close();\n\t\t\t\tdelete this.socket;\n\t\t\t}\n\n\t\t\tif (this.connectOptions.uris && this.hostIndex < this.connectOptions.uris.length-1) {\n\t\t\t// Try the next host.\n\t\t\t\tthis.hostIndex++;\n\t\t\t\tthis._doConnect(this.connectOptions.uris[this.hostIndex]);\n\t\t\t} else {\n\n\t\t\t\tif (errorCode === undefined) {\n\t\t\t\t\terrorCode = ERROR.OK.code;\n\t\t\t\t\terrorText = format(ERROR.OK);\n\t\t\t\t}\n\n\t\t\t\t// Run any application callbacks last as they may attempt to reconnect and hence create a new socket.\n\t\t\t\tif (this.connected) {\n\t\t\t\t\tthis.connected = false;\n\t\t\t\t\t// Execute the connectionLostCallback if there is one, and we were connected.\n\t\t\t\t\tif (this.onConnectionLost) {\n\t\t\t\t\t\tthis.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:this.connectOptions.reconnect, uri:this._wsuri});\n\t\t\t\t\t}\n\t\t\t\t\tif (errorCode !== ERROR.OK.code && this.connectOptions.reconnect) {\n\t\t\t\t\t// Start automatic reconnect process for the very first time since last successful connect.\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnect();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t// Otherwise we never had a connection, so indicate that the connect has failed.\n\t\t\t\t\tif (this.connectOptions.mqttVersion === 4 && this.connectOptions.mqttVersionExplicit === false) {\n\t\t\t\t\t\tthis._trace(\"Failed to connect V4, dropping back to V3\");\n\t\t\t\t\t\tthis.connectOptions.mqttVersion = 3;\n\t\t\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(this.connectOptions.onFailure) {\n\t\t\t\t\t\tthis.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._trace = function () {\n\t\t// Pass trace message back to client's callback function\n\t\t\tif (this.traceFunction) {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\tfor (var i in args)\n\t\t\t\t{\n\t\t\t\t\tif (typeof args[i] !== \"undefined\")\n\t\t\t\t\t\targs.splice(i, 1, JSON.stringify(args[i]));\n\t\t\t\t}\n\t\t\t\tvar record = args.join(\"\");\n\t\t\t\tthis.traceFunction ({severity: \"Debug\", message: record\t});\n\t\t\t}\n\n\t\t\t//buffer style trace\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tfor (var i = 0, max = arguments.length; i < max; i++) {\n\t\t\t\t\tif ( this._traceBuffer.length == this._MAX_TRACE_ENTRIES ) {\n\t\t\t\t\t\tthis._traceBuffer.shift();\n\t\t\t\t\t}\n\t\t\t\t\tif (i === 0) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse if (typeof arguments[i] === \"undefined\" ) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse this._traceBuffer.push(\"  \"+JSON.stringify(arguments[i]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._traceMask = function (traceObject, masked) {\n\t\t\tvar traceObjectMasked = {};\n\t\t\tfor (var attr in traceObject) {\n\t\t\t\tif (traceObject.hasOwnProperty(attr)) {\n\t\t\t\t\tif (attr == masked)\n\t\t\t\t\t\ttraceObjectMasked[attr] = \"******\";\n\t\t\t\t\telse\n\t\t\t\t\t\ttraceObjectMasked[attr] = traceObject[attr];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn traceObjectMasked;\n\t\t};\n\n\t\t// ------------------------------------------------------------------------\n\t\t// Public Programming interface.\n\t\t// ------------------------------------------------------------------------\n\n\t\t/**\n\t * The JavaScript application communicates to the server using a {@link Paho.Client} object.\n\t * <p>\n\t * Most applications will create just one Client object and then call its connect() method,\n\t * however applications can create more than one Client object if they wish.\n\t * In this case the combination of host, port and clientId attributes must be different for each Client object.\n\t * <p>\n\t * The send, subscribe and unsubscribe methods are implemented as asynchronous JavaScript methods\n\t * (even though the underlying protocol exchange might be synchronous in nature).\n\t * This means they signal their completion by calling back to the application,\n\t * via Success or Failure callback functions provided by the application on the method in question.\n\t * Such callbacks are called at most once per method invocation and do not persist beyond the lifetime\n\t * of the script that made the invocation.\n\t * <p>\n\t * In contrast there are some callback functions, most notably <i>onMessageArrived</i>,\n\t * that are defined on the {@link Paho.Client} object.\n\t * These may get called multiple times, and aren't directly related to specific method invocations made by the client.\n\t *\n\t * @name Paho.Client\n\t *\n\t * @constructor\n\t *\n\t * @param {string} host - the address of the messaging server, as a fully qualified WebSocket URI, as a DNS name or dotted decimal IP address.\n\t * @param {number} port - the port number to connect to - only required if host is not a URI\n\t * @param {string} path - the path on the host to connect to - only used if host is not a URI. Default: '/mqtt'.\n\t * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters in length.\n\t *\n\t * @property {string} host - <i>read only</i> the server's DNS hostname or dotted decimal IP address.\n\t * @property {number} port - <i>read only</i> the server's port.\n\t * @property {string} path - <i>read only</i> the server's path.\n\t * @property {string} clientId - <i>read only</i> used when connecting to the server.\n\t * @property {function} onConnectionLost - called when a connection has been lost.\n\t *                            after a connect() method has succeeded.\n\t *                            Establish the call back used when a connection has been lost. The connection may be\n\t *                            lost because the client initiates a disconnect or because the server or network\n\t *                            cause the client to be disconnected. The disconnect call back may be called without\n\t *                            the connectionComplete call back being invoked if, for example the client fails to\n\t *                            connect.\n\t *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:\n\t *                            <ol>\n\t *                            <li>errorCode\n\t *                            <li>errorMessage\n\t *                            </ol>\n\t * @property {function} onMessageDelivered - called when a message has been delivered.\n\t *                            All processing that this Client will ever do has been completed. So, for example,\n\t *                            in the case of a Qos=2 message sent by this client, the PubComp flow has been received from the server\n\t *                            and the message has been removed from persistent storage before this callback is invoked.\n\t *                            Parameters passed to the onMessageDelivered callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that was delivered.\n\t *                            </ol>\n\t * @property {function} onMessageArrived - called when a message has arrived in this Paho.client.\n\t *                            Parameters passed to the onMessageArrived callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that has arrived.\n\t *                            </ol>\n\t * @property {function} onConnected - called when a connection is successfully made to the server.\n\t *                                  after a connect() method.\n\t *                                  Parameters passed to the onConnected callback are:\n\t *                                  <ol>\n\t *                                  <li>reconnect (boolean) - If true, the connection was the result of a reconnect.</li>\n\t *                                  <li>URI (string) - The URI used to connect to the server.</li>\n\t *                                  </ol>\n\t * @property {boolean} disconnectedPublishing - if set, will enable disconnected publishing in\n\t *                                            in the event that the connection to the server is lost.\n\t * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected\n\t *                                             buffer will hold before rejecting new messages. Default size: 5000 messages\n\t * @property {function} trace - called whenever trace is called. TODO\n\t */\n\t\tvar Client = function (host, port, path, clientId) {\n\n\t\t\tvar uri;\n\n\t\t\tif (typeof host !== \"string\")\n\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof host, \"host\"]));\n\n\t\t\tif (arguments.length == 2) {\n\t\t\t// host: must be full ws:// uri\n\t\t\t// port: clientId\n\t\t\t\tclientId = port;\n\t\t\t\turi = host;\n\t\t\t\tvar match = uri.match(/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/);\n\t\t\t\tif (match) {\n\t\t\t\t\thost = match[4]||match[2];\n\t\t\t\t\tport = parseInt(match[7]);\n\t\t\t\t\tpath = match[8];\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[host,\"host\"]));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (arguments.length == 3) {\n\t\t\t\t\tclientId = path;\n\t\t\t\t\tpath = \"/mqtt\";\n\t\t\t\t}\n\t\t\t\tif (typeof port !== \"number\" || port < 0)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof port, \"port\"]));\n\t\t\t\tif (typeof path !== \"string\")\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof path, \"path\"]));\n\n\t\t\t\tvar ipv6AddSBracket = (host.indexOf(\":\") !== -1 && host.slice(0,1) !== \"[\" && host.slice(-1) !== \"]\");\n\t\t\t\turi = \"ws://\"+(ipv6AddSBracket?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t}\n\n\t\t\tvar clientIdLength = 0;\n\t\t\tfor (var i = 0; i<clientId.length; i++) {\n\t\t\t\tvar charCode = clientId.charCodeAt(i);\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)  {\n\t\t\t\t\ti++; // Surrogate pair.\n\t\t\t\t}\n\t\t\t\tclientIdLength++;\n\t\t\t}\n\t\t\tif (typeof clientId !== \"string\" || clientIdLength > 65535)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [clientId, \"clientId\"]));\n\n\t\t\tvar client = new ClientImpl(uri, host, port, path, clientId);\n\n\t\t\t//Public Properties\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"host\":{\n\t\t\t\t\tget: function() { return host; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"port\":{\n\t\t\t\t\tget: function() { return port; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"path\":{\n\t\t\t\t\tget: function() { return path; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"uri\":{\n\t\t\t\t\tget: function() { return uri; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"clientId\":{\n\t\t\t\t\tget: function() { return client.clientId; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"onConnected\":{\n\t\t\t\t\tget: function() { return client.onConnected; },\n\t\t\t\t\tset: function(newOnConnected) {\n\t\t\t\t\t\tif (typeof newOnConnected === \"function\")\n\t\t\t\t\t\t\tclient.onConnected = newOnConnected;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnected, \"onConnected\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedPublishing\":{\n\t\t\t\t\tget: function() { return client.disconnectedPublishing; },\n\t\t\t\t\tset: function(newDisconnectedPublishing) {\n\t\t\t\t\t\tclient.disconnectedPublishing = newDisconnectedPublishing;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedBufferSize\":{\n\t\t\t\t\tget: function() { return client.disconnectedBufferSize; },\n\t\t\t\t\tset: function(newDisconnectedBufferSize) {\n\t\t\t\t\t\tclient.disconnectedBufferSize = newDisconnectedBufferSize;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onConnectionLost\":{\n\t\t\t\t\tget: function() { return client.onConnectionLost; },\n\t\t\t\t\tset: function(newOnConnectionLost) {\n\t\t\t\t\t\tif (typeof newOnConnectionLost === \"function\")\n\t\t\t\t\t\t\tclient.onConnectionLost = newOnConnectionLost;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnectionLost, \"onConnectionLost\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageDelivered\":{\n\t\t\t\t\tget: function() { return client.onMessageDelivered; },\n\t\t\t\t\tset: function(newOnMessageDelivered) {\n\t\t\t\t\t\tif (typeof newOnMessageDelivered === \"function\")\n\t\t\t\t\t\t\tclient.onMessageDelivered = newOnMessageDelivered;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageDelivered, \"onMessageDelivered\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageArrived\":{\n\t\t\t\t\tget: function() { return client.onMessageArrived; },\n\t\t\t\t\tset: function(newOnMessageArrived) {\n\t\t\t\t\t\tif (typeof newOnMessageArrived === \"function\")\n\t\t\t\t\t\t\tclient.onMessageArrived = newOnMessageArrived;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageArrived, \"onMessageArrived\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"trace\":{\n\t\t\t\t\tget: function() { return client.traceFunction; },\n\t\t\t\t\tset: function(trace) {\n\t\t\t\t\t\tif(typeof trace === \"function\"){\n\t\t\t\t\t\t\tclient.traceFunction = trace;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof trace, \"onTrace\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t/**\n\t\t * Connect this Messaging client to its server.\n\t\t *\n\t\t * @name Paho.Client#connect\n\t\t * @function\n\t\t * @param {object} connectOptions - Attributes used with the connection.\n\t\t * @param {number} connectOptions.timeout - If the connect has not succeeded within this\n\t\t *                    number of seconds, it is deemed to have failed.\n\t\t *                    The default is 30 seconds.\n\t\t * @param {string} connectOptions.userName - Authentication username for this connection.\n\t\t * @param {string} connectOptions.password - Authentication password for this connection.\n\t\t * @param {Paho.Message} connectOptions.willMessage - sent by the server when the client\n\t\t *                    disconnects abnormally.\n\t\t * @param {number} connectOptions.keepAliveInterval - the server disconnects this client if\n\t\t *                    there is no activity for this number of seconds.\n\t\t *                    The default value of 60 seconds is assumed if not set.\n\t\t * @param {boolean} connectOptions.cleanSession - if true(default) the client and server\n\t\t *                    persistent state is deleted on successful connect.\n\t\t * @param {boolean} connectOptions.useSSL - if present and true, use an SSL Websocket connection.\n\t\t * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.\n\t\t * @param {function} connectOptions.onSuccess - called when the connect acknowledgement\n\t\t *                    has been received from the server.\n\t\t * A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onSuccess method in the connectOptions.\n\t\t * </ol>\n\t * @param {function} connectOptions.onFailure - called when the connect request has failed or timed out.\n\t\t * A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onFailure method in the connectOptions.\n\t\t * <li>errorCode a number indicating the nature of the error.\n\t\t * <li>errorMessage text describing the error.\n\t\t * </ol>\n\t * @param {array} connectOptions.hosts - If present this contains either a set of hostnames or fully qualified\n\t\t * WebSocket URIs (ws://iot.eclipse.org:80/ws), that are tried in order in place\n\t\t * of the host and port paramater on the construtor. The hosts are tried one at at time in order until\n\t\t * one of then succeeds.\n\t * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, this property\n\t\t * is not used.\n\t * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect\n\t * to the server if the connection is lost.\n\t *<ul>\n\t *<li>If set to false, the client will not attempt to automatically reconnect to the server in the event that the\n\t * connection is lost.</li>\n\t *<li>If set to true, in the event that the connection is lost, the client will attempt to reconnect to the server.\n\t * It will initially wait 1 second before it attempts to reconnect, for every failed reconnect attempt, the delay\n\t * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.</li>\n\t *</ul>\n\t * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.\n\t *<ul>\n\t *<li>3 - MQTT V3.1</li>\n\t *<li>4 - MQTT V3.1.1</li>\n\t *</ul>\n\t * @param {boolean} connectOptions.mqttVersionExplicit - If set to true, will force the connection to use the\n\t * selected MQTT Version or will fail to connect.\n\t * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris\n\t * (e.g. ws://iot.eclipse.org:80/ws), that are tried in order in place of the host and port parameter of the construtor.\n\t * The uris are tried one at a time in order until one of them succeeds. Do not use this in conjunction with hosts as\n\t * the hosts array will be converted to uris and will overwrite this property.\n\t\t * @throws {InvalidState} If the client is not in disconnected state. The client must have received connectionLost\n\t\t * or disconnected before calling connect for a second or subsequent time.\n\t\t */\n\t\t\tthis.connect = function (connectOptions) {\n\t\t\t\tconnectOptions = connectOptions || {} ;\n\t\t\t\tvalidate(connectOptions,  {timeout:\"number\",\n\t\t\t\t\tuserName:\"string\",\n\t\t\t\t\tpassword:\"string\",\n\t\t\t\t\twillMessage:\"object\",\n\t\t\t\t\tkeepAliveInterval:\"number\",\n\t\t\t\t\tcleanSession:\"boolean\",\n\t\t\t\t\tuseSSL:\"boolean\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\thosts:\"object\",\n\t\t\t\t\tports:\"object\",\n\t\t\t\t\treconnect:\"boolean\",\n\t\t\t\t\tmqttVersion:\"number\",\n\t\t\t\t\tmqttVersionExplicit:\"boolean\",\n\t\t\t\t\turis: \"object\"});\n\n\t\t\t\t// If no keep alive interval is set, assume 60 seconds.\n\t\t\t\tif (connectOptions.keepAliveInterval === undefined)\n\t\t\t\t\tconnectOptions.keepAliveInterval = 60;\n\n\t\t\t\tif (connectOptions.mqttVersion > 4 || connectOptions.mqttVersion < 3) {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, \"connectOptions.mqttVersion\"]));\n\t\t\t\t}\n\n\t\t\t\tif (connectOptions.mqttVersion === undefined) {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = false;\n\t\t\t\t\tconnectOptions.mqttVersion = 4;\n\t\t\t\t} else {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = true;\n\t\t\t\t}\n\n\t\t\t\t//Check that if password is set, so is username\n\t\t\t\tif (connectOptions.password !== undefined && connectOptions.userName === undefined)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, \"connectOptions.password\"]));\n\n\t\t\t\tif (connectOptions.willMessage) {\n\t\t\t\t\tif (!(connectOptions.willMessage instanceof Message))\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, \"connectOptions.willMessage\"]));\n\t\t\t\t\t// The will message must have a payload that can be represented as a string.\n\t\t\t\t\t// Cause the willMessage to throw an exception if this is not the case.\n\t\t\t\t\tconnectOptions.willMessage.stringPayload = null;\n\n\t\t\t\t\tif (typeof connectOptions.willMessage.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.willMessage.destinationName, \"connectOptions.willMessage.destinationName\"]));\n\t\t\t\t}\n\t\t\t\tif (typeof connectOptions.cleanSession === \"undefined\")\n\t\t\t\t\tconnectOptions.cleanSession = true;\n\t\t\t\tif (connectOptions.hosts) {\n\n\t\t\t\t\tif (!(connectOptions.hosts instanceof Array) )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\t\t\t\t\tif (connectOptions.hosts.length <1 )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\n\t\t\t\t\tvar usingURIs = false;\n\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\tif (typeof connectOptions.hosts[i] !== \"string\")\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\tif (/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/.test(connectOptions.hosts[i])) {\n\t\t\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\t\t\tusingURIs = true;\n\t\t\t\t\t\t\t} else if (!usingURIs) {\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (usingURIs) {\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!usingURIs) {\n\t\t\t\t\t\tif (!connectOptions.ports)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (!(connectOptions.ports instanceof Array) )\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (connectOptions.hosts.length !== connectOptions.ports.length)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\n\t\t\t\t\t\tconnectOptions.uris = [];\n\n\t\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\t\tif (typeof connectOptions.ports[i] !== \"number\" || connectOptions.ports[i] < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.ports[i], \"connectOptions.ports[\"+i+\"]\"]));\n\t\t\t\t\t\t\tvar host = connectOptions.hosts[i];\n\t\t\t\t\t\t\tvar port = connectOptions.ports[i];\n\n\t\t\t\t\t\t\tvar ipv6 = (host.indexOf(\":\") !== -1);\n\t\t\t\t\t\t\turi = \"ws://\"+(ipv6?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t\t\t\t\tconnectOptions.uris.push(uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconnectOptions.uris = connectOptions.hosts;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tclient.connect(connectOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Subscribe for messages, request receipt of a copy of messages sent to the destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#subscribe\n\t\t * @function\n\t\t * @param {string} filter describing the destinations to receive messages from.\n\t\t * <br>\n\t\t * @param {object} subscribeOptions - used to control the subscription\n\t\t *\n\t\t * @param {number} subscribeOptions.qos - the maximum qos of any publications sent\n\t\t *                                  as a result of making this subscription.\n\t\t * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t *                                  or onFailure callback.\n\t\t * @param {function} subscribeOptions.onSuccess - called when the subscribe acknowledgement\n\t\t *                                  has been received from the server.\n\t\t *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext if set in the subscribeOptions.\n\t\t *                                  </ol>\n\t\t * @param {function} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.\n\t\t *                                  A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext - if set in the subscribeOptions.\n\t\t *                                  <li>errorCode - a number indicating the nature of the error.\n\t\t *                                  <li>errorMessage - text describing the error.\n\t\t *                                  </ol>\n\t\t * @param {number} subscribeOptions.timeout - which, if present, determines the number of\n\t\t *                                  seconds after which the onFailure calback is called.\n\t\t *                                  The presence of a timeout does not prevent the onSuccess\n\t\t *                                  callback from being called when the subscribe completes.\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.subscribe = function (filter, subscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tsubscribeOptions = subscribeOptions || {} ;\n\t\t\t\tvalidate(subscribeOptions,  {qos:\"number\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (subscribeOptions.timeout && !subscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"subscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tif (typeof subscribeOptions.qos !== \"undefined\" && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, \"subscribeOptions.qos\"]));\n\t\t\t\tclient.subscribe(filter, subscribeOptions);\n\t\t\t};\n\n\t\t/**\n\t\t * Unsubscribe for messages, stop receiving messages sent to destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#unsubscribe\n\t\t * @function\n\t\t * @param {string} filter - describing the destinations to receive messages from.\n\t\t * @param {object} unsubscribeOptions - used to control the subscription\n\t\t * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t\t\t\t\t\t\t\t\t\t  or onFailure callback.\n\t\t * @param {function} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received from the server.\n\t\t *                                    A single response object parameter is passed to the\n\t\t *                                    onSuccess callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    </ol>\n\t\t * @param {function} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.\n\t\t *                                    A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    <li>errorCode - a number indicating the nature of the error.\n\t\t *                                    <li>errorMessage - text describing the error.\n\t\t *                                    </ol>\n\t\t * @param {number} unsubscribeOptions.timeout - which, if present, determines the number of seconds\n\t\t *                                    after which the onFailure callback is called. The presence of\n\t\t *                                    a timeout does not prevent the onSuccess callback from being\n\t\t *                                    called when the unsubscribe completes\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.unsubscribe = function (filter, unsubscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tunsubscribeOptions = unsubscribeOptions || {} ;\n\t\t\t\tvalidate(unsubscribeOptions,  {invocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"unsubscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tclient.unsubscribe(filter, unsubscribeOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Send a message to the consumers of the destination in the Message.\n\t\t *\n\t\t * @name Paho.Client#send\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the destination to which the message is to be sent.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be sent.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.send = function (topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Publish a message to the consumers of the destination in the Message.\n\t\t * Synonym for Paho.Mqtt.Client#send\n\t\t *\n\t\t * @name Paho.Client#publish\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the topic to which the message is to be published.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be published.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.publish = function(topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Normal disconnect of this Messaging client from its server.\n\t\t *\n\t\t * @name Paho.Client#disconnect\n\t\t * @function\n\t\t * @throws {InvalidState} if the client is already disconnected.\n\t\t */\n\t\t\tthis.disconnect = function () {\n\t\t\t\tclient.disconnect();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Get the contents of the trace log.\n\t\t *\n\t\t * @name Paho.Client#getTraceLog\n\t\t * @function\n\t\t * @return {Object[]} tracebuffer containing the time ordered trace records.\n\t\t */\n\t\t\tthis.getTraceLog = function () {\n\t\t\t\treturn client.getTraceLog();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Start tracing.\n\t\t *\n\t\t * @name Paho.Client#startTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.startTrace = function () {\n\t\t\t\tclient.startTrace();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Stop tracing.\n\t\t *\n\t\t * @name Paho.Client#stopTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.stopTrace = function () {\n\t\t\t\tclient.stopTrace();\n\t\t\t};\n\n\t\t\tthis.isConnected = function() {\n\t\t\t\treturn client.connected;\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * An application message, sent or received.\n\t * <p>\n\t * All attributes may be null, which implies the default values.\n\t *\n\t * @name Paho.Message\n\t * @constructor\n\t * @param {String|ArrayBuffer} payload The message data to be sent.\n\t * <p>\n\t * @property {string} payloadString <i>read only</i> The payload as a string if the payload consists of valid UTF-8 characters.\n\t * @property {ArrayBuffer} payloadBytes <i>read only</i> The payload as an ArrayBuffer.\n\t * <p>\n\t * @property {string} destinationName <b>mandatory</b> The name of the destination to which the message is to be sent\n\t *                    (for messages about to be sent) or the name of the destination from which the message has been received.\n\t *                    (for messages received by the onMessage function).\n\t * <p>\n\t * @property {number} qos The Quality of Service used to deliver the message.\n\t * <dl>\n\t *     <dt>0 Best effort (default).\n\t *     <dt>1 At least once.\n\t *     <dt>2 Exactly once.\n\t * </dl>\n\t * <p>\n\t * @property {Boolean} retained If true, the message is to be retained by the server and delivered\n\t *                     to both current and future subscriptions.\n\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t *                     A received message has the retained boolean set to true if the message was published\n\t *                     with the retained boolean set to true\n\t *                     and the subscrption was made after the message has been published.\n\t * <p>\n\t * @property {Boolean} duplicate <i>read only</i> If true, this message might be a duplicate of one which has already been received.\n\t *                     This is only set on messages received from the server.\n\t *\n\t */\n\t\tvar Message = function (newPayload) {\n\t\t\tvar payload;\n\t\t\tif (   typeof newPayload === \"string\" ||\n\t\tnewPayload instanceof ArrayBuffer ||\n\t\t(ArrayBuffer.isView(newPayload) && !(newPayload instanceof DataView))\n\t\t\t) {\n\t\t\t\tpayload = newPayload;\n\t\t\t} else {\n\t\t\t\tthrow (format(ERROR.INVALID_ARGUMENT, [newPayload, \"newPayload\"]));\n\t\t\t}\n\n\t\t\tvar destinationName;\n\t\t\tvar qos = 0;\n\t\t\tvar retained = false;\n\t\t\tvar duplicate = false;\n\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"payloadString\":{\n\t\t\t\t\tenumerable : true,\n\t\t\t\t\tget : function () {\n\t\t\t\t\t\tif (typeof payload === \"string\")\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn parseUTF8(payload, 0, payload.length);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"payloadBytes\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\tif (typeof payload === \"string\") {\n\t\t\t\t\t\t\tvar buffer = new ArrayBuffer(UTF8Length(payload));\n\t\t\t\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\t\t\t\tstringToUTF8(payload, byteStream, 0);\n\n\t\t\t\t\t\t\treturn byteStream;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"destinationName\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newDestinationName) {\n\t\t\t\t\t\tif (typeof newDestinationName === \"string\")\n\t\t\t\t\t\t\tdestinationName = newDestinationName;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, \"newDestinationName\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"qos\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return qos; },\n\t\t\t\t\tset: function(newQos) {\n\t\t\t\t\t\tif (newQos === 0 || newQos === 1 || newQos === 2 )\n\t\t\t\t\t\t\tqos = newQos;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+newQos);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"retained\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return retained; },\n\t\t\t\t\tset: function(newRetained) {\n\t\t\t\t\t\tif (typeof newRetained === \"boolean\")\n\t\t\t\t\t\t\tretained = newRetained;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newRetained, \"newRetained\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"topic\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newTopic) {destinationName=newTopic;}\n\t\t\t\t},\n\t\t\t\t\"duplicate\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return duplicate; },\n\t\t\t\t\tset: function(newDuplicate) {duplicate=newDuplicate;}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// Module contents.\n\t\treturn {\n\t\t\tClient: Client,\n\t\t\tMessage: Message\n\t\t};\n\t// eslint-disable-next-line no-nested-ternary\n\t})(typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {});\n\treturn PahoMQTT;\n});\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar punycode = require('punycode');\nvar util = require('./util');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n","'use strict';\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]]\n  ]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/uuidjs/uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","import zenObservable from 'zen-observable';\n\nvar Observable = zenObservable;\n\nexport default Observable;\nexport { Observable };\n//# sourceMappingURL=bundle.esm.js.map\n","module.exports = require('./lib/Observable.js').Observable;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Observable = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// === Symbol Support ===\nvar hasSymbols = function () {\n  return typeof Symbol === 'function';\n};\n\nvar hasSymbol = function (name) {\n  return hasSymbols() && Boolean(Symbol[name]);\n};\n\nvar getSymbol = function (name) {\n  return hasSymbol(name) ? Symbol[name] : '@@' + name;\n};\n\nif (hasSymbols() && !hasSymbol('observable')) {\n  Symbol.observable = Symbol('observable');\n}\n\nvar SymbolIterator = getSymbol('iterator');\nvar SymbolObservable = getSymbol('observable');\nvar SymbolSpecies = getSymbol('species'); // === Abstract Operations ===\n\nfunction getMethod(obj, key) {\n  var value = obj[key];\n  if (value == null) return undefined;\n  if (typeof value !== 'function') throw new TypeError(value + ' is not a function');\n  return value;\n}\n\nfunction getSpecies(obj) {\n  var ctor = obj.constructor;\n\n  if (ctor !== undefined) {\n    ctor = ctor[SymbolSpecies];\n\n    if (ctor === null) {\n      ctor = undefined;\n    }\n  }\n\n  return ctor !== undefined ? ctor : Observable;\n}\n\nfunction isObservable(x) {\n  return x instanceof Observable; // SPEC: Brand check\n}\n\nfunction hostReportError(e) {\n  if (hostReportError.log) {\n    hostReportError.log(e);\n  } else {\n    setTimeout(function () {\n      throw e;\n    });\n  }\n}\n\nfunction enqueue(fn) {\n  Promise.resolve().then(function () {\n    try {\n      fn();\n    } catch (e) {\n      hostReportError(e);\n    }\n  });\n}\n\nfunction cleanupSubscription(subscription) {\n  var cleanup = subscription._cleanup;\n  if (cleanup === undefined) return;\n  subscription._cleanup = undefined;\n\n  if (!cleanup) {\n    return;\n  }\n\n  try {\n    if (typeof cleanup === 'function') {\n      cleanup();\n    } else {\n      var unsubscribe = getMethod(cleanup, 'unsubscribe');\n\n      if (unsubscribe) {\n        unsubscribe.call(cleanup);\n      }\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n}\n\nfunction closeSubscription(subscription) {\n  subscription._observer = undefined;\n  subscription._queue = undefined;\n  subscription._state = 'closed';\n}\n\nfunction flushSubscription(subscription) {\n  var queue = subscription._queue;\n\n  if (!queue) {\n    return;\n  }\n\n  subscription._queue = undefined;\n  subscription._state = 'ready';\n\n  for (var i = 0; i < queue.length; ++i) {\n    notifySubscription(subscription, queue[i].type, queue[i].value);\n    if (subscription._state === 'closed') break;\n  }\n}\n\nfunction notifySubscription(subscription, type, value) {\n  subscription._state = 'running';\n  var observer = subscription._observer;\n\n  try {\n    var m = getMethod(observer, type);\n\n    switch (type) {\n      case 'next':\n        if (m) m.call(observer, value);\n        break;\n\n      case 'error':\n        closeSubscription(subscription);\n        if (m) m.call(observer, value);else throw value;\n        break;\n\n      case 'complete':\n        closeSubscription(subscription);\n        if (m) m.call(observer);\n        break;\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n\n  if (subscription._state === 'closed') cleanupSubscription(subscription);else if (subscription._state === 'running') subscription._state = 'ready';\n}\n\nfunction onNotify(subscription, type, value) {\n  if (subscription._state === 'closed') return;\n\n  if (subscription._state === 'buffering') {\n    subscription._queue.push({\n      type: type,\n      value: value\n    });\n\n    return;\n  }\n\n  if (subscription._state !== 'ready') {\n    subscription._state = 'buffering';\n    subscription._queue = [{\n      type: type,\n      value: value\n    }];\n    enqueue(function () {\n      return flushSubscription(subscription);\n    });\n    return;\n  }\n\n  notifySubscription(subscription, type, value);\n}\n\nvar Subscription =\n/*#__PURE__*/\nfunction () {\n  function Subscription(observer, subscriber) {\n    _classCallCheck(this, Subscription);\n\n    // ASSERT: observer is an object\n    // ASSERT: subscriber is callable\n    this._cleanup = undefined;\n    this._observer = observer;\n    this._queue = undefined;\n    this._state = 'initializing';\n    var subscriptionObserver = new SubscriptionObserver(this);\n\n    try {\n      this._cleanup = subscriber.call(undefined, subscriptionObserver);\n    } catch (e) {\n      subscriptionObserver.error(e);\n    }\n\n    if (this._state === 'initializing') this._state = 'ready';\n  }\n\n  _createClass(Subscription, [{\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      if (this._state !== 'closed') {\n        closeSubscription(this);\n        cleanupSubscription(this);\n      }\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._state === 'closed';\n    }\n  }]);\n\n  return Subscription;\n}();\n\nvar SubscriptionObserver =\n/*#__PURE__*/\nfunction () {\n  function SubscriptionObserver(subscription) {\n    _classCallCheck(this, SubscriptionObserver);\n\n    this._subscription = subscription;\n  }\n\n  _createClass(SubscriptionObserver, [{\n    key: \"next\",\n    value: function next(value) {\n      onNotify(this._subscription, 'next', value);\n    }\n  }, {\n    key: \"error\",\n    value: function error(value) {\n      onNotify(this._subscription, 'error', value);\n    }\n  }, {\n    key: \"complete\",\n    value: function complete() {\n      onNotify(this._subscription, 'complete');\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._subscription._state === 'closed';\n    }\n  }]);\n\n  return SubscriptionObserver;\n}();\n\nvar Observable =\n/*#__PURE__*/\nfunction () {\n  function Observable(subscriber) {\n    _classCallCheck(this, Observable);\n\n    if (!(this instanceof Observable)) throw new TypeError('Observable cannot be called as a function');\n    if (typeof subscriber !== 'function') throw new TypeError('Observable initializer must be a function');\n    this._subscriber = subscriber;\n  }\n\n  _createClass(Observable, [{\n    key: \"subscribe\",\n    value: function subscribe(observer) {\n      if (typeof observer !== 'object' || observer === null) {\n        observer = {\n          next: observer,\n          error: arguments[1],\n          complete: arguments[2]\n        };\n      }\n\n      return new Subscription(observer, this._subscriber);\n    }\n  }, {\n    key: \"forEach\",\n    value: function forEach(fn) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (typeof fn !== 'function') {\n          reject(new TypeError(fn + ' is not a function'));\n          return;\n        }\n\n        function done() {\n          subscription.unsubscribe();\n          resolve();\n        }\n\n        var subscription = _this.subscribe({\n          next: function (value) {\n            try {\n              fn(value, done);\n            } catch (e) {\n              reject(e);\n              subscription.unsubscribe();\n            }\n          },\n          error: reject,\n          complete: resolve\n        });\n      });\n    }\n  }, {\n    key: \"map\",\n    value: function map(fn) {\n      var _this2 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this2.subscribe({\n          next: function (value) {\n            try {\n              value = fn(value);\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(fn) {\n      var _this3 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this3.subscribe({\n          next: function (value) {\n            try {\n              if (!fn(value)) return;\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"reduce\",\n    value: function reduce(fn) {\n      var _this4 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      var hasSeed = arguments.length > 1;\n      var hasValue = false;\n      var seed = arguments[1];\n      var acc = seed;\n      return new C(function (observer) {\n        return _this4.subscribe({\n          next: function (value) {\n            var first = !hasValue;\n            hasValue = true;\n\n            if (!first || hasSeed) {\n              try {\n                acc = fn(acc, value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            } else {\n              acc = value;\n            }\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            if (!hasValue && !hasSeed) return observer.error(new TypeError('Cannot reduce an empty sequence'));\n            observer.next(acc);\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"concat\",\n    value: function concat() {\n      var _this5 = this;\n\n      for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\n        sources[_key] = arguments[_key];\n      }\n\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscription;\n        var index = 0;\n\n        function startNext(next) {\n          subscription = next.subscribe({\n            next: function (v) {\n              observer.next(v);\n            },\n            error: function (e) {\n              observer.error(e);\n            },\n            complete: function () {\n              if (index === sources.length) {\n                subscription = undefined;\n                observer.complete();\n              } else {\n                startNext(C.from(sources[index++]));\n              }\n            }\n          });\n        }\n\n        startNext(_this5);\n        return function () {\n          if (subscription) {\n            subscription.unsubscribe();\n            subscription = undefined;\n          }\n        };\n      });\n    }\n  }, {\n    key: \"flatMap\",\n    value: function flatMap(fn) {\n      var _this6 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscriptions = [];\n\n        var outer = _this6.subscribe({\n          next: function (value) {\n            if (fn) {\n              try {\n                value = fn(value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            }\n\n            var inner = C.from(value).subscribe({\n              next: function (value) {\n                observer.next(value);\n              },\n              error: function (e) {\n                observer.error(e);\n              },\n              complete: function () {\n                var i = subscriptions.indexOf(inner);\n                if (i >= 0) subscriptions.splice(i, 1);\n                completeIfDone();\n              }\n            });\n            subscriptions.push(inner);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            completeIfDone();\n          }\n        });\n\n        function completeIfDone() {\n          if (outer.closed && subscriptions.length === 0) observer.complete();\n        }\n\n        return function () {\n          subscriptions.forEach(function (s) {\n            return s.unsubscribe();\n          });\n          outer.unsubscribe();\n        };\n      });\n    }\n  }, {\n    key: SymbolObservable,\n    value: function () {\n      return this;\n    }\n  }], [{\n    key: \"from\",\n    value: function from(x) {\n      var C = typeof this === 'function' ? this : Observable;\n      if (x == null) throw new TypeError(x + ' is not an object');\n      var method = getMethod(x, SymbolObservable);\n\n      if (method) {\n        var observable = method.call(x);\n        if (Object(observable) !== observable) throw new TypeError(observable + ' is not an object');\n        if (isObservable(observable) && observable.constructor === C) return observable;\n        return new C(function (observer) {\n          return observable.subscribe(observer);\n        });\n      }\n\n      if (hasSymbol('iterator')) {\n        method = getMethod(x, SymbolIterator);\n\n        if (method) {\n          return new C(function (observer) {\n            enqueue(function () {\n              if (observer.closed) return;\n              var _iteratorNormalCompletion = true;\n              var _didIteratorError = false;\n              var _iteratorError = undefined;\n\n              try {\n                for (var _iterator = method.call(x)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  var _item = _step.value;\n                  observer.next(_item);\n                  if (observer.closed) return;\n                }\n              } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion && _iterator.return != null) {\n                    _iterator.return();\n                  }\n                } finally {\n                  if (_didIteratorError) {\n                    throw _iteratorError;\n                  }\n                }\n              }\n\n              observer.complete();\n            });\n          });\n        }\n      }\n\n      if (Array.isArray(x)) {\n        return new C(function (observer) {\n          enqueue(function () {\n            if (observer.closed) return;\n\n            for (var i = 0; i < x.length; ++i) {\n              observer.next(x[i]);\n              if (observer.closed) return;\n            }\n\n            observer.complete();\n          });\n        });\n      }\n\n      throw new TypeError(x + ' is not observable');\n    }\n  }, {\n    key: \"of\",\n    value: function of() {\n      for (var _len2 = arguments.length, items = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        items[_key2] = arguments[_key2];\n      }\n\n      var C = typeof this === 'function' ? this : Observable;\n      return new C(function (observer) {\n        enqueue(function () {\n          if (observer.closed) return;\n\n          for (var i = 0; i < items.length; ++i) {\n            observer.next(items[i]);\n            if (observer.closed) return;\n          }\n\n          observer.complete();\n        });\n      });\n    }\n  }, {\n    key: SymbolSpecies,\n    get: function () {\n      return this;\n    }\n  }]);\n\n  return Observable;\n}();\n\nexports.Observable = Observable;\n\nif (hasSymbols()) {\n  Object.defineProperty(Observable, Symbol('extensions'), {\n    value: {\n      symbol: SymbolObservable,\n      hostReportError: hostReportError\n    },\n    configurable: true\n  });\n}","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport Observable from 'zen-observable-ts';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nvar logger = new Logger('AWSAppSyncProvider');\nvar AWSAppSyncProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncProvider, _super);\n    function AWSAppSyncProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._topicClient = new Map();\n        _this._topicAlias = new Map();\n        return _this;\n    }\n    Object.defineProperty(AWSAppSyncProvider.prototype, \"endpoint\", {\n        get: function () {\n            throw new Error('Not supported');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncProvider';\n    };\n    AWSAppSyncProvider.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype._cleanUp = function (clientId) {\n        var _this = this;\n        var topicsForClient = Array.from(this._topicClient.entries())\n            .filter(function (_a) {\n            var _b = __read(_a, 2), c = _b[1];\n            return c.clientId === clientId;\n        })\n            .map(function (_a) {\n            var _b = __read(_a, 1), t = _b[0];\n            return t;\n        });\n        topicsForClient.forEach(function (t) { return _this._cleanUpForTopic(t); });\n    };\n    AWSAppSyncProvider.prototype._cleanUpForTopic = function (topic) {\n        this._topicClient.delete(topic);\n        this._topicAlias.delete(topic);\n    };\n    AWSAppSyncProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            var topicsForClient = Array.from(this._topicClient.entries())\n                .filter(function (_a) {\n                var _b = __read(_a, 2), c = _b[1];\n                return c.clientId === clientId;\n            })\n                .map(function (_a) {\n                var _b = __read(_a, 1), t = _b[0];\n                return t;\n            });\n            topicsForClient.forEach(function (topic) {\n                if (_this._topicObservers.has(topic)) {\n                    _this._topicObservers.get(topic).forEach(function (obs) {\n                        if (!obs.closed) {\n                            obs.error(args);\n                        }\n                    });\n                    _this._topicObservers.delete(topic);\n                }\n            });\n            this._cleanUp(clientId);\n        }\n    };\n    AWSAppSyncProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        return [4 /*yield*/, _super.prototype.disconnect.call(this, clientId)];\n                    case 2:\n                        _a.sent();\n                        this._cleanUp(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var result = new Observable(function (observer) {\n            var targetTopics = [].concat(topics);\n            logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, mqttConnections, newSubscriptions, newAliases, map;\n                var _this = this;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            // Add these topics to map\n                            targetTopics.forEach(function (t) {\n                                if (!_this._topicObservers.has(t)) {\n                                    _this._topicObservers.set(t, new Set());\n                                }\n                                _this._topicObservers.get(t).add(observer);\n                            });\n                            _a = options.mqttConnections, mqttConnections = _a === void 0 ? [] : _a, newSubscriptions = options.newSubscriptions;\n                            newAliases = Object.entries(newSubscriptions).map(function (_a) {\n                                var _b = __read(_a, 2), alias = _b[0], v = _b[1];\n                                return [v.topic, alias];\n                            });\n                            // Merge new aliases with old ones\n                            this._topicAlias = new Map(__spread(Array.from(this._topicAlias.entries()), newAliases));\n                            map = Object.entries(targetTopics.reduce(function (acc, elem) {\n                                var connectionInfoForTopic = mqttConnections.find(function (c) { return c.topics.indexOf(elem) > -1; });\n                                if (connectionInfoForTopic) {\n                                    var clientId = connectionInfoForTopic.client, url = connectionInfoForTopic.url;\n                                    if (!acc[clientId]) {\n                                        acc[clientId] = {\n                                            url: url,\n                                            topics: new Set(),\n                                        };\n                                    }\n                                    acc[clientId].topics.add(elem);\n                                }\n                                return acc;\n                            }, {}));\n                            // reconnect everything we have in the map\n                            return [4 /*yield*/, Promise.all(map.map(function (_a) {\n                                    var _b = __read(_a, 2), clientId = _b[0], _c = _b[1], url = _c.url, topics = _c.topics;\n                                    return __awaiter(_this, void 0, void 0, function () {\n                                        var client, err_1;\n                                        var _this = this;\n                                        return __generator(this, function (_d) {\n                                            switch (_d.label) {\n                                                case 0:\n                                                    client = null;\n                                                    _d.label = 1;\n                                                case 1:\n                                                    _d.trys.push([1, 3, , 4]);\n                                                    return [4 /*yield*/, this.connect(clientId, {\n                                                            clientId: clientId,\n                                                            url: url,\n                                                        })];\n                                                case 2:\n                                                    client = _d.sent();\n                                                    return [3 /*break*/, 4];\n                                                case 3:\n                                                    err_1 = _d.sent();\n                                                    observer.error({ message: 'Failed to connect', error: err_1 });\n                                                    observer.complete();\n                                                    return [2 /*return*/, undefined];\n                                                case 4:\n                                                    // subscribe to all topics for this client\n                                                    // store topic-client mapping\n                                                    topics.forEach(function (topic) {\n                                                        if (client.isConnected()) {\n                                                            client.subscribe(topic);\n                                                            _this._topicClient.set(topic, client);\n                                                        }\n                                                    });\n                                                    return [2 /*return*/, client];\n                                            }\n                                        });\n                                    });\n                                }))];\n                        case 1:\n                            // reconnect everything we have in the map\n                            _b.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                targetTopics.forEach(function (t) {\n                    var client = _this._topicClient.get(t);\n                    if (client && client.isConnected()) {\n                        client.unsubscribe(t);\n                        _this._topicClient.delete(t);\n                        if (!Array.from(_this._topicClient.values()).some(function (c) { return c === client; })) {\n                            _this.disconnect(client.clientId);\n                        }\n                    }\n                    _this._topicObservers.delete(t);\n                });\n            };\n        });\n        return Observable.from(result).map(function (value) {\n            var topic = _this.getTopicForValue(value);\n            var alias = _this._topicAlias.get(topic);\n            value.data = Object.entries(value.data).reduce(function (obj, _a) {\n                var _b = __read(_a, 2), origKey = _b[0], val = _b[1];\n                return ((obj[(alias || origKey)] = val), obj);\n            }, {});\n            return value;\n        });\n    };\n    return AWSAppSyncProvider;\n}(MqttOverWSProvider));\nexport { AWSAppSyncProvider };\n//# sourceMappingURL=AWSAppSyncProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport Observable from 'zen-observable-ts';\nimport { GraphQLError } from 'graphql';\nimport * as url from 'url';\nimport { v4 as uuid } from 'uuid';\nimport { Buffer } from 'buffer';\nimport { Logger, Credentials, Signer, Hub, Constants, USER_AGENT_HEADER, jitteredExponentialRetry, NonRetryableError, } from '@aws-amplify/core';\nimport Cache from '@aws-amplify/cache';\nimport Auth from '@aws-amplify/auth';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { CONTROL_MSG } from '../index';\nvar logger = new Logger('AWSAppSyncRealTimeProvider');\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' &&\n    typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nvar dispatchApiEvent = function (event, data, message) {\n    Hub.dispatch('api', { event: event, data: data, message: message }, 'PubSub', AMPLIFY_SYMBOL);\n};\nvar MAX_DELAY_MS = 5000;\nvar NON_RETRYABLE_CODES = [400, 401, 403];\nvar MESSAGE_TYPES;\n(function (MESSAGE_TYPES) {\n    /**\n     * Client -> Server message.\n     * This message type is the first message after handshake and this will initialize AWS AppSync RealTime communication\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_INIT\"] = \"connection_init\";\n    /**\n     * Server -> Client message\n     * This message type is in case there is an issue with AWS AppSync RealTime when establishing connection\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ERROR\"] = \"connection_error\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_CONNECTION_INIT message\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ACK\"] = \"connection_ack\";\n    /**\n     * Client -> Server message.\n     * This message type is for register subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_START\"] = \"start\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_START message\n     */\n    MESSAGE_TYPES[\"GQL_START_ACK\"] = \"start_ack\";\n    /**\n     * Server -> Client message.\n     * This message type is for subscription message from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_DATA\"] = \"data\";\n    /**\n     * Server -> Client message.\n     * This message type helps the client to know is still receiving messages from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_KEEP_ALIVE\"] = \"ka\";\n    /**\n     * Client -> Server message.\n     * This message type is for unregister subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_STOP\"] = \"stop\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_STOP message\n     */\n    MESSAGE_TYPES[\"GQL_COMPLETE\"] = \"complete\";\n    /**\n     * Server -> Client message.\n     * This message type is for sending error messages from AWS AppSync RealTime to the client\n     */\n    MESSAGE_TYPES[\"GQL_ERROR\"] = \"error\";\n})(MESSAGE_TYPES || (MESSAGE_TYPES = {}));\nvar SUBSCRIPTION_STATUS;\n(function (SUBSCRIPTION_STATUS) {\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"PENDING\"] = 0] = \"PENDING\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"CONNECTED\"] = 1] = \"CONNECTED\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"FAILED\"] = 2] = \"FAILED\";\n})(SUBSCRIPTION_STATUS || (SUBSCRIPTION_STATUS = {}));\nvar SOCKET_STATUS;\n(function (SOCKET_STATUS) {\n    SOCKET_STATUS[SOCKET_STATUS[\"CLOSED\"] = 0] = \"CLOSED\";\n    SOCKET_STATUS[SOCKET_STATUS[\"READY\"] = 1] = \"READY\";\n    SOCKET_STATUS[SOCKET_STATUS[\"CONNECTING\"] = 2] = \"CONNECTING\";\n})(SOCKET_STATUS || (SOCKET_STATUS = {}));\nvar AWS_APPSYNC_REALTIME_HEADERS = {\n    accept: 'application/json, text/javascript',\n    'content-encoding': 'amz-1.0',\n    'content-type': 'application/json; charset=UTF-8',\n};\n/**\n * Time in milleseconds to wait for GQL_CONNECTION_INIT message\n */\nvar CONNECTION_INIT_TIMEOUT = 15000;\n/**\n * Time in milleseconds to wait for GQL_START_ACK message\n */\nvar START_ACK_TIMEOUT = 15000;\n/**\n * Default Time in milleseconds to wait for GQL_CONNECTION_KEEP_ALIVE message\n */\nvar DEFAULT_KEEP_ALIVE_TIMEOUT = 5 * 60 * 1000;\nvar AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncRealTimeProvider, _super);\n    function AWSAppSyncRealTimeProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.socketStatus = SOCKET_STATUS.CLOSED;\n        _this.keepAliveTimeout = DEFAULT_KEEP_ALIVE_TIMEOUT;\n        _this.subscriptionObserverMap = new Map();\n        _this.promiseArray = [];\n        return _this;\n    }\n    AWSAppSyncRealTimeProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncRealTimeProvider';\n    };\n    AWSAppSyncRealTimeProvider.prototype.newClient = function () {\n        throw new Error('Not used here');\n    };\n    AWSAppSyncRealTimeProvider.prototype.publish = function (_topics, _msg, _options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype.subscribe = function (_topics, options) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint;\n        return new Observable(function (observer) {\n            if (!appSyncGraphqlEndpoint) {\n                observer.error({\n                    errors: [\n                        __assign({}, new GraphQLError(\"Subscribe only available for AWS AppSync endpoint\")),\n                    ],\n                });\n                observer.complete();\n            }\n            else {\n                var subscriptionId_1 = uuid();\n                _this._startSubscriptionWithAWSAppSyncRealTime({\n                    options: options,\n                    observer: observer,\n                    subscriptionId: subscriptionId_1,\n                });\n                return function () { return __awaiter(_this, void 0, void 0, function () {\n                    var subscriptionState, err_1;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                _a.trys.push([0, 2, 3, 4]);\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                return [4 /*yield*/, this._waitForSubscriptionToBeConnected(subscriptionId_1)];\n                            case 1:\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                _a.sent();\n                                subscriptionState = (this.subscriptionObserverMap.get(subscriptionId_1) || {}).subscriptionState;\n                                if (!subscriptionState) {\n                                    // subscription already unsubscribed\n                                    return [2 /*return*/];\n                                }\n                                if (subscriptionState === SUBSCRIPTION_STATUS.CONNECTED) {\n                                    this._sendUnsubscriptionMessage(subscriptionId_1);\n                                }\n                                else {\n                                    throw new Error('Subscription never connected');\n                                }\n                                return [3 /*break*/, 4];\n                            case 2:\n                                err_1 = _a.sent();\n                                logger.debug(\"Error while unsubscribing \" + err_1);\n                                return [3 /*break*/, 4];\n                            case 3:\n                                this._removeSubscriptionObserver(subscriptionId_1);\n                                return [7 /*endfinally*/];\n                            case 4: return [2 /*return*/];\n                        }\n                    });\n                }); };\n            }\n        });\n    };\n    Object.defineProperty(AWSAppSyncRealTimeProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncRealTimeProvider.prototype._startSubscriptionWithAWSAppSyncRealTime = function (_a) {\n        var options = _a.options, observer = _a.observer, subscriptionId = _a.subscriptionId;\n        return __awaiter(this, void 0, void 0, function () {\n            var appSyncGraphqlEndpoint, authenticationType, query, variables, apiKey, region, _b, graphql_headers, _c, additionalHeaders, subscriptionState, data, dataString, headerObj, _d, _e, subscriptionMessage, stringToAWSRealTime, err_2, _f, message, subscriptionFailedCallback_1, _g, subscriptionFailedCallback, subscriptionReadyCallback;\n            var _h;\n            var _this = this;\n            return __generator(this, function (_j) {\n                switch (_j.label) {\n                    case 0:\n                        appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint, authenticationType = options.authenticationType, query = options.query, variables = options.variables, apiKey = options.apiKey, region = options.region, _b = options.graphql_headers, graphql_headers = _b === void 0 ? function () { return ({}); } : _b, _c = options.additionalHeaders, additionalHeaders = _c === void 0 ? {} : _c;\n                        subscriptionState = SUBSCRIPTION_STATUS.PENDING;\n                        data = {\n                            query: query,\n                            variables: variables,\n                        };\n                        // Having a subscription id map will make it simple to forward messages received\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            query: query,\n                            variables: variables,\n                            subscriptionState: subscriptionState,\n                            startAckTimeoutId: null,\n                        });\n                        dataString = JSON.stringify(data);\n                        _d = [{}];\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                payload: dataString,\n                                canonicalUri: '',\n                                region: region,\n                            })];\n                    case 1:\n                        _e = [__assign.apply(void 0, _d.concat([(_j.sent())]))];\n                        return [4 /*yield*/, graphql_headers()];\n                    case 2:\n                        headerObj = __assign.apply(void 0, [__assign.apply(void 0, [__assign.apply(void 0, _e.concat([(_j.sent())])), additionalHeaders]), (_h = {}, _h[USER_AGENT_HEADER] = Constants.userAgent, _h)]);\n                        subscriptionMessage = {\n                            id: subscriptionId,\n                            payload: {\n                                data: dataString,\n                                extensions: {\n                                    authorization: __assign({}, headerObj),\n                                },\n                            },\n                            type: MESSAGE_TYPES.GQL_START,\n                        };\n                        stringToAWSRealTime = JSON.stringify(subscriptionMessage);\n                        _j.label = 3;\n                    case 3:\n                        _j.trys.push([3, 5, , 6]);\n                        return [4 /*yield*/, this._initializeWebSocketConnection({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                region: region,\n                            })];\n                    case 4:\n                        _j.sent();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_2 = _j.sent();\n                        logger.debug({ err: err_2 });\n                        _f = err_2.message, message = _f === void 0 ? '' : _f;\n                        observer.error({\n                            errors: [\n                                __assign({}, new GraphQLError(\"Connection failed: \" + message)),\n                            ],\n                        });\n                        observer.complete();\n                        subscriptionFailedCallback_1 = (this.subscriptionObserverMap.get(subscriptionId) || {}).subscriptionFailedCallback;\n                        // Notify concurrent unsubscription\n                        if (typeof subscriptionFailedCallback_1 === 'function') {\n                            subscriptionFailedCallback_1();\n                        }\n                        return [2 /*return*/];\n                    case 6:\n                        _g = this.subscriptionObserverMap.get(subscriptionId), subscriptionFailedCallback = _g.subscriptionFailedCallback, subscriptionReadyCallback = _g.subscriptionReadyCallback;\n                        // This must be done before sending the message in order to be listening immediately\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            subscriptionState: subscriptionState,\n                            variables: variables,\n                            query: query,\n                            subscriptionReadyCallback: subscriptionReadyCallback,\n                            subscriptionFailedCallback: subscriptionFailedCallback,\n                            startAckTimeoutId: setTimeout(function () {\n                                _this._timeoutStartSubscriptionAck.call(_this, subscriptionId);\n                            }, START_ACK_TIMEOUT),\n                        });\n                        this.awsRealTimeSocket.send(stringToAWSRealTime);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // Waiting that subscription has been connected before trying to unsubscribe\n    AWSAppSyncRealTimeProvider.prototype._waitForSubscriptionToBeConnected = function (subscriptionId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var subscriptionState;\n            var _this = this;\n            return __generator(this, function (_a) {\n                subscriptionState = this.subscriptionObserverMap.get(subscriptionId).subscriptionState;\n                // This in case unsubscribe is invoked before sending start subscription message\n                if (subscriptionState === SUBSCRIPTION_STATUS.PENDING) {\n                    return [2 /*return*/, new Promise(function (res, rej) {\n                            var _a = _this.subscriptionObserverMap.get(subscriptionId), observer = _a.observer, subscriptionState = _a.subscriptionState, variables = _a.variables, query = _a.query;\n                            _this.subscriptionObserverMap.set(subscriptionId, {\n                                observer: observer,\n                                subscriptionState: subscriptionState,\n                                variables: variables,\n                                query: query,\n                                subscriptionReadyCallback: res,\n                                subscriptionFailedCallback: rej,\n                            });\n                        })];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._sendUnsubscriptionMessage = function (subscriptionId) {\n        try {\n            if (this.awsRealTimeSocket &&\n                this.awsRealTimeSocket.readyState === WebSocket.OPEN &&\n                this.socketStatus === SOCKET_STATUS.READY) {\n                // Preparing unsubscribe message to stop receiving messages for that subscription\n                var unsubscribeMessage = {\n                    id: subscriptionId,\n                    type: MESSAGE_TYPES.GQL_STOP,\n                };\n                var stringToAWSRealTime = JSON.stringify(unsubscribeMessage);\n                this.awsRealTimeSocket.send(stringToAWSRealTime);\n            }\n        }\n        catch (err) {\n            // If GQL_STOP is not sent because of disconnection issue, then there is nothing the client can do\n            logger.debug({ err: err });\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._removeSubscriptionObserver = function (subscriptionId) {\n        this.subscriptionObserverMap.delete(subscriptionId);\n        // Verifying 1000ms after removing subscription in case there are new subscription unmount/mount\n        setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n    };\n    AWSAppSyncRealTimeProvider.prototype._closeSocketIfRequired = function () {\n        if (this.subscriptionObserverMap.size > 0) {\n            // Active subscriptions on the WebSocket\n            return;\n        }\n        if (!this.awsRealTimeSocket) {\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n            return;\n        }\n        if (this.awsRealTimeSocket.bufferedAmount > 0) {\n            // Still data on the WebSocket\n            setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n        }\n        else {\n            logger.debug('closing WebSocket...');\n            clearTimeout(this.keepAliveTimeoutId);\n            var tempSocket = this.awsRealTimeSocket;\n            // Cleaning callbacks to avoid race condition, socket still exists\n            tempSocket.onclose = undefined;\n            tempSocket.onerror = undefined;\n            tempSocket.close(1000);\n            this.awsRealTimeSocket = null;\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._handleIncomingSubscriptionMessage = function (message) {\n        logger.debug(\"subscription message from AWS AppSync RealTime: \" + message.data);\n        var _a = JSON.parse(message.data), _b = _a.id, id = _b === void 0 ? '' : _b, payload = _a.payload, type = _a.type;\n        var _c = this.subscriptionObserverMap.get(id) || {}, _d = _c.observer, observer = _d === void 0 ? null : _d, _e = _c.query, query = _e === void 0 ? '' : _e, _f = _c.variables, variables = _f === void 0 ? {} : _f, startAckTimeoutId = _c.startAckTimeoutId, subscriptionReadyCallback = _c.subscriptionReadyCallback, subscriptionFailedCallback = _c.subscriptionFailedCallback;\n        logger.debug({ id: id, observer: observer, query: query, variables: variables });\n        if (type === MESSAGE_TYPES.GQL_DATA && payload && payload.data) {\n            if (observer) {\n                observer.next(payload);\n            }\n            else {\n                logger.debug(\"observer not found for id: \" + id);\n            }\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_START_ACK) {\n            logger.debug(\"subscription ready for \" + JSON.stringify({ query: query, variables: variables }));\n            if (typeof subscriptionReadyCallback === 'function') {\n                subscriptionReadyCallback();\n            }\n            clearTimeout(startAckTimeoutId);\n            dispatchApiEvent(CONTROL_MSG.SUBSCRIPTION_ACK, { query: query, variables: variables }, 'Connection established for subscription');\n            var subscriptionState = SUBSCRIPTION_STATUS.CONNECTED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: null,\n                subscriptionState: subscriptionState,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n            });\n            // TODO: emit event on hub but it requires to store the id first\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_CONNECTION_KEEP_ALIVE) {\n            clearTimeout(this.keepAliveTimeoutId);\n            this.keepAliveTimeoutId = setTimeout(this._errorDisconnect.bind(this, CONTROL_MSG.TIMEOUT_DISCONNECT), this.keepAliveTimeout);\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_ERROR) {\n            var subscriptionState = SUBSCRIPTION_STATUS.FAILED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: startAckTimeoutId,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n                subscriptionState: subscriptionState,\n            });\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(\"Connection failed: \" + JSON.stringify(payload))),\n                ],\n            });\n            clearTimeout(startAckTimeoutId);\n            observer.complete();\n            if (typeof subscriptionFailedCallback === 'function') {\n                subscriptionFailedCallback();\n            }\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._errorDisconnect = function (msg) {\n        logger.debug(\"Disconnect error: \" + msg);\n        this.subscriptionObserverMap.forEach(function (_a) {\n            var observer = _a.observer;\n            if (!observer.closed) {\n                observer.error({\n                    errors: [__assign({}, new GraphQLError(msg))],\n                });\n            }\n        });\n        this.subscriptionObserverMap.clear();\n        if (this.awsRealTimeSocket) {\n            this.awsRealTimeSocket.close();\n        }\n        this.socketStatus = SOCKET_STATUS.CLOSED;\n    };\n    AWSAppSyncRealTimeProvider.prototype._timeoutStartSubscriptionAck = function (subscriptionId) {\n        var _a = this.subscriptionObserverMap.get(subscriptionId) || {}, observer = _a.observer, query = _a.query, variables = _a.variables;\n        if (!observer) {\n            return;\n        }\n        this.subscriptionObserverMap.set(subscriptionId, {\n            observer: observer,\n            query: query,\n            variables: variables,\n            subscriptionState: SUBSCRIPTION_STATUS.FAILED,\n        });\n        if (observer && !observer.closed) {\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(\"Subscription timeout \" + JSON.stringify({ query: query, variables: variables }))),\n                ],\n            });\n            // Cleanup will be automatically executed\n            observer.complete();\n        }\n        logger.debug('timeoutStartSubscription', JSON.stringify({ query: query, variables: variables }));\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeWebSocketConnection = function (_a) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, authenticationType = _a.authenticationType, apiKey = _a.apiKey, region = _a.region;\n        if (this.socketStatus === SOCKET_STATUS.READY) {\n            return;\n        }\n        return new Promise(function (res, rej) { return __awaiter(_this, void 0, void 0, function () {\n            var protocol, discoverableEndpoint, payloadString, headerString, _a, _b, headerQs, payloadQs, awsRealTimeUrl, err_3;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this.promiseArray.push({ res: res, rej: rej });\n                        if (!(this.socketStatus === SOCKET_STATUS.CLOSED)) return [3 /*break*/, 5];\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 4, , 5]);\n                        this.socketStatus = SOCKET_STATUS.CONNECTING;\n                        protocol = this.isSSLEnabled ? 'wss://' : 'ws://';\n                        discoverableEndpoint = appSyncGraphqlEndpoint\n                            .replace('https://', protocol)\n                            .replace('http://', protocol)\n                            .replace('appsync-api', 'appsync-realtime-api')\n                            .replace('gogi-beta', 'grt-beta');\n                        payloadString = '{}';\n                        _b = (_a = JSON).stringify;\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                authenticationType: authenticationType,\n                                payload: payloadString,\n                                canonicalUri: '/connect',\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                region: region,\n                            })];\n                    case 2:\n                        headerString = _b.apply(_a, [_c.sent()]);\n                        headerQs = Buffer.from(headerString).toString('base64');\n                        payloadQs = Buffer.from(payloadString).toString('base64');\n                        awsRealTimeUrl = discoverableEndpoint + \"?header=\" + headerQs + \"&payload=\" + payloadQs;\n                        return [4 /*yield*/, this._initializeRetryableHandshake({ awsRealTimeUrl: awsRealTimeUrl })];\n                    case 3:\n                        _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var res = _a.res;\n                            logger.debug('Notifying connection successful');\n                            res();\n                        });\n                        this.socketStatus = SOCKET_STATUS.READY;\n                        this.promiseArray = [];\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_3 = _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var rej = _a.rej;\n                            return rej(err_3);\n                        });\n                        this.promiseArray = [];\n                        if (this.awsRealTimeSocket &&\n                            this.awsRealTimeSocket.readyState === WebSocket.OPEN) {\n                            this.awsRealTimeSocket.close(3001);\n                        }\n                        this.awsRealTimeSocket = null;\n                        this.socketStatus = SOCKET_STATUS.CLOSED;\n                        throw err_3;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        }); });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeRetryableHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializaling retryable Handshake\");\n                        return [4 /*yield*/, jitteredExponentialRetry(this._initializeHandshake.bind(this), [{ awsRealTimeUrl: awsRealTimeUrl }], MAX_DELAY_MS)];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            var err_4, errorType, errorCode;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializing handshake \" + awsRealTimeUrl);\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, , 5]);\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var newSocket = new WebSocket(awsRealTimeUrl, 'graphql-ws');\n                                    newSocket.onerror = function () {\n                                        logger.debug(\"WebSocket connection error\");\n                                    };\n                                    newSocket.onclose = function () {\n                                        rej(new Error('Connection handshake error'));\n                                    };\n                                    newSocket.onopen = function () {\n                                        _this.awsRealTimeSocket = newSocket;\n                                        return res();\n                                    };\n                                });\n                            })()];\n                    case 2:\n                        _b.sent();\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var ackOk = false;\n                                    _this.awsRealTimeSocket.onerror = function (error) {\n                                        logger.debug(\"WebSocket error \" + JSON.stringify(error));\n                                    };\n                                    _this.awsRealTimeSocket.onclose = function (event) {\n                                        logger.debug(\"WebSocket closed \" + event.reason);\n                                        rej(new Error(JSON.stringify(event)));\n                                    };\n                                    _this.awsRealTimeSocket.onmessage = function (message) {\n                                        logger.debug(\"subscription message from AWS AppSyncRealTime: \" + message.data + \" \");\n                                        var data = JSON.parse(message.data);\n                                        var type = data.type, _a = data.payload, _b = (_a === void 0 ? {} : _a).connectionTimeoutMs, connectionTimeoutMs = _b === void 0 ? DEFAULT_KEEP_ALIVE_TIMEOUT : _b;\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ACK) {\n                                            ackOk = true;\n                                            _this.keepAliveTimeout = connectionTimeoutMs;\n                                            _this.awsRealTimeSocket.onmessage = _this._handleIncomingSubscriptionMessage.bind(_this);\n                                            _this.awsRealTimeSocket.onerror = function (err) {\n                                                logger.debug(err);\n                                                _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);\n                                            };\n                                            res('Cool, connected to AWS AppSyncRealTime');\n                                            return;\n                                        }\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ERROR) {\n                                            var _c = data.payload, _d = (_c === void 0 ? {} : _c).errors, _e = __read(_d === void 0 ? [] : _d, 1), _f = _e[0], _g = _f === void 0 ? {} : _f, _h = _g.errorType, errorType = _h === void 0 ? '' : _h, _j = _g.errorCode, errorCode = _j === void 0 ? 0 : _j;\n                                            rej({ errorType: errorType, errorCode: errorCode });\n                                        }\n                                    };\n                                    var gqlInit = {\n                                        type: MESSAGE_TYPES.GQL_CONNECTION_INIT,\n                                    };\n                                    _this.awsRealTimeSocket.send(JSON.stringify(gqlInit));\n                                    function checkAckOk() {\n                                        if (!ackOk) {\n                                            rej(new Error(\"Connection timeout: ack from AWSRealTime was not received on \" + CONNECTION_INIT_TIMEOUT + \" ms\"));\n                                        }\n                                    }\n                                    setTimeout(checkAckOk.bind(_this), CONNECTION_INIT_TIMEOUT);\n                                });\n                            })()];\n                    case 3:\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        _b.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_4 = _b.sent();\n                        errorType = err_4.errorType, errorCode = err_4.errorCode;\n                        if (NON_RETRYABLE_CODES.includes(errorCode)) {\n                            throw new NonRetryableError(errorType);\n                        }\n                        else if (errorType) {\n                            throw new Error(errorType);\n                        }\n                        else {\n                            throw err_4;\n                        }\n                        return [3 /*break*/, 5];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeHeaderBasedAuth = function (_a) {\n        var authenticationType = _a.authenticationType, payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, apiKey = _a.apiKey, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var headerHandler, handler, host, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        headerHandler = {\n                            API_KEY: this._awsRealTimeApiKeyHeader.bind(this),\n                            AWS_IAM: this._awsRealTimeIAMHeader.bind(this),\n                            OPENID_CONNECT: this._awsRealTimeOPENIDHeader.bind(this),\n                            AMAZON_COGNITO_USER_POOLS: this._awsRealTimeCUPHeader.bind(this),\n                        };\n                        handler = headerHandler[authenticationType];\n                        if (typeof handler !== 'function') {\n                            logger.debug(\"Authentication type \" + authenticationType + \" not supported\");\n                            return [2 /*return*/, ''];\n                        }\n                        host = url.parse(appSyncGraphqlEndpoint).host;\n                        return [4 /*yield*/, handler({\n                                payload: payload,\n                                canonicalUri: canonicalUri,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                apiKey: apiKey,\n                                region: region,\n                                host: host,\n                            })];\n                    case 1:\n                        result = _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeCUPHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var session;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Auth.currentSession()];\n                    case 1:\n                        session = _b.sent();\n                        return [2 /*return*/, {\n                                Authorization: session.getAccessToken().getJwtToken(),\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeOPENIDHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var federatedInfo;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Cache.getItem('federatedInfo')];\n                    case 1:\n                        federatedInfo = _b.sent();\n                        if (!federatedInfo || !federatedInfo.token) {\n                            throw new Error('No federated jwt');\n                        }\n                        return [2 /*return*/, {\n                                Authorization: federatedInfo.token,\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeApiKeyHeader = function (_a) {\n        var apiKey = _a.apiKey, host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var dt, dtStr;\n            return __generator(this, function (_b) {\n                dt = new Date();\n                dtStr = dt.toISOString().replace(/[:\\-]|\\.\\d{3}/g, '');\n                return [2 /*return*/, {\n                        host: host,\n                        'x-amz-date': dtStr,\n                        'x-api-key': apiKey,\n                    }];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeIAMHeader = function (_a) {\n        var payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var endpointInfo, credentialsOK, creds, request, signed_params;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        endpointInfo = {\n                            region: region,\n                            service: 'appsync',\n                        };\n                        return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _b.sent();\n                        if (!credentialsOK) {\n                            throw new Error('No credentials');\n                        }\n                        return [4 /*yield*/, Credentials.get().then(function (credentials) { return ({\n                                secret_key: credentials.secretAccessKey,\n                                access_key: credentials.accessKeyId,\n                                session_token: credentials.sessionToken,\n                            }); })];\n                    case 2:\n                        creds = _b.sent();\n                        request = {\n                            url: \"\" + appSyncGraphqlEndpoint + canonicalUri,\n                            data: payload,\n                            method: 'POST',\n                            headers: __assign({}, AWS_APPSYNC_REALTIME_HEADERS),\n                        };\n                        signed_params = Signer.sign(request, creds, endpointInfo);\n                        return [2 /*return*/, signed_params.headers];\n                }\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    AWSAppSyncRealTimeProvider.prototype._ensureCredentials = function () {\n        return Credentials.get()\n            .then(function (credentials) {\n            if (!credentials)\n                return false;\n            var cred = Credentials.shear(credentials);\n            logger.debug('set credentials for AWSAppSyncRealTimeProvider', cred);\n            return true;\n        })\n            .catch(function (err) {\n            logger.warn('ensure credentials error', err);\n            return false;\n        });\n    };\n    return AWSAppSyncRealTimeProvider;\n}(AbstractPubSubProvider));\nexport { AWSAppSyncRealTimeProvider };\n//# sourceMappingURL=AWSAppSyncRealTimeProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nimport { Signer, Credentials } from '@aws-amplify/core';\nvar SERVICE_NAME = 'iotdevicegateway';\nvar AWSIoTProvider = /** @class */ (function (_super) {\n    __extends(AWSIoTProvider, _super);\n    function AWSIoTProvider() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(AWSIoTProvider.prototype, \"region\", {\n        get: function () {\n            return this.options.aws_pubsub_region;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSIoTProvider.prototype.getProviderName = function () {\n        return 'AWSIoTProvider';\n    };\n    Object.defineProperty(AWSIoTProvider.prototype, \"endpoint\", {\n        get: function () {\n            var _this = this;\n            return (function () { return __awaiter(_this, void 0, void 0, function () {\n                var endpoint, serviceInfo, _a, access_key, secret_key, session_token, result;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            endpoint = this.options.aws_pubsub_endpoint;\n                            serviceInfo = {\n                                service: SERVICE_NAME,\n                                region: this.region,\n                            };\n                            return [4 /*yield*/, Credentials.get()];\n                        case 1:\n                            _a = _b.sent(), access_key = _a.accessKeyId, secret_key = _a.secretAccessKey, session_token = _a.sessionToken;\n                            result = Signer.signUrl(endpoint, { access_key: access_key, secret_key: secret_key, session_token: session_token }, serviceInfo);\n                            return [2 /*return*/, result];\n                    }\n                });\n            }); })();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AWSIoTProvider;\n}(MqttOverWSProvider));\nexport { AWSIoTProvider };\n//# sourceMappingURL=AWSIotProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport * as Paho from 'paho-mqtt';\nimport { v4 as uuid } from 'uuid';\nimport Observable from 'zen-observable-ts';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('MqttOverWSProvider');\nexport function mqttTopicMatch(filter, topic) {\n    var filterArray = filter.split('/');\n    var length = filterArray.length;\n    var topicArray = topic.split('/');\n    for (var i = 0; i < length; ++i) {\n        var left = filterArray[i];\n        var right = topicArray[i];\n        if (left === '#')\n            return topicArray.length >= length;\n        if (left !== '+' && left !== right)\n            return false;\n    }\n    return length === topicArray.length;\n}\nvar ClientsQueue = /** @class */ (function () {\n    function ClientsQueue() {\n        this.promises = new Map();\n    }\n    ClientsQueue.prototype.get = function (clientId, clientFactory) {\n        return __awaiter(this, void 0, void 0, function () {\n            var promise;\n            return __generator(this, function (_a) {\n                promise = this.promises.get(clientId);\n                if (promise) {\n                    return [2 /*return*/, promise];\n                }\n                promise = clientFactory(clientId);\n                this.promises.set(clientId, promise);\n                return [2 /*return*/, promise];\n            });\n        });\n    };\n    Object.defineProperty(ClientsQueue.prototype, \"allClients\", {\n        get: function () {\n            return Array.from(this.promises.keys());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ClientsQueue.prototype.remove = function (clientId) {\n        this.promises.delete(clientId);\n    };\n    return ClientsQueue;\n}());\nvar topicSymbol = typeof Symbol !== 'undefined' ? Symbol('topic') : '@@topic';\nvar MqttOverWSProvider = /** @class */ (function (_super) {\n    __extends(MqttOverWSProvider, _super);\n    function MqttOverWSProvider(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, __assign(__assign({}, options), { clientId: options.clientId || uuid() })) || this;\n        _this._clientsQueue = new ClientsQueue();\n        _this._topicObservers = new Map();\n        _this._clientIdObservers = new Map();\n        return _this;\n    }\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientId\", {\n        get: function () {\n            return this.options.clientId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"endpoint\", {\n        get: function () {\n            return this.options.aws_pubsub_endpoint;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientsQueue\", {\n        get: function () {\n            return this._clientsQueue;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MqttOverWSProvider.prototype.getTopicForValue = function (value) {\n        return typeof value === 'object' && value[topicSymbol];\n    };\n    MqttOverWSProvider.prototype.getProviderName = function () {\n        return 'MqttOverWSProvider';\n    };\n    MqttOverWSProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            logger.warn(clientId, JSON.stringify(__assign({ errorCode: errorCode }, args), null, 2));\n            var topicsToDelete_1 = [];\n            var clientIdObservers = this._clientIdObservers.get(clientId);\n            if (!clientIdObservers) {\n                return;\n            }\n            clientIdObservers.forEach(function (observer) {\n                observer.error('Disconnected, error code: ' + errorCode);\n                // removing observers for disconnected clientId\n                _this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                    observerForTopic.delete(observer);\n                    if (observerForTopic.size === 0) {\n                        topicsToDelete_1.push(observerTopic);\n                    }\n                });\n            });\n            // forgiving any trace of clientId\n            this._clientIdObservers.delete(clientId);\n            // Removing topics that are not listen by an observer\n            topicsToDelete_1.forEach(function (topic) {\n                _this._topicObservers.delete(topic);\n            });\n        }\n    };\n    MqttOverWSProvider.prototype.newClient = function (_a) {\n        var url = _a.url, clientId = _a.clientId;\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug('Creating new MQTT client', clientId);\n                        client = new Paho.Client(url, clientId);\n                        // client.trace = (args) => logger.debug(clientId, JSON.stringify(args, null, 2));\n                        client.onMessageArrived = function (_a) {\n                            var topic = _a.destinationName, msg = _a.payloadString;\n                            _this._onMessage(topic, msg);\n                        };\n                        client.onConnectionLost = function (_a) {\n                            var errorCode = _a.errorCode, args = __rest(_a, [\"errorCode\"]);\n                            _this.onDisconnect(__assign({ clientId: clientId, errorCode: errorCode }, args));\n                        };\n                        return [4 /*yield*/, new Promise(function (resolve, reject) {\n                                client.connect({\n                                    useSSL: _this.isSSLEnabled,\n                                    mqttVersion: 3,\n                                    onSuccess: function () { return resolve(client); },\n                                    onFailure: reject,\n                                });\n                            })];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/, client];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.connect = function (clientId, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function (clientId) {\n                            return _this.newClient(__assign(__assign({}, options), { clientId: clientId }));\n                        })];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        if (client && client.isConnected()) {\n                            client.disconnect();\n                        }\n                        this.clientsQueue.remove(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.publish = function (topics, msg) {\n        return __awaiter(this, void 0, void 0, function () {\n            var targetTopics, message, url, client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        targetTopics = [].concat(topics);\n                        message = JSON.stringify(msg);\n                        return [4 /*yield*/, this.endpoint];\n                    case 1:\n                        url = _a.sent();\n                        return [4 /*yield*/, this.connect(this.clientId, { url: url })];\n                    case 2:\n                        client = _a.sent();\n                        logger.debug('Publishing to topic(s)', targetTopics.join(','), message);\n                        targetTopics.forEach(function (topic) { return client.send(topic, message); });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype._onMessage = function (topic, msg) {\n        try {\n            var matchedTopicObservers_1 = [];\n            this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                if (mqttTopicMatch(observerTopic, topic)) {\n                    matchedTopicObservers_1.push(observerForTopic);\n                }\n            });\n            var parsedMessage_1 = JSON.parse(msg);\n            if (typeof parsedMessage_1 === 'object') {\n                parsedMessage_1[topicSymbol] = topic;\n            }\n            matchedTopicObservers_1.forEach(function (observersForTopic) {\n                observersForTopic.forEach(function (observer) { return observer.next(parsedMessage_1); });\n            });\n        }\n        catch (error) {\n            logger.warn('Error handling message', error, msg);\n        }\n    };\n    MqttOverWSProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var targetTopics = [].concat(topics);\n        logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n        return new Observable(function (observer) {\n            targetTopics.forEach(function (topic) {\n                // this._topicObservers is used to notify the observers according to the topic received on the message\n                var observersForTopic = _this._topicObservers.get(topic);\n                if (!observersForTopic) {\n                    observersForTopic = new Set();\n                    _this._topicObservers.set(topic, observersForTopic);\n                }\n                observersForTopic.add(observer);\n            });\n            // @ts-ignore\n            var client;\n            var _a = options.clientId, clientId = _a === void 0 ? _this.clientId : _a;\n            // this._clientIdObservers is used to close observers when client gets disconnected\n            var observersForClientId = _this._clientIdObservers.get(clientId);\n            if (!observersForClientId) {\n                observersForClientId = new Set();\n            }\n            observersForClientId.add(observer);\n            _this._clientIdObservers.set(clientId, observersForClientId);\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, url, _b, e_1;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            _a = options.url;\n                            if (!(_a === void 0)) return [3 /*break*/, 2];\n                            return [4 /*yield*/, this.endpoint];\n                        case 1:\n                            _b = _c.sent();\n                            return [3 /*break*/, 3];\n                        case 2:\n                            _b = _a;\n                            _c.label = 3;\n                        case 3:\n                            url = _b;\n                            _c.label = 4;\n                        case 4:\n                            _c.trys.push([4, 6, , 7]);\n                            return [4 /*yield*/, this.connect(clientId, { url: url })];\n                        case 5:\n                            client = _c.sent();\n                            targetTopics.forEach(function (topic) {\n                                client.subscribe(topic);\n                            });\n                            return [3 /*break*/, 7];\n                        case 6:\n                            e_1 = _c.sent();\n                            observer.error(e_1);\n                            return [3 /*break*/, 7];\n                        case 7: return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                if (client) {\n                    _this._clientIdObservers.get(clientId).delete(observer);\n                    // No more observers per client => client not needed anymore\n                    if (_this._clientIdObservers.get(clientId).size === 0) {\n                        _this.disconnect(clientId);\n                        _this._clientIdObservers.delete(clientId);\n                    }\n                    targetTopics.forEach(function (topic) {\n                        var observersForTopic = _this._topicObservers.get(topic) ||\n                            new Set();\n                        observersForTopic.delete(observer);\n                        // if no observers exists for the topic, topic should be removed\n                        if (observersForTopic.size === 0) {\n                            _this._topicObservers.delete(topic);\n                            if (client.isConnected()) {\n                                client.unsubscribe(topic);\n                            }\n                        }\n                    });\n                }\n                return null;\n            };\n        });\n    };\n    return MqttOverWSProvider;\n}(AbstractPubSubProvider));\nexport { MqttOverWSProvider };\n//# sourceMappingURL=MqttOverWSProvider.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('AbstractPubSubProvider');\nvar AbstractPubSubProvider = /** @class */ (function () {\n    function AbstractPubSubProvider(options) {\n        if (options === void 0) { options = {}; }\n        this._config = options;\n    }\n    AbstractPubSubProvider.prototype.configure = function (config) {\n        if (config === void 0) { config = {}; }\n        this._config = __assign(__assign({}, config), this._config);\n        logger.debug(\"configure \" + this.getProviderName(), this._config);\n        return this.options;\n    };\n    AbstractPubSubProvider.prototype.getCategory = function () {\n        return 'PubSub';\n    };\n    Object.defineProperty(AbstractPubSubProvider.prototype, \"options\", {\n        get: function () {\n            return __assign({}, this._config);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AbstractPubSubProvider;\n}());\nexport { AbstractPubSubProvider };\n//# sourceMappingURL=PubSubProvider.js.map","/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nexport * from './PubSubProvider';\nexport * from './AWSAppSyncProvider';\nexport * from './AWSAppSyncRealTimeProvider';\nexport * from './AWSIotProvider';\nexport * from './MqttOverWSProvider';\n//# sourceMappingURL=index.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n// import '../Common/Polyfills';\nimport Observable from 'zen-observable-ts';\nimport { Amplify, ConsoleLogger as Logger, INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER, INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER, } from '@aws-amplify/core';\nimport { AWSAppSyncProvider, AWSAppSyncRealTimeProvider } from './Providers';\nvar logger = new Logger('PubSub');\nvar PubSubClass = /** @class */ (function () {\n    /**\n     * Initialize PubSub with AWS configurations\n     *\n     * @param {PubSubOptions} options - Configuration object for PubSub\n     */\n    function PubSubClass(options) {\n        this._options = options;\n        logger.debug('PubSub Options', this._options);\n        this._pluggables = [];\n        this.subscribe = this.subscribe.bind(this);\n        Amplify.register(this);\n    }\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncProvider) {\n                this._awsAppSyncProvider = new AWSAppSyncProvider(this._options);\n            }\n            return this._awsAppSyncProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncRealTimeProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncRealTimeProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncRealTimeProvider) {\n                this._awsAppSyncRealTimeProvider = new AWSAppSyncRealTimeProvider(this._options);\n            }\n            return this._awsAppSyncRealTimeProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PubSubClass.prototype.getModuleName = function () {\n        return 'PubSub';\n    };\n    /**\n     * Configure PubSub part with configurations\n     *\n     * @param {PubSubOptions} config - Configuration for PubSub\n     * @return {Object} - The current configuration\n     */\n    PubSubClass.prototype.configure = function (options) {\n        var _this = this;\n        var opt = options ? options.PubSub || options : {};\n        logger.debug('configure PubSub', { opt: opt });\n        this._options = Object.assign({}, this._options, opt);\n        this._pluggables.map(function (pluggable) { return pluggable.configure(_this._options); });\n        return this._options;\n    };\n    /**\n     * add plugin into Analytics category\n     * @param {Object} pluggable - an instance of the plugin\n     */\n    PubSubClass.prototype.addPluggable = function (pluggable) {\n        return __awaiter(this, void 0, void 0, function () {\n            var config;\n            return __generator(this, function (_a) {\n                if (pluggable && pluggable.getCategory() === 'PubSub') {\n                    this._pluggables.push(pluggable);\n                    config = pluggable.configure(this._options);\n                    return [2 /*return*/, config];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    PubSubClass.prototype.getProviderByName = function (providerName) {\n        if (providerName === INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER) {\n            return this.awsAppSyncProvider;\n        }\n        if (providerName === INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER) {\n            return this.awsAppSyncRealTimeProvider;\n        }\n        return this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === providerName; });\n    };\n    PubSubClass.prototype.getProviders = function (options) {\n        if (options === void 0) { options = {}; }\n        var providerName = options.provider;\n        if (!providerName) {\n            return this._pluggables;\n        }\n        var provider = this.getProviderByName(providerName);\n        if (!provider) {\n            throw new Error(\"Could not find provider named \" + providerName);\n        }\n        return [provider];\n    };\n    PubSubClass.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, Promise.all(this.getProviders(options).map(function (provider) {\n                        return provider.publish(topics, msg, options);\n                    }))];\n            });\n        });\n    };\n    PubSubClass.prototype.subscribe = function (topics, options) {\n        logger.debug('subscribe options', options);\n        var providers = this.getProviders(options);\n        return new Observable(function (observer) {\n            var observables = providers.map(function (provider) { return ({\n                provider: provider,\n                observable: provider.subscribe(topics, options),\n            }); });\n            var subscriptions = observables.map(function (_a) {\n                var provider = _a.provider, observable = _a.observable;\n                return observable.subscribe({\n                    start: console.error,\n                    next: function (value) { return observer.next({ provider: provider, value: value }); },\n                    error: function (error) { return observer.error({ provider: provider, error: error }); },\n                });\n            });\n            return function () {\n                return subscriptions.forEach(function (subscription) { return subscription.unsubscribe(); });\n            };\n        });\n    };\n    return PubSubClass;\n}());\nexport { PubSubClass };\nexport var PubSub = new PubSubClass(null);\n//# sourceMappingURL=PubSub.js.map","/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { PubSub } from './PubSub';\nexport * from './Providers';\nvar CONTROL_MSG;\n(function (CONTROL_MSG) {\n    CONTROL_MSG[\"CONNECTION_CLOSED\"] = \"Connection closed\";\n    CONTROL_MSG[\"TIMEOUT_DISCONNECT\"] = \"Timeout disconnect\";\n    CONTROL_MSG[\"SUBSCRIPTION_ACK\"] = \"Subscription ack\";\n})(CONTROL_MSG || (CONTROL_MSG = {}));\nexport { PubSub, CONTROL_MSG };\n/**\n * @deprecated use named import\n */\nexport default PubSub;\n//# sourceMappingURL=index.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__aws_amplify_auth__;","module.exports = __WEBPACK_EXTERNAL_MODULE__aws_amplify_cache__;","module.exports = __WEBPACK_EXTERNAL_MODULE__aws_amplify_core__;","module.exports = __WEBPACK_EXTERNAL_MODULE_graphql__;"],"sourceRoot":""}
\ No newline at end of file
+{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/base64-js/index.js","webpack:///./node_modules/buffer/index.js","webpack:///./node_modules/ieee754/index.js","webpack:///./node_modules/isarray/index.js","webpack:///./node_modules/node-libs-browser/node_modules/punycode/punycode.js","webpack:///./node_modules/paho-mqtt/paho-mqtt.js","webpack:///./node_modules/querystring-es3/decode.js","webpack:///./node_modules/querystring-es3/encode.js","webpack:///./node_modules/querystring-es3/index.js","webpack:///./node_modules/url/url.js","webpack:///./node_modules/url/util.js","webpack:///./node_modules/uuid/index.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/v1.js","webpack:///./node_modules/uuid/v4.js","webpack:///(webpack)/buildin/global.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/zen-observable-ts/lib/bundle.esm.js","webpack:///./node_modules/zen-observable-ts/node_modules/zen-observable/index.js","webpack:///./node_modules/zen-observable-ts/node_modules/zen-observable/lib/Observable.js","webpack:///../../src/Providers/AWSAppSyncProvider.ts","webpack:///../../src/Providers/AWSAppSyncRealTimeProvider.ts","webpack:///../../src/Providers/AWSIotProvider.ts","webpack:///../../src/Providers/MqttOverWSProvider.ts","webpack:///../../src/Providers/PubSubProvider.ts","webpack:///../../src/Providers/index.ts","webpack:///../src/PubSub.ts","webpack:///../src/index.ts","webpack:///external \"@aws-amplify/auth\"","webpack:///external \"@aws-amplify/cache\"","webpack:///external \"@aws-amplify/core\"","webpack:///external \"graphql\""],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFY;;AAEZ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAkC,SAAS;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0CAA0C,UAAU;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACrJA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEY;;AAEZ,aAAa,mBAAO,CAAC,wDAAW;AAChC,cAAc,mBAAO,CAAC,oDAAS;AAC/B,cAAc,mBAAO,CAAC,oDAAS;;AAE/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,mDAAmD;AACxE;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAAgD,EAAE;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,wBAAwB,QAAQ;AAChC;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA,GAAG;AACH;AACA,eAAe,SAAS;AACxB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,YAAY;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,gBAAgB;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;AC5vDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,QAAQ,WAAW;;AAEnB;AACA;AACA,QAAQ,UAAU;;AAElB;AACA;;;;;;;;;;;;ACpFA,iBAAiB;;AAEjB;AACA;AACA;;;;;;;;;;;;ACJA;AACA,CAAC;;AAED;AACA,mBAAmB,KAA0B;AAC7C;AACA,kBAAkB,KAAyB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,MAAM;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,MAAM;AAClB,YAAY,SAAS;AACrB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA,KAAK;AACL,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,MAAM;AAClB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mCAAmC;AAClE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB;;AAExB,yCAAyC,qBAAqB;;AAE9D;AACA;AACA;AACA;AACA;AACA,kCAAkC,oBAAoB;;AAEtD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,0BAA0B,iBAAiB;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,cAAc,iBAAiB;AAC/B;;AAEA;AACA;AACA;;AAEA;AACA;AACA,8BAA8B,oBAAoB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE,IAEU;AACZ;AACA,EAAE,mCAAmB;AACrB;AACA,GAAG;AAAA,oGAAC;AACJ,EAAE,MAAM,EAaN;;AAEF,CAAC;;;;;;;;;;;;;ACphBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,oBAAoB;;AAEpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI,IAAyD;AAC7D;AACA,EAAE,MAAM,EASN;AACF,CAAC;;;AAGD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,kCAAkC,kBAAkB,EAAE;AACtD,4BAA4B,kBAAkB,EAAE;AAChD,+BAA+B,kBAAkB,EAAE;AACnD;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,SAAS;AACrB,YAAY,OAAO;AACnB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,+BAA+B;AACvC,qBAAqB,8CAA8C;AACnE,uBAAuB,+CAA+C;AACtE,yBAAyB,iDAAiD;AAC1E,kBAAkB,0CAA0C;AAC5D,oBAAoB,yDAAyD,EAAE,gBAAgB,EAAE,EAAE;AACnG,wBAAwB,kDAAkD,EAAE,EAAE,EAAE,GAAG;AACnF,kBAAkB,uCAAuC,EAAE,GAAG;AAC9D,kBAAkB,yCAAyC;AAC3D,mBAAmB,6CAA6C,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG;AAC7E,iBAAiB,2BAA2B,EAAE,oCAAoC;AAClF,mBAAmB,yCAAyC,EAAE,GAAG;AACjE,kBAAkB,wCAAwC,EAAE,MAAM,EAAE,GAAG;AACvE,sBAAsB,4CAA4C,EAAE,MAAM,EAAE,GAAG;AAC/E,2BAA2B,kDAAkD;AAC7E,yBAAyB,6DAA6D,EAAE,QAAQ,EAAE,GAAG;AACrG,+BAA+B,qDAAqD,EAAE,GAAG;AACzF,uBAAuB,oDAAoD,EAAE,EAAE,EAAE,GAAG;AACpF,iBAAiB,wEAAwE,EAAE,GAAG;AAC9F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,MAAM;AAClB,YAAY,cAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,wBAAwB;AACzC,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB,oBAAoB,wBAAwB;AAC5C;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;;AAEA;AACA,kBAAkB;AAClB,oBAAoB,wBAAwB;AAC5C;AACA;AACA;AACA;;AAEA;AACA,kBAAkB;AAClB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,kCAAkC;AAClC,4BAA4B;AAC5B;AACA,2CAA2C;;AAE3C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iCAAiC;AACjC,kCAAkC;AAClC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2DAA2D;AAC3D,sCAAsC;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+BAA+B;AAC1D;;AAEA;AACA,kDAAkD,4BAA4B,2EAA2E;AACzJ;;AAEA;AACA,iDAAiD,4BAA4B,yGAAyG;AACtL;;AAEA;AACA;AACA,OAAO;AACP;AACA,mDAAmD;AACnD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,uCAAuC,8BAA8B,uDAAuD;AAC5H;AACA;AACA;AACA,OAAO;AACP;AACA,qDAAqD;AACrD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB;;AAExB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,qBAAqB;AACvC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mEAAmE,gCAAgC;AACnG,gDAAgD,OAAO;AACvD;AACA;AACA,iEAAiE,gDAAgD;AACjH;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC,wDAAwD;AAC7F;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gEAAgE,gDAAgD;AAChH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,gDAAgD;AACjH;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8DAA8D,gDAAgD;AAC9G;AACA;AACA;;AAEA;AACA;AACA;AACA,8DAA8D,gDAAgD;AAC9G;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,UAAU;AACtB,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,UAAU;AACtB,YAAY,UAAU;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA6B,sGAAsG;AACnI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN,qCAAqC,qGAAqG;AAC1I;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oCAAoC;AAC7D;;AAEA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mEAAmE,kBAAkB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,kBAAkB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA,eAAe,SAAS;AACxB;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA,eAAe,OAAO;AACtB;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,sBAAsB,aAAa,EAAE;AACrC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,aAAa,EAAE;AACrC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,aAAa,EAAE;AACrC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,YAAY,EAAE;AACpC,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,wBAAwB,EAAE;AAChD,sBAAsB,sDAAsD;AAC5E,KAAK;AACL;AACA,sBAAsB,2BAA2B,EAAE;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,sCAAsC,EAAE;AAC9D;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,sCAAsC,EAAE;AAC9D;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,gCAAgC,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,kCAAkC,EAAE;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,gCAAgC,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,6BAA6B,EAAE;AACrD;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,aAAa;AAC1B;AACA,aAAa,OAAO;AACpB;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,QAAQ;AACrB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA,yCAAyC;AACzC,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;;AAEpB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,+BAA+B;AACnD;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,qBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA,aAAa,OAAO;AACpB;AACA,aAAa,OAAO;AACpB;AACA,aAAa,OAAO;AACpB;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,iCAAiC;AACjC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA;AACA,iDAAiD;AACjD,mCAAmC;AACnC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,oBAAoB;AACjC;AACA,aAAa,mBAAmB;AAChC,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,oBAAoB;AACjC;AACA,aAAa,mBAAmB;AAChC,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,aAAa;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,SAAS;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA,eAAe,OAAO;AACtB,eAAe,YAAY;AAC3B;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,wBAAwB,EAAE;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,YAAY,EAAE;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,iBAAiB,EAAE;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,wBAAwB,EAAE;AAChD,8BAA8B;AAC9B,KAAK;AACL;AACA;AACA,sBAAsB,kBAAkB,EAAE;AAC1C,kCAAkC;AAClC;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,2HAA2H;AAC7H;AACA,CAAC;;;;;;;;;;;;;;AC11ED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,SAAS;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpFa;;AAEb,iCAAiC,mBAAO,CAAC,8DAAU;AACnD,qCAAqC,mBAAO,CAAC,8DAAU;;;;;;;;;;;;;ACHvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb,eAAe,mBAAO,CAAC,wFAAU;AACjC,WAAW,mBAAO,CAAC,8CAAQ;;AAE3B;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gBAAgB,KAAK;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA,2CAA2C,KAAK;AAChD,0CAA0C,KAAK;AAC/C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,kBAAkB,mBAAO,CAAC,gEAAa;;AAEvC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C,OAAO;AAClD;AACA;AACA;AACA;AACA,0CAA0C,OAAO;AACjD;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,0CAA0C,OAAO;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,mBAAmB;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B,QAAQ;AACtC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3tBa;;AAEb;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;ACfA,SAAS,mBAAO,CAAC,2CAAM;AACvB,SAAS,mBAAO,CAAC,2CAAM;;AAEvB;AACA;AACA;;AAEA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACzBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC;;AAEjC;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB,QAAQ;AAC9B;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACjCA,UAAU,mBAAO,CAAC,6DAAW;AAC7B,kBAAkB,mBAAO,CAAC,qEAAmB;;AAE7C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC;AACnC;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,iBAAiB,OAAO;AACxB;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AC5GA,UAAU,mBAAO,CAAC,6DAAW;AAC7B,kBAAkB,mBAAO,CAAC,qEAAmB;;AAE7C;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AC5BA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;;ACrBA;AAAA;AAAA;AAAA;AAA2C;;AAE3C,iBAAiB,qDAAa;;AAEf,yEAAU,EAAC;AACJ;AACtB;;;;;;;;;;;;ACNA,iBAAiB,mBAAO,CAAC,+GAAqB;;;;;;;;;;;;;ACAjC;;AAEb;AACA;AACA,CAAC;AACD;;AAEA,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE;;AAE3T,6DAA6D,sEAAsE,8DAA8D,oBAAoB;;AAErN;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,yCAAyC;;AAEzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iCAAiC;AACjC;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAuC;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,0EAA0E;AAC1E;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA,4EAA4E,aAAa;AACzF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8EAA8E,gEAAgE;AAC9I;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA;;AAEA,2BAA2B,cAAc;AACzC;AACA;AACA;;AAEA;AACA,WAAW;AACX,SAAS;AACT;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,6EAA6E,eAAe;AAC5F;AACA;;AAEA;AACA;AACA;AACA;;AAEA,yBAAyB,kBAAkB;AAC3C;AACA;AACA;;AAEA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3lBA;AACA;AAEA;AAEA,IAAM,MAAM,GAAG,oEAAf,oBAAe,CAAf;;AAEA;AAAA;AAAA;AAAwC;;AAAxC;AAAA;;AAgDS,yBAAoC,IA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","file":"aws-amplify-pubsub.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@aws-amplify/auth\"), require(\"@aws-amplify/cache\"), require(\"@aws-amplify/core\"), require(\"graphql\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"aws_amplify_pubsub\", [\"@aws-amplify/auth\", \"@aws-amplify/cache\", \"@aws-amplify/core\", \"graphql\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"aws_amplify_pubsub\"] = factory(require(\"@aws-amplify/auth\"), require(\"@aws-amplify/cache\"), require(\"@aws-amplify/core\"), require(\"graphql\"));\n\telse\n\t\troot[\"aws_amplify_pubsub\"] = factory(root[\"@aws-amplify/auth\"], root[\"@aws-amplify/cache\"], root[\"@aws-amplify/core\"], root[\"graphql\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__aws_amplify_auth__, __WEBPACK_EXTERNAL_MODULE__aws_amplify_cache__, __WEBPACK_EXTERNAL_MODULE__aws_amplify_core__, __WEBPACK_EXTERNAL_MODULE_graphql__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib-esm/index.js\");\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","/*******************************************************************************\n * Copyright (c) 2013 IBM Corp.\n *\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * and Eclipse Distribution License v1.0 which accompany this distribution.\n *\n * The Eclipse Public License is available at\n *    http://www.eclipse.org/legal/epl-v10.html\n * and the Eclipse Distribution License is available at\n *   http://www.eclipse.org/org/documents/edl-v10.php.\n *\n * Contributors:\n *    Andrew Banks - initial API and implementation and initial documentation\n *******************************************************************************/\n\n\n// Only expose a single object name in the global namespace.\n// Everything must go through this module. Global Paho module\n// only has a single public function, client, which returns\n// a Paho client object given connection details.\n\n/**\n * Send and receive messages using web browsers.\n * <p>\n * This programming interface lets a JavaScript client application use the MQTT V3.1 or\n * V3.1.1 protocol to connect to an MQTT-supporting messaging server.\n *\n * The function supported includes:\n * <ol>\n * <li>Connecting to and disconnecting from a server. The server is identified by its host name and port number.\n * <li>Specifying options that relate to the communications link with the server,\n * for example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.\n * <li>Subscribing to and receiving messages from MQTT Topics.\n * <li>Publishing messages to MQTT Topics.\n * </ol>\n * <p>\n * The API consists of two main objects:\n * <dl>\n * <dt><b>{@link Paho.Client}</b></dt>\n * <dd>This contains methods that provide the functionality of the API,\n * including provision of callbacks that notify the application when a message\n * arrives from or is delivered to the messaging server,\n * or when the status of its connection to the messaging server changes.</dd>\n * <dt><b>{@link Paho.Message}</b></dt>\n * <dd>This encapsulates the payload of the message along with various attributes\n * associated with its delivery, in particular the destination to which it has\n * been (or is about to be) sent.</dd>\n * </dl>\n * <p>\n * The programming interface validates parameters passed to it, and will throw\n * an Error containing an error message intended for developer use, if it detects\n * an error with any parameter.\n * <p>\n * Example:\n *\n * <code><pre>\nvar client = new Paho.MQTT.Client(location.hostname, Number(location.port), \"clientId\");\nclient.onConnectionLost = onConnectionLost;\nclient.onMessageArrived = onMessageArrived;\nclient.connect({onSuccess:onConnect});\n\nfunction onConnect() {\n  // Once a connection has been made, make a subscription and send a message.\n  console.log(\"onConnect\");\n  client.subscribe(\"/World\");\n  var message = new Paho.MQTT.Message(\"Hello\");\n  message.destinationName = \"/World\";\n  client.send(message);\n};\nfunction onConnectionLost(responseObject) {\n  if (responseObject.errorCode !== 0)\n\tconsole.log(\"onConnectionLost:\"+responseObject.errorMessage);\n};\nfunction onMessageArrived(message) {\n  console.log(\"onMessageArrived:\"+message.payloadString);\n  client.disconnect();\n};\n * </pre></code>\n * @namespace Paho\n */\n\n/* jshint shadow:true */\n(function ExportLibrary(root, factory) {\n\tif(typeof exports === \"object\" && typeof module === \"object\"){\n\t\tmodule.exports = factory();\n\t} else if (typeof define === \"function\" && define.amd){\n\t\tdefine(factory);\n\t} else if (typeof exports === \"object\"){\n\t\texports = factory();\n\t} else {\n\t\t//if (typeof root.Paho === \"undefined\"){\n\t\t//\troot.Paho = {};\n\t\t//}\n\t\troot.Paho = factory();\n\t}\n})(this, function LibraryFactory(){\n\n\n\tvar PahoMQTT = (function (global) {\n\n\t// Private variables below, these are only visible inside the function closure\n\t// which is used to define the module.\n\tvar version = \"@VERSION@-@BUILDLEVEL@\";\n\n\t/**\n\t * @private\n\t */\n\tvar localStorage = global.localStorage || (function () {\n\t\tvar data = {};\n\n\t\treturn {\n\t\t\tsetItem: function (key, item) { data[key] = item; },\n\t\t\tgetItem: function (key) { return data[key]; },\n\t\t\tremoveItem: function (key) { delete data[key]; },\n\t\t};\n\t})();\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar MESSAGE_TYPE = {\n\t\t\tCONNECT: 1,\n\t\t\tCONNACK: 2,\n\t\t\tPUBLISH: 3,\n\t\t\tPUBACK: 4,\n\t\t\tPUBREC: 5,\n\t\t\tPUBREL: 6,\n\t\t\tPUBCOMP: 7,\n\t\t\tSUBSCRIBE: 8,\n\t\t\tSUBACK: 9,\n\t\t\tUNSUBSCRIBE: 10,\n\t\t\tUNSUBACK: 11,\n\t\t\tPINGREQ: 12,\n\t\t\tPINGRESP: 13,\n\t\t\tDISCONNECT: 14\n\t\t};\n\n\t\t// Collection of utility methods used to simplify module code\n\t\t// and promote the DRY pattern.\n\n\t\t/**\n\t * Validate an object's parameter names to ensure they\n\t * match a list of expected variables name for this option\n\t * type. Used to ensure option object passed into the API don't\n\t * contain erroneous parameters.\n\t * @param {Object} obj - User options object\n\t * @param {Object} keys - valid keys and types that may exist in obj.\n\t * @throws {Error} Invalid option parameter found.\n\t * @private\n\t */\n\t\tvar validate = function(obj, keys) {\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\tif (keys.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (typeof obj[key] !== keys[key])\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof obj[key], key]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar errorStr = \"Unknown property, \" + key + \". Valid properties are:\";\n\t\t\t\t\t\tfor (var validKey in keys)\n\t\t\t\t\t\t\tif (keys.hasOwnProperty(validKey))\n\t\t\t\t\t\t\t\terrorStr = errorStr+\" \"+validKey;\n\t\t\t\t\t\tthrow new Error(errorStr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Return a new function which runs the user function bound\n\t * to a fixed scope.\n\t * @param {function} User function\n\t * @param {object} Function scope\n\t * @return {function} User function bound to another scope\n\t * @private\n\t */\n\t\tvar scope = function (f, scope) {\n\t\t\treturn function () {\n\t\t\t\treturn f.apply(scope, arguments);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar ERROR = {\n\t\t\tOK: {code:0, text:\"AMQJSC0000I OK.\"},\n\t\t\tCONNECT_TIMEOUT: {code:1, text:\"AMQJSC0001E Connect timed out.\"},\n\t\t\tSUBSCRIBE_TIMEOUT: {code:2, text:\"AMQJS0002E Subscribe timed out.\"},\n\t\t\tUNSUBSCRIBE_TIMEOUT: {code:3, text:\"AMQJS0003E Unsubscribe timed out.\"},\n\t\t\tPING_TIMEOUT: {code:4, text:\"AMQJS0004E Ping timed out.\"},\n\t\t\tINTERNAL_ERROR: {code:5, text:\"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}\"},\n\t\t\tCONNACK_RETURNCODE: {code:6, text:\"AMQJS0006E Bad Connack return code:{0} {1}.\"},\n\t\t\tSOCKET_ERROR: {code:7, text:\"AMQJS0007E Socket error:{0}.\"},\n\t\t\tSOCKET_CLOSE: {code:8, text:\"AMQJS0008I Socket closed.\"},\n\t\t\tMALFORMED_UTF: {code:9, text:\"AMQJS0009E Malformed UTF data:{0} {1} {2}.\"},\n\t\t\tUNSUPPORTED: {code:10, text:\"AMQJS0010E {0} is not supported by this browser.\"},\n\t\t\tINVALID_STATE: {code:11, text:\"AMQJS0011E Invalid state {0}.\"},\n\t\t\tINVALID_TYPE: {code:12, text:\"AMQJS0012E Invalid type {0} for {1}.\"},\n\t\t\tINVALID_ARGUMENT: {code:13, text:\"AMQJS0013E Invalid argument {0} for {1}.\"},\n\t\t\tUNSUPPORTED_OPERATION: {code:14, text:\"AMQJS0014E Unsupported operation.\"},\n\t\t\tINVALID_STORED_DATA: {code:15, text:\"AMQJS0015E Invalid data in local storage key={0} value={1}.\"},\n\t\t\tINVALID_MQTT_MESSAGE_TYPE: {code:16, text:\"AMQJS0016E Invalid MQTT message type {0}.\"},\n\t\t\tMALFORMED_UNICODE: {code:17, text:\"AMQJS0017E Malformed Unicode string:{0} {1}.\"},\n\t\t\tBUFFER_FULL: {code:18, text:\"AMQJS0018E Message buffer is full, maximum buffer size: {0}.\"},\n\t\t};\n\n\t\t/** CONNACK RC Meaning. */\n\t\tvar CONNACK_RC = {\n\t\t\t0:\"Connection Accepted\",\n\t\t\t1:\"Connection Refused: unacceptable protocol version\",\n\t\t\t2:\"Connection Refused: identifier rejected\",\n\t\t\t3:\"Connection Refused: server unavailable\",\n\t\t\t4:\"Connection Refused: bad user name or password\",\n\t\t\t5:\"Connection Refused: not authorized\"\n\t\t};\n\n\t/**\n\t * Format an error message text.\n\t * @private\n\t * @param {error} ERROR value above.\n\t * @param {substitutions} [array] substituted into the text.\n\t * @return the text with the substitutions made.\n\t */\n\t\tvar format = function(error, substitutions) {\n\t\t\tvar text = error.text;\n\t\t\tif (substitutions) {\n\t\t\t\tvar field,start;\n\t\t\t\tfor (var i=0; i<substitutions.length; i++) {\n\t\t\t\t\tfield = \"{\"+i+\"}\";\n\t\t\t\t\tstart = text.indexOf(field);\n\t\t\t\t\tif(start > 0) {\n\t\t\t\t\t\tvar part1 = text.substring(0,start);\n\t\t\t\t\t\tvar part2 = text.substring(start+field.length);\n\t\t\t\t\t\ttext = part1+substitutions[i]+part2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn text;\n\t\t};\n\n\t\t//MQTT protocol and version          6    M    Q    I    s    d    p    3\n\t\tvar MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];\n\t\t//MQTT proto/version for 311         4    M    Q    T    T    4\n\t\tvar MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];\n\n\t\t/**\n\t * Construct an MQTT wire protocol message.\n\t * @param type MQTT packet type.\n\t * @param options optional wire message attributes.\n\t *\n\t * Optional properties\n\t *\n\t * messageIdentifier: message ID in the range [0..65535]\n\t * payloadMessage:\tApplication Message - PUBLISH only\n\t * connectStrings:\tarray of 0 or more Strings to be put into the CONNECT payload\n\t * topics:\t\t\tarray of strings (SUBSCRIBE, UNSUBSCRIBE)\n\t * requestQoS:\t\tarray of QoS values [0..2]\n\t *\n\t * \"Flag\" properties\n\t * cleanSession:\ttrue if present / false if absent (CONNECT)\n\t * willMessage:  \ttrue if present / false if absent (CONNECT)\n\t * isRetained:\t\ttrue if present / false if absent (CONNECT)\n\t * userName:\t\ttrue if present / false if absent (CONNECT)\n\t * password:\t\ttrue if present / false if absent (CONNECT)\n\t * keepAliveInterval:\tinteger [0..65535]  (CONNECT)\n\t *\n\t * @private\n\t * @ignore\n\t */\n\t\tvar WireMessage = function (type, options) {\n\t\t\tthis.type = type;\n\t\t\tfor (var name in options) {\n\t\t\t\tif (options.hasOwnProperty(name)) {\n\t\t\t\t\tthis[name] = options[name];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tWireMessage.prototype.encode = function() {\n\t\t// Compute the first byte of the fixed header\n\t\t\tvar first = ((this.type & 0x0f) << 4);\n\n\t\t\t/*\n\t\t * Now calculate the length of the variable header + payload by adding up the lengths\n\t\t * of all the component parts\n\t\t */\n\n\t\t\tvar remLength = 0;\n\t\t\tvar topicStrLength = [];\n\t\t\tvar destinationNameLength = 0;\n\t\t\tvar willMessagePayloadBytes;\n\n\t\t\t// if the message contains a messageIdentifier then we need two bytes for that\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tremLength += 2;\n\n\t\t\tswitch(this.type) {\n\t\t\t// If this a Connect then we need to include 12 bytes for its header\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tswitch(this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tremLength += MqttProtoIdentifierv3.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tremLength += MqttProtoIdentifierv4.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tremLength += UTF8Length(this.clientId) + 2;\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tremLength += UTF8Length(this.willMessage.destinationName) + 2;\n\t\t\t\t\t// Will message is always a string, sent as UTF-8 characters with a preceding length.\n\t\t\t\t\twillMessagePayloadBytes = this.willMessage.payloadBytes;\n\t\t\t\t\tif (!(willMessagePayloadBytes instanceof Uint8Array))\n\t\t\t\t\t\twillMessagePayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\t\tremLength += willMessagePayloadBytes.byteLength +2;\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.userName) + 2;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.password) + 2;\n\t\t\t\tbreak;\n\n\t\t\t// Subscribe, Unsubscribe can both contain topic strings\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tremLength += this.requestedQos.length; // 1 byte for each topic's Qos\n\t\t\t\t// QoS on Subscribe only\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif (this.payloadMessage.duplicate) first |= 0x08;\n\t\t\t\tfirst  = first |= (this.payloadMessage.qos << 1);\n\t\t\t\tif (this.payloadMessage.retained) first |= 0x01;\n\t\t\t\tdestinationNameLength = UTF8Length(this.payloadMessage.destinationName);\n\t\t\t\tremLength += destinationNameLength + 2;\n\t\t\t\tvar payloadBytes = this.payloadMessage.payloadBytes;\n\t\t\t\tremLength += payloadBytes.byteLength;\n\t\t\t\tif (payloadBytes instanceof ArrayBuffer)\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\telse if (!(payloadBytes instanceof Uint8Array))\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes.buffer);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Now we can allocate a buffer for the message\n\n\t\t\tvar mbi = encodeMBI(remLength);  // Convert the length to MQTT MBI format\n\t\t\tvar pos = mbi.length + 1;        // Offset of start of variable header\n\t\t\tvar buffer = new ArrayBuffer(remLength + pos);\n\t\t\tvar byteStream = new Uint8Array(buffer);    // view it as a sequence of bytes\n\n\t\t\t//Write the fixed header into the buffer\n\t\t\tbyteStream[0] = first;\n\t\t\tbyteStream.set(mbi,1);\n\n\t\t\t// If this is a PUBLISH then the variable header starts with a topic\n\t\t\tif (this.type == MESSAGE_TYPE.PUBLISH)\n\t\t\t\tpos = writeString(this.payloadMessage.destinationName, destinationNameLength, byteStream, pos);\n\t\t\t// If this is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time\n\n\t\t\telse if (this.type == MESSAGE_TYPE.CONNECT) {\n\t\t\t\tswitch (this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv3, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv3.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv4, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv4.length;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar connectFlags = 0;\n\t\t\t\tif (this.cleanSession)\n\t\t\t\t\tconnectFlags = 0x02;\n\t\t\t\tif (this.willMessage !== undefined ) {\n\t\t\t\t\tconnectFlags |= 0x04;\n\t\t\t\t\tconnectFlags |= (this.willMessage.qos<<3);\n\t\t\t\t\tif (this.willMessage.retained) {\n\t\t\t\t\t\tconnectFlags |= 0x20;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tconnectFlags |= 0x80;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tconnectFlags |= 0x40;\n\t\t\t\tbyteStream[pos++] = connectFlags;\n\t\t\t\tpos = writeUint16 (this.keepAliveInterval, byteStream, pos);\n\t\t\t}\n\n\t\t\t// Output the messageIdentifier - if there is one\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tpos = writeUint16 (this.messageIdentifier, byteStream, pos);\n\n\t\t\tswitch(this.type) {\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tpos = writeString(this.clientId, UTF8Length(this.clientId), byteStream, pos);\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tpos = writeString(this.willMessage.destinationName, UTF8Length(this.willMessage.destinationName), byteStream, pos);\n\t\t\t\t\tpos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);\n\t\t\t\t\tbyteStream.set(willMessagePayloadBytes, pos);\n\t\t\t\t\tpos += willMessagePayloadBytes.byteLength;\n\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tpos = writeString(this.userName, UTF8Length(this.userName), byteStream, pos);\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tpos = writeString(this.password, UTF8Length(this.password), byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// PUBLISH has a text or binary payload, if text do not add a 2 byte length field, just the UTF characters.\n\t\t\t\tbyteStream.set(payloadBytes, pos);\n\n\t\t\t\tbreak;\n\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREC:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREL:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t//    \t    \tbreak;\n\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\t// SUBSCRIBE has a list of topic strings and request QoS\n\t\t\t\tfor (var i=0; i<this.topics.length; i++) {\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\t\tbyteStream[pos++] = this.requestedQos[i];\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\t// UNSUBSCRIBE has a list of topic strings\n\t\t\t\tfor (var i=0; i<this.topics.length; i++)\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// Do nothing.\n\t\t\t}\n\n\t\t\treturn buffer;\n\t\t};\n\n\t\tfunction decodeMessage(input,pos) {\n\t\t\tvar startingPos = pos;\n\t\t\tvar first = input[pos];\n\t\t\tvar type = first >> 4;\n\t\t\tvar messageInfo = first &= 0x0f;\n\t\t\tpos += 1;\n\n\n\t\t\t// Decode the remaining length (MBI format)\n\n\t\t\tvar digit;\n\t\t\tvar remLength = 0;\n\t\t\tvar multiplier = 1;\n\t\t\tdo {\n\t\t\t\tif (pos == input.length) {\n\t\t\t\t\treturn [null,startingPos];\n\t\t\t\t}\n\t\t\t\tdigit = input[pos++];\n\t\t\t\tremLength += ((digit & 0x7F) * multiplier);\n\t\t\t\tmultiplier *= 128;\n\t\t\t} while ((digit & 0x80) !== 0);\n\n\t\t\tvar endPos = pos+remLength;\n\t\t\tif (endPos > input.length) {\n\t\t\t\treturn [null,startingPos];\n\t\t\t}\n\n\t\t\tvar wireMessage = new WireMessage(type);\n\t\t\tswitch(type) {\n\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\tvar connectAcknowledgeFlags = input[pos++];\n\t\t\t\tif (connectAcknowledgeFlags & 0x01)\n\t\t\t\t\twireMessage.sessionPresent = true;\n\t\t\t\twireMessage.returnCode = input[pos++];\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tvar qos = (messageInfo >> 1) & 0x03;\n\n\t\t\t\tvar len = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\tvar topicName = parseUTF8(input, pos, len);\n\t\t\t\tpos += len;\n\t\t\t\t// If QoS 1 or 2 there will be a messageIdentifier\n\t\t\t\tif (qos > 0) {\n\t\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\t\tpos += 2;\n\t\t\t\t}\n\n\t\t\t\tvar message = new Message(input.subarray(pos, endPos));\n\t\t\t\tif ((messageInfo & 0x01) == 0x01)\n\t\t\t\t\tmessage.retained = true;\n\t\t\t\tif ((messageInfo & 0x08) == 0x08)\n\t\t\t\t\tmessage.duplicate =  true;\n\t\t\t\tmessage.qos = qos;\n\t\t\t\tmessage.destinationName = topicName;\n\t\t\t\twireMessage.payloadMessage = message;\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.PUBACK:\n\t\t\tcase  MESSAGE_TYPE.PUBREC:\n\t\t\tcase  MESSAGE_TYPE.PUBREL:\n\t\t\tcase  MESSAGE_TYPE.PUBCOMP:\n\t\t\tcase  MESSAGE_TYPE.UNSUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.SUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\twireMessage.returnCode = input.subarray(pos, endPos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn [wireMessage,endPos];\n\t\t}\n\n\t\tfunction writeUint16(input, buffer, offset) {\n\t\t\tbuffer[offset++] = input >> 8;      //MSB\n\t\t\tbuffer[offset++] = input % 256;     //LSB\n\t\t\treturn offset;\n\t\t}\n\n\t\tfunction writeString(input, utf8Length, buffer, offset) {\n\t\t\toffset = writeUint16(utf8Length, buffer, offset);\n\t\t\tstringToUTF8(input, buffer, offset);\n\t\t\treturn offset + utf8Length;\n\t\t}\n\n\t\tfunction readUint16(buffer, offset) {\n\t\t\treturn 256*buffer[offset] + buffer[offset+1];\n\t\t}\n\n\t\t/**\n\t * Encodes an MQTT Multi-Byte Integer\n\t * @private\n\t */\n\t\tfunction encodeMBI(number) {\n\t\t\tvar output = new Array(1);\n\t\t\tvar numBytes = 0;\n\n\t\t\tdo {\n\t\t\t\tvar digit = number % 128;\n\t\t\t\tnumber = number >> 7;\n\t\t\t\tif (number > 0) {\n\t\t\t\t\tdigit |= 0x80;\n\t\t\t\t}\n\t\t\t\toutput[numBytes++] = digit;\n\t\t\t} while ( (number > 0) && (numBytes<4) );\n\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and calculates its length in bytes when encoded in UTF8.\n\t * @private\n\t */\n\t\tfunction UTF8Length(input) {\n\t\t\tvar output = 0;\n\t\t\tfor (var i = 0; i<input.length; i++)\n\t\t\t{\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\t\t\t\tif (charCode > 0x7FF)\n\t\t\t\t{\n\t\t\t\t\t// Surrogate pair means its a 4 byte character\n\t\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)\n\t\t\t\t\t{\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\toutput++;\n\t\t\t\t\t}\n\t\t\t\t\toutput +=3;\n\t\t\t\t}\n\t\t\t\telse if (charCode > 0x7F)\n\t\t\t\t\toutput +=2;\n\t\t\t\telse\n\t\t\t\t\toutput++;\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and writes it into an array as UTF8 encoded bytes.\n\t * @private\n\t */\n\t\tfunction stringToUTF8(input, output, start) {\n\t\t\tvar pos = start;\n\t\t\tfor (var i = 0; i<input.length; i++) {\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\n\t\t\t\t// Check for a surrogate pair.\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF) {\n\t\t\t\t\tvar lowCharCode = input.charCodeAt(++i);\n\t\t\t\t\tif (isNaN(lowCharCode)) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));\n\t\t\t\t\t}\n\t\t\t\t\tcharCode = ((charCode - 0xD800)<<10) + (lowCharCode - 0xDC00) + 0x10000;\n\n\t\t\t\t}\n\n\t\t\t\tif (charCode <= 0x7F) {\n\t\t\t\t\toutput[pos++] = charCode;\n\t\t\t\t} else if (charCode <= 0x7FF) {\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x1F | 0xC0;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else if (charCode <= 0xFFFF) {\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x0F | 0xE0;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else {\n\t\t\t\t\toutput[pos++] = charCode>>18 & 0x07 | 0xF0;\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\tfunction parseUTF8(input, offset, length) {\n\t\t\tvar output = \"\";\n\t\t\tvar utf16;\n\t\t\tvar pos = offset;\n\n\t\t\twhile (pos < offset+length)\n\t\t\t{\n\t\t\t\tvar byte1 = input[pos++];\n\t\t\t\tif (byte1 < 128)\n\t\t\t\t\tutf16 = byte1;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar byte2 = input[pos++]-128;\n\t\t\t\t\tif (byte2 < 0)\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),\"\"]));\n\t\t\t\t\tif (byte1 < 0xE0)             // 2 byte character\n\t\t\t\t\t\tutf16 = 64*(byte1-0xC0) + byte2;\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar byte3 = input[pos++]-128;\n\t\t\t\t\t\tif (byte3 < 0)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));\n\t\t\t\t\t\tif (byte1 < 0xF0)        // 3 byte character\n\t\t\t\t\t\t\tutf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar byte4 = input[pos++]-128;\n\t\t\t\t\t\t\tif (byte4 < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t\tif (byte1 < 0xF8)        // 4 byte character\n\t\t\t\t\t\t\t\tutf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;\n\t\t\t\t\t\t\telse                     // longer encodings are not supported\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (utf16 > 0xFFFF)   // 4 byte character - express as a surrogate pair\n\t\t\t\t{\n\t\t\t\t\tutf16 -= 0x10000;\n\t\t\t\t\toutput += String.fromCharCode(0xD800 + (utf16 >> 10)); // lead character\n\t\t\t\t\tutf16 = 0xDC00 + (utf16 & 0x3FF);  // trail character\n\t\t\t\t}\n\t\t\t\toutput += String.fromCharCode(utf16);\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Repeat keepalive requests, monitor responses.\n\t * @ignore\n\t */\n\t\tvar Pinger = function(client, keepAliveInterval) {\n\t\t\tthis._client = client;\n\t\t\tthis._keepAliveInterval = keepAliveInterval*1000;\n\t\t\tthis.isReset = false;\n\n\t\t\tvar pingReq = new WireMessage(MESSAGE_TYPE.PINGREQ).encode();\n\n\t\t\tvar doTimeout = function (pinger) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn doPing.apply(pinger);\n\t\t\t\t};\n\t\t\t};\n\n\t\t\t/** @ignore */\n\t\t\tvar doPing = function() {\n\t\t\t\tif (!this.isReset) {\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"Timed out\");\n\t\t\t\t\tthis._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));\n\t\t\t\t} else {\n\t\t\t\t\tthis.isReset = false;\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"send PINGREQ\");\n\t\t\t\t\tthis._client.socket.send(pingReq);\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.reset = function() {\n\t\t\t\tthis.isReset = true;\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t\tif (this._keepAliveInterval > 0)\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t};\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Monitor request completion.\n\t * @ignore\n\t */\n\t\tvar Timeout = function(client, timeoutSeconds, action, args) {\n\t\t\tif (!timeoutSeconds)\n\t\t\t\ttimeoutSeconds = 30;\n\n\t\t\tvar doTimeout = function (action, client, args) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn action.apply(client, args);\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t/**\n\t * Internal implementation of the Websockets MQTT V3.1 client.\n\t *\n\t * @name Paho.ClientImpl @constructor\n\t * @param {String} host the DNS nameof the webSocket host.\n\t * @param {Number} port the port number for that host.\n\t * @param {String} clientId the MQ client identifier.\n\t */\n\t\tvar ClientImpl = function (uri, host, port, path, clientId) {\n\t\t// Check dependencies are satisfied in this browser.\n\t\t\tif (!(\"WebSocket\" in global && global.WebSocket !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"WebSocket\"]));\n\t\t\t}\n\t\t\tif (!(\"ArrayBuffer\" in global && global.ArrayBuffer !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"ArrayBuffer\"]));\n\t\t\t}\n\t\t\tthis._trace(\"Paho.Client\", uri, host, port, path, clientId);\n\n\t\t\tthis.host = host;\n\t\t\tthis.port = port;\n\t\t\tthis.path = path;\n\t\t\tthis.uri = uri;\n\t\t\tthis.clientId = clientId;\n\t\t\tthis._wsuri = null;\n\n\t\t\t// Local storagekeys are qualified with the following string.\n\t\t\t// The conditional inclusion of path in the key is for backward\n\t\t\t// compatibility to when the path was not configurable and assumed to\n\t\t\t// be /mqtt\n\t\t\tthis._localKey=host+\":\"+port+(path!=\"/mqtt\"?\":\"+path:\"\")+\":\"+clientId+\":\";\n\n\t\t\t// Create private instance-only message queue\n\t\t\t// Internal queue of messages to be sent, in sending order.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\n\t\t\t// Messages we have sent and are expecting a response for, indexed by their respective message ids.\n\t\t\tthis._sentMessages = {};\n\n\t\t\t// Messages we have received and acknowleged and are expecting a confirm message for\n\t\t\t// indexed by their respective message ids.\n\t\t\tthis._receivedMessages = {};\n\n\t\t\t// Internal list of callbacks to be executed when messages\n\t\t\t// have been successfully sent over web socket, e.g. disconnect\n\t\t\t// when it doesn't have to wait for ACK, just message is dispatched.\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\t// Unique identifier for SEND messages, incrementing\n\t\t\t// counter as messages are sent.\n\t\t\tthis._message_identifier = 1;\n\n\t\t\t// Used to determine the transmission sequence of stored sent messages.\n\t\t\tthis._sequence = 0;\n\n\n\t\t\t// Load the local state, if any, from the saved version, only restore state relevant to this client.\n\t\t\tfor (var key in localStorage)\n\t\t\t\tif (   key.indexOf(\"Sent:\"+this._localKey) === 0 || key.indexOf(\"Received:\"+this._localKey) === 0)\n\t\t\t\t\tthis.restore(key);\n\t\t};\n\n\t\t// Messaging Client public instance members.\n\t\tClientImpl.prototype.host = null;\n\t\tClientImpl.prototype.port = null;\n\t\tClientImpl.prototype.path = null;\n\t\tClientImpl.prototype.uri = null;\n\t\tClientImpl.prototype.clientId = null;\n\n\t\t// Messaging Client private instance members.\n\t\tClientImpl.prototype.socket = null;\n\t\t/* true once we have received an acknowledgement to a CONNECT packet. */\n\t\tClientImpl.prototype.connected = false;\n\t\t/* The largest message identifier allowed, may not be larger than 2**16 but\n\t\t * if set smaller reduces the maximum number of outbound messages allowed.\n\t\t */\n\t\tClientImpl.prototype.maxMessageIdentifier = 65536;\n\t\tClientImpl.prototype.connectOptions = null;\n\t\tClientImpl.prototype.hostIndex = null;\n\t\tClientImpl.prototype.onConnected = null;\n\t\tClientImpl.prototype.onConnectionLost = null;\n\t\tClientImpl.prototype.onMessageDelivered = null;\n\t\tClientImpl.prototype.onMessageArrived = null;\n\t\tClientImpl.prototype.traceFunction = null;\n\t\tClientImpl.prototype._msg_queue = null;\n\t\tClientImpl.prototype._buffered_msg_queue = null;\n\t\tClientImpl.prototype._connectTimeout = null;\n\t\t/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */\n\t\tClientImpl.prototype.sendPinger = null;\n\t\t/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */\n\t\tClientImpl.prototype.receivePinger = null;\n\t\tClientImpl.prototype._reconnectInterval = 1; // Reconnect Delay, starts at 1 second\n\t\tClientImpl.prototype._reconnecting = false;\n\t\tClientImpl.prototype._reconnectTimeout = null;\n\t\tClientImpl.prototype.disconnectedPublishing = false;\n\t\tClientImpl.prototype.disconnectedBufferSize = 5000;\n\n\t\tClientImpl.prototype.receiveBuffer = null;\n\n\t\tClientImpl.prototype._traceBuffer = null;\n\t\tClientImpl.prototype._MAX_TRACE_ENTRIES = 100;\n\n\t\tClientImpl.prototype.connect = function (connectOptions) {\n\t\t\tvar connectOptionsMasked = this._traceMask(connectOptions, \"password\");\n\t\t\tthis._trace(\"Client.connect\", connectOptionsMasked, this.socket, this.connected);\n\n\t\t\tif (this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\t\t\tif (this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// connect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process to use new connect options.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tthis.connectOptions = connectOptions;\n\t\t\tthis._reconnectInterval = 1;\n\t\t\tthis._reconnecting = false;\n\t\t\tif (connectOptions.uris) {\n\t\t\t\tthis.hostIndex = 0;\n\t\t\t\tthis._doConnect(connectOptions.uris[0]);\n\t\t\t} else {\n\t\t\t\tthis._doConnect(this.uri);\n\t\t\t}\n\n\t\t};\n\n\t\tClientImpl.prototype.subscribe = function (filter, subscribeOptions) {\n\t\t\tthis._trace(\"Client.subscribe\", filter, subscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.SUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n            if (subscribeOptions.qos === undefined)\n                subscribeOptions.qos = 0;\n            wireMessage.requestedQos = [];\n            for (var i = 0; i < wireMessage.topics.length; i++)\n                wireMessage.requestedQos[i] = subscribeOptions.qos;\n\n\t\t\tif (subscribeOptions.onSuccess) {\n\t\t\t\twireMessage.onSuccess = function(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.onFailure) {\n\t\t\t\twireMessage.onFailure = function(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, subscribeOptions.timeout, subscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:subscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.SUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All subscriptions return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype.unsubscribe = function(filter, unsubscribeOptions) {\n\t\t\tthis._trace(\"Client.unsubscribe\", filter, unsubscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n\n\t\t\tif (unsubscribeOptions.onSuccess) {\n\t\t\t\twireMessage.callback = function() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};\n\t\t\t}\n\t\t\tif (unsubscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:unsubscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All unsubscribes return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.send = function (message) {\n\t\t\tthis._trace(\"Client.send\", message);\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.PUBLISH);\n\t\t\twireMessage.payloadMessage = message;\n\n\t\t\tif (this.connected) {\n\t\t\t// Mark qos 1 & 2 message as \"ACK required\"\n\t\t\t// For qos 0 message, invoke onMessageDelivered callback if there is one.\n\t\t\t// Then schedule the message.\n\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t} else if (this.onMessageDelivered) {\n\t\t\t\t\tthis._notify_msg_sent[wireMessage] = this.onMessageDelivered(wireMessage.payloadMessage);\n\t\t\t\t}\n\t\t\t\tthis._schedule_message(wireMessage);\n\t\t\t} else {\n\t\t\t// Currently disconnected, will not schedule this message\n\t\t\t// Check if reconnecting is in progress and disconnected publish is enabled.\n\t\t\t\tif (this._reconnecting && this.disconnectedPublishing) {\n\t\t\t\t// Check the limit which include the \"required ACK\" messages\n\t\t\t\t\tvar messageCount = Object.keys(this._sentMessages).length + this._buffered_msg_queue.length;\n\t\t\t\t\tif (messageCount > this.disconnectedBufferSize) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.BUFFER_FULL, [this.disconnectedBufferSize]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\t\t// Mark this message as \"ACK required\"\n\t\t\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\t\t\t\t\tthis._buffered_msg_queue.unshift(wireMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.disconnect = function () {\n\t\t\tthis._trace(\"Client.disconnect\");\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// disconnect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tif (!this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connecting or connected\"]));\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.DISCONNECT);\n\n\t\t\t// Run the disconnected call back as soon as the message has been sent,\n\t\t\t// in case of a failure later on in the disconnect processing.\n\t\t\t// as a consequence, the _disconected call back may be run several times.\n\t\t\tthis._notify_msg_sent[wireMessage] = scope(this._disconnected, this);\n\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.getTraceLog = function () {\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tthis._trace(\"Client.getTraceLog\", new Date());\n\t\t\t\tthis._trace(\"Client.getTraceLog in flight messages\", this._sentMessages.length);\n\t\t\t\tfor (var key in this._sentMessages)\n\t\t\t\t\tthis._trace(\"_sentMessages \",key, this._sentMessages[key]);\n\t\t\t\tfor (var key in this._receivedMessages)\n\t\t\t\t\tthis._trace(\"_receivedMessages \",key, this._receivedMessages[key]);\n\n\t\t\t\treturn this._traceBuffer;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.startTrace = function () {\n\t\t\tif ( this._traceBuffer === null ) {\n\t\t\t\tthis._traceBuffer = [];\n\t\t\t}\n\t\t\tthis._trace(\"Client.startTrace\", new Date(), version);\n\t\t};\n\n\t\tClientImpl.prototype.stopTrace = function () {\n\t\t\tdelete this._traceBuffer;\n\t\t};\n\n\t\tClientImpl.prototype._doConnect = function (wsurl) {\n\t\t// When the socket is open, this client will send the CONNECT WireMessage using the saved parameters.\n\t\t\tif (this.connectOptions.useSSL) {\n\t\t\t\tvar uriParts = wsurl.split(\":\");\n\t\t\t\turiParts[0] = \"wss\";\n\t\t\t\twsurl = uriParts.join(\":\");\n\t\t\t}\n\t\t\tthis._wsuri = wsurl;\n\t\t\tthis.connected = false;\n\n\n\n\t\t\tif (this.connectOptions.mqttVersion < 4) {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqttv3.1\"]);\n\t\t\t} else {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqtt\"]);\n\t\t\t}\n\t\t\tthis.socket.binaryType = \"arraybuffer\";\n\t\t\tthis.socket.onopen = scope(this._on_socket_open, this);\n\t\t\tthis.socket.onmessage = scope(this._on_socket_message, this);\n\t\t\tthis.socket.onerror = scope(this._on_socket_error, this);\n\t\t\tthis.socket.onclose = scope(this._on_socket_close, this);\n\n\t\t\tthis.sendPinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tthis.receivePinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\t\t\tthis._connectTimeout = new Timeout(this, this.connectOptions.timeout, this._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);\n\t\t};\n\n\n\t\t// Schedule a new message to be sent over the WebSockets\n\t\t// connection. CONNECT messages cause WebSocket connection\n\t\t// to be started. All other messages are queued internally\n\t\t// until this has happened. When WS connection starts, process\n\t\t// all outstanding messages.\n\t\tClientImpl.prototype._schedule_message = function (message) {\n\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\tthis._msg_queue.unshift(message);\n\t\t\t// Process outstanding messages in the queue if we have an  open socket, and have received CONNACK.\n\t\t\tif (this.connected) {\n\t\t\t\tthis._process_queue();\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.store = function(prefix, wireMessage) {\n\t\t\tvar storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};\n\n\t\t\tswitch(wireMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif(wireMessage.pubRecReceived)\n\t\t\t\t\tstoredMessage.pubRecReceived = true;\n\n\t\t\t\t// Convert the payload to a hex string.\n\t\t\t\tstoredMessage.payloadMessage = {};\n\t\t\t\tvar hex = \"\";\n\t\t\t\tvar messageBytes = wireMessage.payloadMessage.payloadBytes;\n\t\t\t\tfor (var i=0; i<messageBytes.length; i++) {\n\t\t\t\t\tif (messageBytes[i] <= 0xF)\n\t\t\t\t\t\thex = hex+\"0\"+messageBytes[i].toString(16);\n\t\t\t\t\telse\n\t\t\t\t\t\thex = hex+messageBytes[i].toString(16);\n\t\t\t\t}\n\t\t\t\tstoredMessage.payloadMessage.payloadHex = hex;\n\n\t\t\t\tstoredMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;\n\t\t\t\tstoredMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;\n\t\t\t\tif (wireMessage.payloadMessage.duplicate)\n\t\t\t\t\tstoredMessage.payloadMessage.duplicate = true;\n\t\t\t\tif (wireMessage.payloadMessage.retained)\n\t\t\t\t\tstoredMessage.payloadMessage.retained = true;\n\n\t\t\t\t// Add a sequence number to sent messages.\n\t\t\t\tif ( prefix.indexOf(\"Sent:\") === 0 ) {\n\t\t\t\t\tif ( wireMessage.sequence === undefined )\n\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\tstoredMessage.sequence = wireMessage.sequence;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [prefix+this._localKey+wireMessage.messageIdentifier, storedMessage]));\n\t\t\t}\n\t\t\tlocalStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));\n\t\t};\n\n\t\tClientImpl.prototype.restore = function(key) {\n\t\t\tvar value = localStorage.getItem(key);\n\t\t\tvar storedMessage = JSON.parse(value);\n\n\t\t\tvar wireMessage = new WireMessage(storedMessage.type, storedMessage);\n\n\t\t\tswitch(storedMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// Replace the payload message with a Message object.\n\t\t\t\tvar hex = storedMessage.payloadMessage.payloadHex;\n\t\t\t\tvar buffer = new ArrayBuffer((hex.length)/2);\n\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (hex.length >= 2) {\n\t\t\t\t\tvar x = parseInt(hex.substring(0, 2), 16);\n\t\t\t\t\thex = hex.substring(2, hex.length);\n\t\t\t\t\tbyteStream[i++] = x;\n\t\t\t\t}\n\t\t\t\tvar payloadMessage = new Message(byteStream);\n\n\t\t\t\tpayloadMessage.qos = storedMessage.payloadMessage.qos;\n\t\t\t\tpayloadMessage.destinationName = storedMessage.payloadMessage.destinationName;\n\t\t\t\tif (storedMessage.payloadMessage.duplicate)\n\t\t\t\t\tpayloadMessage.duplicate = true;\n\t\t\t\tif (storedMessage.payloadMessage.retained)\n\t\t\t\t\tpayloadMessage.retained = true;\n\t\t\t\twireMessage.payloadMessage = payloadMessage;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [key, value]));\n\t\t\t}\n\n\t\t\tif (key.indexOf(\"Sent:\"+this._localKey) === 0) {\n\t\t\t\twireMessage.payloadMessage.duplicate = true;\n\t\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t} else if (key.indexOf(\"Received:\"+this._localKey) === 0) {\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._process_queue = function () {\n\t\t\tvar message = null;\n\n\t\t\t// Send all queued messages down socket connection\n\t\t\twhile ((message = this._msg_queue.pop())) {\n\t\t\t\tthis._socket_send(message);\n\t\t\t\t// Notify listeners that message was successfully sent\n\t\t\t\tif (this._notify_msg_sent[message]) {\n\t\t\t\t\tthis._notify_msg_sent[message]();\n\t\t\t\t\tdelete this._notify_msg_sent[message];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Expect an ACK response for this message. Add message to the set of in progress\n\t * messages and set an unused identifier in this message.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._requires_ack = function (wireMessage) {\n\t\t\tvar messageCount = Object.keys(this._sentMessages).length;\n\t\t\tif (messageCount > this.maxMessageIdentifier)\n\t\t\t\tthrow Error (\"Too many messages:\"+messageCount);\n\n\t\t\twhile(this._sentMessages[this._message_identifier] !== undefined) {\n\t\t\t\tthis._message_identifier++;\n\t\t\t}\n\t\t\twireMessage.messageIdentifier = this._message_identifier;\n\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\tif (wireMessage.type === MESSAGE_TYPE.PUBLISH) {\n\t\t\t\tthis.store(\"Sent:\", wireMessage);\n\t\t\t}\n\t\t\tif (this._message_identifier === this.maxMessageIdentifier) {\n\t\t\t\tthis._message_identifier = 1;\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has been opened.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_open = function () {\n\t\t// Create the CONNECT message object.\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.CONNECT, this.connectOptions);\n\t\t\twireMessage.clientId = this.clientId;\n\t\t\tthis._socket_send(wireMessage);\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has received a complete packet.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_message = function (event) {\n\t\t\tthis._trace(\"Client._on_socket_message\", event.data);\n\t\t\tvar messages = this._deframeMessages(event.data);\n\t\t\tfor (var i = 0; i < messages.length; i+=1) {\n\t\t\t\tthis._handleMessage(messages[i]);\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._deframeMessages = function(data) {\n\t\t\tvar byteArray = new Uint8Array(data);\n\t\t\tvar messages = [];\n\t\t\tif (this.receiveBuffer) {\n\t\t\t\tvar newData = new Uint8Array(this.receiveBuffer.length+byteArray.length);\n\t\t\t\tnewData.set(this.receiveBuffer);\n\t\t\t\tnewData.set(byteArray,this.receiveBuffer.length);\n\t\t\t\tbyteArray = newData;\n\t\t\t\tdelete this.receiveBuffer;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar offset = 0;\n\t\t\t\twhile(offset < byteArray.length) {\n\t\t\t\t\tvar result = decodeMessage(byteArray,offset);\n\t\t\t\t\tvar wireMessage = result[0];\n\t\t\t\t\toffset = result[1];\n\t\t\t\t\tif (wireMessage !== null) {\n\t\t\t\t\t\tmessages.push(wireMessage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (offset < byteArray.length) {\n\t\t\t\t\tthis.receiveBuffer = byteArray.subarray(offset);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn messages;\n\t\t};\n\n\t\tClientImpl.prototype._handleMessage = function(wireMessage) {\n\n\t\t\tthis._trace(\"Client._handleMessage\", wireMessage);\n\n\t\t\ttry {\n\t\t\t\tswitch(wireMessage.type) {\n\t\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\t\tif (this._reconnectTimeout)\n\t\t\t\t\t\tthis._reconnectTimeout.cancel();\n\n\t\t\t\t\t// If we have started using clean session then clear up the local state.\n\t\t\t\t\tif (this.connectOptions.cleanSession) {\n\t\t\t\t\t\tfor (var key in this._sentMessages) {\n\t\t\t\t\t\t\tvar sentMessage = this._sentMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+sentMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._sentMessages = {};\n\n\t\t\t\t\t\tfor (var key in this._receivedMessages) {\n\t\t\t\t\t\t\tvar receivedMessage = this._receivedMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+receivedMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._receivedMessages = {};\n\t\t\t\t\t}\n\t\t\t\t\t// Client connected and ready for business.\n\t\t\t\t\tif (wireMessage.returnCode === 0) {\n\n\t\t\t\t\t\tthis.connected = true;\n\t\t\t\t\t\t// Jump to the end of the list of uris and stop looking for a good host.\n\n\t\t\t\t\t\tif (this.connectOptions.uris)\n\t\t\t\t\t\t\tthis.hostIndex = this.connectOptions.uris.length;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Resend messages.\n\t\t\t\t\tvar sequencedMessages = [];\n\t\t\t\t\tfor (var msgId in this._sentMessages) {\n\t\t\t\t\t\tif (this._sentMessages.hasOwnProperty(msgId))\n\t\t\t\t\t\t\tsequencedMessages.push(this._sentMessages[msgId]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Also schedule qos 0 buffered messages if any\n\t\t\t\t\tif (this._buffered_msg_queue.length > 0) {\n\t\t\t\t\t\tvar msg = null;\n\t\t\t\t\t\twhile ((msg = this._buffered_msg_queue.pop())) {\n\t\t\t\t\t\t\tsequencedMessages.push(msg);\n\t\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\t\tthis._notify_msg_sent[msg] = this.onMessageDelivered(msg.payloadMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sort sentMessages into the original sent order.\n\t\t\t\t\tvar sequencedMessages = sequencedMessages.sort(function(a,b) {return a.sequence - b.sequence;} );\n\t\t\t\t\tfor (var i=0, len=sequencedMessages.length; i<len; i++) {\n\t\t\t\t\t\tvar sentMessage = sequencedMessages[i];\n\t\t\t\t\t\tif (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {\n\t\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});\n\t\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._schedule_message(sentMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the connectOptions.onSuccess callback if there is one.\n\t\t\t\t\t// Will also now return if this connection was the result of an automatic\n\t\t\t\t\t// reconnect and which URI was successfully connected to.\n\t\t\t\t\tif (this.connectOptions.onSuccess) {\n\t\t\t\t\t\tthis.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar reconnected = false;\n\t\t\t\t\tif (this._reconnecting) {\n\t\t\t\t\t\treconnected = true;\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnecting = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the onConnected callback if there is one.\n\t\t\t\t\tthis._connected(reconnected, this._wsuri);\n\n\t\t\t\t\t// Process all queued messages now that the connection is established.\n\t\t\t\t\tthis._process_queue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t\tthis._receivePublish(wireMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBACK after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREC:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBREC after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tsentMessage.pubRecReceived = true;\n\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\t\tthis.store(\"Sent:\", sentMessage);\n\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\t\tvar receivedMessage = this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t// If this is a re flow of a PUBREL after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (receivedMessage) {\n\t\t\t\t\t\tthis._receiveMessage(receivedMessage);\n\t\t\t\t\t\tdelete this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\t// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.\n\t\t\t\t\tvar pubCompMessage = new WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\tthis._schedule_message(pubCompMessage);\n\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.SUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif(sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\t// This will need to be fixed when we add multiple topic support\n\t\t\t\t\t\tif (wireMessage.returnCode[0] === 0x80) {\n\t\t\t\t\t\t\tif (sentMessage.onFailure) {\n\t\t\t\t\t\t\t\tsentMessage.onFailure(wireMessage.returnCode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (sentMessage.onSuccess) {\n\t\t\t\t\t\t\tsentMessage.onSuccess(wireMessage.returnCode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.UNSUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif (sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\tif (sentMessage.callback) {\n\t\t\t\t\t\t\tsentMessage.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PINGRESP:\n\t\t\t\t/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */\n\t\t\t\t\tthis.sendPinger.reset();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\t// Clients do not expect to receive disconnect packets.\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_error = function (error) {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_close = function () {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._socket_send = function (wireMessage) {\n\n\t\t\tif (wireMessage.type == 1) {\n\t\t\t\tvar wireMessageMasked = this._traceMask(wireMessage, \"password\");\n\t\t\t\tthis._trace(\"Client._socket_send\", wireMessageMasked);\n\t\t\t}\n\t\t\telse this._trace(\"Client._socket_send\", wireMessage);\n\n\t\t\tthis.socket.send(wireMessage.encode());\n\t\t\t/* We have proved to the server we are alive. */\n\t\t\tthis.sendPinger.reset();\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receivePublish = function (wireMessage) {\n\t\t\tswitch(wireMessage.payloadMessage.qos) {\n\t\t\tcase \"undefined\":\n\t\t\tcase 0:\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\tvar pubAckMessage = new WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubAckMessage);\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t\tthis.store(\"Received:\", wireMessage);\n\t\t\t\tvar pubRecMessage = new WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubRecMessage);\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(\"Invaild qos=\" + wireMessage.payloadMessage.qos);\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receiveMessage = function (wireMessage) {\n\t\t\tif (this.onMessageArrived) {\n\t\t\t\tthis.onMessageArrived(wireMessage.payloadMessage);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has connected.\n\t * @param {reconnect} [boolean] indicate if this was a result of reconnect operation.\n\t * @param {uri} [string] fully qualified WebSocket URI of the server.\n\t */\n\t\tClientImpl.prototype._connected = function (reconnect, uri) {\n\t\t// Execute the onConnected callback if there is one.\n\t\t\tif (this.onConnected)\n\t\t\t\tthis.onConnected(reconnect, uri);\n\t\t};\n\n\t\t/**\n\t * Attempts to reconnect the client to the server.\n   * For each reconnect attempt, will double the reconnect interval\n   * up to 128 seconds.\n\t */\n\t\tClientImpl.prototype._reconnect = function () {\n\t\t\tthis._trace(\"Client._reconnect\");\n\t\t\tif (!this.connected) {\n\t\t\t\tthis._reconnecting = true;\n\t\t\t\tthis.sendPinger.cancel();\n\t\t\t\tthis.receivePinger.cancel();\n\t\t\t\tif (this._reconnectInterval < 128)\n\t\t\t\t\tthis._reconnectInterval = this._reconnectInterval * 2;\n\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has disconnected either at its own request or because the server\n\t * or network disconnected it. Remove all non-durable state.\n\t * @param {errorCode} [number] the error number.\n\t * @param {errorText} [string] the error text.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._disconnected = function (errorCode, errorText) {\n\t\t\tthis._trace(\"Client._disconnected\", errorCode, errorText);\n\n\t\t\tif (errorCode !== undefined && this._reconnecting) {\n\t\t\t\t//Continue automatic reconnect process\n\t\t\t\tthis._reconnectTimeout = new Timeout(this, this._reconnectInterval, this._reconnect);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendPinger.cancel();\n\t\t\tthis.receivePinger.cancel();\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\n\t\t\t// Clear message buffers.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\tif (this.socket) {\n\t\t\t// Cancel all socket callbacks so that they cannot be driven again by this socket.\n\t\t\t\tthis.socket.onopen = null;\n\t\t\t\tthis.socket.onmessage = null;\n\t\t\t\tthis.socket.onerror = null;\n\t\t\t\tthis.socket.onclose = null;\n\t\t\t\tif (this.socket.readyState === 1)\n\t\t\t\t\tthis.socket.close();\n\t\t\t\tdelete this.socket;\n\t\t\t}\n\n\t\t\tif (this.connectOptions.uris && this.hostIndex < this.connectOptions.uris.length-1) {\n\t\t\t// Try the next host.\n\t\t\t\tthis.hostIndex++;\n\t\t\t\tthis._doConnect(this.connectOptions.uris[this.hostIndex]);\n\t\t\t} else {\n\n\t\t\t\tif (errorCode === undefined) {\n\t\t\t\t\terrorCode = ERROR.OK.code;\n\t\t\t\t\terrorText = format(ERROR.OK);\n\t\t\t\t}\n\n\t\t\t\t// Run any application callbacks last as they may attempt to reconnect and hence create a new socket.\n\t\t\t\tif (this.connected) {\n\t\t\t\t\tthis.connected = false;\n\t\t\t\t\t// Execute the connectionLostCallback if there is one, and we were connected.\n\t\t\t\t\tif (this.onConnectionLost) {\n\t\t\t\t\t\tthis.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:this.connectOptions.reconnect, uri:this._wsuri});\n\t\t\t\t\t}\n\t\t\t\t\tif (errorCode !== ERROR.OK.code && this.connectOptions.reconnect) {\n\t\t\t\t\t// Start automatic reconnect process for the very first time since last successful connect.\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnect();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t// Otherwise we never had a connection, so indicate that the connect has failed.\n\t\t\t\t\tif (this.connectOptions.mqttVersion === 4 && this.connectOptions.mqttVersionExplicit === false) {\n\t\t\t\t\t\tthis._trace(\"Failed to connect V4, dropping back to V3\");\n\t\t\t\t\t\tthis.connectOptions.mqttVersion = 3;\n\t\t\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(this.connectOptions.onFailure) {\n\t\t\t\t\t\tthis.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._trace = function () {\n\t\t// Pass trace message back to client's callback function\n\t\t\tif (this.traceFunction) {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\tfor (var i in args)\n\t\t\t\t{\n\t\t\t\t\tif (typeof args[i] !== \"undefined\")\n\t\t\t\t\t\targs.splice(i, 1, JSON.stringify(args[i]));\n\t\t\t\t}\n\t\t\t\tvar record = args.join(\"\");\n\t\t\t\tthis.traceFunction ({severity: \"Debug\", message: record\t});\n\t\t\t}\n\n\t\t\t//buffer style trace\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tfor (var i = 0, max = arguments.length; i < max; i++) {\n\t\t\t\t\tif ( this._traceBuffer.length == this._MAX_TRACE_ENTRIES ) {\n\t\t\t\t\t\tthis._traceBuffer.shift();\n\t\t\t\t\t}\n\t\t\t\t\tif (i === 0) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse if (typeof arguments[i] === \"undefined\" ) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse this._traceBuffer.push(\"  \"+JSON.stringify(arguments[i]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._traceMask = function (traceObject, masked) {\n\t\t\tvar traceObjectMasked = {};\n\t\t\tfor (var attr in traceObject) {\n\t\t\t\tif (traceObject.hasOwnProperty(attr)) {\n\t\t\t\t\tif (attr == masked)\n\t\t\t\t\t\ttraceObjectMasked[attr] = \"******\";\n\t\t\t\t\telse\n\t\t\t\t\t\ttraceObjectMasked[attr] = traceObject[attr];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn traceObjectMasked;\n\t\t};\n\n\t\t// ------------------------------------------------------------------------\n\t\t// Public Programming interface.\n\t\t// ------------------------------------------------------------------------\n\n\t\t/**\n\t * The JavaScript application communicates to the server using a {@link Paho.Client} object.\n\t * <p>\n\t * Most applications will create just one Client object and then call its connect() method,\n\t * however applications can create more than one Client object if they wish.\n\t * In this case the combination of host, port and clientId attributes must be different for each Client object.\n\t * <p>\n\t * The send, subscribe and unsubscribe methods are implemented as asynchronous JavaScript methods\n\t * (even though the underlying protocol exchange might be synchronous in nature).\n\t * This means they signal their completion by calling back to the application,\n\t * via Success or Failure callback functions provided by the application on the method in question.\n\t * Such callbacks are called at most once per method invocation and do not persist beyond the lifetime\n\t * of the script that made the invocation.\n\t * <p>\n\t * In contrast there are some callback functions, most notably <i>onMessageArrived</i>,\n\t * that are defined on the {@link Paho.Client} object.\n\t * These may get called multiple times, and aren't directly related to specific method invocations made by the client.\n\t *\n\t * @name Paho.Client\n\t *\n\t * @constructor\n\t *\n\t * @param {string} host - the address of the messaging server, as a fully qualified WebSocket URI, as a DNS name or dotted decimal IP address.\n\t * @param {number} port - the port number to connect to - only required if host is not a URI\n\t * @param {string} path - the path on the host to connect to - only used if host is not a URI. Default: '/mqtt'.\n\t * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters in length.\n\t *\n\t * @property {string} host - <i>read only</i> the server's DNS hostname or dotted decimal IP address.\n\t * @property {number} port - <i>read only</i> the server's port.\n\t * @property {string} path - <i>read only</i> the server's path.\n\t * @property {string} clientId - <i>read only</i> used when connecting to the server.\n\t * @property {function} onConnectionLost - called when a connection has been lost.\n\t *                            after a connect() method has succeeded.\n\t *                            Establish the call back used when a connection has been lost. The connection may be\n\t *                            lost because the client initiates a disconnect or because the server or network\n\t *                            cause the client to be disconnected. The disconnect call back may be called without\n\t *                            the connectionComplete call back being invoked if, for example the client fails to\n\t *                            connect.\n\t *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:\n\t *                            <ol>\n\t *                            <li>errorCode\n\t *                            <li>errorMessage\n\t *                            </ol>\n\t * @property {function} onMessageDelivered - called when a message has been delivered.\n\t *                            All processing that this Client will ever do has been completed. So, for example,\n\t *                            in the case of a Qos=2 message sent by this client, the PubComp flow has been received from the server\n\t *                            and the message has been removed from persistent storage before this callback is invoked.\n\t *                            Parameters passed to the onMessageDelivered callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that was delivered.\n\t *                            </ol>\n\t * @property {function} onMessageArrived - called when a message has arrived in this Paho.client.\n\t *                            Parameters passed to the onMessageArrived callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that has arrived.\n\t *                            </ol>\n\t * @property {function} onConnected - called when a connection is successfully made to the server.\n\t *                                  after a connect() method.\n\t *                                  Parameters passed to the onConnected callback are:\n\t *                                  <ol>\n\t *                                  <li>reconnect (boolean) - If true, the connection was the result of a reconnect.</li>\n\t *                                  <li>URI (string) - The URI used to connect to the server.</li>\n\t *                                  </ol>\n\t * @property {boolean} disconnectedPublishing - if set, will enable disconnected publishing in\n\t *                                            in the event that the connection to the server is lost.\n\t * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected\n\t *                                             buffer will hold before rejecting new messages. Default size: 5000 messages\n\t * @property {function} trace - called whenever trace is called. TODO\n\t */\n\t\tvar Client = function (host, port, path, clientId) {\n\n\t\t\tvar uri;\n\n\t\t\tif (typeof host !== \"string\")\n\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof host, \"host\"]));\n\n\t\t\tif (arguments.length == 2) {\n\t\t\t// host: must be full ws:// uri\n\t\t\t// port: clientId\n\t\t\t\tclientId = port;\n\t\t\t\turi = host;\n\t\t\t\tvar match = uri.match(/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/);\n\t\t\t\tif (match) {\n\t\t\t\t\thost = match[4]||match[2];\n\t\t\t\t\tport = parseInt(match[7]);\n\t\t\t\t\tpath = match[8];\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[host,\"host\"]));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (arguments.length == 3) {\n\t\t\t\t\tclientId = path;\n\t\t\t\t\tpath = \"/mqtt\";\n\t\t\t\t}\n\t\t\t\tif (typeof port !== \"number\" || port < 0)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof port, \"port\"]));\n\t\t\t\tif (typeof path !== \"string\")\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof path, \"path\"]));\n\n\t\t\t\tvar ipv6AddSBracket = (host.indexOf(\":\") !== -1 && host.slice(0,1) !== \"[\" && host.slice(-1) !== \"]\");\n\t\t\t\turi = \"ws://\"+(ipv6AddSBracket?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t}\n\n\t\t\tvar clientIdLength = 0;\n\t\t\tfor (var i = 0; i<clientId.length; i++) {\n\t\t\t\tvar charCode = clientId.charCodeAt(i);\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)  {\n\t\t\t\t\ti++; // Surrogate pair.\n\t\t\t\t}\n\t\t\t\tclientIdLength++;\n\t\t\t}\n\t\t\tif (typeof clientId !== \"string\" || clientIdLength > 65535)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [clientId, \"clientId\"]));\n\n\t\t\tvar client = new ClientImpl(uri, host, port, path, clientId);\n\n\t\t\t//Public Properties\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"host\":{\n\t\t\t\t\tget: function() { return host; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"port\":{\n\t\t\t\t\tget: function() { return port; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"path\":{\n\t\t\t\t\tget: function() { return path; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"uri\":{\n\t\t\t\t\tget: function() { return uri; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"clientId\":{\n\t\t\t\t\tget: function() { return client.clientId; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"onConnected\":{\n\t\t\t\t\tget: function() { return client.onConnected; },\n\t\t\t\t\tset: function(newOnConnected) {\n\t\t\t\t\t\tif (typeof newOnConnected === \"function\")\n\t\t\t\t\t\t\tclient.onConnected = newOnConnected;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnected, \"onConnected\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedPublishing\":{\n\t\t\t\t\tget: function() { return client.disconnectedPublishing; },\n\t\t\t\t\tset: function(newDisconnectedPublishing) {\n\t\t\t\t\t\tclient.disconnectedPublishing = newDisconnectedPublishing;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedBufferSize\":{\n\t\t\t\t\tget: function() { return client.disconnectedBufferSize; },\n\t\t\t\t\tset: function(newDisconnectedBufferSize) {\n\t\t\t\t\t\tclient.disconnectedBufferSize = newDisconnectedBufferSize;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onConnectionLost\":{\n\t\t\t\t\tget: function() { return client.onConnectionLost; },\n\t\t\t\t\tset: function(newOnConnectionLost) {\n\t\t\t\t\t\tif (typeof newOnConnectionLost === \"function\")\n\t\t\t\t\t\t\tclient.onConnectionLost = newOnConnectionLost;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnectionLost, \"onConnectionLost\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageDelivered\":{\n\t\t\t\t\tget: function() { return client.onMessageDelivered; },\n\t\t\t\t\tset: function(newOnMessageDelivered) {\n\t\t\t\t\t\tif (typeof newOnMessageDelivered === \"function\")\n\t\t\t\t\t\t\tclient.onMessageDelivered = newOnMessageDelivered;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageDelivered, \"onMessageDelivered\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageArrived\":{\n\t\t\t\t\tget: function() { return client.onMessageArrived; },\n\t\t\t\t\tset: function(newOnMessageArrived) {\n\t\t\t\t\t\tif (typeof newOnMessageArrived === \"function\")\n\t\t\t\t\t\t\tclient.onMessageArrived = newOnMessageArrived;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageArrived, \"onMessageArrived\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"trace\":{\n\t\t\t\t\tget: function() { return client.traceFunction; },\n\t\t\t\t\tset: function(trace) {\n\t\t\t\t\t\tif(typeof trace === \"function\"){\n\t\t\t\t\t\t\tclient.traceFunction = trace;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof trace, \"onTrace\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t/**\n\t\t * Connect this Messaging client to its server.\n\t\t *\n\t\t * @name Paho.Client#connect\n\t\t * @function\n\t\t * @param {object} connectOptions - Attributes used with the connection.\n\t\t * @param {number} connectOptions.timeout - If the connect has not succeeded within this\n\t\t *                    number of seconds, it is deemed to have failed.\n\t\t *                    The default is 30 seconds.\n\t\t * @param {string} connectOptions.userName - Authentication username for this connection.\n\t\t * @param {string} connectOptions.password - Authentication password for this connection.\n\t\t * @param {Paho.Message} connectOptions.willMessage - sent by the server when the client\n\t\t *                    disconnects abnormally.\n\t\t * @param {number} connectOptions.keepAliveInterval - the server disconnects this client if\n\t\t *                    there is no activity for this number of seconds.\n\t\t *                    The default value of 60 seconds is assumed if not set.\n\t\t * @param {boolean} connectOptions.cleanSession - if true(default) the client and server\n\t\t *                    persistent state is deleted on successful connect.\n\t\t * @param {boolean} connectOptions.useSSL - if present and true, use an SSL Websocket connection.\n\t\t * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.\n\t\t * @param {function} connectOptions.onSuccess - called when the connect acknowledgement\n\t\t *                    has been received from the server.\n\t\t * A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onSuccess method in the connectOptions.\n\t\t * </ol>\n\t * @param {function} connectOptions.onFailure - called when the connect request has failed or timed out.\n\t\t * A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onFailure method in the connectOptions.\n\t\t * <li>errorCode a number indicating the nature of the error.\n\t\t * <li>errorMessage text describing the error.\n\t\t * </ol>\n\t * @param {array} connectOptions.hosts - If present this contains either a set of hostnames or fully qualified\n\t\t * WebSocket URIs (ws://iot.eclipse.org:80/ws), that are tried in order in place\n\t\t * of the host and port paramater on the construtor. The hosts are tried one at at time in order until\n\t\t * one of then succeeds.\n\t * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, this property\n\t\t * is not used.\n\t * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect\n\t * to the server if the connection is lost.\n\t *<ul>\n\t *<li>If set to false, the client will not attempt to automatically reconnect to the server in the event that the\n\t * connection is lost.</li>\n\t *<li>If set to true, in the event that the connection is lost, the client will attempt to reconnect to the server.\n\t * It will initially wait 1 second before it attempts to reconnect, for every failed reconnect attempt, the delay\n\t * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.</li>\n\t *</ul>\n\t * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.\n\t *<ul>\n\t *<li>3 - MQTT V3.1</li>\n\t *<li>4 - MQTT V3.1.1</li>\n\t *</ul>\n\t * @param {boolean} connectOptions.mqttVersionExplicit - If set to true, will force the connection to use the\n\t * selected MQTT Version or will fail to connect.\n\t * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris\n\t * (e.g. ws://iot.eclipse.org:80/ws), that are tried in order in place of the host and port parameter of the construtor.\n\t * The uris are tried one at a time in order until one of them succeeds. Do not use this in conjunction with hosts as\n\t * the hosts array will be converted to uris and will overwrite this property.\n\t\t * @throws {InvalidState} If the client is not in disconnected state. The client must have received connectionLost\n\t\t * or disconnected before calling connect for a second or subsequent time.\n\t\t */\n\t\t\tthis.connect = function (connectOptions) {\n\t\t\t\tconnectOptions = connectOptions || {} ;\n\t\t\t\tvalidate(connectOptions,  {timeout:\"number\",\n\t\t\t\t\tuserName:\"string\",\n\t\t\t\t\tpassword:\"string\",\n\t\t\t\t\twillMessage:\"object\",\n\t\t\t\t\tkeepAliveInterval:\"number\",\n\t\t\t\t\tcleanSession:\"boolean\",\n\t\t\t\t\tuseSSL:\"boolean\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\thosts:\"object\",\n\t\t\t\t\tports:\"object\",\n\t\t\t\t\treconnect:\"boolean\",\n\t\t\t\t\tmqttVersion:\"number\",\n\t\t\t\t\tmqttVersionExplicit:\"boolean\",\n\t\t\t\t\turis: \"object\"});\n\n\t\t\t\t// If no keep alive interval is set, assume 60 seconds.\n\t\t\t\tif (connectOptions.keepAliveInterval === undefined)\n\t\t\t\t\tconnectOptions.keepAliveInterval = 60;\n\n\t\t\t\tif (connectOptions.mqttVersion > 4 || connectOptions.mqttVersion < 3) {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, \"connectOptions.mqttVersion\"]));\n\t\t\t\t}\n\n\t\t\t\tif (connectOptions.mqttVersion === undefined) {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = false;\n\t\t\t\t\tconnectOptions.mqttVersion = 4;\n\t\t\t\t} else {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = true;\n\t\t\t\t}\n\n\t\t\t\t//Check that if password is set, so is username\n\t\t\t\tif (connectOptions.password !== undefined && connectOptions.userName === undefined)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, \"connectOptions.password\"]));\n\n\t\t\t\tif (connectOptions.willMessage) {\n\t\t\t\t\tif (!(connectOptions.willMessage instanceof Message))\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, \"connectOptions.willMessage\"]));\n\t\t\t\t\t// The will message must have a payload that can be represented as a string.\n\t\t\t\t\t// Cause the willMessage to throw an exception if this is not the case.\n\t\t\t\t\tconnectOptions.willMessage.stringPayload = null;\n\n\t\t\t\t\tif (typeof connectOptions.willMessage.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.willMessage.destinationName, \"connectOptions.willMessage.destinationName\"]));\n\t\t\t\t}\n\t\t\t\tif (typeof connectOptions.cleanSession === \"undefined\")\n\t\t\t\t\tconnectOptions.cleanSession = true;\n\t\t\t\tif (connectOptions.hosts) {\n\n\t\t\t\t\tif (!(connectOptions.hosts instanceof Array) )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\t\t\t\t\tif (connectOptions.hosts.length <1 )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\n\t\t\t\t\tvar usingURIs = false;\n\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\tif (typeof connectOptions.hosts[i] !== \"string\")\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\tif (/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/.test(connectOptions.hosts[i])) {\n\t\t\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\t\t\tusingURIs = true;\n\t\t\t\t\t\t\t} else if (!usingURIs) {\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (usingURIs) {\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!usingURIs) {\n\t\t\t\t\t\tif (!connectOptions.ports)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (!(connectOptions.ports instanceof Array) )\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (connectOptions.hosts.length !== connectOptions.ports.length)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\n\t\t\t\t\t\tconnectOptions.uris = [];\n\n\t\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\t\tif (typeof connectOptions.ports[i] !== \"number\" || connectOptions.ports[i] < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.ports[i], \"connectOptions.ports[\"+i+\"]\"]));\n\t\t\t\t\t\t\tvar host = connectOptions.hosts[i];\n\t\t\t\t\t\t\tvar port = connectOptions.ports[i];\n\n\t\t\t\t\t\t\tvar ipv6 = (host.indexOf(\":\") !== -1);\n\t\t\t\t\t\t\turi = \"ws://\"+(ipv6?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t\t\t\t\tconnectOptions.uris.push(uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconnectOptions.uris = connectOptions.hosts;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tclient.connect(connectOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Subscribe for messages, request receipt of a copy of messages sent to the destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#subscribe\n\t\t * @function\n\t\t * @param {string} filter describing the destinations to receive messages from.\n\t\t * <br>\n\t\t * @param {object} subscribeOptions - used to control the subscription\n\t\t *\n\t\t * @param {number} subscribeOptions.qos - the maximum qos of any publications sent\n\t\t *                                  as a result of making this subscription.\n\t\t * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t *                                  or onFailure callback.\n\t\t * @param {function} subscribeOptions.onSuccess - called when the subscribe acknowledgement\n\t\t *                                  has been received from the server.\n\t\t *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext if set in the subscribeOptions.\n\t\t *                                  </ol>\n\t\t * @param {function} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.\n\t\t *                                  A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext - if set in the subscribeOptions.\n\t\t *                                  <li>errorCode - a number indicating the nature of the error.\n\t\t *                                  <li>errorMessage - text describing the error.\n\t\t *                                  </ol>\n\t\t * @param {number} subscribeOptions.timeout - which, if present, determines the number of\n\t\t *                                  seconds after which the onFailure calback is called.\n\t\t *                                  The presence of a timeout does not prevent the onSuccess\n\t\t *                                  callback from being called when the subscribe completes.\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.subscribe = function (filter, subscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tsubscribeOptions = subscribeOptions || {} ;\n\t\t\t\tvalidate(subscribeOptions,  {qos:\"number\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (subscribeOptions.timeout && !subscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"subscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tif (typeof subscribeOptions.qos !== \"undefined\" && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, \"subscribeOptions.qos\"]));\n\t\t\t\tclient.subscribe(filter, subscribeOptions);\n\t\t\t};\n\n\t\t/**\n\t\t * Unsubscribe for messages, stop receiving messages sent to destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#unsubscribe\n\t\t * @function\n\t\t * @param {string} filter - describing the destinations to receive messages from.\n\t\t * @param {object} unsubscribeOptions - used to control the subscription\n\t\t * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t\t\t\t\t\t\t\t\t\t  or onFailure callback.\n\t\t * @param {function} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received from the server.\n\t\t *                                    A single response object parameter is passed to the\n\t\t *                                    onSuccess callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    </ol>\n\t\t * @param {function} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.\n\t\t *                                    A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    <li>errorCode - a number indicating the nature of the error.\n\t\t *                                    <li>errorMessage - text describing the error.\n\t\t *                                    </ol>\n\t\t * @param {number} unsubscribeOptions.timeout - which, if present, determines the number of seconds\n\t\t *                                    after which the onFailure callback is called. The presence of\n\t\t *                                    a timeout does not prevent the onSuccess callback from being\n\t\t *                                    called when the unsubscribe completes\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.unsubscribe = function (filter, unsubscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tunsubscribeOptions = unsubscribeOptions || {} ;\n\t\t\t\tvalidate(unsubscribeOptions,  {invocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"unsubscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tclient.unsubscribe(filter, unsubscribeOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Send a message to the consumers of the destination in the Message.\n\t\t *\n\t\t * @name Paho.Client#send\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the destination to which the message is to be sent.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be sent.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.send = function (topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Publish a message to the consumers of the destination in the Message.\n\t\t * Synonym for Paho.Mqtt.Client#send\n\t\t *\n\t\t * @name Paho.Client#publish\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the topic to which the message is to be published.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be published.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.publish = function(topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Normal disconnect of this Messaging client from its server.\n\t\t *\n\t\t * @name Paho.Client#disconnect\n\t\t * @function\n\t\t * @throws {InvalidState} if the client is already disconnected.\n\t\t */\n\t\t\tthis.disconnect = function () {\n\t\t\t\tclient.disconnect();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Get the contents of the trace log.\n\t\t *\n\t\t * @name Paho.Client#getTraceLog\n\t\t * @function\n\t\t * @return {Object[]} tracebuffer containing the time ordered trace records.\n\t\t */\n\t\t\tthis.getTraceLog = function () {\n\t\t\t\treturn client.getTraceLog();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Start tracing.\n\t\t *\n\t\t * @name Paho.Client#startTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.startTrace = function () {\n\t\t\t\tclient.startTrace();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Stop tracing.\n\t\t *\n\t\t * @name Paho.Client#stopTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.stopTrace = function () {\n\t\t\t\tclient.stopTrace();\n\t\t\t};\n\n\t\t\tthis.isConnected = function() {\n\t\t\t\treturn client.connected;\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * An application message, sent or received.\n\t * <p>\n\t * All attributes may be null, which implies the default values.\n\t *\n\t * @name Paho.Message\n\t * @constructor\n\t * @param {String|ArrayBuffer} payload The message data to be sent.\n\t * <p>\n\t * @property {string} payloadString <i>read only</i> The payload as a string if the payload consists of valid UTF-8 characters.\n\t * @property {ArrayBuffer} payloadBytes <i>read only</i> The payload as an ArrayBuffer.\n\t * <p>\n\t * @property {string} destinationName <b>mandatory</b> The name of the destination to which the message is to be sent\n\t *                    (for messages about to be sent) or the name of the destination from which the message has been received.\n\t *                    (for messages received by the onMessage function).\n\t * <p>\n\t * @property {number} qos The Quality of Service used to deliver the message.\n\t * <dl>\n\t *     <dt>0 Best effort (default).\n\t *     <dt>1 At least once.\n\t *     <dt>2 Exactly once.\n\t * </dl>\n\t * <p>\n\t * @property {Boolean} retained If true, the message is to be retained by the server and delivered\n\t *                     to both current and future subscriptions.\n\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t *                     A received message has the retained boolean set to true if the message was published\n\t *                     with the retained boolean set to true\n\t *                     and the subscrption was made after the message has been published.\n\t * <p>\n\t * @property {Boolean} duplicate <i>read only</i> If true, this message might be a duplicate of one which has already been received.\n\t *                     This is only set on messages received from the server.\n\t *\n\t */\n\t\tvar Message = function (newPayload) {\n\t\t\tvar payload;\n\t\t\tif (   typeof newPayload === \"string\" ||\n\t\tnewPayload instanceof ArrayBuffer ||\n\t\t(ArrayBuffer.isView(newPayload) && !(newPayload instanceof DataView))\n\t\t\t) {\n\t\t\t\tpayload = newPayload;\n\t\t\t} else {\n\t\t\t\tthrow (format(ERROR.INVALID_ARGUMENT, [newPayload, \"newPayload\"]));\n\t\t\t}\n\n\t\t\tvar destinationName;\n\t\t\tvar qos = 0;\n\t\t\tvar retained = false;\n\t\t\tvar duplicate = false;\n\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"payloadString\":{\n\t\t\t\t\tenumerable : true,\n\t\t\t\t\tget : function () {\n\t\t\t\t\t\tif (typeof payload === \"string\")\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn parseUTF8(payload, 0, payload.length);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"payloadBytes\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\tif (typeof payload === \"string\") {\n\t\t\t\t\t\t\tvar buffer = new ArrayBuffer(UTF8Length(payload));\n\t\t\t\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\t\t\t\tstringToUTF8(payload, byteStream, 0);\n\n\t\t\t\t\t\t\treturn byteStream;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"destinationName\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newDestinationName) {\n\t\t\t\t\t\tif (typeof newDestinationName === \"string\")\n\t\t\t\t\t\t\tdestinationName = newDestinationName;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, \"newDestinationName\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"qos\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return qos; },\n\t\t\t\t\tset: function(newQos) {\n\t\t\t\t\t\tif (newQos === 0 || newQos === 1 || newQos === 2 )\n\t\t\t\t\t\t\tqos = newQos;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+newQos);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"retained\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return retained; },\n\t\t\t\t\tset: function(newRetained) {\n\t\t\t\t\t\tif (typeof newRetained === \"boolean\")\n\t\t\t\t\t\t\tretained = newRetained;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newRetained, \"newRetained\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"topic\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newTopic) {destinationName=newTopic;}\n\t\t\t\t},\n\t\t\t\t\"duplicate\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return duplicate; },\n\t\t\t\t\tset: function(newDuplicate) {duplicate=newDuplicate;}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// Module contents.\n\t\treturn {\n\t\t\tClient: Client,\n\t\t\tMessage: Message\n\t\t};\n\t// eslint-disable-next-line no-nested-ternary\n\t})(typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {});\n\treturn PahoMQTT;\n});\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar punycode = require('punycode');\nvar util = require('./util');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n","'use strict';\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]]\n  ]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/uuidjs/uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","import zenObservable from 'zen-observable';\n\nvar Observable = zenObservable;\n\nexport default Observable;\nexport { Observable };\n//# sourceMappingURL=bundle.esm.js.map\n","module.exports = require('./lib/Observable.js').Observable;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Observable = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// === Symbol Support ===\nvar hasSymbols = function () {\n  return typeof Symbol === 'function';\n};\n\nvar hasSymbol = function (name) {\n  return hasSymbols() && Boolean(Symbol[name]);\n};\n\nvar getSymbol = function (name) {\n  return hasSymbol(name) ? Symbol[name] : '@@' + name;\n};\n\nif (hasSymbols() && !hasSymbol('observable')) {\n  Symbol.observable = Symbol('observable');\n}\n\nvar SymbolIterator = getSymbol('iterator');\nvar SymbolObservable = getSymbol('observable');\nvar SymbolSpecies = getSymbol('species'); // === Abstract Operations ===\n\nfunction getMethod(obj, key) {\n  var value = obj[key];\n  if (value == null) return undefined;\n  if (typeof value !== 'function') throw new TypeError(value + ' is not a function');\n  return value;\n}\n\nfunction getSpecies(obj) {\n  var ctor = obj.constructor;\n\n  if (ctor !== undefined) {\n    ctor = ctor[SymbolSpecies];\n\n    if (ctor === null) {\n      ctor = undefined;\n    }\n  }\n\n  return ctor !== undefined ? ctor : Observable;\n}\n\nfunction isObservable(x) {\n  return x instanceof Observable; // SPEC: Brand check\n}\n\nfunction hostReportError(e) {\n  if (hostReportError.log) {\n    hostReportError.log(e);\n  } else {\n    setTimeout(function () {\n      throw e;\n    });\n  }\n}\n\nfunction enqueue(fn) {\n  Promise.resolve().then(function () {\n    try {\n      fn();\n    } catch (e) {\n      hostReportError(e);\n    }\n  });\n}\n\nfunction cleanupSubscription(subscription) {\n  var cleanup = subscription._cleanup;\n  if (cleanup === undefined) return;\n  subscription._cleanup = undefined;\n\n  if (!cleanup) {\n    return;\n  }\n\n  try {\n    if (typeof cleanup === 'function') {\n      cleanup();\n    } else {\n      var unsubscribe = getMethod(cleanup, 'unsubscribe');\n\n      if (unsubscribe) {\n        unsubscribe.call(cleanup);\n      }\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n}\n\nfunction closeSubscription(subscription) {\n  subscription._observer = undefined;\n  subscription._queue = undefined;\n  subscription._state = 'closed';\n}\n\nfunction flushSubscription(subscription) {\n  var queue = subscription._queue;\n\n  if (!queue) {\n    return;\n  }\n\n  subscription._queue = undefined;\n  subscription._state = 'ready';\n\n  for (var i = 0; i < queue.length; ++i) {\n    notifySubscription(subscription, queue[i].type, queue[i].value);\n    if (subscription._state === 'closed') break;\n  }\n}\n\nfunction notifySubscription(subscription, type, value) {\n  subscription._state = 'running';\n  var observer = subscription._observer;\n\n  try {\n    var m = getMethod(observer, type);\n\n    switch (type) {\n      case 'next':\n        if (m) m.call(observer, value);\n        break;\n\n      case 'error':\n        closeSubscription(subscription);\n        if (m) m.call(observer, value);else throw value;\n        break;\n\n      case 'complete':\n        closeSubscription(subscription);\n        if (m) m.call(observer);\n        break;\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n\n  if (subscription._state === 'closed') cleanupSubscription(subscription);else if (subscription._state === 'running') subscription._state = 'ready';\n}\n\nfunction onNotify(subscription, type, value) {\n  if (subscription._state === 'closed') return;\n\n  if (subscription._state === 'buffering') {\n    subscription._queue.push({\n      type: type,\n      value: value\n    });\n\n    return;\n  }\n\n  if (subscription._state !== 'ready') {\n    subscription._state = 'buffering';\n    subscription._queue = [{\n      type: type,\n      value: value\n    }];\n    enqueue(function () {\n      return flushSubscription(subscription);\n    });\n    return;\n  }\n\n  notifySubscription(subscription, type, value);\n}\n\nvar Subscription =\n/*#__PURE__*/\nfunction () {\n  function Subscription(observer, subscriber) {\n    _classCallCheck(this, Subscription);\n\n    // ASSERT: observer is an object\n    // ASSERT: subscriber is callable\n    this._cleanup = undefined;\n    this._observer = observer;\n    this._queue = undefined;\n    this._state = 'initializing';\n    var subscriptionObserver = new SubscriptionObserver(this);\n\n    try {\n      this._cleanup = subscriber.call(undefined, subscriptionObserver);\n    } catch (e) {\n      subscriptionObserver.error(e);\n    }\n\n    if (this._state === 'initializing') this._state = 'ready';\n  }\n\n  _createClass(Subscription, [{\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      if (this._state !== 'closed') {\n        closeSubscription(this);\n        cleanupSubscription(this);\n      }\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._state === 'closed';\n    }\n  }]);\n\n  return Subscription;\n}();\n\nvar SubscriptionObserver =\n/*#__PURE__*/\nfunction () {\n  function SubscriptionObserver(subscription) {\n    _classCallCheck(this, SubscriptionObserver);\n\n    this._subscription = subscription;\n  }\n\n  _createClass(SubscriptionObserver, [{\n    key: \"next\",\n    value: function next(value) {\n      onNotify(this._subscription, 'next', value);\n    }\n  }, {\n    key: \"error\",\n    value: function error(value) {\n      onNotify(this._subscription, 'error', value);\n    }\n  }, {\n    key: \"complete\",\n    value: function complete() {\n      onNotify(this._subscription, 'complete');\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._subscription._state === 'closed';\n    }\n  }]);\n\n  return SubscriptionObserver;\n}();\n\nvar Observable =\n/*#__PURE__*/\nfunction () {\n  function Observable(subscriber) {\n    _classCallCheck(this, Observable);\n\n    if (!(this instanceof Observable)) throw new TypeError('Observable cannot be called as a function');\n    if (typeof subscriber !== 'function') throw new TypeError('Observable initializer must be a function');\n    this._subscriber = subscriber;\n  }\n\n  _createClass(Observable, [{\n    key: \"subscribe\",\n    value: function subscribe(observer) {\n      if (typeof observer !== 'object' || observer === null) {\n        observer = {\n          next: observer,\n          error: arguments[1],\n          complete: arguments[2]\n        };\n      }\n\n      return new Subscription(observer, this._subscriber);\n    }\n  }, {\n    key: \"forEach\",\n    value: function forEach(fn) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (typeof fn !== 'function') {\n          reject(new TypeError(fn + ' is not a function'));\n          return;\n        }\n\n        function done() {\n          subscription.unsubscribe();\n          resolve();\n        }\n\n        var subscription = _this.subscribe({\n          next: function (value) {\n            try {\n              fn(value, done);\n            } catch (e) {\n              reject(e);\n              subscription.unsubscribe();\n            }\n          },\n          error: reject,\n          complete: resolve\n        });\n      });\n    }\n  }, {\n    key: \"map\",\n    value: function map(fn) {\n      var _this2 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this2.subscribe({\n          next: function (value) {\n            try {\n              value = fn(value);\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(fn) {\n      var _this3 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this3.subscribe({\n          next: function (value) {\n            try {\n              if (!fn(value)) return;\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"reduce\",\n    value: function reduce(fn) {\n      var _this4 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      var hasSeed = arguments.length > 1;\n      var hasValue = false;\n      var seed = arguments[1];\n      var acc = seed;\n      return new C(function (observer) {\n        return _this4.subscribe({\n          next: function (value) {\n            var first = !hasValue;\n            hasValue = true;\n\n            if (!first || hasSeed) {\n              try {\n                acc = fn(acc, value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            } else {\n              acc = value;\n            }\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            if (!hasValue && !hasSeed) return observer.error(new TypeError('Cannot reduce an empty sequence'));\n            observer.next(acc);\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"concat\",\n    value: function concat() {\n      var _this5 = this;\n\n      for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\n        sources[_key] = arguments[_key];\n      }\n\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscription;\n        var index = 0;\n\n        function startNext(next) {\n          subscription = next.subscribe({\n            next: function (v) {\n              observer.next(v);\n            },\n            error: function (e) {\n              observer.error(e);\n            },\n            complete: function () {\n              if (index === sources.length) {\n                subscription = undefined;\n                observer.complete();\n              } else {\n                startNext(C.from(sources[index++]));\n              }\n            }\n          });\n        }\n\n        startNext(_this5);\n        return function () {\n          if (subscription) {\n            subscription.unsubscribe();\n            subscription = undefined;\n          }\n        };\n      });\n    }\n  }, {\n    key: \"flatMap\",\n    value: function flatMap(fn) {\n      var _this6 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscriptions = [];\n\n        var outer = _this6.subscribe({\n          next: function (value) {\n            if (fn) {\n              try {\n                value = fn(value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            }\n\n            var inner = C.from(value).subscribe({\n              next: function (value) {\n                observer.next(value);\n              },\n              error: function (e) {\n                observer.error(e);\n              },\n              complete: function () {\n                var i = subscriptions.indexOf(inner);\n                if (i >= 0) subscriptions.splice(i, 1);\n                completeIfDone();\n              }\n            });\n            subscriptions.push(inner);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            completeIfDone();\n          }\n        });\n\n        function completeIfDone() {\n          if (outer.closed && subscriptions.length === 0) observer.complete();\n        }\n\n        return function () {\n          subscriptions.forEach(function (s) {\n            return s.unsubscribe();\n          });\n          outer.unsubscribe();\n        };\n      });\n    }\n  }, {\n    key: SymbolObservable,\n    value: function () {\n      return this;\n    }\n  }], [{\n    key: \"from\",\n    value: function from(x) {\n      var C = typeof this === 'function' ? this : Observable;\n      if (x == null) throw new TypeError(x + ' is not an object');\n      var method = getMethod(x, SymbolObservable);\n\n      if (method) {\n        var observable = method.call(x);\n        if (Object(observable) !== observable) throw new TypeError(observable + ' is not an object');\n        if (isObservable(observable) && observable.constructor === C) return observable;\n        return new C(function (observer) {\n          return observable.subscribe(observer);\n        });\n      }\n\n      if (hasSymbol('iterator')) {\n        method = getMethod(x, SymbolIterator);\n\n        if (method) {\n          return new C(function (observer) {\n            enqueue(function () {\n              if (observer.closed) return;\n              var _iteratorNormalCompletion = true;\n              var _didIteratorError = false;\n              var _iteratorError = undefined;\n\n              try {\n                for (var _iterator = method.call(x)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  var _item = _step.value;\n                  observer.next(_item);\n                  if (observer.closed) return;\n                }\n              } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion && _iterator.return != null) {\n                    _iterator.return();\n                  }\n                } finally {\n                  if (_didIteratorError) {\n                    throw _iteratorError;\n                  }\n                }\n              }\n\n              observer.complete();\n            });\n          });\n        }\n      }\n\n      if (Array.isArray(x)) {\n        return new C(function (observer) {\n          enqueue(function () {\n            if (observer.closed) return;\n\n            for (var i = 0; i < x.length; ++i) {\n              observer.next(x[i]);\n              if (observer.closed) return;\n            }\n\n            observer.complete();\n          });\n        });\n      }\n\n      throw new TypeError(x + ' is not observable');\n    }\n  }, {\n    key: \"of\",\n    value: function of() {\n      for (var _len2 = arguments.length, items = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        items[_key2] = arguments[_key2];\n      }\n\n      var C = typeof this === 'function' ? this : Observable;\n      return new C(function (observer) {\n        enqueue(function () {\n          if (observer.closed) return;\n\n          for (var i = 0; i < items.length; ++i) {\n            observer.next(items[i]);\n            if (observer.closed) return;\n          }\n\n          observer.complete();\n        });\n      });\n    }\n  }, {\n    key: SymbolSpecies,\n    get: function () {\n      return this;\n    }\n  }]);\n\n  return Observable;\n}();\n\nexports.Observable = Observable;\n\nif (hasSymbols()) {\n  Object.defineProperty(Observable, Symbol('extensions'), {\n    value: {\n      symbol: SymbolObservable,\n      hostReportError: hostReportError\n    },\n    configurable: true\n  });\n}","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport Observable from 'zen-observable-ts';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nvar logger = new Logger('AWSAppSyncProvider');\nvar AWSAppSyncProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncProvider, _super);\n    function AWSAppSyncProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._topicClient = new Map();\n        _this._topicAlias = new Map();\n        return _this;\n    }\n    Object.defineProperty(AWSAppSyncProvider.prototype, \"endpoint\", {\n        get: function () {\n            throw new Error('Not supported');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncProvider';\n    };\n    AWSAppSyncProvider.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype._cleanUp = function (clientId) {\n        var _this = this;\n        var topicsForClient = Array.from(this._topicClient.entries())\n            .filter(function (_a) {\n            var _b = __read(_a, 2), c = _b[1];\n            return c.clientId === clientId;\n        })\n            .map(function (_a) {\n            var _b = __read(_a, 1), t = _b[0];\n            return t;\n        });\n        topicsForClient.forEach(function (t) { return _this._cleanUpForTopic(t); });\n    };\n    AWSAppSyncProvider.prototype._cleanUpForTopic = function (topic) {\n        this._topicClient.delete(topic);\n        this._topicAlias.delete(topic);\n    };\n    AWSAppSyncProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            var topicsForClient = Array.from(this._topicClient.entries())\n                .filter(function (_a) {\n                var _b = __read(_a, 2), c = _b[1];\n                return c.clientId === clientId;\n            })\n                .map(function (_a) {\n                var _b = __read(_a, 1), t = _b[0];\n                return t;\n            });\n            topicsForClient.forEach(function (topic) {\n                if (_this._topicObservers.has(topic)) {\n                    _this._topicObservers.get(topic).forEach(function (obs) {\n                        if (!obs.closed) {\n                            obs.error(args);\n                        }\n                    });\n                    _this._topicObservers.delete(topic);\n                }\n            });\n            this._cleanUp(clientId);\n        }\n    };\n    AWSAppSyncProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        return [4 /*yield*/, _super.prototype.disconnect.call(this, clientId)];\n                    case 2:\n                        _a.sent();\n                        this._cleanUp(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var result = new Observable(function (observer) {\n            var targetTopics = [].concat(topics);\n            logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, mqttConnections, newSubscriptions, newAliases, map;\n                var _this = this;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            // Add these topics to map\n                            targetTopics.forEach(function (t) {\n                                if (!_this._topicObservers.has(t)) {\n                                    _this._topicObservers.set(t, new Set());\n                                }\n                                _this._topicObservers.get(t).add(observer);\n                            });\n                            _a = options.mqttConnections, mqttConnections = _a === void 0 ? [] : _a, newSubscriptions = options.newSubscriptions;\n                            newAliases = Object.entries(newSubscriptions).map(function (_a) {\n                                var _b = __read(_a, 2), alias = _b[0], v = _b[1];\n                                return [v.topic, alias];\n                            });\n                            // Merge new aliases with old ones\n                            this._topicAlias = new Map(__spread(Array.from(this._topicAlias.entries()), newAliases));\n                            map = Object.entries(targetTopics.reduce(function (acc, elem) {\n                                var connectionInfoForTopic = mqttConnections.find(function (c) { return c.topics.indexOf(elem) > -1; });\n                                if (connectionInfoForTopic) {\n                                    var clientId = connectionInfoForTopic.client, url = connectionInfoForTopic.url;\n                                    if (!acc[clientId]) {\n                                        acc[clientId] = {\n                                            url: url,\n                                            topics: new Set(),\n                                        };\n                                    }\n                                    acc[clientId].topics.add(elem);\n                                }\n                                return acc;\n                            }, {}));\n                            // reconnect everything we have in the map\n                            return [4 /*yield*/, Promise.all(map.map(function (_a) {\n                                    var _b = __read(_a, 2), clientId = _b[0], _c = _b[1], url = _c.url, topics = _c.topics;\n                                    return __awaiter(_this, void 0, void 0, function () {\n                                        var client, err_1;\n                                        var _this = this;\n                                        return __generator(this, function (_d) {\n                                            switch (_d.label) {\n                                                case 0:\n                                                    client = null;\n                                                    _d.label = 1;\n                                                case 1:\n                                                    _d.trys.push([1, 3, , 4]);\n                                                    return [4 /*yield*/, this.connect(clientId, {\n                                                            clientId: clientId,\n                                                            url: url,\n                                                        })];\n                                                case 2:\n                                                    client = _d.sent();\n                                                    return [3 /*break*/, 4];\n                                                case 3:\n                                                    err_1 = _d.sent();\n                                                    observer.error({ message: 'Failed to connect', error: err_1 });\n                                                    observer.complete();\n                                                    return [2 /*return*/, undefined];\n                                                case 4:\n                                                    // subscribe to all topics for this client\n                                                    // store topic-client mapping\n                                                    topics.forEach(function (topic) {\n                                                        if (client.isConnected()) {\n                                                            client.subscribe(topic);\n                                                            _this._topicClient.set(topic, client);\n                                                        }\n                                                    });\n                                                    return [2 /*return*/, client];\n                                            }\n                                        });\n                                    });\n                                }))];\n                        case 1:\n                            // reconnect everything we have in the map\n                            _b.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                targetTopics.forEach(function (t) {\n                    var client = _this._topicClient.get(t);\n                    if (client && client.isConnected()) {\n                        client.unsubscribe(t);\n                        _this._topicClient.delete(t);\n                        if (!Array.from(_this._topicClient.values()).some(function (c) { return c === client; })) {\n                            _this.disconnect(client.clientId);\n                        }\n                    }\n                    _this._topicObservers.delete(t);\n                });\n            };\n        });\n        return Observable.from(result).map(function (value) {\n            var topic = _this.getTopicForValue(value);\n            var alias = _this._topicAlias.get(topic);\n            value.data = Object.entries(value.data).reduce(function (obj, _a) {\n                var _b = __read(_a, 2), origKey = _b[0], val = _b[1];\n                return ((obj[(alias || origKey)] = val), obj);\n            }, {});\n            return value;\n        });\n    };\n    return AWSAppSyncProvider;\n}(MqttOverWSProvider));\nexport { AWSAppSyncProvider };\n//# sourceMappingURL=AWSAppSyncProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport Observable from 'zen-observable-ts';\nimport { GraphQLError } from 'graphql';\nimport * as url from 'url';\nimport { v4 as uuid } from 'uuid';\nimport { Buffer } from 'buffer';\nimport { Logger, Credentials, Signer, Hub, Constants, USER_AGENT_HEADER, jitteredExponentialRetry, NonRetryableError, } from '@aws-amplify/core';\nimport Cache from '@aws-amplify/cache';\nimport Auth from '@aws-amplify/auth';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { CONTROL_MSG } from '../index';\nvar logger = new Logger('AWSAppSyncRealTimeProvider');\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' &&\n    typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nvar dispatchApiEvent = function (event, data, message) {\n    Hub.dispatch('api', { event: event, data: data, message: message }, 'PubSub', AMPLIFY_SYMBOL);\n};\nvar MAX_DELAY_MS = 5000;\nvar NON_RETRYABLE_CODES = [400, 401, 403];\nvar MESSAGE_TYPES;\n(function (MESSAGE_TYPES) {\n    /**\n     * Client -> Server message.\n     * This message type is the first message after handshake and this will initialize AWS AppSync RealTime communication\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_INIT\"] = \"connection_init\";\n    /**\n     * Server -> Client message\n     * This message type is in case there is an issue with AWS AppSync RealTime when establishing connection\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ERROR\"] = \"connection_error\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_CONNECTION_INIT message\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ACK\"] = \"connection_ack\";\n    /**\n     * Client -> Server message.\n     * This message type is for register subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_START\"] = \"start\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_START message\n     */\n    MESSAGE_TYPES[\"GQL_START_ACK\"] = \"start_ack\";\n    /**\n     * Server -> Client message.\n     * This message type is for subscription message from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_DATA\"] = \"data\";\n    /**\n     * Server -> Client message.\n     * This message type helps the client to know is still receiving messages from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_KEEP_ALIVE\"] = \"ka\";\n    /**\n     * Client -> Server message.\n     * This message type is for unregister subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_STOP\"] = \"stop\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_STOP message\n     */\n    MESSAGE_TYPES[\"GQL_COMPLETE\"] = \"complete\";\n    /**\n     * Server -> Client message.\n     * This message type is for sending error messages from AWS AppSync RealTime to the client\n     */\n    MESSAGE_TYPES[\"GQL_ERROR\"] = \"error\";\n})(MESSAGE_TYPES || (MESSAGE_TYPES = {}));\nvar SUBSCRIPTION_STATUS;\n(function (SUBSCRIPTION_STATUS) {\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"PENDING\"] = 0] = \"PENDING\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"CONNECTED\"] = 1] = \"CONNECTED\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"FAILED\"] = 2] = \"FAILED\";\n})(SUBSCRIPTION_STATUS || (SUBSCRIPTION_STATUS = {}));\nvar SOCKET_STATUS;\n(function (SOCKET_STATUS) {\n    SOCKET_STATUS[SOCKET_STATUS[\"CLOSED\"] = 0] = \"CLOSED\";\n    SOCKET_STATUS[SOCKET_STATUS[\"READY\"] = 1] = \"READY\";\n    SOCKET_STATUS[SOCKET_STATUS[\"CONNECTING\"] = 2] = \"CONNECTING\";\n})(SOCKET_STATUS || (SOCKET_STATUS = {}));\nvar AWS_APPSYNC_REALTIME_HEADERS = {\n    accept: 'application/json, text/javascript',\n    'content-encoding': 'amz-1.0',\n    'content-type': 'application/json; charset=UTF-8',\n};\n/**\n * Time in milleseconds to wait for GQL_CONNECTION_INIT message\n */\nvar CONNECTION_INIT_TIMEOUT = 15000;\n/**\n * Time in milleseconds to wait for GQL_START_ACK message\n */\nvar START_ACK_TIMEOUT = 15000;\n/**\n * Default Time in milleseconds to wait for GQL_CONNECTION_KEEP_ALIVE message\n */\nvar DEFAULT_KEEP_ALIVE_TIMEOUT = 5 * 60 * 1000;\nvar AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncRealTimeProvider, _super);\n    function AWSAppSyncRealTimeProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.socketStatus = SOCKET_STATUS.CLOSED;\n        _this.keepAliveTimeout = DEFAULT_KEEP_ALIVE_TIMEOUT;\n        _this.subscriptionObserverMap = new Map();\n        _this.promiseArray = [];\n        return _this;\n    }\n    AWSAppSyncRealTimeProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncRealTimeProvider';\n    };\n    AWSAppSyncRealTimeProvider.prototype.newClient = function () {\n        throw new Error('Not used here');\n    };\n    AWSAppSyncRealTimeProvider.prototype.publish = function (_topics, _msg, _options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype.subscribe = function (_topics, options) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint;\n        return new Observable(function (observer) {\n            if (!appSyncGraphqlEndpoint) {\n                observer.error({\n                    errors: [\n                        __assign({}, new GraphQLError(\"Subscribe only available for AWS AppSync endpoint\")),\n                    ],\n                });\n                observer.complete();\n            }\n            else {\n                var subscriptionId_1 = uuid();\n                _this._startSubscriptionWithAWSAppSyncRealTime({\n                    options: options,\n                    observer: observer,\n                    subscriptionId: subscriptionId_1,\n                }).catch(function (err) {\n                    observer.error({\n                        errors: [\n                            __assign({}, new GraphQLError(CONTROL_MSG.REALTIME_SUBSCRIPTION_INIT_ERROR + \": \" + err)),\n                        ],\n                    });\n                    observer.complete();\n                });\n                return function () { return __awaiter(_this, void 0, void 0, function () {\n                    var subscriptionState, err_1;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                _a.trys.push([0, 2, 3, 4]);\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                return [4 /*yield*/, this._waitForSubscriptionToBeConnected(subscriptionId_1)];\n                            case 1:\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                _a.sent();\n                                subscriptionState = (this.subscriptionObserverMap.get(subscriptionId_1) || {}).subscriptionState;\n                                if (!subscriptionState) {\n                                    // subscription already unsubscribed\n                                    return [2 /*return*/];\n                                }\n                                if (subscriptionState === SUBSCRIPTION_STATUS.CONNECTED) {\n                                    this._sendUnsubscriptionMessage(subscriptionId_1);\n                                }\n                                else {\n                                    throw new Error('Subscription never connected');\n                                }\n                                return [3 /*break*/, 4];\n                            case 2:\n                                err_1 = _a.sent();\n                                logger.debug(\"Error while unsubscribing \" + err_1);\n                                return [3 /*break*/, 4];\n                            case 3:\n                                this._removeSubscriptionObserver(subscriptionId_1);\n                                return [7 /*endfinally*/];\n                            case 4: return [2 /*return*/];\n                        }\n                    });\n                }); };\n            }\n        });\n    };\n    Object.defineProperty(AWSAppSyncRealTimeProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncRealTimeProvider.prototype._startSubscriptionWithAWSAppSyncRealTime = function (_a) {\n        var options = _a.options, observer = _a.observer, subscriptionId = _a.subscriptionId;\n        return __awaiter(this, void 0, void 0, function () {\n            var appSyncGraphqlEndpoint, authenticationType, query, variables, apiKey, region, _b, graphql_headers, _c, additionalHeaders, subscriptionState, data, dataString, headerObj, _d, _e, subscriptionMessage, stringToAWSRealTime, err_2, _f, message, subscriptionFailedCallback_1, _g, subscriptionFailedCallback, subscriptionReadyCallback;\n            var _h;\n            var _this = this;\n            return __generator(this, function (_j) {\n                switch (_j.label) {\n                    case 0:\n                        appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint, authenticationType = options.authenticationType, query = options.query, variables = options.variables, apiKey = options.apiKey, region = options.region, _b = options.graphql_headers, graphql_headers = _b === void 0 ? function () { return ({}); } : _b, _c = options.additionalHeaders, additionalHeaders = _c === void 0 ? {} : _c;\n                        subscriptionState = SUBSCRIPTION_STATUS.PENDING;\n                        data = {\n                            query: query,\n                            variables: variables,\n                        };\n                        // Having a subscription id map will make it simple to forward messages received\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            query: query,\n                            variables: variables,\n                            subscriptionState: subscriptionState,\n                            startAckTimeoutId: null,\n                        });\n                        dataString = JSON.stringify(data);\n                        _d = [{}];\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                payload: dataString,\n                                canonicalUri: '',\n                                region: region,\n                            })];\n                    case 1:\n                        _e = [__assign.apply(void 0, _d.concat([(_j.sent())]))];\n                        return [4 /*yield*/, graphql_headers()];\n                    case 2:\n                        headerObj = __assign.apply(void 0, [__assign.apply(void 0, [__assign.apply(void 0, _e.concat([(_j.sent())])), additionalHeaders]), (_h = {}, _h[USER_AGENT_HEADER] = Constants.userAgent, _h)]);\n                        subscriptionMessage = {\n                            id: subscriptionId,\n                            payload: {\n                                data: dataString,\n                                extensions: {\n                                    authorization: __assign({}, headerObj),\n                                },\n                            },\n                            type: MESSAGE_TYPES.GQL_START,\n                        };\n                        stringToAWSRealTime = JSON.stringify(subscriptionMessage);\n                        _j.label = 3;\n                    case 3:\n                        _j.trys.push([3, 5, , 6]);\n                        return [4 /*yield*/, this._initializeWebSocketConnection({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                region: region,\n                            })];\n                    case 4:\n                        _j.sent();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_2 = _j.sent();\n                        logger.debug({ err: err_2 });\n                        _f = err_2.message, message = _f === void 0 ? '' : _f;\n                        observer.error({\n                            errors: [\n                                __assign({}, new GraphQLError(CONTROL_MSG.CONNECTION_FAILED + \": \" + message)),\n                            ],\n                        });\n                        observer.complete();\n                        subscriptionFailedCallback_1 = (this.subscriptionObserverMap.get(subscriptionId) || {}).subscriptionFailedCallback;\n                        // Notify concurrent unsubscription\n                        if (typeof subscriptionFailedCallback_1 === 'function') {\n                            subscriptionFailedCallback_1();\n                        }\n                        return [2 /*return*/];\n                    case 6:\n                        _g = this.subscriptionObserverMap.get(subscriptionId), subscriptionFailedCallback = _g.subscriptionFailedCallback, subscriptionReadyCallback = _g.subscriptionReadyCallback;\n                        // This must be done before sending the message in order to be listening immediately\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            subscriptionState: subscriptionState,\n                            variables: variables,\n                            query: query,\n                            subscriptionReadyCallback: subscriptionReadyCallback,\n                            subscriptionFailedCallback: subscriptionFailedCallback,\n                            startAckTimeoutId: setTimeout(function () {\n                                _this._timeoutStartSubscriptionAck.call(_this, subscriptionId);\n                            }, START_ACK_TIMEOUT),\n                        });\n                        if (this.awsRealTimeSocket) {\n                            this.awsRealTimeSocket.send(stringToAWSRealTime);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // Waiting that subscription has been connected before trying to unsubscribe\n    AWSAppSyncRealTimeProvider.prototype._waitForSubscriptionToBeConnected = function (subscriptionId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var subscriptionState;\n            var _this = this;\n            return __generator(this, function (_a) {\n                subscriptionState = this.subscriptionObserverMap.get(subscriptionId).subscriptionState;\n                // This in case unsubscribe is invoked before sending start subscription message\n                if (subscriptionState === SUBSCRIPTION_STATUS.PENDING) {\n                    return [2 /*return*/, new Promise(function (res, rej) {\n                            var _a = _this.subscriptionObserverMap.get(subscriptionId), observer = _a.observer, subscriptionState = _a.subscriptionState, variables = _a.variables, query = _a.query;\n                            _this.subscriptionObserverMap.set(subscriptionId, {\n                                observer: observer,\n                                subscriptionState: subscriptionState,\n                                variables: variables,\n                                query: query,\n                                subscriptionReadyCallback: res,\n                                subscriptionFailedCallback: rej,\n                            });\n                        })];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._sendUnsubscriptionMessage = function (subscriptionId) {\n        try {\n            if (this.awsRealTimeSocket &&\n                this.awsRealTimeSocket.readyState === WebSocket.OPEN &&\n                this.socketStatus === SOCKET_STATUS.READY) {\n                // Preparing unsubscribe message to stop receiving messages for that subscription\n                var unsubscribeMessage = {\n                    id: subscriptionId,\n                    type: MESSAGE_TYPES.GQL_STOP,\n                };\n                var stringToAWSRealTime = JSON.stringify(unsubscribeMessage);\n                this.awsRealTimeSocket.send(stringToAWSRealTime);\n            }\n        }\n        catch (err) {\n            // If GQL_STOP is not sent because of disconnection issue, then there is nothing the client can do\n            logger.debug({ err: err });\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._removeSubscriptionObserver = function (subscriptionId) {\n        this.subscriptionObserverMap.delete(subscriptionId);\n        // Verifying 1000ms after removing subscription in case there are new subscription unmount/mount\n        setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n    };\n    AWSAppSyncRealTimeProvider.prototype._closeSocketIfRequired = function () {\n        if (this.subscriptionObserverMap.size > 0) {\n            // Active subscriptions on the WebSocket\n            return;\n        }\n        if (!this.awsRealTimeSocket) {\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n            return;\n        }\n        if (this.awsRealTimeSocket.bufferedAmount > 0) {\n            // Still data on the WebSocket\n            setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n        }\n        else {\n            logger.debug('closing WebSocket...');\n            clearTimeout(this.keepAliveTimeoutId);\n            var tempSocket = this.awsRealTimeSocket;\n            // Cleaning callbacks to avoid race condition, socket still exists\n            tempSocket.onclose = undefined;\n            tempSocket.onerror = undefined;\n            tempSocket.close(1000);\n            this.awsRealTimeSocket = null;\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._handleIncomingSubscriptionMessage = function (message) {\n        logger.debug(\"subscription message from AWS AppSync RealTime: \" + message.data);\n        var _a = JSON.parse(message.data), _b = _a.id, id = _b === void 0 ? '' : _b, payload = _a.payload, type = _a.type;\n        var _c = this.subscriptionObserverMap.get(id) || {}, _d = _c.observer, observer = _d === void 0 ? null : _d, _e = _c.query, query = _e === void 0 ? '' : _e, _f = _c.variables, variables = _f === void 0 ? {} : _f, startAckTimeoutId = _c.startAckTimeoutId, subscriptionReadyCallback = _c.subscriptionReadyCallback, subscriptionFailedCallback = _c.subscriptionFailedCallback;\n        logger.debug({ id: id, observer: observer, query: query, variables: variables });\n        if (type === MESSAGE_TYPES.GQL_DATA && payload && payload.data) {\n            if (observer) {\n                observer.next(payload);\n            }\n            else {\n                logger.debug(\"observer not found for id: \" + id);\n            }\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_START_ACK) {\n            logger.debug(\"subscription ready for \" + JSON.stringify({ query: query, variables: variables }));\n            if (typeof subscriptionReadyCallback === 'function') {\n                subscriptionReadyCallback();\n            }\n            clearTimeout(startAckTimeoutId);\n            dispatchApiEvent(CONTROL_MSG.SUBSCRIPTION_ACK, { query: query, variables: variables }, 'Connection established for subscription');\n            var subscriptionState = SUBSCRIPTION_STATUS.CONNECTED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: null,\n                subscriptionState: subscriptionState,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n            });\n            // TODO: emit event on hub but it requires to store the id first\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_CONNECTION_KEEP_ALIVE) {\n            clearTimeout(this.keepAliveTimeoutId);\n            this.keepAliveTimeoutId = setTimeout(this._errorDisconnect.bind(this, CONTROL_MSG.TIMEOUT_DISCONNECT), this.keepAliveTimeout);\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_ERROR) {\n            var subscriptionState = SUBSCRIPTION_STATUS.FAILED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: startAckTimeoutId,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n                subscriptionState: subscriptionState,\n            });\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(CONTROL_MSG.CONNECTION_FAILED + \": \" + JSON.stringify(payload))),\n                ],\n            });\n            clearTimeout(startAckTimeoutId);\n            observer.complete();\n            if (typeof subscriptionFailedCallback === 'function') {\n                subscriptionFailedCallback();\n            }\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._errorDisconnect = function (msg) {\n        logger.debug(\"Disconnect error: \" + msg);\n        this.subscriptionObserverMap.forEach(function (_a) {\n            var observer = _a.observer;\n            if (observer && !observer.closed) {\n                observer.error({\n                    errors: [__assign({}, new GraphQLError(msg))],\n                });\n            }\n        });\n        this.subscriptionObserverMap.clear();\n        if (this.awsRealTimeSocket) {\n            this.awsRealTimeSocket.close();\n        }\n        this.socketStatus = SOCKET_STATUS.CLOSED;\n    };\n    AWSAppSyncRealTimeProvider.prototype._timeoutStartSubscriptionAck = function (subscriptionId) {\n        var _a = this.subscriptionObserverMap.get(subscriptionId) || {}, observer = _a.observer, query = _a.query, variables = _a.variables;\n        if (!observer) {\n            return;\n        }\n        this.subscriptionObserverMap.set(subscriptionId, {\n            observer: observer,\n            query: query,\n            variables: variables,\n            subscriptionState: SUBSCRIPTION_STATUS.FAILED,\n        });\n        if (observer && !observer.closed) {\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(\"Subscription timeout \" + JSON.stringify({ query: query, variables: variables }))),\n                ],\n            });\n            // Cleanup will be automatically executed\n            observer.complete();\n        }\n        logger.debug('timeoutStartSubscription', JSON.stringify({ query: query, variables: variables }));\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeWebSocketConnection = function (_a) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, authenticationType = _a.authenticationType, apiKey = _a.apiKey, region = _a.region;\n        if (this.socketStatus === SOCKET_STATUS.READY) {\n            return;\n        }\n        return new Promise(function (res, rej) { return __awaiter(_this, void 0, void 0, function () {\n            var protocol, discoverableEndpoint, payloadString, headerString, _a, _b, headerQs, payloadQs, awsRealTimeUrl, err_3;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this.promiseArray.push({ res: res, rej: rej });\n                        if (!(this.socketStatus === SOCKET_STATUS.CLOSED)) return [3 /*break*/, 5];\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 4, , 5]);\n                        this.socketStatus = SOCKET_STATUS.CONNECTING;\n                        protocol = this.isSSLEnabled ? 'wss://' : 'ws://';\n                        discoverableEndpoint = appSyncGraphqlEndpoint\n                            .replace('https://', protocol)\n                            .replace('http://', protocol)\n                            .replace('appsync-api', 'appsync-realtime-api')\n                            .replace('gogi-beta', 'grt-beta');\n                        payloadString = '{}';\n                        _b = (_a = JSON).stringify;\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                authenticationType: authenticationType,\n                                payload: payloadString,\n                                canonicalUri: '/connect',\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                region: region,\n                            })];\n                    case 2:\n                        headerString = _b.apply(_a, [_c.sent()]);\n                        headerQs = Buffer.from(headerString).toString('base64');\n                        payloadQs = Buffer.from(payloadString).toString('base64');\n                        awsRealTimeUrl = discoverableEndpoint + \"?header=\" + headerQs + \"&payload=\" + payloadQs;\n                        return [4 /*yield*/, this._initializeRetryableHandshake({ awsRealTimeUrl: awsRealTimeUrl })];\n                    case 3:\n                        _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var res = _a.res;\n                            logger.debug('Notifying connection successful');\n                            res();\n                        });\n                        this.socketStatus = SOCKET_STATUS.READY;\n                        this.promiseArray = [];\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_3 = _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var rej = _a.rej;\n                            return rej(err_3);\n                        });\n                        this.promiseArray = [];\n                        if (this.awsRealTimeSocket &&\n                            this.awsRealTimeSocket.readyState === WebSocket.OPEN) {\n                            this.awsRealTimeSocket.close(3001);\n                        }\n                        this.awsRealTimeSocket = null;\n                        this.socketStatus = SOCKET_STATUS.CLOSED;\n                        return [3 /*break*/, 5];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        }); });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeRetryableHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializaling retryable Handshake\");\n                        return [4 /*yield*/, jitteredExponentialRetry(this._initializeHandshake.bind(this), [{ awsRealTimeUrl: awsRealTimeUrl }], MAX_DELAY_MS)];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            var err_4, errorType, errorCode;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializing handshake \" + awsRealTimeUrl);\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, , 5]);\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var newSocket = new WebSocket(awsRealTimeUrl, 'graphql-ws');\n                                    newSocket.onerror = function () {\n                                        logger.debug(\"WebSocket connection error\");\n                                    };\n                                    newSocket.onclose = function () {\n                                        rej(new Error('Connection handshake error'));\n                                    };\n                                    newSocket.onopen = function () {\n                                        _this.awsRealTimeSocket = newSocket;\n                                        return res();\n                                    };\n                                });\n                            })()];\n                    case 2:\n                        _b.sent();\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var ackOk = false;\n                                    _this.awsRealTimeSocket.onerror = function (error) {\n                                        logger.debug(\"WebSocket error \" + JSON.stringify(error));\n                                    };\n                                    _this.awsRealTimeSocket.onclose = function (event) {\n                                        logger.debug(\"WebSocket closed \" + event.reason);\n                                        rej(new Error(JSON.stringify(event)));\n                                    };\n                                    _this.awsRealTimeSocket.onmessage = function (message) {\n                                        logger.debug(\"subscription message from AWS AppSyncRealTime: \" + message.data + \" \");\n                                        var data = JSON.parse(message.data);\n                                        var type = data.type, _a = data.payload, _b = (_a === void 0 ? {} : _a).connectionTimeoutMs, connectionTimeoutMs = _b === void 0 ? DEFAULT_KEEP_ALIVE_TIMEOUT : _b;\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ACK) {\n                                            ackOk = true;\n                                            _this.keepAliveTimeout = connectionTimeoutMs;\n                                            _this.awsRealTimeSocket.onmessage = _this._handleIncomingSubscriptionMessage.bind(_this);\n                                            _this.awsRealTimeSocket.onerror = function (err) {\n                                                logger.debug(err);\n                                                _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);\n                                            };\n                                            _this.awsRealTimeSocket.onclose = function (event) {\n                                                logger.debug(\"WebSocket closed \" + event.reason);\n                                                _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);\n                                            };\n                                            res('Cool, connected to AWS AppSyncRealTime');\n                                            return;\n                                        }\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ERROR) {\n                                            var _c = data.payload, _d = (_c === void 0 ? {} : _c).errors, _e = __read(_d === void 0 ? [] : _d, 1), _f = _e[0], _g = _f === void 0 ? {} : _f, _h = _g.errorType, errorType = _h === void 0 ? '' : _h, _j = _g.errorCode, errorCode = _j === void 0 ? 0 : _j;\n                                            rej({ errorType: errorType, errorCode: errorCode });\n                                        }\n                                    };\n                                    var gqlInit = {\n                                        type: MESSAGE_TYPES.GQL_CONNECTION_INIT,\n                                    };\n                                    _this.awsRealTimeSocket.send(JSON.stringify(gqlInit));\n                                    function checkAckOk() {\n                                        if (!ackOk) {\n                                            rej(new Error(\"Connection timeout: ack from AWSRealTime was not received on \" + CONNECTION_INIT_TIMEOUT + \" ms\"));\n                                        }\n                                    }\n                                    setTimeout(checkAckOk.bind(_this), CONNECTION_INIT_TIMEOUT);\n                                });\n                            })()];\n                    case 3:\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        _b.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_4 = _b.sent();\n                        errorType = err_4.errorType, errorCode = err_4.errorCode;\n                        if (NON_RETRYABLE_CODES.includes(errorCode)) {\n                            throw new NonRetryableError(errorType);\n                        }\n                        else if (errorType) {\n                            throw new Error(errorType);\n                        }\n                        else {\n                            throw err_4;\n                        }\n                        return [3 /*break*/, 5];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeHeaderBasedAuth = function (_a) {\n        var authenticationType = _a.authenticationType, payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, apiKey = _a.apiKey, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var headerHandler, handler, host, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        headerHandler = {\n                            API_KEY: this._awsRealTimeApiKeyHeader.bind(this),\n                            AWS_IAM: this._awsRealTimeIAMHeader.bind(this),\n                            OPENID_CONNECT: this._awsRealTimeOPENIDHeader.bind(this),\n                            AMAZON_COGNITO_USER_POOLS: this._awsRealTimeCUPHeader.bind(this),\n                        };\n                        handler = headerHandler[authenticationType];\n                        if (typeof handler !== 'function') {\n                            logger.debug(\"Authentication type \" + authenticationType + \" not supported\");\n                            return [2 /*return*/, ''];\n                        }\n                        host = url.parse(appSyncGraphqlEndpoint).host;\n                        return [4 /*yield*/, handler({\n                                payload: payload,\n                                canonicalUri: canonicalUri,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                apiKey: apiKey,\n                                region: region,\n                                host: host,\n                            })];\n                    case 1:\n                        result = _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeCUPHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var session;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Auth.currentSession()];\n                    case 1:\n                        session = _b.sent();\n                        return [2 /*return*/, {\n                                Authorization: session.getAccessToken().getJwtToken(),\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeOPENIDHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var token, federatedInfo, currentUser;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Cache.getItem('federatedInfo')];\n                    case 1:\n                        federatedInfo = _b.sent();\n                        if (!federatedInfo) return [3 /*break*/, 2];\n                        token = federatedInfo.token;\n                        return [3 /*break*/, 4];\n                    case 2: return [4 /*yield*/, Auth.currentAuthenticatedUser()];\n                    case 3:\n                        currentUser = _b.sent();\n                        if (currentUser) {\n                            token = currentUser.token;\n                        }\n                        _b.label = 4;\n                    case 4:\n                        if (!token) {\n                            throw new Error('No federated jwt');\n                        }\n                        return [2 /*return*/, {\n                                Authorization: token,\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeApiKeyHeader = function (_a) {\n        var apiKey = _a.apiKey, host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var dt, dtStr;\n            return __generator(this, function (_b) {\n                dt = new Date();\n                dtStr = dt.toISOString().replace(/[:\\-]|\\.\\d{3}/g, '');\n                return [2 /*return*/, {\n                        host: host,\n                        'x-amz-date': dtStr,\n                        'x-api-key': apiKey,\n                    }];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeIAMHeader = function (_a) {\n        var payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var endpointInfo, credentialsOK, creds, request, signed_params;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        endpointInfo = {\n                            region: region,\n                            service: 'appsync',\n                        };\n                        return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _b.sent();\n                        if (!credentialsOK) {\n                            throw new Error('No credentials');\n                        }\n                        return [4 /*yield*/, Credentials.get().then(function (credentials) { return ({\n                                secret_key: credentials.secretAccessKey,\n                                access_key: credentials.accessKeyId,\n                                session_token: credentials.sessionToken,\n                            }); })];\n                    case 2:\n                        creds = _b.sent();\n                        request = {\n                            url: \"\" + appSyncGraphqlEndpoint + canonicalUri,\n                            data: payload,\n                            method: 'POST',\n                            headers: __assign({}, AWS_APPSYNC_REALTIME_HEADERS),\n                        };\n                        signed_params = Signer.sign(request, creds, endpointInfo);\n                        return [2 /*return*/, signed_params.headers];\n                }\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    AWSAppSyncRealTimeProvider.prototype._ensureCredentials = function () {\n        return Credentials.get()\n            .then(function (credentials) {\n            if (!credentials)\n                return false;\n            var cred = Credentials.shear(credentials);\n            logger.debug('set credentials for AWSAppSyncRealTimeProvider', cred);\n            return true;\n        })\n            .catch(function (err) {\n            logger.warn('ensure credentials error', err);\n            return false;\n        });\n    };\n    return AWSAppSyncRealTimeProvider;\n}(AbstractPubSubProvider));\nexport { AWSAppSyncRealTimeProvider };\n//# sourceMappingURL=AWSAppSyncRealTimeProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nimport { Signer, Credentials } from '@aws-amplify/core';\nvar SERVICE_NAME = 'iotdevicegateway';\nvar AWSIoTProvider = /** @class */ (function (_super) {\n    __extends(AWSIoTProvider, _super);\n    function AWSIoTProvider() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(AWSIoTProvider.prototype, \"region\", {\n        get: function () {\n            return this.options.aws_pubsub_region;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSIoTProvider.prototype.getProviderName = function () {\n        return 'AWSIoTProvider';\n    };\n    Object.defineProperty(AWSIoTProvider.prototype, \"endpoint\", {\n        get: function () {\n            var _this = this;\n            return (function () { return __awaiter(_this, void 0, void 0, function () {\n                var endpoint, serviceInfo, _a, access_key, secret_key, session_token, result;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            endpoint = this.options.aws_pubsub_endpoint;\n                            serviceInfo = {\n                                service: SERVICE_NAME,\n                                region: this.region,\n                            };\n                            return [4 /*yield*/, Credentials.get()];\n                        case 1:\n                            _a = _b.sent(), access_key = _a.accessKeyId, secret_key = _a.secretAccessKey, session_token = _a.sessionToken;\n                            result = Signer.signUrl(endpoint, { access_key: access_key, secret_key: secret_key, session_token: session_token }, serviceInfo);\n                            return [2 /*return*/, result];\n                    }\n                });\n            }); })();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AWSIoTProvider;\n}(MqttOverWSProvider));\nexport { AWSIoTProvider };\n//# sourceMappingURL=AWSIotProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport * as Paho from 'paho-mqtt';\nimport { v4 as uuid } from 'uuid';\nimport Observable from 'zen-observable-ts';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('MqttOverWSProvider');\nexport function mqttTopicMatch(filter, topic) {\n    var filterArray = filter.split('/');\n    var length = filterArray.length;\n    var topicArray = topic.split('/');\n    for (var i = 0; i < length; ++i) {\n        var left = filterArray[i];\n        var right = topicArray[i];\n        if (left === '#')\n            return topicArray.length >= length;\n        if (left !== '+' && left !== right)\n            return false;\n    }\n    return length === topicArray.length;\n}\nvar ClientsQueue = /** @class */ (function () {\n    function ClientsQueue() {\n        this.promises = new Map();\n    }\n    ClientsQueue.prototype.get = function (clientId, clientFactory) {\n        return __awaiter(this, void 0, void 0, function () {\n            var promise;\n            return __generator(this, function (_a) {\n                promise = this.promises.get(clientId);\n                if (promise) {\n                    return [2 /*return*/, promise];\n                }\n                promise = clientFactory(clientId);\n                this.promises.set(clientId, promise);\n                return [2 /*return*/, promise];\n            });\n        });\n    };\n    Object.defineProperty(ClientsQueue.prototype, \"allClients\", {\n        get: function () {\n            return Array.from(this.promises.keys());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ClientsQueue.prototype.remove = function (clientId) {\n        this.promises.delete(clientId);\n    };\n    return ClientsQueue;\n}());\nvar topicSymbol = typeof Symbol !== 'undefined' ? Symbol('topic') : '@@topic';\nvar MqttOverWSProvider = /** @class */ (function (_super) {\n    __extends(MqttOverWSProvider, _super);\n    function MqttOverWSProvider(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, __assign(__assign({}, options), { clientId: options.clientId || uuid() })) || this;\n        _this._clientsQueue = new ClientsQueue();\n        _this._topicObservers = new Map();\n        _this._clientIdObservers = new Map();\n        return _this;\n    }\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientId\", {\n        get: function () {\n            return this.options.clientId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"endpoint\", {\n        get: function () {\n            return this.options.aws_pubsub_endpoint;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientsQueue\", {\n        get: function () {\n            return this._clientsQueue;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MqttOverWSProvider.prototype.getTopicForValue = function (value) {\n        return typeof value === 'object' && value[topicSymbol];\n    };\n    MqttOverWSProvider.prototype.getProviderName = function () {\n        return 'MqttOverWSProvider';\n    };\n    MqttOverWSProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            logger.warn(clientId, JSON.stringify(__assign({ errorCode: errorCode }, args), null, 2));\n            var topicsToDelete_1 = [];\n            var clientIdObservers = this._clientIdObservers.get(clientId);\n            if (!clientIdObservers) {\n                return;\n            }\n            clientIdObservers.forEach(function (observer) {\n                observer.error('Disconnected, error code: ' + errorCode);\n                // removing observers for disconnected clientId\n                _this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                    observerForTopic.delete(observer);\n                    if (observerForTopic.size === 0) {\n                        topicsToDelete_1.push(observerTopic);\n                    }\n                });\n            });\n            // forgiving any trace of clientId\n            this._clientIdObservers.delete(clientId);\n            // Removing topics that are not listen by an observer\n            topicsToDelete_1.forEach(function (topic) {\n                _this._topicObservers.delete(topic);\n            });\n        }\n    };\n    MqttOverWSProvider.prototype.newClient = function (_a) {\n        var url = _a.url, clientId = _a.clientId;\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug('Creating new MQTT client', clientId);\n                        client = new Paho.Client(url, clientId);\n                        // client.trace = (args) => logger.debug(clientId, JSON.stringify(args, null, 2));\n                        client.onMessageArrived = function (_a) {\n                            var topic = _a.destinationName, msg = _a.payloadString;\n                            _this._onMessage(topic, msg);\n                        };\n                        client.onConnectionLost = function (_a) {\n                            var errorCode = _a.errorCode, args = __rest(_a, [\"errorCode\"]);\n                            _this.onDisconnect(__assign({ clientId: clientId, errorCode: errorCode }, args));\n                        };\n                        return [4 /*yield*/, new Promise(function (resolve, reject) {\n                                client.connect({\n                                    useSSL: _this.isSSLEnabled,\n                                    mqttVersion: 3,\n                                    onSuccess: function () { return resolve(client); },\n                                    onFailure: reject,\n                                });\n                            })];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/, client];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.connect = function (clientId, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function (clientId) {\n                            return _this.newClient(__assign(__assign({}, options), { clientId: clientId }));\n                        })];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        if (client && client.isConnected()) {\n                            client.disconnect();\n                        }\n                        this.clientsQueue.remove(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.publish = function (topics, msg) {\n        return __awaiter(this, void 0, void 0, function () {\n            var targetTopics, message, url, client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        targetTopics = [].concat(topics);\n                        message = JSON.stringify(msg);\n                        return [4 /*yield*/, this.endpoint];\n                    case 1:\n                        url = _a.sent();\n                        return [4 /*yield*/, this.connect(this.clientId, { url: url })];\n                    case 2:\n                        client = _a.sent();\n                        logger.debug('Publishing to topic(s)', targetTopics.join(','), message);\n                        targetTopics.forEach(function (topic) { return client.send(topic, message); });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype._onMessage = function (topic, msg) {\n        try {\n            var matchedTopicObservers_1 = [];\n            this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                if (mqttTopicMatch(observerTopic, topic)) {\n                    matchedTopicObservers_1.push(observerForTopic);\n                }\n            });\n            var parsedMessage_1 = JSON.parse(msg);\n            if (typeof parsedMessage_1 === 'object') {\n                parsedMessage_1[topicSymbol] = topic;\n            }\n            matchedTopicObservers_1.forEach(function (observersForTopic) {\n                observersForTopic.forEach(function (observer) { return observer.next(parsedMessage_1); });\n            });\n        }\n        catch (error) {\n            logger.warn('Error handling message', error, msg);\n        }\n    };\n    MqttOverWSProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var targetTopics = [].concat(topics);\n        logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n        return new Observable(function (observer) {\n            targetTopics.forEach(function (topic) {\n                // this._topicObservers is used to notify the observers according to the topic received on the message\n                var observersForTopic = _this._topicObservers.get(topic);\n                if (!observersForTopic) {\n                    observersForTopic = new Set();\n                    _this._topicObservers.set(topic, observersForTopic);\n                }\n                observersForTopic.add(observer);\n            });\n            // @ts-ignore\n            var client;\n            var _a = options.clientId, clientId = _a === void 0 ? _this.clientId : _a;\n            // this._clientIdObservers is used to close observers when client gets disconnected\n            var observersForClientId = _this._clientIdObservers.get(clientId);\n            if (!observersForClientId) {\n                observersForClientId = new Set();\n            }\n            observersForClientId.add(observer);\n            _this._clientIdObservers.set(clientId, observersForClientId);\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, url, _b, e_1;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            _a = options.url;\n                            if (!(_a === void 0)) return [3 /*break*/, 2];\n                            return [4 /*yield*/, this.endpoint];\n                        case 1:\n                            _b = _c.sent();\n                            return [3 /*break*/, 3];\n                        case 2:\n                            _b = _a;\n                            _c.label = 3;\n                        case 3:\n                            url = _b;\n                            _c.label = 4;\n                        case 4:\n                            _c.trys.push([4, 6, , 7]);\n                            return [4 /*yield*/, this.connect(clientId, { url: url })];\n                        case 5:\n                            client = _c.sent();\n                            targetTopics.forEach(function (topic) {\n                                client.subscribe(topic);\n                            });\n                            return [3 /*break*/, 7];\n                        case 6:\n                            e_1 = _c.sent();\n                            observer.error(e_1);\n                            return [3 /*break*/, 7];\n                        case 7: return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                if (client) {\n                    _this._clientIdObservers.get(clientId).delete(observer);\n                    // No more observers per client => client not needed anymore\n                    if (_this._clientIdObservers.get(clientId).size === 0) {\n                        _this.disconnect(clientId);\n                        _this._clientIdObservers.delete(clientId);\n                    }\n                    targetTopics.forEach(function (topic) {\n                        var observersForTopic = _this._topicObservers.get(topic) ||\n                            new Set();\n                        observersForTopic.delete(observer);\n                        // if no observers exists for the topic, topic should be removed\n                        if (observersForTopic.size === 0) {\n                            _this._topicObservers.delete(topic);\n                            if (client.isConnected()) {\n                                client.unsubscribe(topic);\n                            }\n                        }\n                    });\n                }\n                return null;\n            };\n        });\n    };\n    return MqttOverWSProvider;\n}(AbstractPubSubProvider));\nexport { MqttOverWSProvider };\n//# sourceMappingURL=MqttOverWSProvider.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('AbstractPubSubProvider');\nvar AbstractPubSubProvider = /** @class */ (function () {\n    function AbstractPubSubProvider(options) {\n        if (options === void 0) { options = {}; }\n        this._config = options;\n    }\n    AbstractPubSubProvider.prototype.configure = function (config) {\n        if (config === void 0) { config = {}; }\n        this._config = __assign(__assign({}, config), this._config);\n        logger.debug(\"configure \" + this.getProviderName(), this._config);\n        return this.options;\n    };\n    AbstractPubSubProvider.prototype.getCategory = function () {\n        return 'PubSub';\n    };\n    Object.defineProperty(AbstractPubSubProvider.prototype, \"options\", {\n        get: function () {\n            return __assign({}, this._config);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AbstractPubSubProvider;\n}());\nexport { AbstractPubSubProvider };\n//# sourceMappingURL=PubSubProvider.js.map","/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nexport * from './PubSubProvider';\nexport * from './AWSAppSyncProvider';\nexport * from './AWSAppSyncRealTimeProvider';\nexport * from './AWSIotProvider';\nexport * from './MqttOverWSProvider';\n//# sourceMappingURL=index.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n// import '../Common/Polyfills';\nimport Observable from 'zen-observable-ts';\nimport { Amplify, browserOrNode, ConsoleLogger as Logger, INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER, INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER, } from '@aws-amplify/core';\nimport { AWSAppSyncProvider, AWSAppSyncRealTimeProvider } from './Providers';\nvar isNode = browserOrNode().isNode;\nvar logger = new Logger('PubSub');\nvar PubSubClass = /** @class */ (function () {\n    /**\n     * Initialize PubSub with AWS configurations\n     *\n     * @param {PubSubOptions} options - Configuration object for PubSub\n     */\n    function PubSubClass(options) {\n        this._options = options;\n        logger.debug('PubSub Options', this._options);\n        this._pluggables = [];\n        this.subscribe = this.subscribe.bind(this);\n    }\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncProvider) {\n                this._awsAppSyncProvider = new AWSAppSyncProvider(this._options);\n            }\n            return this._awsAppSyncProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncRealTimeProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncRealTimeProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncRealTimeProvider) {\n                this._awsAppSyncRealTimeProvider = new AWSAppSyncRealTimeProvider(this._options);\n            }\n            return this._awsAppSyncRealTimeProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PubSubClass.prototype.getModuleName = function () {\n        return 'PubSub';\n    };\n    /**\n     * Configure PubSub part with configurations\n     *\n     * @param {PubSubOptions} config - Configuration for PubSub\n     * @return {Object} - The current configuration\n     */\n    PubSubClass.prototype.configure = function (options) {\n        var _this = this;\n        var opt = options ? options.PubSub || options : {};\n        logger.debug('configure PubSub', { opt: opt });\n        this._options = Object.assign({}, this._options, opt);\n        this._pluggables.map(function (pluggable) { return pluggable.configure(_this._options); });\n        return this._options;\n    };\n    /**\n     * add plugin into Analytics category\n     * @param {Object} pluggable - an instance of the plugin\n     */\n    PubSubClass.prototype.addPluggable = function (pluggable) {\n        return __awaiter(this, void 0, void 0, function () {\n            var config;\n            return __generator(this, function (_a) {\n                if (pluggable && pluggable.getCategory() === 'PubSub') {\n                    this._pluggables.push(pluggable);\n                    config = pluggable.configure(this._options);\n                    return [2 /*return*/, config];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    PubSubClass.prototype.getProviderByName = function (providerName) {\n        if (providerName === INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER) {\n            return this.awsAppSyncProvider;\n        }\n        if (providerName === INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER) {\n            return this.awsAppSyncRealTimeProvider;\n        }\n        return this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === providerName; });\n    };\n    PubSubClass.prototype.getProviders = function (options) {\n        if (options === void 0) { options = {}; }\n        var providerName = options.provider;\n        if (!providerName) {\n            return this._pluggables;\n        }\n        var provider = this.getProviderByName(providerName);\n        if (!provider) {\n            throw new Error(\"Could not find provider named \" + providerName);\n        }\n        return [provider];\n    };\n    PubSubClass.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, Promise.all(this.getProviders(options).map(function (provider) {\n                        return provider.publish(topics, msg, options);\n                    }))];\n            });\n        });\n    };\n    PubSubClass.prototype.subscribe = function (topics, options) {\n        if (isNode && this._options && this._options.ssr) {\n            throw new Error('Subscriptions are not supported for Server-Side Rendering (SSR)');\n        }\n        logger.debug('subscribe options', options);\n        var providers = this.getProviders(options);\n        return new Observable(function (observer) {\n            var observables = providers.map(function (provider) { return ({\n                provider: provider,\n                observable: provider.subscribe(topics, options),\n            }); });\n            var subscriptions = observables.map(function (_a) {\n                var provider = _a.provider, observable = _a.observable;\n                return observable.subscribe({\n                    start: console.error,\n                    next: function (value) { return observer.next({ provider: provider, value: value }); },\n                    error: function (error) { return observer.error({ provider: provider, error: error }); },\n                });\n            });\n            return function () {\n                return subscriptions.forEach(function (subscription) { return subscription.unsubscribe(); });\n            };\n        });\n    };\n    return PubSubClass;\n}());\nexport { PubSubClass };\nexport var PubSub = new PubSubClass(null);\nAmplify.register(PubSub);\n//# sourceMappingURL=PubSub.js.map","/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { PubSub } from './PubSub';\nexport * from './Providers';\nvar CONTROL_MSG;\n(function (CONTROL_MSG) {\n    CONTROL_MSG[\"CONNECTION_CLOSED\"] = \"Connection closed\";\n    CONTROL_MSG[\"CONNECTION_FAILED\"] = \"Connection failed\";\n    CONTROL_MSG[\"REALTIME_SUBSCRIPTION_INIT_ERROR\"] = \"AppSync Realtime subscription init error\";\n    CONTROL_MSG[\"SUBSCRIPTION_ACK\"] = \"Subscription ack\";\n    CONTROL_MSG[\"TIMEOUT_DISCONNECT\"] = \"Timeout disconnect\";\n})(CONTROL_MSG || (CONTROL_MSG = {}));\nexport { PubSub, CONTROL_MSG };\n/**\n * @deprecated use named import\n */\nexport default PubSub;\n//# sourceMappingURL=index.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__aws_amplify_auth__;","module.exports = __WEBPACK_EXTERNAL_MODULE__aws_amplify_cache__;","module.exports = __WEBPACK_EXTERNAL_MODULE__aws_amplify_core__;","module.exports = __WEBPACK_EXTERNAL_MODULE_graphql__;"],"sourceRoot":""}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js
index 6d4622c..8aafb17 100644
--- a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js
+++ b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js
@@ -1,9 +1,11 @@
-!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@aws-amplify/core"),require("graphql"),require("@aws-amplify/cache"),require("@aws-amplify/auth")):"function"==typeof define&&define.amd?define("aws_amplify_pubsub",["@aws-amplify/core","graphql","@aws-amplify/cache","@aws-amplify/auth"],t):"object"==typeof exports?exports.aws_amplify_pubsub=t(require("@aws-amplify/core"),require("graphql"),require("@aws-amplify/cache"),require("@aws-amplify/auth")):e.aws_amplify_pubsub=t(e["@aws-amplify/core"],e.graphql,e["@aws-amplify/cache"],e["@aws-amplify/auth"])}(this,(function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var r=n(13),o=n(14),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e){
+!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@aws-amplify/core"),require("graphql"),require("@aws-amplify/auth"),require("@aws-amplify/cache")):"function"==typeof define&&define.amd?define("aws_amplify_pubsub",["@aws-amplify/core","graphql","@aws-amplify/auth","@aws-amplify/cache"],t):"object"==typeof exports?exports.aws_amplify_pubsub=t(require("@aws-amplify/core"),require("graphql"),require("@aws-amplify/auth"),require("@aws-amplify/cache")):e.aws_amplify_pubsub=t(e["@aws-amplify/core"],e.graphql,e["@aws-amplify/auth"],e["@aws-amplify/cache"])}(this,(function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var r=n(13),o=n(14),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e){
 /*!
  * The buffer module from node.js, for the browser.
  *
  * @author   Feross Aboukhadijeh <http://feross.org>
  * @license  MIT
  */
-var r=n(21),o=n(22),i=n(23);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=l(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(t,n),o=(e=a(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):l(e,t);if("Buffer"===t.type&&i(t.data))return l(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(f(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function l(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function d(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return B(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return O(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){var i,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var f=-1;for(i=n;i<a;i++)if(u(e,i)===u(t,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===c)return f*s}else-1!==f&&(i-=i-f),f=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var h=!0,l=0;l<c;l++)if(u(e,i+l)!==u(t,l)){h=!1;break}if(h)return i}return-1}function _(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function m(e,t,n,r){return G(B(t,e.length-n),e,n,r)}function w(e,t,n,r){return G(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return w(e,t,n,r)}function S(e,t,n,r){return G(V(t),e,n,r)}function A(e,t,n,r){return G(function(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function O(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],f=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h<=n)switch(h){case 1:u<128&&(f=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(f=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,h=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),o+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return f(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):y.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(i,s),u=this.slice(r,o),f=e.slice(t,n),h=0;h<a;++h)if(u[h]!==f[h]){i=u[h],s=f[h];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return m(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return E(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=j(e[i]);return o}function M(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function k(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function x(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function U(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,i){return i||U(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,i){return i||U(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):x(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):x(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=c.isBuffer(e)?e:B(new c(e,r).toString()),a=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var q=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function B(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function V(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(3))},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){e.exports=n(12).Observable},function(e,t,n){(function(t){var n;n=function(){return function(e){var t,n=e.localStorage||(t={},{setItem:function(e,n){t[e]=n},getItem:function(e){return t[e]},removeItem:function(e){delete t[e]}}),r=1,o=2,i=3,s=4,a=5,c=6,u=7,f=8,h=9,l=10,p=11,d=12,y=13,g=14,v=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n)){var r="Unknown property, "+n+". Valid properties are:";for(var o in t)t.hasOwnProperty(o)&&(r=r+" "+o);throw new Error(r)}if(typeof e[n]!==t[n])throw new Error(w(_.INVALID_TYPE,[typeof e[n],n]))}},b=function(e,t){return function(){return e.apply(t,arguments)}},_={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},m={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},w=function(e,t){var n=e.text;if(t)for(var r,o,i=0;i<t.length;i++)if(r="{"+i+"}",(o=n.indexOf(r))>0){var s=n.substring(0,o),a=n.substring(o+r.length);n=s+t[i]+a}return n},E=[0,6,77,81,73,115,100,112,3],S=[0,4,77,81,84,84,4],A=function(e,t){for(var n in this.type=e,t)t.hasOwnProperty(n)&&(this[n]=t[n])};function O(e,t){var n,r=t,f=e[t],l=f>>4,d=f&=15;t+=1;var y=0,g=1;do{if(t==e.length)return[null,r];y+=(127&(n=e[t++]))*g,g*=128}while(0!=(128&n));var v=t+y;if(v>e.length)return[null,r];var b=new A(l);switch(l){case o:1&e[t++]&&(b.sessionPresent=!0),b.returnCode=e[t++];break;case i:var _=d>>1&3,m=C(e,t),w=N(e,t+=2,m);t+=m,_>0&&(b.messageIdentifier=C(e,t),t+=2);var E=new U(e.subarray(t,v));1==(1&d)&&(E.retained=!0),8==(8&d)&&(E.duplicate=!0),E.qos=_,E.destinationName=w,b.payloadMessage=E;break;case s:case a:case c:case u:case p:b.messageIdentifier=C(e,t);break;case h:b.messageIdentifier=C(e,t),t+=2,b.returnCode=e.subarray(t,v)}return[b,v]}function T(e,t,n){return t[n++]=e>>8,t[n++]=e%256,n}function I(e,t,n,r){return M(e,n,r=T(t,n,r)),r+t}function C(e,t){return 256*e[t]+e[t+1]}function R(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r>2047?(55296<=r&&r<=56319&&(n++,t++),t+=3):r>127?t+=2:t++}return t}function M(e,t,n){for(var r=n,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(55296<=i&&i<=56319){var s=e.charCodeAt(++o);if(isNaN(s))throw new Error(w(_.MALFORMED_UNICODE,[i,s]));i=s-56320+(i-55296<<10)+65536}i<=127?t[r++]=i:i<=2047?(t[r++]=i>>6&31|192,t[r++]=63&i|128):i<=65535?(t[r++]=i>>12&15|224,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>18&7|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t}function N(e,t,n){for(var r,o="",i=t;i<t+n;){var s=e[i++];if(s<128)r=s;else{var a=e[i++]-128;if(a<0)throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),""]));if(s<224)r=64*(s-192)+a;else{var c=e[i++]-128;if(c<0)throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),c.toString(16)]));if(s<240)r=4096*(s-224)+64*a+c;else{var u=e[i++]-128;if(u<0)throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),c.toString(16),u.toString(16)]));if(!(s<248))throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),c.toString(16),u.toString(16)]));r=262144*(s-240)+4096*a+64*c+u}}}r>65535&&(r-=65536,o+=String.fromCharCode(55296+(r>>10)),r=56320+(1023&r)),o+=String.fromCharCode(r)}return o}A.prototype.encode=function(){var e,t=(15&this.type)<<4,n=0,o=[],s=0;switch(void 0!==this.messageIdentifier&&(n+=2),this.type){case r:switch(this.mqttVersion){case 3:n+=E.length+3;break;case 4:n+=S.length+3}n+=R(this.clientId)+2,void 0!==this.willMessage&&(n+=R(this.willMessage.destinationName)+2,(e=this.willMessage.payloadBytes)instanceof Uint8Array||(e=new Uint8Array(u)),n+=e.byteLength+2),void 0!==this.userName&&(n+=R(this.userName)+2),void 0!==this.password&&(n+=R(this.password)+2);break;case f:t|=2;for(var a=0;a<this.topics.length;a++)o[a]=R(this.topics[a]),n+=o[a]+2;n+=this.requestedQos.length;break;case l:for(t|=2,a=0;a<this.topics.length;a++)o[a]=R(this.topics[a]),n+=o[a]+2;break;case c:t|=2;break;case i:this.payloadMessage.duplicate&&(t|=8),t=t|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(t|=1),n+=(s=R(this.payloadMessage.destinationName))+2;var u=this.payloadMessage.payloadBytes;n+=u.byteLength,u instanceof ArrayBuffer?u=new Uint8Array(u):u instanceof Uint8Array||(u=new Uint8Array(u.buffer))}var h=function(e){var t=new Array(1),n=0;do{var r=e%128;(e>>=7)>0&&(r|=128),t[n++]=r}while(e>0&&n<4);return t}(n),p=h.length+1,d=new ArrayBuffer(n+p),y=new Uint8Array(d);if(y[0]=t,y.set(h,1),this.type==i)p=I(this.payloadMessage.destinationName,s,y,p);else if(this.type==r){switch(this.mqttVersion){case 3:y.set(E,p),p+=E.length;break;case 4:y.set(S,p),p+=S.length}var g=0;this.cleanSession&&(g=2),void 0!==this.willMessage&&(g|=4,g|=this.willMessage.qos<<3,this.willMessage.retained&&(g|=32)),void 0!==this.userName&&(g|=128),void 0!==this.password&&(g|=64),y[p++]=g,p=T(this.keepAliveInterval,y,p)}switch(void 0!==this.messageIdentifier&&(p=T(this.messageIdentifier,y,p)),this.type){case r:p=I(this.clientId,R(this.clientId),y,p),void 0!==this.willMessage&&(p=I(this.willMessage.destinationName,R(this.willMessage.destinationName),y,p),p=T(e.byteLength,y,p),y.set(e,p),p+=e.byteLength),void 0!==this.userName&&(p=I(this.userName,R(this.userName),y,p)),void 0!==this.password&&(p=I(this.password,R(this.password),y,p));break;case i:y.set(u,p);break;case f:for(a=0;a<this.topics.length;a++)p=I(this.topics[a],o[a],y,p),y[p++]=this.requestedQos[a];break;case l:for(a=0;a<this.topics.length;a++)p=I(this.topics[a],o[a],y,p)}return d};var P=function(e,t){this._client=e,this._keepAliveInterval=1e3*t,this.isReset=!1;var n=new A(d).encode(),r=function(e){return function(){return o.apply(e)}},o=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(n),this.timeout=setTimeout(r(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(_.PING_TIMEOUT.code,w(_.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(r(this),this._keepAliveInterval))},this.cancel=function(){clearTimeout(this.timeout)}},k=function(e,t,n,r){t||(t=30),this.timeout=setTimeout(function(e,t,n){return function(){return e.apply(t,n)}}(n,e,r),1e3*t),this.cancel=function(){clearTimeout(this.timeout)}},x=function(t,r,o,i,s){if(!("WebSocket"in e)||null===e.WebSocket)throw new Error(w(_.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in e)||null===e.ArrayBuffer)throw new Error(w(_.UNSUPPORTED,["ArrayBuffer"]));for(var a in this._trace("Paho.Client",t,r,o,i,s),this.host=r,this.port=o,this.path=i,this.uri=t,this.clientId=s,this._wsuri=null,this._localKey=r+":"+o+("/mqtt"!=i?":"+i:"")+":"+s+":",this._msg_queue=[],this._buffered_msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0,n)0!==a.indexOf("Sent:"+this._localKey)&&0!==a.indexOf("Received:"+this._localKey)||this.restore(a)};x.prototype.host=null,x.prototype.port=null,x.prototype.path=null,x.prototype.uri=null,x.prototype.clientId=null,x.prototype.socket=null,x.prototype.connected=!1,x.prototype.maxMessageIdentifier=65536,x.prototype.connectOptions=null,x.prototype.hostIndex=null,x.prototype.onConnected=null,x.prototype.onConnectionLost=null,x.prototype.onMessageDelivered=null,x.prototype.onMessageArrived=null,x.prototype.traceFunction=null,x.prototype._msg_queue=null,x.prototype._buffered_msg_queue=null,x.prototype._connectTimeout=null,x.prototype.sendPinger=null,x.prototype.receivePinger=null,x.prototype._reconnectInterval=1,x.prototype._reconnecting=!1,x.prototype._reconnectTimeout=null,x.prototype.disconnectedPublishing=!1,x.prototype.disconnectedBufferSize=5e3,x.prototype.receiveBuffer=null,x.prototype._traceBuffer=null,x.prototype._MAX_TRACE_ENTRIES=100,x.prototype.connect=function(e){var t=this._traceMask(e,"password");if(this._trace("Client.connect",t,this.socket,this.connected),this.connected)throw new Error(w(_.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(w(_.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),this.connectOptions=e,this._reconnectInterval=1,this._reconnecting=!1,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},x.prototype.subscribe=function(e,t){if(this._trace("Client.subscribe",e,t),!this.connected)throw new Error(w(_.INVALID_STATE,["not connected"]));var n=new A(f);n.topics=e.constructor===Array?e:[e],void 0===t.qos&&(t.qos=0),n.requestedQos=[];for(var r=0;r<n.topics.length;r++)n.requestedQos[r]=t.qos;t.onSuccess&&(n.onSuccess=function(e){t.onSuccess({invocationContext:t.invocationContext,grantedQos:e})}),t.onFailure&&(n.onFailure=function(e){t.onFailure({invocationContext:t.invocationContext,errorCode:e,errorMessage:w(e)})}),t.timeout&&(n.timeOut=new k(this,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:_.SUBSCRIBE_TIMEOUT.code,errorMessage:w(_.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},x.prototype.unsubscribe=function(e,t){if(this._trace("Client.unsubscribe",e,t),!this.connected)throw new Error(w(_.INVALID_STATE,["not connected"]));var n=new A(l);n.topics=e.constructor===Array?e:[e],t.onSuccess&&(n.callback=function(){t.onSuccess({invocationContext:t.invocationContext})}),t.timeout&&(n.timeOut=new k(this,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:_.UNSUBSCRIBE_TIMEOUT.code,errorMessage:w(_.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},x.prototype.send=function(e){this._trace("Client.send",e);var t=new A(i);if(t.payloadMessage=e,this.connected)e.qos>0?this._requires_ack(t):this.onMessageDelivered&&(this._notify_msg_sent[t]=this.onMessageDelivered(t.payloadMessage)),this._schedule_message(t);else{if(!this._reconnecting||!this.disconnectedPublishing)throw new Error(w(_.INVALID_STATE,["not connected"]));if(Object.keys(this._sentMessages).length+this._buffered_msg_queue.length>this.disconnectedBufferSize)throw new Error(w(_.BUFFER_FULL,[this.disconnectedBufferSize]));e.qos>0?this._requires_ack(t):(t.sequence=++this._sequence,this._buffered_msg_queue.unshift(t))}},x.prototype.disconnect=function(){if(this._trace("Client.disconnect"),this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),!this.socket)throw new Error(w(_.INVALID_STATE,["not connecting or connected"]));var e=new A(g);this._notify_msg_sent[e]=b(this._disconnected,this),this._schedule_message(e)},x.prototype.getTraceLog=function(){if(null!==this._traceBuffer){for(var e in this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length),this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},x.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"@VERSION@-@BUILDLEVEL@")},x.prototype.stopTrace=function(){delete this._traceBuffer},x.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this._wsuri=e,this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(e,["mqttv3.1"]):this.socket=new WebSocket(e,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=b(this._on_socket_open,this),this.socket.onmessage=b(this._on_socket_message,this),this.socket.onerror=b(this._on_socket_error,this),this.socket.onclose=b(this._on_socket_close,this),this.sendPinger=new P(this,this.connectOptions.keepAliveInterval),this.receivePinger=new P(this,this.connectOptions.keepAliveInterval),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._connectTimeout=new k(this,this.connectOptions.timeout,this._disconnected,[_.CONNECT_TIMEOUT.code,w(_.CONNECT_TIMEOUT)])},x.prototype._schedule_message=function(e){this._msg_queue.unshift(e),this.connected&&this._process_queue()},x.prototype.store=function(e,t){var r={type:t.type,messageIdentifier:t.messageIdentifier,version:1};switch(t.type){case i:t.pubRecReceived&&(r.pubRecReceived=!0),r.payloadMessage={};for(var o="",s=t.payloadMessage.payloadBytes,a=0;a<s.length;a++)s[a]<=15?o=o+"0"+s[a].toString(16):o+=s[a].toString(16);r.payloadMessage.payloadHex=o,r.payloadMessage.qos=t.payloadMessage.qos,r.payloadMessage.destinationName=t.payloadMessage.destinationName,t.payloadMessage.duplicate&&(r.payloadMessage.duplicate=!0),t.payloadMessage.retained&&(r.payloadMessage.retained=!0),0===e.indexOf("Sent:")&&(void 0===t.sequence&&(t.sequence=++this._sequence),r.sequence=t.sequence);break;default:throw Error(w(_.INVALID_STORED_DATA,[e+this._localKey+t.messageIdentifier,r]))}n.setItem(e+this._localKey+t.messageIdentifier,JSON.stringify(r))},x.prototype.restore=function(e){var t=n.getItem(e),r=JSON.parse(t),o=new A(r.type,r);switch(r.type){case i:for(var s=r.payloadMessage.payloadHex,a=new ArrayBuffer(s.length/2),c=new Uint8Array(a),u=0;s.length>=2;){var f=parseInt(s.substring(0,2),16);s=s.substring(2,s.length),c[u++]=f}var h=new U(c);h.qos=r.payloadMessage.qos,h.destinationName=r.payloadMessage.destinationName,r.payloadMessage.duplicate&&(h.duplicate=!0),r.payloadMessage.retained&&(h.retained=!0),o.payloadMessage=h;break;default:throw Error(w(_.INVALID_STORED_DATA,[e,t]))}0===e.indexOf("Sent:"+this._localKey)?(o.payloadMessage.duplicate=!0,this._sentMessages[o.messageIdentifier]=o):0===e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[o.messageIdentifier]=o)},x.prototype._process_queue=function(){for(var e=null;e=this._msg_queue.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},x.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,e.type===i&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},x.prototype._on_socket_open=function(){var e=new A(r,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},x.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data);for(var t=this._deframeMessages(e.data),n=0;n<t.length;n+=1)this._handleMessage(t[n])},x.prototype._deframeMessages=function(e){var t=new Uint8Array(e),n=[];if(this.receiveBuffer){var r=new Uint8Array(this.receiveBuffer.length+t.length);r.set(this.receiveBuffer),r.set(t,this.receiveBuffer.length),t=r,delete this.receiveBuffer}try{for(var o=0;o<t.length;){var i=O(t,o),s=i[0];if(o=i[1],null===s)break;n.push(s)}o<t.length&&(this.receiveBuffer=t.subarray(o))}catch(e){var a="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(_.INTERNAL_ERROR.code,w(_.INTERNAL_ERROR,[e.message,a]))}return n},x.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case o:if(this._connectTimeout.cancel(),this._reconnectTimeout&&this._reconnectTimeout.cancel(),this.connectOptions.cleanSession){for(var t in this._sentMessages){var r=this._sentMessages[t];n.removeItem("Sent:"+this._localKey+r.messageIdentifier)}for(var t in this._sentMessages={},this._receivedMessages){var f=this._receivedMessages[t];n.removeItem("Received:"+this._localKey+f.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(_.CONNACK_RETURNCODE.code,w(_.CONNACK_RETURNCODE,[e.returnCode,m[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var l=[];for(var d in this._sentMessages)this._sentMessages.hasOwnProperty(d)&&l.push(this._sentMessages[d]);if(this._buffered_msg_queue.length>0)for(var v=null;v=this._buffered_msg_queue.pop();)l.push(v),this.onMessageDelivered&&(this._notify_msg_sent[v]=this.onMessageDelivered(v.payloadMessage));l=l.sort((function(e,t){return e.sequence-t.sequence}));for(var b=0,E=l.length;b<E;b++)if((r=l[b]).type==i&&r.pubRecReceived){var S=new A(c,{messageIdentifier:r.messageIdentifier});this._schedule_message(S)}else this._schedule_message(r);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});var O=!1;this._reconnecting&&(O=!0,this._reconnectInterval=1,this._reconnecting=!1),this._connected(O,this._wsuri),this._process_queue();break;case i:this._receivePublish(e);break;case s:(r=this._sentMessages[e.messageIdentifier])&&(delete this._sentMessages[e.messageIdentifier],n.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(r.payloadMessage));break;case a:(r=this._sentMessages[e.messageIdentifier])&&(r.pubRecReceived=!0,S=new A(c,{messageIdentifier:e.messageIdentifier}),this.store("Sent:",r),this._schedule_message(S));break;case c:f=this._receivedMessages[e.messageIdentifier],n.removeItem("Received:"+this._localKey+e.messageIdentifier),f&&(this._receiveMessage(f),delete this._receivedMessages[e.messageIdentifier]);var T=new A(u,{messageIdentifier:e.messageIdentifier});this._schedule_message(T);break;case u:r=this._sentMessages[e.messageIdentifier],delete this._sentMessages[e.messageIdentifier],n.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(r.payloadMessage);break;case h:(r=this._sentMessages[e.messageIdentifier])&&(r.timeOut&&r.timeOut.cancel(),128===e.returnCode[0]?r.onFailure&&r.onFailure(e.returnCode):r.onSuccess&&r.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case p:(r=this._sentMessages[e.messageIdentifier])&&(r.timeOut&&r.timeOut.cancel(),r.callback&&r.callback(),delete this._sentMessages[e.messageIdentifier]);break;case y:this.sendPinger.reset();break;case g:this._disconnected(_.INVALID_MQTT_MESSAGE_TYPE.code,w(_.INVALID_MQTT_MESSAGE_TYPE,[e.type]));break;default:this._disconnected(_.INVALID_MQTT_MESSAGE_TYPE.code,w(_.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(e){var I="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(_.INTERNAL_ERROR.code,w(_.INTERNAL_ERROR,[e.message,I]))}},x.prototype._on_socket_error=function(e){this._reconnecting||this._disconnected(_.SOCKET_ERROR.code,w(_.SOCKET_ERROR,[e.data]))},x.prototype._on_socket_close=function(){this._reconnecting||this._disconnected(_.SOCKET_CLOSE.code,w(_.SOCKET_CLOSE))},x.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),this.sendPinger.reset()},x.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new A(s,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var n=new A(a,{messageIdentifier:e.messageIdentifier});this._schedule_message(n);break;default:throw Error("Invaild qos="+e.payloadMessage.qos)}},x.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},x.prototype._connected=function(e,t){this.onConnected&&this.onConnected(e,t)},x.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=2*this._reconnectInterval),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))},x.prototype._disconnected=function(e,t){if(this._trace("Client._disconnected",e,t),void 0!==e&&this._reconnecting)this._reconnectTimeout=new k(this,this._reconnectInterval,this._reconnect);else if(this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._msg_queue=[],this._buffered_msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else if(void 0===e&&(e=_.OK.code,t=w(_.OK)),this.connected){if(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t,reconnect:this.connectOptions.reconnect,uri:this._wsuri}),e!==_.OK.code&&this.connectOptions.reconnect)return this._reconnectInterval=1,void this._reconnect()}else 4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t})},x.prototype._trace=function(){if(this.traceFunction){var e=Array.prototype.slice.call(arguments);for(var t in e)void 0!==e[t]&&e.splice(t,1,JSON.stringify(e[t]));var n=e.join("");this.traceFunction({severity:"Debug",message:n})}if(null!==this._traceBuffer){t=0;for(var r=arguments.length;t<r;t++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===t||void 0===arguments[t]?this._traceBuffer.push(arguments[t]):this._traceBuffer.push("  "+JSON.stringify(arguments[t]))}},x.prototype._traceMask=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=r==t?"******":e[r]);return n};var U=function(e){var t,n;if(!("string"==typeof e||e instanceof ArrayBuffer||ArrayBuffer.isView(e)&&!(e instanceof DataView)))throw w(_.INVALID_ARGUMENT,[e,"newPayload"]);t=e;var r=0,o=!1,i=!1;Object.defineProperties(this,{payloadString:{enumerable:!0,get:function(){return"string"==typeof t?t:N(t,0,t.length)}},payloadBytes:{enumerable:!0,get:function(){if("string"==typeof t){var e=new ArrayBuffer(R(t)),n=new Uint8Array(e);return M(t,n,0),n}return t}},destinationName:{enumerable:!0,get:function(){return n},set:function(e){if("string"!=typeof e)throw new Error(w(_.INVALID_ARGUMENT,[e,"newDestinationName"]));n=e}},qos:{enumerable:!0,get:function(){return r},set:function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);r=e}},retained:{enumerable:!0,get:function(){return o},set:function(e){if("boolean"!=typeof e)throw new Error(w(_.INVALID_ARGUMENT,[e,"newRetained"]));o=e}},topic:{enumerable:!0,get:function(){return n},set:function(e){n=e}},duplicate:{enumerable:!0,get:function(){return i},set:function(e){i=e}}})};return{Client:function(e,t,n,r){var o;if("string"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"host"]));if(2==arguments.length){r=t;var i=(o=e).match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!i)throw new Error(w(_.INVALID_ARGUMENT,[e,"host"]));e=i[4]||i[2],t=parseInt(i[7]),n=i[8]}else{if(3==arguments.length&&(r=n,n="/mqtt"),"number"!=typeof t||t<0)throw new Error(w(_.INVALID_TYPE,[typeof t,"port"]));if("string"!=typeof n)throw new Error(w(_.INVALID_TYPE,[typeof n,"path"]));var s=-1!==e.indexOf(":")&&"["!==e.slice(0,1)&&"]"!==e.slice(-1);o="ws://"+(s?"["+e+"]":e)+":"+t+n}for(var a=0,c=0;c<r.length;c++){var u=r.charCodeAt(c);55296<=u&&u<=56319&&c++,a++}if("string"!=typeof r||a>65535)throw new Error(w(_.INVALID_ARGUMENT,[r,"clientId"]));var f=new x(o,e,t,n,r);Object.defineProperties(this,{host:{get:function(){return e},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},port:{get:function(){return t},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},path:{get:function(){return n},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},uri:{get:function(){return o},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},clientId:{get:function(){return f.clientId},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},onConnected:{get:function(){return f.onConnected},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onConnected"]));f.onConnected=e}},disconnectedPublishing:{get:function(){return f.disconnectedPublishing},set:function(e){f.disconnectedPublishing=e}},disconnectedBufferSize:{get:function(){return f.disconnectedBufferSize},set:function(e){f.disconnectedBufferSize=e}},onConnectionLost:{get:function(){return f.onConnectionLost},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onConnectionLost"]));f.onConnectionLost=e}},onMessageDelivered:{get:function(){return f.onMessageDelivered},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onMessageDelivered"]));f.onMessageDelivered=e}},onMessageArrived:{get:function(){return f.onMessageArrived},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onMessageArrived"]));f.onMessageArrived=e}},trace:{get:function(){return f.traceFunction},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onTrace"]));f.traceFunction=e}}}),this.connect=function(e){if(v(e=e||{},{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(w(_.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0!==e.password&&void 0===e.userName)throw new Error(w(_.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof U))throw new Error(w(_.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload=null,void 0===e.willMessage.destinationName)throw new Error(w(_.INVALID_TYPE,[typeof e.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if(void 0===e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(w(_.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(w(_.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var t=!1,r=0;r<e.hosts.length;r++){if("string"!=typeof e.hosts[r])throw new Error(w(_.INVALID_TYPE,[typeof e.hosts[r],"connectOptions.hosts["+r+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[r])){if(0===r)t=!0;else if(!t)throw new Error(w(_.INVALID_ARGUMENT,[e.hosts[r],"connectOptions.hosts["+r+"]"]))}else if(t)throw new Error(w(_.INVALID_ARGUMENT,[e.hosts[r],"connectOptions.hosts["+r+"]"]))}if(t)e.uris=e.hosts;else{if(!e.ports)throw new Error(w(_.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(w(_.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!==e.ports.length)throw new Error(w(_.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));for(e.uris=[],r=0;r<e.hosts.length;r++){if("number"!=typeof e.ports[r]||e.ports[r]<0)throw new Error(w(_.INVALID_TYPE,[typeof e.ports[r],"connectOptions.ports["+r+"]"]));var i=e.hosts[r],s=e.ports[r],a=-1!==i.indexOf(":");o="ws://"+(a?"["+i+"]":i)+":"+s+n,e.uris.push(o)}}}f.connect(e)},this.subscribe=function(e,t){if("string"!=typeof e&&e.constructor!==Array)throw new Error("Invalid argument:"+e);if(v(t=t||{},{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(void 0!==t.qos&&0!==t.qos&&1!==t.qos&&2!==t.qos)throw new Error(w(_.INVALID_ARGUMENT,[t.qos,"subscribeOptions.qos"]));f.subscribe(e,t)},this.unsubscribe=function(e,t){if("string"!=typeof e&&e.constructor!==Array)throw new Error("Invalid argument:"+e);if(v(t=t||{},{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");f.unsubscribe(e,t)},this.send=function(e,t,n,r){var o;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof U)&&"string"!=typeof e)throw new Error("Invalid argument:"+typeof e);if(void 0===(o=e).destinationName)throw new Error(w(_.INVALID_ARGUMENT,[o.destinationName,"Message.destinationName"]));f.send(o)}else(o=new U(t)).destinationName=e,arguments.length>=3&&(o.qos=n),arguments.length>=4&&(o.retained=r),f.send(o)},this.publish=function(e,t,n,r){var o;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof U)&&"string"!=typeof e)throw new Error("Invalid argument:"+typeof e);if(void 0===(o=e).destinationName)throw new Error(w(_.INVALID_ARGUMENT,[o.destinationName,"Message.destinationName"]));f.send(o)}else(o=new U(t)).destinationName=e,arguments.length>=3&&(o.qos=n),arguments.length>=4&&(o.retained=r),f.send(o)},this.disconnect=function(){f.disconnect()},this.getTraceLog=function(){return f.getTraceLog()},this.startTrace=function(){f.startTrace()},this.stopTrace=function(){f.stopTrace()},this.isConnected=function(){return f.connected}},Message:U}}(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},e.exports=n()}).call(this,n(3))},function(e,t,n){"use strict";var r=n(15),o=n(17);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=_,t.resolve=function(e,t){return _(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?_(e,!1,!0).resolveObject(t):t},t.format=function(e){o.isString(e)&&(e=_(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),f=["'"].concat(u),h=["%","/","?",";","#"].concat(f),l=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=n(18);function _(e,t,n){if(e&&o.isObject(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}i.prototype.parse=function(e,t,n){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),a=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var _=e=u.join(a);if(_=_.trim(),!n&&1===e.split("#").length){var m=c.exec(_);if(m)return this.path=_,this.href=_,this.pathname=m[1],m[2]?(this.search=m[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=s.exec(_);if(w){var E=(w=w[0]).toLowerCase();this.protocol=E,_=_.substr(w.length)}if(n||w||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===_.substr(0,2);!S||w&&g[w]||(_=_.substr(2),this.slashes=!0)}if(!g[w]&&(S||w&&!v[w])){for(var A,O,T=-1,I=0;I<l.length;I++){-1!==(C=_.indexOf(l[I]))&&(-1===T||C<T)&&(T=C)}-1!==(O=-1===T?_.lastIndexOf("@"):_.lastIndexOf("@",T))&&(A=_.slice(0,O),_=_.slice(O+1),this.auth=decodeURIComponent(A)),T=-1;for(I=0;I<h.length;I++){var C;-1!==(C=_.indexOf(h[I]))&&(-1===T||C<T)&&(T=C)}-1===T&&(T=_.length),this.host=_.slice(0,T),_=_.slice(T),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var M=this.hostname.split(/\./),N=(I=0,M.length);I<N;I++){var P=M[I];if(P&&!P.match(p)){for(var k="",x=0,U=P.length;x<U;x++)P.charCodeAt(x)>127?k+="x":k+=P[x];if(!k.match(p)){var L=M.slice(0,I),D=M.slice(I+1),q=P.match(d);q&&(L.push(q[1]),D.unshift(q[2])),D.length&&(_="/"+D.join(".")+_),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=r.toASCII(this.hostname));var j=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+j,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!y[E])for(I=0,N=f.length;I<N;I++){var V=f[I];if(-1!==_.indexOf(V)){var G=encodeURIComponent(V);G===V&&(G=escape(V)),_=_.split(V).join(G)}}var F=_.indexOf("#");-1!==F&&(this.hash=_.substr(F),_=_.slice(0,F));var Y=_.indexOf("?");if(-1!==Y?(this.search=_.substr(Y),this.query=_.substr(Y+1),t&&(this.query=b.parse(this.query)),_=_.slice(0,Y)):t&&(this.search="",this.query={}),_&&(this.pathname=_),v[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var Q=this.search||"";this.path=j+Q}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,s="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(s=b.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+r},i.prototype.resolve=function(e){return this.resolveObject(_(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(o.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var n=new i,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),u=0;u<c.length;u++){var f=c[u];"protocol"!==f&&(n[f]=e[f])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var h=Object.keys(e),l=0;l<h.length;l++){var p=h[l];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var y=n.pathname||"",b=n.search||"";n.path=y+b}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var _=n.pathname&&"/"===n.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=m||_||n.host&&e.pathname,E=w,S=n.pathname&&n.pathname.split("/")||[],A=(d=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),w=w&&(""===d[0]||""===S[0])),m)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=e.search,n.query=e.query;else if(!o.isNullOrUndefined(e.search)){if(A)n.hostname=n.host=S.shift(),(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift());return n.search=e.search,n.query=e.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var O=S.slice(-1)[0],T=(n.host||e.host||S.length>1)&&("."===O||".."===O)||""===O,I=0,C=S.length;C>=0;C--)"."===(O=S[C])?S.splice(C,1):".."===O?(S.splice(C,1),I++):I&&(S.splice(C,1),I--);if(!w&&!E)for(;I--;I)S.unshift("..");!w||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),T&&"/"!==S.join("/").substr(-1)&&S.push("");var R,M=""===S[0]||S[0]&&"/"===S[0].charAt(0);A&&(n.hostname=n.host=M?"":S.length?S.shift():"",(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift()));return(w=w||n.host&&S.length)&&!M&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var s=function(){return"function"==typeof Symbol},a=function(e){return s()&&Boolean(Symbol[e])},c=function(e){return a(e)?Symbol[e]:"@@"+e};s()&&!a("observable")&&(Symbol.observable=Symbol("observable"));var u=c("iterator"),f=c("observable"),h=c("species");function l(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function p(e){var t=e.constructor;return void 0!==t&&null===(t=t[h])&&(t=void 0),void 0!==t?t:S}function d(e){return e instanceof S}function y(e){y.log?y.log(e):setTimeout((function(){throw e}))}function g(e){Promise.resolve().then((function(){try{e()}catch(e){y(e)}}))}function v(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var n=l(t,"unsubscribe");n&&n.call(t)}}catch(e){y(e)}}function b(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function _(e,t,n){e._state="running";var r=e._observer;try{var o=l(r,t);switch(t){case"next":o&&o.call(r,n);break;case"error":if(b(e),!o)throw n;o.call(r,n);break;case"complete":b(e),o&&o.call(r)}}catch(e){y(e)}"closed"===e._state?v(e):"running"===e._state&&(e._state="ready")}function m(e,t,n){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void g((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var n=0;n<t.length&&(_(e,t[n].type,t[n].value),"closed"!==e._state);++n);}}(e)}))):void _(e,t,n);e._queue.push({type:t,value:n})}}var w=function(){function e(t,n){r(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var o=new E(this);try{this._cleanup=n.call(void 0,o)}catch(e){o.error(e)}"initializing"===this._state&&(this._state="ready")}return i(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(b(this),v(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),E=function(){function e(t){r(this,e),this._subscription=t}return i(e,[{key:"next",value:function(e){m(this._subscription,"next",e)}},{key:"error",value:function(e){m(this._subscription,"error",e)}},{key:"complete",value:function(){m(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),S=function(){function e(t){if(r(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return i(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new w(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise((function(n,r){if("function"==typeof e)var o=t.subscribe({next:function(t){try{e(t,i)}catch(e){r(e),o.unsubscribe()}},error:r,complete:n});else r(new TypeError(e+" is not a function"));function i(){o.unsubscribe(),n()}}))}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))((function(n){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))((function(n){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=p(this),r=arguments.length>1,o=!1,i=arguments[1],s=i;return new n((function(n){return t.subscribe({next:function(t){var i=!o;if(o=!0,!i||r)try{s=e(s,t)}catch(e){return n.error(e)}else s=t},error:function(e){n.error(e)},complete:function(){if(!o&&!r)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(s),n.complete()}})}))}},{key:"concat",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=p(this);return new o((function(t){var r,i=0;return function e(s){r=s.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){i===n.length?(r=void 0,t.complete()):e(o.from(n[i++]))}})}(e),function(){r&&(r.unsubscribe(),r=void 0)}}))}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=p(this);return new n((function(r){var o=[],i=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return r.error(e)}var i=n.from(t).subscribe({next:function(e){r.next(e)},error:function(e){r.error(e)},complete:function(){var e=o.indexOf(i);e>=0&&o.splice(e,1),s()}});o.push(i)},error:function(e){r.error(e)},complete:function(){s()}});function s(){i.closed&&0===o.length&&r.complete()}return function(){o.forEach((function(e){return e.unsubscribe()})),i.unsubscribe()}}))}},{key:f,value:function(){return this}}],[{key:"from",value:function(t){var n="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var r=l(t,f);if(r){var o=r.call(t);if(Object(o)!==o)throw new TypeError(o+" is not an object");return d(o)&&o.constructor===n?o:new n((function(e){return o.subscribe(e)}))}if(a("iterator")&&(r=l(t,u)))return new n((function(e){g((function(){if(!e.closed){var n=!0,o=!1,i=void 0;try{for(var s,a=r.call(t)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var c=s.value;if(e.next(c),e.closed)return}}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}e.complete()}}))}));if(Array.isArray(t))return new n((function(e){g((function(){if(!e.closed){for(var n=0;n<t.length;++n)if(e.next(t[n]),e.closed)return;e.complete()}}))}));throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o="function"==typeof this?this:e;return new o((function(e){g((function(){if(!e.closed){for(var t=0;t<n.length;++t)if(e.next(n[t]),e.closed)return;e.complete()}}))}))}},{key:h,get:function(){return this}}]),e}();t.Observable=S,s()&&Object.defineProperty(S,Symbol("extensions"),{value:{symbol:f,hostReportError:y},configurable:!0})},function(e,t,n){var r,o,i=n(5),s=n(6),a=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,f=t||[],h=(e=e||{}).node||r,l=void 0!==e.clockseq?e.clockseq:o;if(null==h||null==l){var p=i();null==h&&(h=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==l&&(l=o=16383&(p[6]<<8|p[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:c+1,g=d-a+(y-c)/1e4;if(g<0&&void 0===e.clockseq&&(l=l+1&16383),(g<0||d>a)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=d,c=y,o=l;var v=(1e4*(268435455&(d+=122192928e5))+y)%4294967296;f[u++]=v>>>24&255,f[u++]=v>>>16&255,f[u++]=v>>>8&255,f[u++]=255&v;var b=d/4294967296*1e4&268435455;f[u++]=b>>>8&255,f[u++]=255&b,f[u++]=b>>>24&15|16,f[u++]=b>>>16&255,f[u++]=l>>>8|128,f[u++]=255&l;for(var _=0;_<6;++_)f[u+_]=h[_];return t||s(f)}},function(e,t,n){var r=n(5),o=n(6);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||o(s)}},function(e,t,n){(function(e,r){var o;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,c=2147483647,u=/^xn--/,f=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,d=String.fromCharCode;function y(e){throw new RangeError(l[e])}function g(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function v(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+g((e=e.replace(h,".")).split("."),t).join(".")}function b(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function _(e){return g(e,(function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=d(e)})).join("")}function m(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function w(e,t,n){var r=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;r+=36)e=p(e/35);return p(r+36*e/(e+38))}function E(e){var t,n,r,o,i,s,a,u,f,h,l,d=[],g=e.length,v=0,b=128,m=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&y("not-basic"),d.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<g;){for(i=v,s=1,a=36;o>=g&&y("invalid-input"),((u=(l=e.charCodeAt(o++))-48<10?l-22:l-65<26?l-65:l-97<26?l-97:36)>=36||u>p((c-v)/s))&&y("overflow"),v+=u*s,!(u<(f=a<=m?1:a>=m+26?26:a-m));a+=36)s>p(c/(h=36-f))&&y("overflow"),s*=h;m=w(v-i,t=d.length+1,0==i),p(v/t)>c-b&&y("overflow"),b+=p(v/t),v%=t,d.splice(v++,0,b)}return _(d)}function S(e){var t,n,r,o,i,s,a,u,f,h,l,g,v,_,E,S=[];for(g=(e=b(e)).length,t=128,n=0,i=72,s=0;s<g;++s)(l=e[s])<128&&S.push(d(l));for(r=o=S.length,o&&S.push("-");r<g;){for(a=c,s=0;s<g;++s)(l=e[s])>=t&&l<a&&(a=l);for(a-t>p((c-n)/(v=r+1))&&y("overflow"),n+=(a-t)*v,t=a,s=0;s<g;++s)if((l=e[s])<t&&++n>c&&y("overflow"),l==t){for(u=n,f=36;!(u<(h=f<=i?1:f>=i+26?26:f-i));f+=36)E=u-h,_=36-h,S.push(d(m(h+E%_,0))),u=p(E/_);S.push(d(m(u,0))),i=w(n,v,r==o),n=0,++r}++n,++t}return S.join("")}a={version:"1.4.1",ucs2:{decode:b,encode:_},decode:E,encode:S,toASCII:function(e){return v(e,(function(e){return f.test(e)?"xn--"+S(e):e}))},toUnicode:function(e){return v(e,(function(e){return u.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(o=function(){return a}.call(t,n,t,e))||(e.exports=o)}()}).call(this,n(16)(e),n(3))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(19),t.encode=t.stringify=n(20)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var f=0;f<u;++f){var h,l,p,d,y=e[f].replace(a,"%20"),g=y.indexOf(n);g>=0?(h=y.substr(0,g),l=y.substr(g+1)):(h=y,l=""),p=decodeURIComponent(h),d=decodeURIComponent(l),r(s,p)?o(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(s(e),(function(s){var a=encodeURIComponent(r(s))+n;return o(e[s])?i(e[s],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[s]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),s=r[0],a=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),f=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[f++]=t>>16&255,c[f++]=t>>8&255,c[f++]=255&t;2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[f++]=255&t);1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[f++]=t>>8&255,c[f++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(f(e,s,s+16383>a?a:s+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function f(e,t,n){for(var o,i,s=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,f=-7,h=n?o-1:0,l=n?-1:1,p=e[t+h];for(h+=l,i=p&(1<<-f)-1,p>>=-f,f+=a;f>0;i=256*i+e[t+h],h+=l,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=r;f>0;s=256*s+e[t+h],h+=l,f-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=u}return(p?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var s,a,c,u=8*i-o-1,f=(1<<u)-1,h=f>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?l/c:l*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=f?(a=0,s=f):s+h>=1?(a=(t*c-1)*Math.pow(2,o),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+p]=255&s,p+=d,s/=256,u-=8);e[n+p-d]|=128*y}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"AbstractPubSubProvider",(function(){return f})),n.d(t,"AWSAppSyncProvider",(function(){return k})),n.d(t,"AWSAppSyncRealTimeProvider",(function(){return $})),n.d(t,"AWSIoTProvider",(function(){return ie})),n.d(t,"mqttTopicMatch",(function(){return _})),n.d(t,"MqttOverWSProvider",(function(){return O})),n.d(t,"PubSub",(function(){return te})),n.d(t,"CONTROL_MSG",(function(){return W}));var r=n(7),o=n.n(r).a,i=n(0),s=n(8),a=n(2),c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=new i.ConsoleLogger("AbstractPubSubProvider"),f=function(){function e(e){void 0===e&&(e={}),this._config=e}return e.prototype.configure=function(e){return void 0===e&&(e={}),this._config=c(c({},e),this._config),u.debug("configure "+this.getProviderName(),this._config),this.options},e.prototype.getCategory=function(){return"PubSub"},Object.defineProperty(e.prototype,"options",{get:function(){return c({},this._config)},enumerable:!0,configurable:!0}),e}();function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l,p=(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},g=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},v=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},b=new i.ConsoleLogger("MqttOverWSProvider");function _(e,t){for(var n=e.split("/"),r=n.length,o=t.split("/"),i=0;i<r;++i){var s=n[i],a=o[i];if("#"===s)return o.length>=r;if("+"!==s&&s!==a)return!1}return r===o.length}var m,w,E,S=function(){function e(){this.promises=new Map}return e.prototype.get=function(e,t){return y(this,void 0,void 0,(function(){var n;return g(this,(function(r){return(n=this.promises.get(e))||(n=t(e),this.promises.set(e,n)),[2,n]}))}))},Object.defineProperty(e.prototype,"allClients",{get:function(){return Array.from(this.promises.keys())},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.promises.delete(e)},e}(),A="undefined"!=typeof Symbol?Symbol("topic"):"@@topic",O=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,d(d({},t),{clientId:t.clientId||Object(a.v4)()}))||this;return n._clientsQueue=new S,n._topicObservers=new Map,n._clientIdObservers=new Map,n}return p(t,e),Object.defineProperty(t.prototype,"clientId",{get:function(){return this.options.clientId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endpoint",{get:function(){return this.options.aws_pubsub_endpoint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientsQueue",{get:function(){return this._clientsQueue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSSLEnabled",{get:function(){return!this.options.aws_appsync_dangerously_connect_to_http_endpoint_for_testing},enumerable:!0,configurable:!0}),t.prototype.getTopicForValue=function(e){return"object"===h(e)&&e[A]},t.prototype.getProviderName=function(){return"MqttOverWSProvider"},t.prototype.onDisconnect=function(e){var t=this,n=e.clientId,r=e.errorCode,o=v(e,["clientId","errorCode"]);if(0!==r){b.warn(n,JSON.stringify(d({errorCode:r},o),null,2));var i=[],s=this._clientIdObservers.get(n);if(!s)return;s.forEach((function(e){e.error("Disconnected, error code: "+r),t._topicObservers.forEach((function(t,n){t.delete(e),0===t.size&&i.push(n)}))})),this._clientIdObservers.delete(n),i.forEach((function(e){t._topicObservers.delete(e)}))}},t.prototype.newClient=function(e){var t=e.url,n=e.clientId;return y(this,void 0,void 0,(function(){var e,r=this;return g(this,(function(o){switch(o.label){case 0:return b.debug("Creating new MQTT client",n),(e=new s.Client(t,n)).onMessageArrived=function(e){var t=e.destinationName,n=e.payloadString;r._onMessage(t,n)},e.onConnectionLost=function(e){var t=e.errorCode,o=v(e,["errorCode"]);r.onDisconnect(d({clientId:n,errorCode:t},o))},[4,new Promise((function(t,n){e.connect({useSSL:r.isSSLEnabled,mqttVersion:3,onSuccess:function(){return t(e)},onFailure:n})}))];case 1:return o.sent(),[2,e]}}))}))},t.prototype.connect=function(e,t){return void 0===t&&(t={}),y(this,void 0,void 0,(function(){var n=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.clientsQueue.get(e,(function(e){return n.newClient(d(d({},t),{clientId:e}))}))];case 1:return[2,r.sent()]}}))}))},t.prototype.disconnect=function(e){return y(this,void 0,void 0,(function(){var t;return g(this,(function(n){switch(n.label){case 0:return[4,this.clientsQueue.get(e,(function(){return null}))];case 1:return(t=n.sent())&&t.isConnected()&&t.disconnect(),this.clientsQueue.remove(e),[2]}}))}))},t.prototype.publish=function(e,t){return y(this,void 0,void 0,(function(){var n,r,o,i;return g(this,(function(s){switch(s.label){case 0:return n=[].concat(e),r=JSON.stringify(t),[4,this.endpoint];case 1:return o=s.sent(),[4,this.connect(this.clientId,{url:o})];case 2:return i=s.sent(),b.debug("Publishing to topic(s)",n.join(","),r),n.forEach((function(e){return i.send(e,r)})),[2]}}))}))},t.prototype._onMessage=function(e,t){try{var n=[];this._topicObservers.forEach((function(t,r){_(r,e)&&n.push(t)}));var r=JSON.parse(t);"object"===h(r)&&(r[A]=e),n.forEach((function(e){e.forEach((function(e){return e.next(r)}))}))}catch(e){b.warn("Error handling message",e,t)}},t.prototype.subscribe=function(e,t){var n=this;void 0===t&&(t={});var r=[].concat(e);return b.debug("Subscribing to topic(s)",r.join(",")),new o((function(e){var o;r.forEach((function(t){var r=n._topicObservers.get(t);r||(r=new Set,n._topicObservers.set(t,r)),r.add(e)}));var i=t.clientId,s=void 0===i?n.clientId:i,a=n._clientIdObservers.get(s);return a||(a=new Set),a.add(e),n._clientIdObservers.set(s,a),y(n,void 0,void 0,(function(){var n,i,a,c;return g(this,(function(u){switch(u.label){case 0:return void 0!==(n=t.url)?[3,2]:[4,this.endpoint];case 1:return a=u.sent(),[3,3];case 2:a=n,u.label=3;case 3:i=a,u.label=4;case 4:return u.trys.push([4,6,,7]),[4,this.connect(s,{url:i})];case 5:return o=u.sent(),r.forEach((function(e){o.subscribe(e)})),[3,7];case 6:return c=u.sent(),e.error(c),[3,7];case 7:return[2]}}))})),function(){return b.debug("Unsubscribing from topic(s)",r.join(",")),o&&(n._clientIdObservers.get(s).delete(e),0===n._clientIdObservers.get(s).size&&(n.disconnect(s),n._clientIdObservers.delete(s)),r.forEach((function(t){var r=n._topicObservers.get(t)||new Set;r.delete(e),0===r.size&&(n._topicObservers.delete(t),o.isConnected()&&o.unsubscribe(t))}))),null}}))},t}(f),T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},C=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},R=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},M=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},N=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(M(arguments[t]));return e},P=new i.ConsoleLogger("AWSAppSyncProvider"),k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._topicClient=new Map,t._topicAlias=new Map,t}return T(t,e),Object.defineProperty(t.prototype,"endpoint",{get:function(){throw new Error("Not supported")},enumerable:!0,configurable:!0}),t.prototype.getProviderName=function(){return"AWSAppSyncProvider"},t.prototype.publish=function(e,t,n){return I(this,void 0,void 0,(function(){return C(this,(function(e){throw new Error("Operation not supported")}))}))},t.prototype._cleanUp=function(e){var t=this;Array.from(this._topicClient.entries()).filter((function(t){return M(t,2)[1].clientId===e})).map((function(e){return M(e,1)[0]})).forEach((function(e){return t._cleanUpForTopic(e)}))},t.prototype._cleanUpForTopic=function(e){this._topicClient.delete(e),this._topicAlias.delete(e)},t.prototype.onDisconnect=function(e){var t=this,n=e.clientId,r=e.errorCode,o=R(e,["clientId","errorCode"]);0!==r&&(Array.from(this._topicClient.entries()).filter((function(e){return M(e,2)[1].clientId===n})).map((function(e){return M(e,1)[0]})).forEach((function(e){t._topicObservers.has(e)&&(t._topicObservers.get(e).forEach((function(e){e.closed||e.error(o)})),t._topicObservers.delete(e))})),this._cleanUp(n))},t.prototype.disconnect=function(t){return I(this,void 0,void 0,(function(){return C(this,(function(n){switch(n.label){case 0:return[4,this.clientsQueue.get(t,(function(){return null}))];case 1:return n.sent(),[4,e.prototype.disconnect.call(this,t)];case 2:return n.sent(),this._cleanUp(t),[2]}}))}))},t.prototype.subscribe=function(e,t){var n=this;void 0===t&&(t={});var r=new o((function(r){var o=[].concat(e);return P.debug("Subscribing to topic(s)",o.join(",")),I(n,void 0,void 0,(function(){var e,n,i,s,a,c=this;return C(this,(function(u){switch(u.label){case 0:return o.forEach((function(e){c._topicObservers.has(e)||c._topicObservers.set(e,new Set),c._topicObservers.get(e).add(r)})),e=t.mqttConnections,n=void 0===e?[]:e,i=t.newSubscriptions,s=Object.entries(i).map((function(e){var t=M(e,2),n=t[0];return[t[1].topic,n]})),this._topicAlias=new Map(N(Array.from(this._topicAlias.entries()),s)),a=Object.entries(o.reduce((function(e,t){var r=n.find((function(e){return e.topics.indexOf(t)>-1}));if(r){var o=r.client,i=r.url;e[o]||(e[o]={url:i,topics:new Set}),e[o].topics.add(t)}return e}),{})),[4,Promise.all(a.map((function(e){var t=M(e,2),n=t[0],o=t[1],i=o.url,s=o.topics;return I(c,void 0,void 0,(function(){var e,t,o=this;return C(this,(function(a){switch(a.label){case 0:e=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.connect(n,{clientId:n,url:i})];case 2:return e=a.sent(),[3,4];case 3:return t=a.sent(),r.error({message:"Failed to connect",error:t}),r.complete(),[2,void 0];case 4:return s.forEach((function(t){e.isConnected()&&(e.subscribe(t),o._topicClient.set(t,e))})),[2,e]}}))}))})))];case 1:return u.sent(),[2]}}))})),function(){P.debug("Unsubscribing from topic(s)",o.join(",")),o.forEach((function(e){var t=n._topicClient.get(e);t&&t.isConnected()&&(t.unsubscribe(e),n._topicClient.delete(e),Array.from(n._topicClient.values()).some((function(e){return e===t}))||n.disconnect(t.clientId)),n._topicObservers.delete(e)}))}}));return o.from(r).map((function(e){var t=n.getTopicForValue(e),r=n._topicAlias.get(t);return e.data=Object.entries(e.data).reduce((function(e,t){var n=M(t,2),o=n[0],i=n[1];return e[r||o]=i,e}),{}),e}))},t}(O),x=n(1),U=n(9),L=n(4),D=n(10),q=n.n(D),j=n(11),B=n.n(j),V=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(){return(G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},F=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Y=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Q=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},K=new i.Logger("AWSAppSyncRealTimeProvider"),J="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default",z=[400,401,403];!function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.GQL_DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error"}(m||(m={})),function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"}(w||(w={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"}(E||(E={}));var W,H={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.socketStatus=E.CLOSED,t.keepAliveTimeout=3e5,t.subscriptionObserverMap=new Map,t.promiseArray=[],t}return V(t,e),t.prototype.getProviderName=function(){return"AWSAppSyncRealTimeProvider"},t.prototype.newClient=function(){throw new Error("Not used here")},t.prototype.publish=function(e,t,n){return F(this,void 0,void 0,(function(){return Y(this,(function(e){throw new Error("Operation not supported")}))}))},t.prototype.subscribe=function(e,t){var n=this,r=t.appSyncGraphqlEndpoint;return new o((function(e){if(r){var o=Object(a.v4)();return n._startSubscriptionWithAWSAppSyncRealTime({options:t,observer:e,subscriptionId:o}),function(){return F(n,void 0,void 0,(function(){var e,t;return Y(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,this._waitForSubscriptionToBeConnected(o)];case 1:if(n.sent(),!(e=(this.subscriptionObserverMap.get(o)||{}).subscriptionState))return[2];if(e!==w.CONNECTED)throw new Error("Subscription never connected");return this._sendUnsubscriptionMessage(o),[3,4];case 2:return t=n.sent(),K.debug("Error while unsubscribing "+t),[3,4];case 3:return this._removeSubscriptionObserver(o),[7];case 4:return[2]}}))}))}}e.error({errors:[G({},new x.GraphQLError("Subscribe only available for AWS AppSync endpoint"))]}),e.complete()}))},Object.defineProperty(t.prototype,"isSSLEnabled",{get:function(){return!this.options.aws_appsync_dangerously_connect_to_http_endpoint_for_testing},enumerable:!0,configurable:!0}),t.prototype._startSubscriptionWithAWSAppSyncRealTime=function(e){var t=e.options,n=e.observer,r=e.subscriptionId;return F(this,void 0,void 0,(function(){var e,o,s,a,c,u,f,h,l,p,d,y,g,v,b,_,E,S,A,O,T,I,C,R,M,N,P=this;return Y(this,(function(k){switch(k.label){case 0:return e=t.appSyncGraphqlEndpoint,o=t.authenticationType,s=t.query,a=t.variables,c=t.apiKey,u=t.region,f=t.graphql_headers,h=void 0===f?function(){return{}}:f,l=t.additionalHeaders,p=void 0===l?{}:l,d=w.PENDING,y={query:s,variables:a},this.subscriptionObserverMap.set(r,{observer:n,query:s,variables:a,subscriptionState:d,startAckTimeoutId:null}),g=JSON.stringify(y),b=[{}],[4,this._awsRealTimeHeaderBasedAuth({apiKey:c,appSyncGraphqlEndpoint:e,authenticationType:o,payload:g,canonicalUri:"",region:u})];case 1:return _=[G.apply(void 0,b.concat([k.sent()]))],[4,h()];case 2:v=G.apply(void 0,[G.apply(void 0,[G.apply(void 0,_.concat([k.sent()])),p]),(N={},N[i.USER_AGENT_HEADER]=i.Constants.userAgent,N)]),E={id:r,payload:{data:g,extensions:{authorization:G({},v)}},type:m.GQL_START},S=JSON.stringify(E),k.label=3;case 3:return k.trys.push([3,5,,6]),[4,this._initializeWebSocketConnection({apiKey:c,appSyncGraphqlEndpoint:e,authenticationType:o,region:u})];case 4:return k.sent(),[3,6];case 5:return A=k.sent(),K.debug({err:A}),O=A.message,T=void 0===O?"":O,n.error({errors:[G({},new x.GraphQLError("Connection failed: "+T))]}),n.complete(),"function"==typeof(I=(this.subscriptionObserverMap.get(r)||{}).subscriptionFailedCallback)&&I(),[2];case 6:return C=this.subscriptionObserverMap.get(r),R=C.subscriptionFailedCallback,M=C.subscriptionReadyCallback,this.subscriptionObserverMap.set(r,{observer:n,subscriptionState:d,variables:a,query:s,subscriptionReadyCallback:M,subscriptionFailedCallback:R,startAckTimeoutId:setTimeout((function(){P._timeoutStartSubscriptionAck.call(P,r)}),15e3)}),this.awsRealTimeSocket.send(S),[2]}}))}))},t.prototype._waitForSubscriptionToBeConnected=function(e){return F(this,void 0,void 0,(function(){var t=this;return Y(this,(function(n){return this.subscriptionObserverMap.get(e).subscriptionState===w.PENDING?[2,new Promise((function(n,r){var o=t.subscriptionObserverMap.get(e),i=o.observer,s=o.subscriptionState,a=o.variables,c=o.query;t.subscriptionObserverMap.set(e,{observer:i,subscriptionState:s,variables:a,query:c,subscriptionReadyCallback:n,subscriptionFailedCallback:r})}))]:[2]}))}))},t.prototype._sendUnsubscriptionMessage=function(e){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===E.READY){var t={id:e,type:m.GQL_STOP},n=JSON.stringify(t);this.awsRealTimeSocket.send(n)}}catch(e){K.debug({err:e})}},t.prototype._removeSubscriptionObserver=function(e){this.subscriptionObserverMap.delete(e),setTimeout(this._closeSocketIfRequired.bind(this),1e3)},t.prototype._closeSocketIfRequired=function(){if(!(this.subscriptionObserverMap.size>0))if(this.awsRealTimeSocket)if(this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{K.debug("closing WebSocket..."),clearTimeout(this.keepAliveTimeoutId);var e=this.awsRealTimeSocket;e.onclose=void 0,e.onerror=void 0,e.close(1e3),this.awsRealTimeSocket=null,this.socketStatus=E.CLOSED}else this.socketStatus=E.CLOSED},t.prototype._handleIncomingSubscriptionMessage=function(e){K.debug("subscription message from AWS AppSync RealTime: "+e.data);var t=JSON.parse(e.data),n=t.id,r=void 0===n?"":n,o=t.payload,s=t.type,a=this.subscriptionObserverMap.get(r)||{},c=a.observer,u=void 0===c?null:c,f=a.query,h=void 0===f?"":f,l=a.variables,p=void 0===l?{}:l,d=a.startAckTimeoutId,y=a.subscriptionReadyCallback,g=a.subscriptionFailedCallback;if(K.debug({id:r,observer:u,query:h,variables:p}),s===m.GQL_DATA&&o&&o.data)u?u.next(o):K.debug("observer not found for id: "+r);else if(s!==m.GQL_START_ACK){if(s===m.GQL_CONNECTION_KEEP_ALIVE)return clearTimeout(this.keepAliveTimeoutId),void(this.keepAliveTimeoutId=setTimeout(this._errorDisconnect.bind(this,W.TIMEOUT_DISCONNECT),this.keepAliveTimeout));if(s===m.GQL_ERROR){v=w.FAILED;this.subscriptionObserverMap.set(r,{observer:u,query:h,variables:p,startAckTimeoutId:d,subscriptionReadyCallback:y,subscriptionFailedCallback:g,subscriptionState:v}),u.error({errors:[G({},new x.GraphQLError("Connection failed: "+JSON.stringify(o)))]}),clearTimeout(d),u.complete(),"function"==typeof g&&g()}}else{K.debug("subscription ready for "+JSON.stringify({query:h,variables:p})),"function"==typeof y&&y(),clearTimeout(d),function(e,t,n){i.Hub.dispatch("api",{event:e,data:t,message:n},"PubSub",J)}(W.SUBSCRIPTION_ACK,{query:h,variables:p},"Connection established for subscription");var v=w.CONNECTED;this.subscriptionObserverMap.set(r,{observer:u,query:h,variables:p,startAckTimeoutId:null,subscriptionState:v,subscriptionReadyCallback:y,subscriptionFailedCallback:g})}},t.prototype._errorDisconnect=function(e){K.debug("Disconnect error: "+e),this.subscriptionObserverMap.forEach((function(t){var n=t.observer;n.closed||n.error({errors:[G({},new x.GraphQLError(e))]})})),this.subscriptionObserverMap.clear(),this.awsRealTimeSocket&&this.awsRealTimeSocket.close(),this.socketStatus=E.CLOSED},t.prototype._timeoutStartSubscriptionAck=function(e){var t=this.subscriptionObserverMap.get(e)||{},n=t.observer,r=t.query,o=t.variables;n&&(this.subscriptionObserverMap.set(e,{observer:n,query:r,variables:o,subscriptionState:w.FAILED}),n&&!n.closed&&(n.error({errors:[G({},new x.GraphQLError("Subscription timeout "+JSON.stringify({query:r,variables:o})))]}),n.complete()),K.debug("timeoutStartSubscription",JSON.stringify({query:r,variables:o})))},t.prototype._initializeWebSocketConnection=function(e){var t=this,n=e.appSyncGraphqlEndpoint,r=e.authenticationType,o=e.apiKey,i=e.region;if(this.socketStatus!==E.READY)return new Promise((function(e,s){return F(t,void 0,void 0,(function(){var t,a,c,u,f,h,l,p,d,y;return Y(this,(function(g){switch(g.label){case 0:if(this.promiseArray.push({res:e,rej:s}),this.socketStatus!==E.CLOSED)return[3,5];g.label=1;case 1:return g.trys.push([1,4,,5]),this.socketStatus=E.CONNECTING,t=this.isSSLEnabled?"wss://":"ws://",a=n.replace("https://",t).replace("http://",t).replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta"),c="{}",h=(f=JSON).stringify,[4,this._awsRealTimeHeaderBasedAuth({authenticationType:r,payload:c,canonicalUri:"/connect",apiKey:o,appSyncGraphqlEndpoint:n,region:i})];case 2:return u=h.apply(f,[g.sent()]),l=L.Buffer.from(u).toString("base64"),p=L.Buffer.from(c).toString("base64"),d=a+"?header="+l+"&payload="+p,[4,this._initializeRetryableHandshake({awsRealTimeUrl:d})];case 3:return g.sent(),this.promiseArray.forEach((function(e){var t=e.res;K.debug("Notifying connection successful"),t()})),this.socketStatus=E.READY,this.promiseArray=[],[3,5];case 4:throw y=g.sent(),this.promiseArray.forEach((function(e){return(0,e.rej)(y)})),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=null,this.socketStatus=E.CLOSED,y;case 5:return[2]}}))}))}))},t.prototype._initializeRetryableHandshake=function(e){var t=e.awsRealTimeUrl;return F(this,void 0,void 0,(function(){return Y(this,(function(e){switch(e.label){case 0:return K.debug("Initializaling retryable Handshake"),[4,Object(i.jitteredExponentialRetry)(this._initializeHandshake.bind(this),[{awsRealTimeUrl:t}],5e3)];case 1:return e.sent(),[2]}}))}))},t.prototype._initializeHandshake=function(e){var t=e.awsRealTimeUrl;return F(this,void 0,void 0,(function(){var e,n,r,o=this;return Y(this,(function(s){switch(s.label){case 0:K.debug("Initializing handshake "+t),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,new Promise((function(e,n){var r=new WebSocket(t,"graphql-ws");r.onerror=function(){K.debug("WebSocket connection error")},r.onclose=function(){n(new Error("Connection handshake error"))},r.onopen=function(){return o.awsRealTimeSocket=r,e()}}))];case 2:return s.sent(),[4,new Promise((function(e,t){var n=!1;o.awsRealTimeSocket.onerror=function(e){K.debug("WebSocket error "+JSON.stringify(e))},o.awsRealTimeSocket.onclose=function(e){K.debug("WebSocket closed "+e.reason),t(new Error(JSON.stringify(e)))},o.awsRealTimeSocket.onmessage=function(r){K.debug("subscription message from AWS AppSyncRealTime: "+r.data+" ");var i=JSON.parse(r.data),s=i.type,a=i.payload,c=(void 0===a?{}:a).connectionTimeoutMs,u=void 0===c?3e5:c;if(s===m.GQL_CONNECTION_ACK)return n=!0,o.keepAliveTimeout=u,o.awsRealTimeSocket.onmessage=o._handleIncomingSubscriptionMessage.bind(o),o.awsRealTimeSocket.onerror=function(e){K.debug(e),o._errorDisconnect(W.CONNECTION_CLOSED)},void e("Cool, connected to AWS AppSyncRealTime");if(s===m.GQL_CONNECTION_ERROR){var f=i.payload,h=(void 0===f?{}:f).errors,l=Q(void 0===h?[]:h,1)[0],p=void 0===l?{}:l,d=p.errorType,y=void 0===d?"":d,g=p.errorCode;t({errorType:y,errorCode:void 0===g?0:g})}};var r={type:m.GQL_CONNECTION_INIT};o.awsRealTimeSocket.send(JSON.stringify(r)),setTimeout(function(){n||t(new Error("Connection timeout: ack from AWSRealTime was not received on 15000 ms"))}.bind(o),15e3)}))];case 3:return s.sent(),[3,5];case 4:throw e=s.sent(),n=e.errorType,r=e.errorCode,z.includes(r)?new i.NonRetryableError(n):n?new Error(n):e;case 5:return[2]}}))}))},t.prototype._awsRealTimeHeaderBasedAuth=function(e){var t=e.authenticationType,n=e.payload,r=e.canonicalUri,o=e.appSyncGraphqlEndpoint,i=e.apiKey,s=e.region;return F(this,void 0,void 0,(function(){var e,a,c;return Y(this,(function(u){switch(u.label){case 0:return e={API_KEY:this._awsRealTimeApiKeyHeader.bind(this),AWS_IAM:this._awsRealTimeIAMHeader.bind(this),OPENID_CONNECT:this._awsRealTimeOPENIDHeader.bind(this),AMAZON_COGNITO_USER_POOLS:this._awsRealTimeCUPHeader.bind(this)},"function"!=typeof(a=e[t])?(K.debug("Authentication type "+t+" not supported"),[2,""]):(c=U.parse(o).host,[4,a({payload:n,canonicalUri:r,appSyncGraphqlEndpoint:o,apiKey:i,region:s,host:c})]);case 1:return[2,u.sent()]}}))}))},t.prototype._awsRealTimeCUPHeader=function(e){var t=e.host;return F(this,void 0,void 0,(function(){return Y(this,(function(e){switch(e.label){case 0:return[4,B.a.currentSession()];case 1:return[2,{Authorization:e.sent().getAccessToken().getJwtToken(),host:t}]}}))}))},t.prototype._awsRealTimeOPENIDHeader=function(e){var t=e.host;return F(this,void 0,void 0,(function(){var e;return Y(this,(function(n){switch(n.label){case 0:return[4,q.a.getItem("federatedInfo")];case 1:if(!(e=n.sent())||!e.token)throw new Error("No federated jwt");return[2,{Authorization:e.token,host:t}]}}))}))},t.prototype._awsRealTimeApiKeyHeader=function(e){var t=e.apiKey,n=e.host;return F(this,void 0,void 0,(function(){var e,r;return Y(this,(function(o){return e=new Date,r=e.toISOString().replace(/[:\-]|\.\d{3}/g,""),[2,{host:n,"x-amz-date":r,"x-api-key":t}]}))}))},t.prototype._awsRealTimeIAMHeader=function(e){var t=e.payload,n=e.canonicalUri,r=e.appSyncGraphqlEndpoint,o=e.region;return F(this,void 0,void 0,(function(){var e,s,a;return Y(this,(function(c){switch(c.label){case 0:return e={region:o,service:"appsync"},[4,this._ensureCredentials()];case 1:if(!c.sent())throw new Error("No credentials");return[4,i.Credentials.get().then((function(e){return{secret_key:e.secretAccessKey,access_key:e.accessKeyId,session_token:e.sessionToken}}))];case 2:return s=c.sent(),a={url:""+r+n,data:t,method:"POST",headers:G({},H)},[2,i.Signer.sign(a,s,e).headers]}}))}))},t.prototype._ensureCredentials=function(){return i.Credentials.get().then((function(e){if(!e)return!1;var t=i.Credentials.shear(e);return K.debug("set credentials for AWSAppSyncRealTimeProvider",t),!0})).catch((function(e){return K.warn("ensure credentials error",e),!1}))},t}(f),X=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Z=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ee=new i.ConsoleLogger("PubSub"),te=new(function(){function e(e){this._options=e,ee.debug("PubSub Options",this._options),this._pluggables=[],this.subscribe=this.subscribe.bind(this),i.Amplify.register(this)}return Object.defineProperty(e.prototype,"awsAppSyncProvider",{get:function(){return this._awsAppSyncProvider||(this._awsAppSyncProvider=new k(this._options)),this._awsAppSyncProvider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"awsAppSyncRealTimeProvider",{get:function(){return this._awsAppSyncRealTimeProvider||(this._awsAppSyncRealTimeProvider=new $(this._options)),this._awsAppSyncRealTimeProvider},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"PubSub"},e.prototype.configure=function(e){var t=this,n=e?e.PubSub||e:{};return ee.debug("configure PubSub",{opt:n}),this._options=Object.assign({},this._options,n),this._pluggables.map((function(e){return e.configure(t._options)})),this._options},e.prototype.addPluggable=function(e){return X(this,void 0,void 0,(function(){return Z(this,(function(t){return e&&"PubSub"===e.getCategory()?(this._pluggables.push(e),[2,e.configure(this._options)]):[2]}))}))},e.prototype.getProviderByName=function(e){return e===i.INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER?this.awsAppSyncProvider:e===i.INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER?this.awsAppSyncRealTimeProvider:this._pluggables.find((function(t){return t.getProviderName()===e}))},e.prototype.getProviders=function(e){void 0===e&&(e={});var t=e.provider;if(!t)return this._pluggables;var n=this.getProviderByName(t);if(!n)throw new Error("Could not find provider named "+t);return[n]},e.prototype.publish=function(e,t,n){return X(this,void 0,void 0,(function(){return Z(this,(function(r){return[2,Promise.all(this.getProviders(n).map((function(r){return r.publish(e,t,n)})))]}))}))},e.prototype.subscribe=function(e,t){ee.debug("subscribe options",t);var n=this.getProviders(t);return new o((function(r){var o=n.map((function(n){return{provider:n,observable:n.subscribe(e,t)}})).map((function(e){var t=e.provider;return e.observable.subscribe({start:console.error,next:function(e){return r.next({provider:t,value:e})},error:function(e){return r.error({provider:t,error:e})}})}));return function(){return o.forEach((function(e){return e.unsubscribe()}))}}))},e}())(null),ne=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},oe=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),Object.defineProperty(t.prototype,"region",{get:function(){return this.options.aws_pubsub_region},enumerable:!0,configurable:!0}),t.prototype.getProviderName=function(){return"AWSIoTProvider"},Object.defineProperty(t.prototype,"endpoint",{get:function(){return re(this,void 0,void 0,(function(){var e,t,n,r,o,s;return oe(this,(function(a){switch(a.label){case 0:return e=this.options.aws_pubsub_endpoint,t={service:"iotdevicegateway",region:this.region},[4,i.Credentials.get()];case 1:return n=a.sent(),r=n.accessKeyId,o=n.secretAccessKey,s=n.sessionToken,[2,i.Signer.signUrl(e,{access_key:r,secret_key:o,session_token:s},t)]}}))}))},enumerable:!0,configurable:!0}),t}(O);!function(e){e.CONNECTION_CLOSED="Connection closed",e.TIMEOUT_DISCONNECT="Timeout disconnect",e.SUBSCRIPTION_ACK="Subscription ack"}(W||(W={}));t.default=te}])}));
+var r=n(21),o=n(22),i=n(23);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=l(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(t,n),o=(e=a(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):l(e,t);if("Buffer"===t.type&&i(t.data))return l(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(f(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function l(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function d(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return j(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return O(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){var i,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var f=-1;for(i=n;i<a;i++)if(u(e,i)===u(t,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===c)return f*s}else-1!==f&&(i-=i-f),f=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var h=!0,l=0;l<c;l++)if(u(e,i+l)!==u(t,l)){h=!1;break}if(h)return i}return-1}function _(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function m(e,t,n,r){return F(j(t,e.length-n),e,n,r)}function w(e,t,n,r){return F(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return w(e,t,n,r)}function S(e,t,n,r){return F(V(t),e,n,r)}function A(e,t,n,r){return F(function(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function O(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],f=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h<=n)switch(h){case 1:u<128&&(f=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(f=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,h=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),o+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return f(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):y.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(i,s),u=this.slice(r,o),f=e.slice(t,n),h=0;h<a;++h)if(u[h]!==f[h]){i=u[h],s=f[h];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return m(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return E(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function C(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=B(e[i]);return o}function N(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function k(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function x(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function U(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,i){return i||U(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,i){return i||U(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):x(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):x(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=c.isBuffer(e)?e:j(new c(e,r).toString()),a=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var q=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function V(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(3))},function(e,t){e.exports=n},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){e.exports=n(12).Observable},function(e,t,n){(function(t){var n;n=function(){return function(e){var t,n=e.localStorage||(t={},{setItem:function(e,n){t[e]=n},getItem:function(e){return t[e]},removeItem:function(e){delete t[e]}}),r=1,o=2,i=3,s=4,a=5,c=6,u=7,f=8,h=9,l=10,p=11,d=12,y=13,g=14,v=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n)){var r="Unknown property, "+n+". Valid properties are:";for(var o in t)t.hasOwnProperty(o)&&(r=r+" "+o);throw new Error(r)}if(typeof e[n]!==t[n])throw new Error(w(_.INVALID_TYPE,[typeof e[n],n]))}},b=function(e,t){return function(){return e.apply(t,arguments)}},_={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},m={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},w=function(e,t){var n=e.text;if(t)for(var r,o,i=0;i<t.length;i++)if(r="{"+i+"}",(o=n.indexOf(r))>0){var s=n.substring(0,o),a=n.substring(o+r.length);n=s+t[i]+a}return n},E=[0,6,77,81,73,115,100,112,3],S=[0,4,77,81,84,84,4],A=function(e,t){for(var n in this.type=e,t)t.hasOwnProperty(n)&&(this[n]=t[n])};function O(e,t){var n,r=t,f=e[t],l=f>>4,d=f&=15;t+=1;var y=0,g=1;do{if(t==e.length)return[null,r];y+=(127&(n=e[t++]))*g,g*=128}while(0!=(128&n));var v=t+y;if(v>e.length)return[null,r];var b=new A(l);switch(l){case o:1&e[t++]&&(b.sessionPresent=!0),b.returnCode=e[t++];break;case i:var _=d>>1&3,m=R(e,t),w=M(e,t+=2,m);t+=m,_>0&&(b.messageIdentifier=R(e,t),t+=2);var E=new U(e.subarray(t,v));1==(1&d)&&(E.retained=!0),8==(8&d)&&(E.duplicate=!0),E.qos=_,E.destinationName=w,b.payloadMessage=E;break;case s:case a:case c:case u:case p:b.messageIdentifier=R(e,t);break;case h:b.messageIdentifier=R(e,t),t+=2,b.returnCode=e.subarray(t,v)}return[b,v]}function T(e,t,n){return t[n++]=e>>8,t[n++]=e%256,n}function I(e,t,n,r){return N(e,n,r=T(t,n,r)),r+t}function R(e,t){return 256*e[t]+e[t+1]}function C(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r>2047?(55296<=r&&r<=56319&&(n++,t++),t+=3):r>127?t+=2:t++}return t}function N(e,t,n){for(var r=n,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(55296<=i&&i<=56319){var s=e.charCodeAt(++o);if(isNaN(s))throw new Error(w(_.MALFORMED_UNICODE,[i,s]));i=s-56320+(i-55296<<10)+65536}i<=127?t[r++]=i:i<=2047?(t[r++]=i>>6&31|192,t[r++]=63&i|128):i<=65535?(t[r++]=i>>12&15|224,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>18&7|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t}function M(e,t,n){for(var r,o="",i=t;i<t+n;){var s=e[i++];if(s<128)r=s;else{var a=e[i++]-128;if(a<0)throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),""]));if(s<224)r=64*(s-192)+a;else{var c=e[i++]-128;if(c<0)throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),c.toString(16)]));if(s<240)r=4096*(s-224)+64*a+c;else{var u=e[i++]-128;if(u<0)throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),c.toString(16),u.toString(16)]));if(!(s<248))throw new Error(w(_.MALFORMED_UTF,[s.toString(16),a.toString(16),c.toString(16),u.toString(16)]));r=262144*(s-240)+4096*a+64*c+u}}}r>65535&&(r-=65536,o+=String.fromCharCode(55296+(r>>10)),r=56320+(1023&r)),o+=String.fromCharCode(r)}return o}A.prototype.encode=function(){var e,t=(15&this.type)<<4,n=0,o=[],s=0;switch(void 0!==this.messageIdentifier&&(n+=2),this.type){case r:switch(this.mqttVersion){case 3:n+=E.length+3;break;case 4:n+=S.length+3}n+=C(this.clientId)+2,void 0!==this.willMessage&&(n+=C(this.willMessage.destinationName)+2,(e=this.willMessage.payloadBytes)instanceof Uint8Array||(e=new Uint8Array(u)),n+=e.byteLength+2),void 0!==this.userName&&(n+=C(this.userName)+2),void 0!==this.password&&(n+=C(this.password)+2);break;case f:t|=2;for(var a=0;a<this.topics.length;a++)o[a]=C(this.topics[a]),n+=o[a]+2;n+=this.requestedQos.length;break;case l:for(t|=2,a=0;a<this.topics.length;a++)o[a]=C(this.topics[a]),n+=o[a]+2;break;case c:t|=2;break;case i:this.payloadMessage.duplicate&&(t|=8),t=t|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(t|=1),n+=(s=C(this.payloadMessage.destinationName))+2;var u=this.payloadMessage.payloadBytes;n+=u.byteLength,u instanceof ArrayBuffer?u=new Uint8Array(u):u instanceof Uint8Array||(u=new Uint8Array(u.buffer))}var h=function(e){var t=new Array(1),n=0;do{var r=e%128;(e>>=7)>0&&(r|=128),t[n++]=r}while(e>0&&n<4);return t}(n),p=h.length+1,d=new ArrayBuffer(n+p),y=new Uint8Array(d);if(y[0]=t,y.set(h,1),this.type==i)p=I(this.payloadMessage.destinationName,s,y,p);else if(this.type==r){switch(this.mqttVersion){case 3:y.set(E,p),p+=E.length;break;case 4:y.set(S,p),p+=S.length}var g=0;this.cleanSession&&(g=2),void 0!==this.willMessage&&(g|=4,g|=this.willMessage.qos<<3,this.willMessage.retained&&(g|=32)),void 0!==this.userName&&(g|=128),void 0!==this.password&&(g|=64),y[p++]=g,p=T(this.keepAliveInterval,y,p)}switch(void 0!==this.messageIdentifier&&(p=T(this.messageIdentifier,y,p)),this.type){case r:p=I(this.clientId,C(this.clientId),y,p),void 0!==this.willMessage&&(p=I(this.willMessage.destinationName,C(this.willMessage.destinationName),y,p),p=T(e.byteLength,y,p),y.set(e,p),p+=e.byteLength),void 0!==this.userName&&(p=I(this.userName,C(this.userName),y,p)),void 0!==this.password&&(p=I(this.password,C(this.password),y,p));break;case i:y.set(u,p);break;case f:for(a=0;a<this.topics.length;a++)p=I(this.topics[a],o[a],y,p),y[p++]=this.requestedQos[a];break;case l:for(a=0;a<this.topics.length;a++)p=I(this.topics[a],o[a],y,p)}return d};var P=function(e,t){this._client=e,this._keepAliveInterval=1e3*t,this.isReset=!1;var n=new A(d).encode(),r=function(e){return function(){return o.apply(e)}},o=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(n),this.timeout=setTimeout(r(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(_.PING_TIMEOUT.code,w(_.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(r(this),this._keepAliveInterval))},this.cancel=function(){clearTimeout(this.timeout)}},k=function(e,t,n,r){t||(t=30),this.timeout=setTimeout(function(e,t,n){return function(){return e.apply(t,n)}}(n,e,r),1e3*t),this.cancel=function(){clearTimeout(this.timeout)}},x=function(t,r,o,i,s){if(!("WebSocket"in e)||null===e.WebSocket)throw new Error(w(_.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in e)||null===e.ArrayBuffer)throw new Error(w(_.UNSUPPORTED,["ArrayBuffer"]));for(var a in this._trace("Paho.Client",t,r,o,i,s),this.host=r,this.port=o,this.path=i,this.uri=t,this.clientId=s,this._wsuri=null,this._localKey=r+":"+o+("/mqtt"!=i?":"+i:"")+":"+s+":",this._msg_queue=[],this._buffered_msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0,n)0!==a.indexOf("Sent:"+this._localKey)&&0!==a.indexOf("Received:"+this._localKey)||this.restore(a)};x.prototype.host=null,x.prototype.port=null,x.prototype.path=null,x.prototype.uri=null,x.prototype.clientId=null,x.prototype.socket=null,x.prototype.connected=!1,x.prototype.maxMessageIdentifier=65536,x.prototype.connectOptions=null,x.prototype.hostIndex=null,x.prototype.onConnected=null,x.prototype.onConnectionLost=null,x.prototype.onMessageDelivered=null,x.prototype.onMessageArrived=null,x.prototype.traceFunction=null,x.prototype._msg_queue=null,x.prototype._buffered_msg_queue=null,x.prototype._connectTimeout=null,x.prototype.sendPinger=null,x.prototype.receivePinger=null,x.prototype._reconnectInterval=1,x.prototype._reconnecting=!1,x.prototype._reconnectTimeout=null,x.prototype.disconnectedPublishing=!1,x.prototype.disconnectedBufferSize=5e3,x.prototype.receiveBuffer=null,x.prototype._traceBuffer=null,x.prototype._MAX_TRACE_ENTRIES=100,x.prototype.connect=function(e){var t=this._traceMask(e,"password");if(this._trace("Client.connect",t,this.socket,this.connected),this.connected)throw new Error(w(_.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(w(_.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),this.connectOptions=e,this._reconnectInterval=1,this._reconnecting=!1,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},x.prototype.subscribe=function(e,t){if(this._trace("Client.subscribe",e,t),!this.connected)throw new Error(w(_.INVALID_STATE,["not connected"]));var n=new A(f);n.topics=e.constructor===Array?e:[e],void 0===t.qos&&(t.qos=0),n.requestedQos=[];for(var r=0;r<n.topics.length;r++)n.requestedQos[r]=t.qos;t.onSuccess&&(n.onSuccess=function(e){t.onSuccess({invocationContext:t.invocationContext,grantedQos:e})}),t.onFailure&&(n.onFailure=function(e){t.onFailure({invocationContext:t.invocationContext,errorCode:e,errorMessage:w(e)})}),t.timeout&&(n.timeOut=new k(this,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:_.SUBSCRIBE_TIMEOUT.code,errorMessage:w(_.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},x.prototype.unsubscribe=function(e,t){if(this._trace("Client.unsubscribe",e,t),!this.connected)throw new Error(w(_.INVALID_STATE,["not connected"]));var n=new A(l);n.topics=e.constructor===Array?e:[e],t.onSuccess&&(n.callback=function(){t.onSuccess({invocationContext:t.invocationContext})}),t.timeout&&(n.timeOut=new k(this,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:_.UNSUBSCRIBE_TIMEOUT.code,errorMessage:w(_.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},x.prototype.send=function(e){this._trace("Client.send",e);var t=new A(i);if(t.payloadMessage=e,this.connected)e.qos>0?this._requires_ack(t):this.onMessageDelivered&&(this._notify_msg_sent[t]=this.onMessageDelivered(t.payloadMessage)),this._schedule_message(t);else{if(!this._reconnecting||!this.disconnectedPublishing)throw new Error(w(_.INVALID_STATE,["not connected"]));if(Object.keys(this._sentMessages).length+this._buffered_msg_queue.length>this.disconnectedBufferSize)throw new Error(w(_.BUFFER_FULL,[this.disconnectedBufferSize]));e.qos>0?this._requires_ack(t):(t.sequence=++this._sequence,this._buffered_msg_queue.unshift(t))}},x.prototype.disconnect=function(){if(this._trace("Client.disconnect"),this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),!this.socket)throw new Error(w(_.INVALID_STATE,["not connecting or connected"]));var e=new A(g);this._notify_msg_sent[e]=b(this._disconnected,this),this._schedule_message(e)},x.prototype.getTraceLog=function(){if(null!==this._traceBuffer){for(var e in this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length),this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},x.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"@VERSION@-@BUILDLEVEL@")},x.prototype.stopTrace=function(){delete this._traceBuffer},x.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this._wsuri=e,this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(e,["mqttv3.1"]):this.socket=new WebSocket(e,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=b(this._on_socket_open,this),this.socket.onmessage=b(this._on_socket_message,this),this.socket.onerror=b(this._on_socket_error,this),this.socket.onclose=b(this._on_socket_close,this),this.sendPinger=new P(this,this.connectOptions.keepAliveInterval),this.receivePinger=new P(this,this.connectOptions.keepAliveInterval),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._connectTimeout=new k(this,this.connectOptions.timeout,this._disconnected,[_.CONNECT_TIMEOUT.code,w(_.CONNECT_TIMEOUT)])},x.prototype._schedule_message=function(e){this._msg_queue.unshift(e),this.connected&&this._process_queue()},x.prototype.store=function(e,t){var r={type:t.type,messageIdentifier:t.messageIdentifier,version:1};switch(t.type){case i:t.pubRecReceived&&(r.pubRecReceived=!0),r.payloadMessage={};for(var o="",s=t.payloadMessage.payloadBytes,a=0;a<s.length;a++)s[a]<=15?o=o+"0"+s[a].toString(16):o+=s[a].toString(16);r.payloadMessage.payloadHex=o,r.payloadMessage.qos=t.payloadMessage.qos,r.payloadMessage.destinationName=t.payloadMessage.destinationName,t.payloadMessage.duplicate&&(r.payloadMessage.duplicate=!0),t.payloadMessage.retained&&(r.payloadMessage.retained=!0),0===e.indexOf("Sent:")&&(void 0===t.sequence&&(t.sequence=++this._sequence),r.sequence=t.sequence);break;default:throw Error(w(_.INVALID_STORED_DATA,[e+this._localKey+t.messageIdentifier,r]))}n.setItem(e+this._localKey+t.messageIdentifier,JSON.stringify(r))},x.prototype.restore=function(e){var t=n.getItem(e),r=JSON.parse(t),o=new A(r.type,r);switch(r.type){case i:for(var s=r.payloadMessage.payloadHex,a=new ArrayBuffer(s.length/2),c=new Uint8Array(a),u=0;s.length>=2;){var f=parseInt(s.substring(0,2),16);s=s.substring(2,s.length),c[u++]=f}var h=new U(c);h.qos=r.payloadMessage.qos,h.destinationName=r.payloadMessage.destinationName,r.payloadMessage.duplicate&&(h.duplicate=!0),r.payloadMessage.retained&&(h.retained=!0),o.payloadMessage=h;break;default:throw Error(w(_.INVALID_STORED_DATA,[e,t]))}0===e.indexOf("Sent:"+this._localKey)?(o.payloadMessage.duplicate=!0,this._sentMessages[o.messageIdentifier]=o):0===e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[o.messageIdentifier]=o)},x.prototype._process_queue=function(){for(var e=null;e=this._msg_queue.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},x.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,e.type===i&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},x.prototype._on_socket_open=function(){var e=new A(r,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},x.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data);for(var t=this._deframeMessages(e.data),n=0;n<t.length;n+=1)this._handleMessage(t[n])},x.prototype._deframeMessages=function(e){var t=new Uint8Array(e),n=[];if(this.receiveBuffer){var r=new Uint8Array(this.receiveBuffer.length+t.length);r.set(this.receiveBuffer),r.set(t,this.receiveBuffer.length),t=r,delete this.receiveBuffer}try{for(var o=0;o<t.length;){var i=O(t,o),s=i[0];if(o=i[1],null===s)break;n.push(s)}o<t.length&&(this.receiveBuffer=t.subarray(o))}catch(e){var a="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(_.INTERNAL_ERROR.code,w(_.INTERNAL_ERROR,[e.message,a]))}return n},x.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case o:if(this._connectTimeout.cancel(),this._reconnectTimeout&&this._reconnectTimeout.cancel(),this.connectOptions.cleanSession){for(var t in this._sentMessages){var r=this._sentMessages[t];n.removeItem("Sent:"+this._localKey+r.messageIdentifier)}for(var t in this._sentMessages={},this._receivedMessages){var f=this._receivedMessages[t];n.removeItem("Received:"+this._localKey+f.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(_.CONNACK_RETURNCODE.code,w(_.CONNACK_RETURNCODE,[e.returnCode,m[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var l=[];for(var d in this._sentMessages)this._sentMessages.hasOwnProperty(d)&&l.push(this._sentMessages[d]);if(this._buffered_msg_queue.length>0)for(var v=null;v=this._buffered_msg_queue.pop();)l.push(v),this.onMessageDelivered&&(this._notify_msg_sent[v]=this.onMessageDelivered(v.payloadMessage));l=l.sort((function(e,t){return e.sequence-t.sequence}));for(var b=0,E=l.length;b<E;b++)if((r=l[b]).type==i&&r.pubRecReceived){var S=new A(c,{messageIdentifier:r.messageIdentifier});this._schedule_message(S)}else this._schedule_message(r);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});var O=!1;this._reconnecting&&(O=!0,this._reconnectInterval=1,this._reconnecting=!1),this._connected(O,this._wsuri),this._process_queue();break;case i:this._receivePublish(e);break;case s:(r=this._sentMessages[e.messageIdentifier])&&(delete this._sentMessages[e.messageIdentifier],n.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(r.payloadMessage));break;case a:(r=this._sentMessages[e.messageIdentifier])&&(r.pubRecReceived=!0,S=new A(c,{messageIdentifier:e.messageIdentifier}),this.store("Sent:",r),this._schedule_message(S));break;case c:f=this._receivedMessages[e.messageIdentifier],n.removeItem("Received:"+this._localKey+e.messageIdentifier),f&&(this._receiveMessage(f),delete this._receivedMessages[e.messageIdentifier]);var T=new A(u,{messageIdentifier:e.messageIdentifier});this._schedule_message(T);break;case u:r=this._sentMessages[e.messageIdentifier],delete this._sentMessages[e.messageIdentifier],n.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(r.payloadMessage);break;case h:(r=this._sentMessages[e.messageIdentifier])&&(r.timeOut&&r.timeOut.cancel(),128===e.returnCode[0]?r.onFailure&&r.onFailure(e.returnCode):r.onSuccess&&r.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case p:(r=this._sentMessages[e.messageIdentifier])&&(r.timeOut&&r.timeOut.cancel(),r.callback&&r.callback(),delete this._sentMessages[e.messageIdentifier]);break;case y:this.sendPinger.reset();break;case g:this._disconnected(_.INVALID_MQTT_MESSAGE_TYPE.code,w(_.INVALID_MQTT_MESSAGE_TYPE,[e.type]));break;default:this._disconnected(_.INVALID_MQTT_MESSAGE_TYPE.code,w(_.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(e){var I="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(_.INTERNAL_ERROR.code,w(_.INTERNAL_ERROR,[e.message,I]))}},x.prototype._on_socket_error=function(e){this._reconnecting||this._disconnected(_.SOCKET_ERROR.code,w(_.SOCKET_ERROR,[e.data]))},x.prototype._on_socket_close=function(){this._reconnecting||this._disconnected(_.SOCKET_CLOSE.code,w(_.SOCKET_CLOSE))},x.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),this.sendPinger.reset()},x.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new A(s,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var n=new A(a,{messageIdentifier:e.messageIdentifier});this._schedule_message(n);break;default:throw Error("Invaild qos="+e.payloadMessage.qos)}},x.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},x.prototype._connected=function(e,t){this.onConnected&&this.onConnected(e,t)},x.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=2*this._reconnectInterval),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))},x.prototype._disconnected=function(e,t){if(this._trace("Client._disconnected",e,t),void 0!==e&&this._reconnecting)this._reconnectTimeout=new k(this,this._reconnectInterval,this._reconnect);else if(this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._msg_queue=[],this._buffered_msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else if(void 0===e&&(e=_.OK.code,t=w(_.OK)),this.connected){if(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t,reconnect:this.connectOptions.reconnect,uri:this._wsuri}),e!==_.OK.code&&this.connectOptions.reconnect)return this._reconnectInterval=1,void this._reconnect()}else 4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t})},x.prototype._trace=function(){if(this.traceFunction){var e=Array.prototype.slice.call(arguments);for(var t in e)void 0!==e[t]&&e.splice(t,1,JSON.stringify(e[t]));var n=e.join("");this.traceFunction({severity:"Debug",message:n})}if(null!==this._traceBuffer){t=0;for(var r=arguments.length;t<r;t++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===t||void 0===arguments[t]?this._traceBuffer.push(arguments[t]):this._traceBuffer.push("  "+JSON.stringify(arguments[t]))}},x.prototype._traceMask=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=r==t?"******":e[r]);return n};var U=function(e){var t,n;if(!("string"==typeof e||e instanceof ArrayBuffer||ArrayBuffer.isView(e)&&!(e instanceof DataView)))throw w(_.INVALID_ARGUMENT,[e,"newPayload"]);t=e;var r=0,o=!1,i=!1;Object.defineProperties(this,{payloadString:{enumerable:!0,get:function(){return"string"==typeof t?t:M(t,0,t.length)}},payloadBytes:{enumerable:!0,get:function(){if("string"==typeof t){var e=new ArrayBuffer(C(t)),n=new Uint8Array(e);return N(t,n,0),n}return t}},destinationName:{enumerable:!0,get:function(){return n},set:function(e){if("string"!=typeof e)throw new Error(w(_.INVALID_ARGUMENT,[e,"newDestinationName"]));n=e}},qos:{enumerable:!0,get:function(){return r},set:function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);r=e}},retained:{enumerable:!0,get:function(){return o},set:function(e){if("boolean"!=typeof e)throw new Error(w(_.INVALID_ARGUMENT,[e,"newRetained"]));o=e}},topic:{enumerable:!0,get:function(){return n},set:function(e){n=e}},duplicate:{enumerable:!0,get:function(){return i},set:function(e){i=e}}})};return{Client:function(e,t,n,r){var o;if("string"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"host"]));if(2==arguments.length){r=t;var i=(o=e).match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!i)throw new Error(w(_.INVALID_ARGUMENT,[e,"host"]));e=i[4]||i[2],t=parseInt(i[7]),n=i[8]}else{if(3==arguments.length&&(r=n,n="/mqtt"),"number"!=typeof t||t<0)throw new Error(w(_.INVALID_TYPE,[typeof t,"port"]));if("string"!=typeof n)throw new Error(w(_.INVALID_TYPE,[typeof n,"path"]));var s=-1!==e.indexOf(":")&&"["!==e.slice(0,1)&&"]"!==e.slice(-1);o="ws://"+(s?"["+e+"]":e)+":"+t+n}for(var a=0,c=0;c<r.length;c++){var u=r.charCodeAt(c);55296<=u&&u<=56319&&c++,a++}if("string"!=typeof r||a>65535)throw new Error(w(_.INVALID_ARGUMENT,[r,"clientId"]));var f=new x(o,e,t,n,r);Object.defineProperties(this,{host:{get:function(){return e},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},port:{get:function(){return t},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},path:{get:function(){return n},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},uri:{get:function(){return o},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},clientId:{get:function(){return f.clientId},set:function(){throw new Error(w(_.UNSUPPORTED_OPERATION))}},onConnected:{get:function(){return f.onConnected},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onConnected"]));f.onConnected=e}},disconnectedPublishing:{get:function(){return f.disconnectedPublishing},set:function(e){f.disconnectedPublishing=e}},disconnectedBufferSize:{get:function(){return f.disconnectedBufferSize},set:function(e){f.disconnectedBufferSize=e}},onConnectionLost:{get:function(){return f.onConnectionLost},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onConnectionLost"]));f.onConnectionLost=e}},onMessageDelivered:{get:function(){return f.onMessageDelivered},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onMessageDelivered"]));f.onMessageDelivered=e}},onMessageArrived:{get:function(){return f.onMessageArrived},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onMessageArrived"]));f.onMessageArrived=e}},trace:{get:function(){return f.traceFunction},set:function(e){if("function"!=typeof e)throw new Error(w(_.INVALID_TYPE,[typeof e,"onTrace"]));f.traceFunction=e}}}),this.connect=function(e){if(v(e=e||{},{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(w(_.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0!==e.password&&void 0===e.userName)throw new Error(w(_.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof U))throw new Error(w(_.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload=null,void 0===e.willMessage.destinationName)throw new Error(w(_.INVALID_TYPE,[typeof e.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if(void 0===e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(w(_.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(w(_.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var t=!1,r=0;r<e.hosts.length;r++){if("string"!=typeof e.hosts[r])throw new Error(w(_.INVALID_TYPE,[typeof e.hosts[r],"connectOptions.hosts["+r+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[r])){if(0===r)t=!0;else if(!t)throw new Error(w(_.INVALID_ARGUMENT,[e.hosts[r],"connectOptions.hosts["+r+"]"]))}else if(t)throw new Error(w(_.INVALID_ARGUMENT,[e.hosts[r],"connectOptions.hosts["+r+"]"]))}if(t)e.uris=e.hosts;else{if(!e.ports)throw new Error(w(_.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(w(_.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!==e.ports.length)throw new Error(w(_.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));for(e.uris=[],r=0;r<e.hosts.length;r++){if("number"!=typeof e.ports[r]||e.ports[r]<0)throw new Error(w(_.INVALID_TYPE,[typeof e.ports[r],"connectOptions.ports["+r+"]"]));var i=e.hosts[r],s=e.ports[r],a=-1!==i.indexOf(":");o="ws://"+(a?"["+i+"]":i)+":"+s+n,e.uris.push(o)}}}f.connect(e)},this.subscribe=function(e,t){if("string"!=typeof e&&e.constructor!==Array)throw new Error("Invalid argument:"+e);if(v(t=t||{},{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(void 0!==t.qos&&0!==t.qos&&1!==t.qos&&2!==t.qos)throw new Error(w(_.INVALID_ARGUMENT,[t.qos,"subscribeOptions.qos"]));f.subscribe(e,t)},this.unsubscribe=function(e,t){if("string"!=typeof e&&e.constructor!==Array)throw new Error("Invalid argument:"+e);if(v(t=t||{},{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");f.unsubscribe(e,t)},this.send=function(e,t,n,r){var o;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof U)&&"string"!=typeof e)throw new Error("Invalid argument:"+typeof e);if(void 0===(o=e).destinationName)throw new Error(w(_.INVALID_ARGUMENT,[o.destinationName,"Message.destinationName"]));f.send(o)}else(o=new U(t)).destinationName=e,arguments.length>=3&&(o.qos=n),arguments.length>=4&&(o.retained=r),f.send(o)},this.publish=function(e,t,n,r){var o;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof U)&&"string"!=typeof e)throw new Error("Invalid argument:"+typeof e);if(void 0===(o=e).destinationName)throw new Error(w(_.INVALID_ARGUMENT,[o.destinationName,"Message.destinationName"]));f.send(o)}else(o=new U(t)).destinationName=e,arguments.length>=3&&(o.qos=n),arguments.length>=4&&(o.retained=r),f.send(o)},this.disconnect=function(){f.disconnect()},this.getTraceLog=function(){return f.getTraceLog()},this.startTrace=function(){f.startTrace()},this.stopTrace=function(){f.stopTrace()},this.isConnected=function(){return f.connected}},Message:U}}(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},e.exports=n()}).call(this,n(3))},function(e,t,n){"use strict";var r=n(15),o=n(17);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=_,t.resolve=function(e,t){return _(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?_(e,!1,!0).resolveObject(t):t},t.format=function(e){o.isString(e)&&(e=_(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),f=["'"].concat(u),h=["%","/","?",";","#"].concat(f),l=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=n(18);function _(e,t,n){if(e&&o.isObject(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}i.prototype.parse=function(e,t,n){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),a=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var _=e=u.join(a);if(_=_.trim(),!n&&1===e.split("#").length){var m=c.exec(_);if(m)return this.path=_,this.href=_,this.pathname=m[1],m[2]?(this.search=m[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=s.exec(_);if(w){var E=(w=w[0]).toLowerCase();this.protocol=E,_=_.substr(w.length)}if(n||w||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===_.substr(0,2);!S||w&&g[w]||(_=_.substr(2),this.slashes=!0)}if(!g[w]&&(S||w&&!v[w])){for(var A,O,T=-1,I=0;I<l.length;I++){-1!==(R=_.indexOf(l[I]))&&(-1===T||R<T)&&(T=R)}-1!==(O=-1===T?_.lastIndexOf("@"):_.lastIndexOf("@",T))&&(A=_.slice(0,O),_=_.slice(O+1),this.auth=decodeURIComponent(A)),T=-1;for(I=0;I<h.length;I++){var R;-1!==(R=_.indexOf(h[I]))&&(-1===T||R<T)&&(T=R)}-1===T&&(T=_.length),this.host=_.slice(0,T),_=_.slice(T),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var N=this.hostname.split(/\./),M=(I=0,N.length);I<M;I++){var P=N[I];if(P&&!P.match(p)){for(var k="",x=0,U=P.length;x<U;x++)P.charCodeAt(x)>127?k+="x":k+=P[x];if(!k.match(p)){var L=N.slice(0,I),D=N.slice(I+1),q=P.match(d);q&&(L.push(q[1]),D.unshift(q[2])),D.length&&(_="/"+D.join(".")+_),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=r.toASCII(this.hostname));var B=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+B,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!y[E])for(I=0,M=f.length;I<M;I++){var V=f[I];if(-1!==_.indexOf(V)){var F=encodeURIComponent(V);F===V&&(F=escape(V)),_=_.split(V).join(F)}}var G=_.indexOf("#");-1!==G&&(this.hash=_.substr(G),_=_.slice(0,G));var Y=_.indexOf("?");if(-1!==Y?(this.search=_.substr(Y),this.query=_.substr(Y+1),t&&(this.query=b.parse(this.query)),_=_.slice(0,Y)):t&&(this.search="",this.query={}),_&&(this.pathname=_),v[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var Q=this.search||"";this.path=B+Q}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,s="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(s=b.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+r},i.prototype.resolve=function(e){return this.resolveObject(_(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(o.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var n=new i,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),u=0;u<c.length;u++){var f=c[u];"protocol"!==f&&(n[f]=e[f])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var h=Object.keys(e),l=0;l<h.length;l++){var p=h[l];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var y=n.pathname||"",b=n.search||"";n.path=y+b}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var _=n.pathname&&"/"===n.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=m||_||n.host&&e.pathname,E=w,S=n.pathname&&n.pathname.split("/")||[],A=(d=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),w=w&&(""===d[0]||""===S[0])),m)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,S=d;else if(d.length)S||(S=[]),S.pop(),S=S.concat(d),n.search=e.search,n.query=e.query;else if(!o.isNullOrUndefined(e.search)){if(A)n.hostname=n.host=S.shift(),(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift());return n.search=e.search,n.query=e.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var O=S.slice(-1)[0],T=(n.host||e.host||S.length>1)&&("."===O||".."===O)||""===O,I=0,R=S.length;R>=0;R--)"."===(O=S[R])?S.splice(R,1):".."===O?(S.splice(R,1),I++):I&&(S.splice(R,1),I--);if(!w&&!E)for(;I--;I)S.unshift("..");!w||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),T&&"/"!==S.join("/").substr(-1)&&S.push("");var C,N=""===S[0]||S[0]&&"/"===S[0].charAt(0);A&&(n.hostname=n.host=N?"":S.length?S.shift():"",(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift()));return(w=w||n.host&&S.length)&&!N&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t){e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var s=function(){return"function"==typeof Symbol},a=function(e){return s()&&Boolean(Symbol[e])},c=function(e){return a(e)?Symbol[e]:"@@"+e};s()&&!a("observable")&&(Symbol.observable=Symbol("observable"));var u=c("iterator"),f=c("observable"),h=c("species");function l(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function p(e){var t=e.constructor;return void 0!==t&&null===(t=t[h])&&(t=void 0),void 0!==t?t:S}function d(e){return e instanceof S}function y(e){y.log?y.log(e):setTimeout((function(){throw e}))}function g(e){Promise.resolve().then((function(){try{e()}catch(e){y(e)}}))}function v(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var n=l(t,"unsubscribe");n&&n.call(t)}}catch(e){y(e)}}function b(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function _(e,t,n){e._state="running";var r=e._observer;try{var o=l(r,t);switch(t){case"next":o&&o.call(r,n);break;case"error":if(b(e),!o)throw n;o.call(r,n);break;case"complete":b(e),o&&o.call(r)}}catch(e){y(e)}"closed"===e._state?v(e):"running"===e._state&&(e._state="ready")}function m(e,t,n){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void g((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var n=0;n<t.length&&(_(e,t[n].type,t[n].value),"closed"!==e._state);++n);}}(e)}))):void _(e,t,n);e._queue.push({type:t,value:n})}}var w=function(){function e(t,n){r(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var o=new E(this);try{this._cleanup=n.call(void 0,o)}catch(e){o.error(e)}"initializing"===this._state&&(this._state="ready")}return i(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(b(this),v(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),E=function(){function e(t){r(this,e),this._subscription=t}return i(e,[{key:"next",value:function(e){m(this._subscription,"next",e)}},{key:"error",value:function(e){m(this._subscription,"error",e)}},{key:"complete",value:function(){m(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),S=function(){function e(t){if(r(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return i(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new w(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise((function(n,r){if("function"==typeof e)var o=t.subscribe({next:function(t){try{e(t,i)}catch(e){r(e),o.unsubscribe()}},error:r,complete:n});else r(new TypeError(e+" is not a function"));function i(){o.unsubscribe(),n()}}))}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))((function(n){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))((function(n){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=p(this),r=arguments.length>1,o=!1,i=arguments[1],s=i;return new n((function(n){return t.subscribe({next:function(t){var i=!o;if(o=!0,!i||r)try{s=e(s,t)}catch(e){return n.error(e)}else s=t},error:function(e){n.error(e)},complete:function(){if(!o&&!r)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(s),n.complete()}})}))}},{key:"concat",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=p(this);return new o((function(t){var r,i=0;return function e(s){r=s.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){i===n.length?(r=void 0,t.complete()):e(o.from(n[i++]))}})}(e),function(){r&&(r.unsubscribe(),r=void 0)}}))}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=p(this);return new n((function(r){var o=[],i=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return r.error(e)}var i=n.from(t).subscribe({next:function(e){r.next(e)},error:function(e){r.error(e)},complete:function(){var e=o.indexOf(i);e>=0&&o.splice(e,1),s()}});o.push(i)},error:function(e){r.error(e)},complete:function(){s()}});function s(){i.closed&&0===o.length&&r.complete()}return function(){o.forEach((function(e){return e.unsubscribe()})),i.unsubscribe()}}))}},{key:f,value:function(){return this}}],[{key:"from",value:function(t){var n="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var r=l(t,f);if(r){var o=r.call(t);if(Object(o)!==o)throw new TypeError(o+" is not an object");return d(o)&&o.constructor===n?o:new n((function(e){return o.subscribe(e)}))}if(a("iterator")&&(r=l(t,u)))return new n((function(e){g((function(){if(!e.closed){var n=!0,o=!1,i=void 0;try{for(var s,a=r.call(t)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var c=s.value;if(e.next(c),e.closed)return}}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}e.complete()}}))}));if(Array.isArray(t))return new n((function(e){g((function(){if(!e.closed){for(var n=0;n<t.length;++n)if(e.next(t[n]),e.closed)return;e.complete()}}))}));throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o="function"==typeof this?this:e;return new o((function(e){g((function(){if(!e.closed){for(var t=0;t<n.length;++t)if(e.next(n[t]),e.closed)return;e.complete()}}))}))}},{key:h,get:function(){return this}}]),e}();t.Observable=S,s()&&Object.defineProperty(S,Symbol("extensions"),{value:{symbol:f,hostReportError:y},configurable:!0})},function(e,t,n){var r,o,i=n(6),s=n(7),a=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,f=t||[],h=(e=e||{}).node||r,l=void 0!==e.clockseq?e.clockseq:o;if(null==h||null==l){var p=i();null==h&&(h=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==l&&(l=o=16383&(p[6]<<8|p[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:c+1,g=d-a+(y-c)/1e4;if(g<0&&void 0===e.clockseq&&(l=l+1&16383),(g<0||d>a)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=d,c=y,o=l;var v=(1e4*(268435455&(d+=122192928e5))+y)%4294967296;f[u++]=v>>>24&255,f[u++]=v>>>16&255,f[u++]=v>>>8&255,f[u++]=255&v;var b=d/4294967296*1e4&268435455;f[u++]=b>>>8&255,f[u++]=255&b,f[u++]=b>>>24&15|16,f[u++]=b>>>16&255,f[u++]=l>>>8|128,f[u++]=255&l;for(var _=0;_<6;++_)f[u+_]=h[_];return t||s(f)}},function(e,t,n){var r=n(6),o=n(7);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||o(s)}},function(e,t,n){(function(e,r){var o;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,c=2147483647,u=/^xn--/,f=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,d=String.fromCharCode;function y(e){throw new RangeError(l[e])}function g(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function v(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+g((e=e.replace(h,".")).split("."),t).join(".")}function b(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function _(e){return g(e,(function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=d(e)})).join("")}function m(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function w(e,t,n){var r=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;r+=36)e=p(e/35);return p(r+36*e/(e+38))}function E(e){var t,n,r,o,i,s,a,u,f,h,l,d=[],g=e.length,v=0,b=128,m=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&y("not-basic"),d.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<g;){for(i=v,s=1,a=36;o>=g&&y("invalid-input"),((u=(l=e.charCodeAt(o++))-48<10?l-22:l-65<26?l-65:l-97<26?l-97:36)>=36||u>p((c-v)/s))&&y("overflow"),v+=u*s,!(u<(f=a<=m?1:a>=m+26?26:a-m));a+=36)s>p(c/(h=36-f))&&y("overflow"),s*=h;m=w(v-i,t=d.length+1,0==i),p(v/t)>c-b&&y("overflow"),b+=p(v/t),v%=t,d.splice(v++,0,b)}return _(d)}function S(e){var t,n,r,o,i,s,a,u,f,h,l,g,v,_,E,S=[];for(g=(e=b(e)).length,t=128,n=0,i=72,s=0;s<g;++s)(l=e[s])<128&&S.push(d(l));for(r=o=S.length,o&&S.push("-");r<g;){for(a=c,s=0;s<g;++s)(l=e[s])>=t&&l<a&&(a=l);for(a-t>p((c-n)/(v=r+1))&&y("overflow"),n+=(a-t)*v,t=a,s=0;s<g;++s)if((l=e[s])<t&&++n>c&&y("overflow"),l==t){for(u=n,f=36;!(u<(h=f<=i?1:f>=i+26?26:f-i));f+=36)E=u-h,_=36-h,S.push(d(m(h+E%_,0))),u=p(E/_);S.push(d(m(u,0))),i=w(n,v,r==o),n=0,++r}++n,++t}return S.join("")}a={version:"1.4.1",ucs2:{decode:b,encode:_},decode:E,encode:S,toASCII:function(e){return v(e,(function(e){return f.test(e)?"xn--"+S(e):e}))},toUnicode:function(e){return v(e,(function(e){return u.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(o=function(){return a}.call(t,n,t,e))||(e.exports=o)}()}).call(this,n(16)(e),n(3))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(19),t.encode=t.stringify=n(20)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var f=0;f<u;++f){var h,l,p,d,y=e[f].replace(a,"%20"),g=y.indexOf(n);g>=0?(h=y.substr(0,g),l=y.substr(g+1)):(h=y,l=""),p=decodeURIComponent(h),d=decodeURIComponent(l),r(s,p)?o(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(s(e),(function(s){var a=encodeURIComponent(r(s))+n;return o(e[s])?i(e[s],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[s]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),s=r[0],a=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),f=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[f++]=t>>16&255,c[f++]=t>>8&255,c[f++]=255&t;2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[f++]=255&t);1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[f++]=t>>8&255,c[f++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(f(e,s,s+16383>a?a:s+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function f(e,t,n){for(var o,i,s=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){
+/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
+t.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,f=-7,h=n?o-1:0,l=n?-1:1,p=e[t+h];for(h+=l,i=p&(1<<-f)-1,p>>=-f,f+=a;f>0;i=256*i+e[t+h],h+=l,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=r;f>0;s=256*s+e[t+h],h+=l,f-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=u}return(p?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var s,a,c,u=8*i-o-1,f=(1<<u)-1,h=f>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?l/c:l*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=f?(a=0,s=f):s+h>=1?(a=(t*c-1)*Math.pow(2,o),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+p]=255&s,p+=d,s/=256,u-=8);e[n+p-d]|=128*y}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"AbstractPubSubProvider",(function(){return f})),n.d(t,"AWSAppSyncProvider",(function(){return k})),n.d(t,"AWSAppSyncRealTimeProvider",(function(){return H})),n.d(t,"AWSIoTProvider",(function(){return se})),n.d(t,"mqttTopicMatch",(function(){return _})),n.d(t,"MqttOverWSProvider",(function(){return O})),n.d(t,"PubSub",(function(){return te})),n.d(t,"CONTROL_MSG",(function(){return ne}));var r=n(8),o=n.n(r).a,i=n(0),s=n(9),a=n(2),c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=new i.ConsoleLogger("AbstractPubSubProvider"),f=function(){function e(e){void 0===e&&(e={}),this._config=e}return e.prototype.configure=function(e){return void 0===e&&(e={}),this._config=c(c({},e),this._config),u.debug("configure "+this.getProviderName(),this._config),this.options},e.prototype.getCategory=function(){return"PubSub"},Object.defineProperty(e.prototype,"options",{get:function(){return c({},this._config)},enumerable:!0,configurable:!0}),e}();function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l,p=(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},g=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},v=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},b=new i.ConsoleLogger("MqttOverWSProvider");function _(e,t){for(var n=e.split("/"),r=n.length,o=t.split("/"),i=0;i<r;++i){var s=n[i],a=o[i];if("#"===s)return o.length>=r;if("+"!==s&&s!==a)return!1}return r===o.length}var m,w,E,S=function(){function e(){this.promises=new Map}return e.prototype.get=function(e,t){return y(this,void 0,void 0,(function(){var n;return g(this,(function(r){return(n=this.promises.get(e))||(n=t(e),this.promises.set(e,n)),[2,n]}))}))},Object.defineProperty(e.prototype,"allClients",{get:function(){return Array.from(this.promises.keys())},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.promises.delete(e)},e}(),A="undefined"!=typeof Symbol?Symbol("topic"):"@@topic",O=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,d(d({},t),{clientId:t.clientId||Object(a.v4)()}))||this;return n._clientsQueue=new S,n._topicObservers=new Map,n._clientIdObservers=new Map,n}return p(t,e),Object.defineProperty(t.prototype,"clientId",{get:function(){return this.options.clientId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endpoint",{get:function(){return this.options.aws_pubsub_endpoint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientsQueue",{get:function(){return this._clientsQueue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSSLEnabled",{get:function(){return!this.options.aws_appsync_dangerously_connect_to_http_endpoint_for_testing},enumerable:!0,configurable:!0}),t.prototype.getTopicForValue=function(e){return"object"===h(e)&&e[A]},t.prototype.getProviderName=function(){return"MqttOverWSProvider"},t.prototype.onDisconnect=function(e){var t=this,n=e.clientId,r=e.errorCode,o=v(e,["clientId","errorCode"]);if(0!==r){b.warn(n,JSON.stringify(d({errorCode:r},o),null,2));var i=[],s=this._clientIdObservers.get(n);if(!s)return;s.forEach((function(e){e.error("Disconnected, error code: "+r),t._topicObservers.forEach((function(t,n){t.delete(e),0===t.size&&i.push(n)}))})),this._clientIdObservers.delete(n),i.forEach((function(e){t._topicObservers.delete(e)}))}},t.prototype.newClient=function(e){var t=e.url,n=e.clientId;return y(this,void 0,void 0,(function(){var e,r=this;return g(this,(function(o){switch(o.label){case 0:return b.debug("Creating new MQTT client",n),(e=new s.Client(t,n)).onMessageArrived=function(e){var t=e.destinationName,n=e.payloadString;r._onMessage(t,n)},e.onConnectionLost=function(e){var t=e.errorCode,o=v(e,["errorCode"]);r.onDisconnect(d({clientId:n,errorCode:t},o))},[4,new Promise((function(t,n){e.connect({useSSL:r.isSSLEnabled,mqttVersion:3,onSuccess:function(){return t(e)},onFailure:n})}))];case 1:return o.sent(),[2,e]}}))}))},t.prototype.connect=function(e,t){return void 0===t&&(t={}),y(this,void 0,void 0,(function(){var n=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.clientsQueue.get(e,(function(e){return n.newClient(d(d({},t),{clientId:e}))}))];case 1:return[2,r.sent()]}}))}))},t.prototype.disconnect=function(e){return y(this,void 0,void 0,(function(){var t;return g(this,(function(n){switch(n.label){case 0:return[4,this.clientsQueue.get(e,(function(){return null}))];case 1:return(t=n.sent())&&t.isConnected()&&t.disconnect(),this.clientsQueue.remove(e),[2]}}))}))},t.prototype.publish=function(e,t){return y(this,void 0,void 0,(function(){var n,r,o,i;return g(this,(function(s){switch(s.label){case 0:return n=[].concat(e),r=JSON.stringify(t),[4,this.endpoint];case 1:return o=s.sent(),[4,this.connect(this.clientId,{url:o})];case 2:return i=s.sent(),b.debug("Publishing to topic(s)",n.join(","),r),n.forEach((function(e){return i.send(e,r)})),[2]}}))}))},t.prototype._onMessage=function(e,t){try{var n=[];this._topicObservers.forEach((function(t,r){_(r,e)&&n.push(t)}));var r=JSON.parse(t);"object"===h(r)&&(r[A]=e),n.forEach((function(e){e.forEach((function(e){return e.next(r)}))}))}catch(e){b.warn("Error handling message",e,t)}},t.prototype.subscribe=function(e,t){var n=this;void 0===t&&(t={});var r=[].concat(e);return b.debug("Subscribing to topic(s)",r.join(",")),new o((function(e){var o;r.forEach((function(t){var r=n._topicObservers.get(t);r||(r=new Set,n._topicObservers.set(t,r)),r.add(e)}));var i=t.clientId,s=void 0===i?n.clientId:i,a=n._clientIdObservers.get(s);return a||(a=new Set),a.add(e),n._clientIdObservers.set(s,a),y(n,void 0,void 0,(function(){var n,i,a,c;return g(this,(function(u){switch(u.label){case 0:return void 0!==(n=t.url)?[3,2]:[4,this.endpoint];case 1:return a=u.sent(),[3,3];case 2:a=n,u.label=3;case 3:i=a,u.label=4;case 4:return u.trys.push([4,6,,7]),[4,this.connect(s,{url:i})];case 5:return o=u.sent(),r.forEach((function(e){o.subscribe(e)})),[3,7];case 6:return c=u.sent(),e.error(c),[3,7];case 7:return[2]}}))})),function(){return b.debug("Unsubscribing from topic(s)",r.join(",")),o&&(n._clientIdObservers.get(s).delete(e),0===n._clientIdObservers.get(s).size&&(n.disconnect(s),n._clientIdObservers.delete(s)),r.forEach((function(t){var r=n._topicObservers.get(t)||new Set;r.delete(e),0===r.size&&(n._topicObservers.delete(t),o.isConnected()&&o.unsubscribe(t))}))),null}}))},t}(f),T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},R=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},C=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},N=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},M=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(N(arguments[t]));return e},P=new i.ConsoleLogger("AWSAppSyncProvider"),k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._topicClient=new Map,t._topicAlias=new Map,t}return T(t,e),Object.defineProperty(t.prototype,"endpoint",{get:function(){throw new Error("Not supported")},enumerable:!0,configurable:!0}),t.prototype.getProviderName=function(){return"AWSAppSyncProvider"},t.prototype.publish=function(e,t,n){return I(this,void 0,void 0,(function(){return R(this,(function(e){throw new Error("Operation not supported")}))}))},t.prototype._cleanUp=function(e){var t=this;Array.from(this._topicClient.entries()).filter((function(t){return N(t,2)[1].clientId===e})).map((function(e){return N(e,1)[0]})).forEach((function(e){return t._cleanUpForTopic(e)}))},t.prototype._cleanUpForTopic=function(e){this._topicClient.delete(e),this._topicAlias.delete(e)},t.prototype.onDisconnect=function(e){var t=this,n=e.clientId,r=e.errorCode,o=C(e,["clientId","errorCode"]);0!==r&&(Array.from(this._topicClient.entries()).filter((function(e){return N(e,2)[1].clientId===n})).map((function(e){return N(e,1)[0]})).forEach((function(e){t._topicObservers.has(e)&&(t._topicObservers.get(e).forEach((function(e){e.closed||e.error(o)})),t._topicObservers.delete(e))})),this._cleanUp(n))},t.prototype.disconnect=function(t){return I(this,void 0,void 0,(function(){return R(this,(function(n){switch(n.label){case 0:return[4,this.clientsQueue.get(t,(function(){return null}))];case 1:return n.sent(),[4,e.prototype.disconnect.call(this,t)];case 2:return n.sent(),this._cleanUp(t),[2]}}))}))},t.prototype.subscribe=function(e,t){var n=this;void 0===t&&(t={});var r=new o((function(r){var o=[].concat(e);return P.debug("Subscribing to topic(s)",o.join(",")),I(n,void 0,void 0,(function(){var e,n,i,s,a,c=this;return R(this,(function(u){switch(u.label){case 0:return o.forEach((function(e){c._topicObservers.has(e)||c._topicObservers.set(e,new Set),c._topicObservers.get(e).add(r)})),e=t.mqttConnections,n=void 0===e?[]:e,i=t.newSubscriptions,s=Object.entries(i).map((function(e){var t=N(e,2),n=t[0];return[t[1].topic,n]})),this._topicAlias=new Map(M(Array.from(this._topicAlias.entries()),s)),a=Object.entries(o.reduce((function(e,t){var r=n.find((function(e){return e.topics.indexOf(t)>-1}));if(r){var o=r.client,i=r.url;e[o]||(e[o]={url:i,topics:new Set}),e[o].topics.add(t)}return e}),{})),[4,Promise.all(a.map((function(e){var t=N(e,2),n=t[0],o=t[1],i=o.url,s=o.topics;return I(c,void 0,void 0,(function(){var e,t,o=this;return R(this,(function(a){switch(a.label){case 0:e=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.connect(n,{clientId:n,url:i})];case 2:return e=a.sent(),[3,4];case 3:return t=a.sent(),r.error({message:"Failed to connect",error:t}),r.complete(),[2,void 0];case 4:return s.forEach((function(t){e.isConnected()&&(e.subscribe(t),o._topicClient.set(t,e))})),[2,e]}}))}))})))];case 1:return u.sent(),[2]}}))})),function(){P.debug("Unsubscribing from topic(s)",o.join(",")),o.forEach((function(e){var t=n._topicClient.get(e);t&&t.isConnected()&&(t.unsubscribe(e),n._topicClient.delete(e),Array.from(n._topicClient.values()).some((function(e){return e===t}))||n.disconnect(t.clientId)),n._topicObservers.delete(e)}))}}));return o.from(r).map((function(e){var t=n.getTopicForValue(e),r=n._topicAlias.get(t);return e.data=Object.entries(e.data).reduce((function(e,t){var n=N(t,2),o=n[0],i=n[1];return e[r||o]=i,e}),{}),e}))},t}(O),x=n(1),U=n(10),L=n(4),D=n(11),q=n.n(D),B=n(5),j=n.n(B),V=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(){return(F=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},G=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Y=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Q=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},K=new i.Logger("AWSAppSyncRealTimeProvider"),J="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default",z=[400,401,403];!function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.GQL_DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error"}(m||(m={})),function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"}(w||(w={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"}(E||(E={}));var W={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.socketStatus=E.CLOSED,t.keepAliveTimeout=3e5,t.subscriptionObserverMap=new Map,t.promiseArray=[],t}return V(t,e),t.prototype.getProviderName=function(){return"AWSAppSyncRealTimeProvider"},t.prototype.newClient=function(){throw new Error("Not used here")},t.prototype.publish=function(e,t,n){return G(this,void 0,void 0,(function(){return Y(this,(function(e){throw new Error("Operation not supported")}))}))},t.prototype.subscribe=function(e,t){var n=this,r=t.appSyncGraphqlEndpoint;return new o((function(e){if(r){var o=Object(a.v4)();return n._startSubscriptionWithAWSAppSyncRealTime({options:t,observer:e,subscriptionId:o}).catch((function(t){e.error({errors:[F({},new x.GraphQLError(ne.REALTIME_SUBSCRIPTION_INIT_ERROR+": "+t))]}),e.complete()})),function(){return G(n,void 0,void 0,(function(){var e,t;return Y(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,this._waitForSubscriptionToBeConnected(o)];case 1:if(n.sent(),!(e=(this.subscriptionObserverMap.get(o)||{}).subscriptionState))return[2];if(e!==w.CONNECTED)throw new Error("Subscription never connected");return this._sendUnsubscriptionMessage(o),[3,4];case 2:return t=n.sent(),K.debug("Error while unsubscribing "+t),[3,4];case 3:return this._removeSubscriptionObserver(o),[7];case 4:return[2]}}))}))}}e.error({errors:[F({},new x.GraphQLError("Subscribe only available for AWS AppSync endpoint"))]}),e.complete()}))},Object.defineProperty(t.prototype,"isSSLEnabled",{get:function(){return!this.options.aws_appsync_dangerously_connect_to_http_endpoint_for_testing},enumerable:!0,configurable:!0}),t.prototype._startSubscriptionWithAWSAppSyncRealTime=function(e){var t=e.options,n=e.observer,r=e.subscriptionId;return G(this,void 0,void 0,(function(){var e,o,s,a,c,u,f,h,l,p,d,y,g,v,b,_,E,S,A,O,T,I,R,C,N,M,P=this;return Y(this,(function(k){switch(k.label){case 0:return e=t.appSyncGraphqlEndpoint,o=t.authenticationType,s=t.query,a=t.variables,c=t.apiKey,u=t.region,f=t.graphql_headers,h=void 0===f?function(){return{}}:f,l=t.additionalHeaders,p=void 0===l?{}:l,d=w.PENDING,y={query:s,variables:a},this.subscriptionObserverMap.set(r,{observer:n,query:s,variables:a,subscriptionState:d,startAckTimeoutId:null}),g=JSON.stringify(y),b=[{}],[4,this._awsRealTimeHeaderBasedAuth({apiKey:c,appSyncGraphqlEndpoint:e,authenticationType:o,payload:g,canonicalUri:"",region:u})];case 1:return _=[F.apply(void 0,b.concat([k.sent()]))],[4,h()];case 2:v=F.apply(void 0,[F.apply(void 0,[F.apply(void 0,_.concat([k.sent()])),p]),(M={},M[i.USER_AGENT_HEADER]=i.Constants.userAgent,M)]),E={id:r,payload:{data:g,extensions:{authorization:F({},v)}},type:m.GQL_START},S=JSON.stringify(E),k.label=3;case 3:return k.trys.push([3,5,,6]),[4,this._initializeWebSocketConnection({apiKey:c,appSyncGraphqlEndpoint:e,authenticationType:o,region:u})];case 4:return k.sent(),[3,6];case 5:return A=k.sent(),K.debug({err:A}),O=A.message,T=void 0===O?"":O,n.error({errors:[F({},new x.GraphQLError(ne.CONNECTION_FAILED+": "+T))]}),n.complete(),"function"==typeof(I=(this.subscriptionObserverMap.get(r)||{}).subscriptionFailedCallback)&&I(),[2];case 6:return R=this.subscriptionObserverMap.get(r),C=R.subscriptionFailedCallback,N=R.subscriptionReadyCallback,this.subscriptionObserverMap.set(r,{observer:n,subscriptionState:d,variables:a,query:s,subscriptionReadyCallback:N,subscriptionFailedCallback:C,startAckTimeoutId:setTimeout((function(){P._timeoutStartSubscriptionAck.call(P,r)}),15e3)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(S),[2]}}))}))},t.prototype._waitForSubscriptionToBeConnected=function(e){return G(this,void 0,void 0,(function(){var t=this;return Y(this,(function(n){return this.subscriptionObserverMap.get(e).subscriptionState===w.PENDING?[2,new Promise((function(n,r){var o=t.subscriptionObserverMap.get(e),i=o.observer,s=o.subscriptionState,a=o.variables,c=o.query;t.subscriptionObserverMap.set(e,{observer:i,subscriptionState:s,variables:a,query:c,subscriptionReadyCallback:n,subscriptionFailedCallback:r})}))]:[2]}))}))},t.prototype._sendUnsubscriptionMessage=function(e){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===E.READY){var t={id:e,type:m.GQL_STOP},n=JSON.stringify(t);this.awsRealTimeSocket.send(n)}}catch(e){K.debug({err:e})}},t.prototype._removeSubscriptionObserver=function(e){this.subscriptionObserverMap.delete(e),setTimeout(this._closeSocketIfRequired.bind(this),1e3)},t.prototype._closeSocketIfRequired=function(){if(!(this.subscriptionObserverMap.size>0))if(this.awsRealTimeSocket)if(this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{K.debug("closing WebSocket..."),clearTimeout(this.keepAliveTimeoutId);var e=this.awsRealTimeSocket;e.onclose=void 0,e.onerror=void 0,e.close(1e3),this.awsRealTimeSocket=null,this.socketStatus=E.CLOSED}else this.socketStatus=E.CLOSED},t.prototype._handleIncomingSubscriptionMessage=function(e){K.debug("subscription message from AWS AppSync RealTime: "+e.data);var t=JSON.parse(e.data),n=t.id,r=void 0===n?"":n,o=t.payload,s=t.type,a=this.subscriptionObserverMap.get(r)||{},c=a.observer,u=void 0===c?null:c,f=a.query,h=void 0===f?"":f,l=a.variables,p=void 0===l?{}:l,d=a.startAckTimeoutId,y=a.subscriptionReadyCallback,g=a.subscriptionFailedCallback;if(K.debug({id:r,observer:u,query:h,variables:p}),s===m.GQL_DATA&&o&&o.data)u?u.next(o):K.debug("observer not found for id: "+r);else if(s!==m.GQL_START_ACK){if(s===m.GQL_CONNECTION_KEEP_ALIVE)return clearTimeout(this.keepAliveTimeoutId),void(this.keepAliveTimeoutId=setTimeout(this._errorDisconnect.bind(this,ne.TIMEOUT_DISCONNECT),this.keepAliveTimeout));if(s===m.GQL_ERROR){v=w.FAILED;this.subscriptionObserverMap.set(r,{observer:u,query:h,variables:p,startAckTimeoutId:d,subscriptionReadyCallback:y,subscriptionFailedCallback:g,subscriptionState:v}),u.error({errors:[F({},new x.GraphQLError(ne.CONNECTION_FAILED+": "+JSON.stringify(o)))]}),clearTimeout(d),u.complete(),"function"==typeof g&&g()}}else{K.debug("subscription ready for "+JSON.stringify({query:h,variables:p})),"function"==typeof y&&y(),clearTimeout(d),function(e,t,n){i.Hub.dispatch("api",{event:e,data:t,message:n},"PubSub",J)}(ne.SUBSCRIPTION_ACK,{query:h,variables:p},"Connection established for subscription");var v=w.CONNECTED;this.subscriptionObserverMap.set(r,{observer:u,query:h,variables:p,startAckTimeoutId:null,subscriptionState:v,subscriptionReadyCallback:y,subscriptionFailedCallback:g})}},t.prototype._errorDisconnect=function(e){K.debug("Disconnect error: "+e),this.subscriptionObserverMap.forEach((function(t){var n=t.observer;n&&!n.closed&&n.error({errors:[F({},new x.GraphQLError(e))]})})),this.subscriptionObserverMap.clear(),this.awsRealTimeSocket&&this.awsRealTimeSocket.close(),this.socketStatus=E.CLOSED},t.prototype._timeoutStartSubscriptionAck=function(e){var t=this.subscriptionObserverMap.get(e)||{},n=t.observer,r=t.query,o=t.variables;n&&(this.subscriptionObserverMap.set(e,{observer:n,query:r,variables:o,subscriptionState:w.FAILED}),n&&!n.closed&&(n.error({errors:[F({},new x.GraphQLError("Subscription timeout "+JSON.stringify({query:r,variables:o})))]}),n.complete()),K.debug("timeoutStartSubscription",JSON.stringify({query:r,variables:o})))},t.prototype._initializeWebSocketConnection=function(e){var t=this,n=e.appSyncGraphqlEndpoint,r=e.authenticationType,o=e.apiKey,i=e.region;if(this.socketStatus!==E.READY)return new Promise((function(e,s){return G(t,void 0,void 0,(function(){var t,a,c,u,f,h,l,p,d,y;return Y(this,(function(g){switch(g.label){case 0:if(this.promiseArray.push({res:e,rej:s}),this.socketStatus!==E.CLOSED)return[3,5];g.label=1;case 1:return g.trys.push([1,4,,5]),this.socketStatus=E.CONNECTING,t=this.isSSLEnabled?"wss://":"ws://",a=n.replace("https://",t).replace("http://",t).replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta"),c="{}",h=(f=JSON).stringify,[4,this._awsRealTimeHeaderBasedAuth({authenticationType:r,payload:c,canonicalUri:"/connect",apiKey:o,appSyncGraphqlEndpoint:n,region:i})];case 2:return u=h.apply(f,[g.sent()]),l=L.Buffer.from(u).toString("base64"),p=L.Buffer.from(c).toString("base64"),d=a+"?header="+l+"&payload="+p,[4,this._initializeRetryableHandshake({awsRealTimeUrl:d})];case 3:return g.sent(),this.promiseArray.forEach((function(e){var t=e.res;K.debug("Notifying connection successful"),t()})),this.socketStatus=E.READY,this.promiseArray=[],[3,5];case 4:return y=g.sent(),this.promiseArray.forEach((function(e){return(0,e.rej)(y)})),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=null,this.socketStatus=E.CLOSED,[3,5];case 5:return[2]}}))}))}))},t.prototype._initializeRetryableHandshake=function(e){var t=e.awsRealTimeUrl;return G(this,void 0,void 0,(function(){return Y(this,(function(e){switch(e.label){case 0:return K.debug("Initializaling retryable Handshake"),[4,Object(i.jitteredExponentialRetry)(this._initializeHandshake.bind(this),[{awsRealTimeUrl:t}],5e3)];case 1:return e.sent(),[2]}}))}))},t.prototype._initializeHandshake=function(e){var t=e.awsRealTimeUrl;return G(this,void 0,void 0,(function(){var e,n,r,o=this;return Y(this,(function(s){switch(s.label){case 0:K.debug("Initializing handshake "+t),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,new Promise((function(e,n){var r=new WebSocket(t,"graphql-ws");r.onerror=function(){K.debug("WebSocket connection error")},r.onclose=function(){n(new Error("Connection handshake error"))},r.onopen=function(){return o.awsRealTimeSocket=r,e()}}))];case 2:return s.sent(),[4,new Promise((function(e,t){var n=!1;o.awsRealTimeSocket.onerror=function(e){K.debug("WebSocket error "+JSON.stringify(e))},o.awsRealTimeSocket.onclose=function(e){K.debug("WebSocket closed "+e.reason),t(new Error(JSON.stringify(e)))},o.awsRealTimeSocket.onmessage=function(r){K.debug("subscription message from AWS AppSyncRealTime: "+r.data+" ");var i=JSON.parse(r.data),s=i.type,a=i.payload,c=(void 0===a?{}:a).connectionTimeoutMs,u=void 0===c?3e5:c;if(s===m.GQL_CONNECTION_ACK)return n=!0,o.keepAliveTimeout=u,o.awsRealTimeSocket.onmessage=o._handleIncomingSubscriptionMessage.bind(o),o.awsRealTimeSocket.onerror=function(e){K.debug(e),o._errorDisconnect(ne.CONNECTION_CLOSED)},o.awsRealTimeSocket.onclose=function(e){K.debug("WebSocket closed "+e.reason),o._errorDisconnect(ne.CONNECTION_CLOSED)},void e("Cool, connected to AWS AppSyncRealTime");if(s===m.GQL_CONNECTION_ERROR){var f=i.payload,h=(void 0===f?{}:f).errors,l=Q(void 0===h?[]:h,1)[0],p=void 0===l?{}:l,d=p.errorType,y=void 0===d?"":d,g=p.errorCode;t({errorType:y,errorCode:void 0===g?0:g})}};var r={type:m.GQL_CONNECTION_INIT};o.awsRealTimeSocket.send(JSON.stringify(r)),setTimeout(function(){n||t(new Error("Connection timeout: ack from AWSRealTime was not received on 15000 ms"))}.bind(o),15e3)}))];case 3:return s.sent(),[3,5];case 4:throw e=s.sent(),n=e.errorType,r=e.errorCode,z.includes(r)?new i.NonRetryableError(n):n?new Error(n):e;case 5:return[2]}}))}))},t.prototype._awsRealTimeHeaderBasedAuth=function(e){var t=e.authenticationType,n=e.payload,r=e.canonicalUri,o=e.appSyncGraphqlEndpoint,i=e.apiKey,s=e.region;return G(this,void 0,void 0,(function(){var e,a,c;return Y(this,(function(u){switch(u.label){case 0:return e={API_KEY:this._awsRealTimeApiKeyHeader.bind(this),AWS_IAM:this._awsRealTimeIAMHeader.bind(this),OPENID_CONNECT:this._awsRealTimeOPENIDHeader.bind(this),AMAZON_COGNITO_USER_POOLS:this._awsRealTimeCUPHeader.bind(this)},"function"!=typeof(a=e[t])?(K.debug("Authentication type "+t+" not supported"),[2,""]):(c=U.parse(o).host,[4,a({payload:n,canonicalUri:r,appSyncGraphqlEndpoint:o,apiKey:i,region:s,host:c})]);case 1:return[2,u.sent()]}}))}))},t.prototype._awsRealTimeCUPHeader=function(e){var t=e.host;return G(this,void 0,void 0,(function(){return Y(this,(function(e){switch(e.label){case 0:return[4,j.a.currentSession()];case 1:return[2,{Authorization:e.sent().getAccessToken().getJwtToken(),host:t}]}}))}))},t.prototype._awsRealTimeOPENIDHeader=function(e){var t=e.host;return G(this,void 0,void 0,(function(){var e,n,r;return Y(this,(function(o){switch(o.label){case 0:return[4,q.a.getItem("federatedInfo")];case 1:return(n=o.sent())?(e=n.token,[3,4]):[3,2];case 2:return[4,j.a.currentAuthenticatedUser()];case 3:(r=o.sent())&&(e=r.token),o.label=4;case 4:if(!e)throw new Error("No federated jwt");return[2,{Authorization:e,host:t}]}}))}))},t.prototype._awsRealTimeApiKeyHeader=function(e){var t=e.apiKey,n=e.host;return G(this,void 0,void 0,(function(){var e,r;return Y(this,(function(o){return e=new Date,r=e.toISOString().replace(/[:\-]|\.\d{3}/g,""),[2,{host:n,"x-amz-date":r,"x-api-key":t}]}))}))},t.prototype._awsRealTimeIAMHeader=function(e){var t=e.payload,n=e.canonicalUri,r=e.appSyncGraphqlEndpoint,o=e.region;return G(this,void 0,void 0,(function(){var e,s,a;return Y(this,(function(c){switch(c.label){case 0:return e={region:o,service:"appsync"},[4,this._ensureCredentials()];case 1:if(!c.sent())throw new Error("No credentials");return[4,i.Credentials.get().then((function(e){return{secret_key:e.secretAccessKey,access_key:e.accessKeyId,session_token:e.sessionToken}}))];case 2:return s=c.sent(),a={url:""+r+n,data:t,method:"POST",headers:F({},W)},[2,i.Signer.sign(a,s,e).headers]}}))}))},t.prototype._ensureCredentials=function(){return i.Credentials.get().then((function(e){if(!e)return!1;var t=i.Credentials.shear(e);return K.debug("set credentials for AWSAppSyncRealTimeProvider",t),!0})).catch((function(e){return K.warn("ensure credentials error",e),!1}))},t}(f),$=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},X=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Z=Object(i.browserOrNode)().isNode,ee=new i.ConsoleLogger("PubSub"),te=new(function(){function e(e){this._options=e,ee.debug("PubSub Options",this._options),this._pluggables=[],this.subscribe=this.subscribe.bind(this)}return Object.defineProperty(e.prototype,"awsAppSyncProvider",{get:function(){return this._awsAppSyncProvider||(this._awsAppSyncProvider=new k(this._options)),this._awsAppSyncProvider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"awsAppSyncRealTimeProvider",{get:function(){return this._awsAppSyncRealTimeProvider||(this._awsAppSyncRealTimeProvider=new H(this._options)),this._awsAppSyncRealTimeProvider},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"PubSub"},e.prototype.configure=function(e){var t=this,n=e?e.PubSub||e:{};return ee.debug("configure PubSub",{opt:n}),this._options=Object.assign({},this._options,n),this._pluggables.map((function(e){return e.configure(t._options)})),this._options},e.prototype.addPluggable=function(e){return $(this,void 0,void 0,(function(){return X(this,(function(t){return e&&"PubSub"===e.getCategory()?(this._pluggables.push(e),[2,e.configure(this._options)]):[2]}))}))},e.prototype.getProviderByName=function(e){return e===i.INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER?this.awsAppSyncProvider:e===i.INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER?this.awsAppSyncRealTimeProvider:this._pluggables.find((function(t){return t.getProviderName()===e}))},e.prototype.getProviders=function(e){void 0===e&&(e={});var t=e.provider;if(!t)return this._pluggables;var n=this.getProviderByName(t);if(!n)throw new Error("Could not find provider named "+t);return[n]},e.prototype.publish=function(e,t,n){return $(this,void 0,void 0,(function(){return X(this,(function(r){return[2,Promise.all(this.getProviders(n).map((function(r){return r.publish(e,t,n)})))]}))}))},e.prototype.subscribe=function(e,t){if(Z&&this._options&&this._options.ssr)throw new Error("Subscriptions are not supported for Server-Side Rendering (SSR)");ee.debug("subscribe options",t);var n=this.getProviders(t);return new o((function(r){var o=n.map((function(n){return{provider:n,observable:n.subscribe(e,t)}})).map((function(e){var t=e.provider;return e.observable.subscribe({start:console.error,next:function(e){return r.next({provider:t,value:e})},error:function(e){return r.error({provider:t,error:e})}})}));return function(){return o.forEach((function(e){return e.unsubscribe()}))}}))},e}())(null);i.Amplify.register(te);var ne,re=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ie=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return re(t,e),Object.defineProperty(t.prototype,"region",{get:function(){return this.options.aws_pubsub_region},enumerable:!0,configurable:!0}),t.prototype.getProviderName=function(){return"AWSIoTProvider"},Object.defineProperty(t.prototype,"endpoint",{get:function(){return oe(this,void 0,void 0,(function(){var e,t,n,r,o,s;return ie(this,(function(a){switch(a.label){case 0:return e=this.options.aws_pubsub_endpoint,t={service:"iotdevicegateway",region:this.region},[4,i.Credentials.get()];case 1:return n=a.sent(),r=n.accessKeyId,o=n.secretAccessKey,s=n.sessionToken,[2,i.Signer.signUrl(e,{access_key:r,secret_key:o,session_token:s},t)]}}))}))},enumerable:!0,configurable:!0}),t}(O);!function(e){e.CONNECTION_CLOSED="Connection closed",e.CONNECTION_FAILED="Connection failed",e.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",e.SUBSCRIPTION_ACK="Subscription ack",e.TIMEOUT_DISCONNECT="Timeout disconnect"}(ne||(ne={}));t.default=te}])}));
 //# sourceMappingURL=aws-amplify-pubsub.min.js.map
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js.map b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js.map
index 954d3dc..9c753fc 100644
--- a/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js.map
+++ b/node_modules/@aws-amplify/pubsub/dist/aws-amplify-pubsub.min.js.map
@@ -1 +1 @@
-{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external \"@aws-amplify/core\"","webpack:///external \"graphql\"","webpack:///./node_modules/uuid/index.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/node-libs-browser/node_modules/buffer/index.js","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js","webpack:///./node_modules/zen-observable/index.js","webpack:///./node_modules/paho-mqtt/paho-mqtt.js","webpack:///./node_modules/url/url.js","webpack:///external \"@aws-amplify/cache\"","webpack:///external \"@aws-amplify/auth\"","webpack:///./node_modules/zen-observable/lib/Observable.js","webpack:///./node_modules/uuid/v1.js","webpack:///./node_modules/uuid/v4.js","webpack:///./node_modules/punycode/punycode.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/url/util.js","webpack:///./node_modules/querystring-es3/index.js","webpack:///./node_modules/querystring-es3/decode.js","webpack:///./node_modules/querystring-es3/encode.js","webpack:///./node_modules/base64-js/index.js","webpack:///./node_modules/ieee754/index.js","webpack:///./node_modules/isarray/index.js","webpack:///./node_modules/zen-observable-ts/lib/bundle.esm.js","webpack:///../../src/Providers/PubSubProvider.ts","webpack:///../../src/Providers/MqttOverWSProvider.ts","webpack:///../../src/Providers/AWSAppSyncRealTimeProvider.ts","webpack:///../../src/Providers/AWSAppSyncProvider.ts","webpack:///../src/index.ts","webpack:///../src/PubSub.ts","webpack:///../../src/Providers/AWSIotProvider.ts"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__10__","__WEBPACK_EXTERNAL_MODULE__11__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","v1","v4","uuid","g","Function","e","window","base64","ieee754","isArray","kMaxLength","Buffer","TYPED_ARRAY_SUPPORT","createBuffer","that","length","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","Error","allocUnsafe","from","TypeError","ArrayBuffer","array","byteOffset","byteLength","undefined","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","slice","fromString","obj","isBuffer","len","checked","copy","buffer","val","type","data","fromObject","assertSize","size","toString","isView","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","b","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","indexOf","lastIndexOf","arr","indexSize","arrLength","valLength","String","read","buf","readUInt16BE","foundIndex","found","j","hexWrite","offset","Number","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","push","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","Math","min","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","fromCharCode","apply","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","fill","allocUnsafeSlow","_isBuffer","compare","a","x","y","concat","list","pos","swap16","swap32","swap64","arguments","equals","inspect","max","match","join","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","Array","_arr","ret","out","toHex","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","set","code","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","trim","replace","stringtrim","base64clean","src","dst","getRandomValues","crypto","msCrypto","rnds8","rnds","random","byteToHex","bth","Observable","localStorage","setItem","item","getItem","removeItem","MESSAGE_TYPE","validate","keys","errorStr","validKey","format","ERROR","INVALID_TYPE","scope","f","OK","text","CONNECT_TIMEOUT","SUBSCRIBE_TIMEOUT","UNSUBSCRIBE_TIMEOUT","PING_TIMEOUT","INTERNAL_ERROR","CONNACK_RETURNCODE","SOCKET_ERROR","SOCKET_CLOSE","MALFORMED_UTF","UNSUPPORTED","INVALID_STATE","INVALID_ARGUMENT","UNSUPPORTED_OPERATION","INVALID_STORED_DATA","INVALID_MQTT_MESSAGE_TYPE","MALFORMED_UNICODE","BUFFER_FULL","CONNACK_RC","0","1","2","3","4","5","error","substitutions","field","part1","substring","part2","MqttProtoIdentifierv3","MqttProtoIdentifierv4","WireMessage","options","decodeMessage","input","digit","startingPos","first","messageInfo","remLength","multiplier","endPos","wireMessage","sessionPresent","returnCode","qos","readUint16","topicName","parseUTF8","messageIdentifier","message","Message","retained","duplicate","destinationName","payloadMessage","writeUint16","writeString","utf8Length","stringToUTF8","UTF8Length","output","charCode","lowCharCode","utf16","byte1","byte2","byte3","byte4","encode","willMessagePayloadBytes","topicStrLength","destinationNameLength","mqttVersion","clientId","willMessage","payloadBytes","userName","password","topics","requestedQos","mbi","number","numBytes","encodeMBI","byteStream","connectFlags","cleanSession","keepAliveInterval","Pinger","client","_client","_keepAliveInterval","isReset","pingReq","doTimeout","pinger","doPing","_trace","socket","send","timeout","setTimeout","_disconnected","reset","clearTimeout","cancel","Timeout","timeoutSeconds","action","args","ClientImpl","uri","host","port","path","WebSocket","_wsuri","_localKey","_msg_queue","_buffered_msg_queue","_sentMessages","_receivedMessages","_notify_msg_sent","_message_identifier","_sequence","restore","connected","maxMessageIdentifier","connectOptions","hostIndex","onConnected","onConnectionLost","onMessageDelivered","onMessageArrived","traceFunction","_connectTimeout","sendPinger","receivePinger","_reconnectInterval","_reconnecting","_reconnectTimeout","disconnectedPublishing","disconnectedBufferSize","receiveBuffer","_traceBuffer","_MAX_TRACE_ENTRIES","connect","connectOptionsMasked","_traceMask","uris","_doConnect","subscribe","filter","subscribeOptions","constructor","onSuccess","grantedQos","invocationContext","onFailure","errorCode","errorMessage","timeOut","_requires_ack","_schedule_message","unsubscribe","unsubscribeOptions","callback","sequence","unshift","disconnect","getTraceLog","Date","startTrace","stopTrace","wsurl","useSSL","uriParts","split","binaryType","onopen","_on_socket_open","onmessage","_on_socket_message","onerror","_on_socket_error","onclose","_on_socket_close","_process_queue","store","prefix","storedMessage","version","pubRecReceived","hex","messageBytes","payloadHex","JSON","stringify","parse","pop","_socket_send","messageCount","event","messages","_deframeMessages","_handleMessage","newData","result","errorStack","stack","sentMessage","receivedMessage","sequencedMessages","msgId","msg","sort","pubRelMessage","reconnected","_connected","_receivePublish","_receiveMessage","pubCompMessage","wireMessageMasked","pubAckMessage","pubRecMessage","reconnect","_reconnect","errorText","readyState","close","mqttVersionExplicit","splice","record","severity","shift","traceObject","masked","traceObjectMasked","attr","newPayload","payload","DataView","defineProperties","newDestinationName","newQos","newRetained","newTopic","newDuplicate","Client","ipv6AddSBracket","clientIdLength","newOnConnected","newDisconnectedPublishing","newDisconnectedBufferSize","newOnConnectionLost","newOnMessageDelivered","newOnMessageArrived","trace","hosts","ports","stringPayload","usingURIs","test","ipv6","topic","publish","isConnected","self","punycode","util","Url","protocol","slashes","auth","hostname","hash","search","query","pathname","href","urlParse","resolve","source","relative","resolveObject","isString","protocolPattern","portPattern","simplePathPattern","unwise","autoEscape","nonHostChars","hostEndingChars","hostnamePartPattern","hostnamePartStart","unsafeProtocol","hostlessProtocol","slashedProtocol","querystring","url","parseQueryString","slashesDenoteHost","isObject","u","queryIndex","splitter","uSplit","rest","simplePath","exec","proto","lowerProto","atSign","hostEnd","hec","decodeURIComponent","parseHost","ipv6Hostname","hostparts","part","newpart","k","validParts","notHost","bit","toASCII","h","ae","esc","encodeURIComponent","escape","qm","charAt","rel","tkeys","tk","tkey","rkeys","rk","rkey","v","relPath","isSourceAbs","isRelAbs","mustEndAbs","removeAllDots","srcPath","psychotic","isNullOrUndefined","authInHost","isNull","last","hasTrailingSlash","up","isAbsolute","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","writable","_createClass","protoProps","staticProps","hasSymbols","hasSymbol","Boolean","getSymbol","observable","SymbolIterator","SymbolObservable","SymbolSpecies","getMethod","getSpecies","ctor","isObservable","hostReportError","log","enqueue","fn","Promise","then","cleanupSubscription","subscription","cleanup","_cleanup","closeSubscription","_observer","_queue","_state","notifySubscription","observer","onNotify","queue","flushSubscription","Subscription","subscriber","subscriptionObserver","SubscriptionObserver","_subscription","_subscriber","next","complete","_this","reject","done","_this2","_this3","_this4","C","hasSeed","hasValue","seed","acc","_this5","_len","sources","_key","index","startNext","_this6","subscriptions","outer","inner","completeIfDone","closed","forEach","method","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","_item","err","return","_len2","items","_key2","symbol","_nodeId","_clockseq","rng","bytesToUuid","_lastMSecs","_lastNSecs","node","clockseq","seedBytes","msecs","getTime","nsecs","dt","tl","tmh","ii","nodeType","freeGlobal","maxInt","regexPunycode","regexNonASCII","regexSeparators","errors","stringFromCharCode","map","mapDomain","parts","ucs2decode","extra","counter","ucs2encode","digitToBasic","flag","adapt","delta","numPoints","firstTime","baseMinusTMin","base","decode","basic","oldi","w","baseMinusT","inputLength","bias","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","webpackPolyfill","deprecate","paths","children","prop","qs","sep","eq","regexp","maxKeys","kstr","vstr","idx","xs","stringifyPrimitive","objectKeys","ks","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","num","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","abs","LN2","provider"],"mappings":"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","file":"aws-amplify-pubsub.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@aws-amplify/core\"), require(\"graphql\"), require(\"@aws-amplify/cache\"), require(\"@aws-amplify/auth\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"aws_amplify_pubsub\", [\"@aws-amplify/core\", \"graphql\", \"@aws-amplify/cache\", \"@aws-amplify/auth\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"aws_amplify_pubsub\"] = factory(require(\"@aws-amplify/core\"), require(\"graphql\"), require(\"@aws-amplify/cache\"), require(\"@aws-amplify/auth\"));\n\telse\n\t\troot[\"aws_amplify_pubsub\"] = factory(root[\"@aws-amplify/core\"], root[\"graphql\"], root[\"@aws-amplify/cache\"], root[\"@aws-amplify/auth\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__10__, __WEBPACK_EXTERNAL_MODULE__11__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]]\n  ]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","module.exports = require('./lib/Observable.js').Observable;\n","/*******************************************************************************\n * Copyright (c) 2013 IBM Corp.\n *\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * and Eclipse Distribution License v1.0 which accompany this distribution.\n *\n * The Eclipse Public License is available at\n *    http://www.eclipse.org/legal/epl-v10.html\n * and the Eclipse Distribution License is available at\n *   http://www.eclipse.org/org/documents/edl-v10.php.\n *\n * Contributors:\n *    Andrew Banks - initial API and implementation and initial documentation\n *******************************************************************************/\n\n\n// Only expose a single object name in the global namespace.\n// Everything must go through this module. Global Paho module\n// only has a single public function, client, which returns\n// a Paho client object given connection details.\n\n/**\n * Send and receive messages using web browsers.\n * <p>\n * This programming interface lets a JavaScript client application use the MQTT V3.1 or\n * V3.1.1 protocol to connect to an MQTT-supporting messaging server.\n *\n * The function supported includes:\n * <ol>\n * <li>Connecting to and disconnecting from a server. The server is identified by its host name and port number.\n * <li>Specifying options that relate to the communications link with the server,\n * for example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.\n * <li>Subscribing to and receiving messages from MQTT Topics.\n * <li>Publishing messages to MQTT Topics.\n * </ol>\n * <p>\n * The API consists of two main objects:\n * <dl>\n * <dt><b>{@link Paho.Client}</b></dt>\n * <dd>This contains methods that provide the functionality of the API,\n * including provision of callbacks that notify the application when a message\n * arrives from or is delivered to the messaging server,\n * or when the status of its connection to the messaging server changes.</dd>\n * <dt><b>{@link Paho.Message}</b></dt>\n * <dd>This encapsulates the payload of the message along with various attributes\n * associated with its delivery, in particular the destination to which it has\n * been (or is about to be) sent.</dd>\n * </dl>\n * <p>\n * The programming interface validates parameters passed to it, and will throw\n * an Error containing an error message intended for developer use, if it detects\n * an error with any parameter.\n * <p>\n * Example:\n *\n * <code><pre>\nvar client = new Paho.MQTT.Client(location.hostname, Number(location.port), \"clientId\");\nclient.onConnectionLost = onConnectionLost;\nclient.onMessageArrived = onMessageArrived;\nclient.connect({onSuccess:onConnect});\n\nfunction onConnect() {\n  // Once a connection has been made, make a subscription and send a message.\n  console.log(\"onConnect\");\n  client.subscribe(\"/World\");\n  var message = new Paho.MQTT.Message(\"Hello\");\n  message.destinationName = \"/World\";\n  client.send(message);\n};\nfunction onConnectionLost(responseObject) {\n  if (responseObject.errorCode !== 0)\n\tconsole.log(\"onConnectionLost:\"+responseObject.errorMessage);\n};\nfunction onMessageArrived(message) {\n  console.log(\"onMessageArrived:\"+message.payloadString);\n  client.disconnect();\n};\n * </pre></code>\n * @namespace Paho\n */\n\n/* jshint shadow:true */\n(function ExportLibrary(root, factory) {\n\tif(typeof exports === \"object\" && typeof module === \"object\"){\n\t\tmodule.exports = factory();\n\t} else if (typeof define === \"function\" && define.amd){\n\t\tdefine(factory);\n\t} else if (typeof exports === \"object\"){\n\t\texports = factory();\n\t} else {\n\t\t//if (typeof root.Paho === \"undefined\"){\n\t\t//\troot.Paho = {};\n\t\t//}\n\t\troot.Paho = factory();\n\t}\n})(this, function LibraryFactory(){\n\n\n\tvar PahoMQTT = (function (global) {\n\n\t// Private variables below, these are only visible inside the function closure\n\t// which is used to define the module.\n\tvar version = \"@VERSION@-@BUILDLEVEL@\";\n\n\t/**\n\t * @private\n\t */\n\tvar localStorage = global.localStorage || (function () {\n\t\tvar data = {};\n\n\t\treturn {\n\t\t\tsetItem: function (key, item) { data[key] = item; },\n\t\t\tgetItem: function (key) { return data[key]; },\n\t\t\tremoveItem: function (key) { delete data[key]; },\n\t\t};\n\t})();\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar MESSAGE_TYPE = {\n\t\t\tCONNECT: 1,\n\t\t\tCONNACK: 2,\n\t\t\tPUBLISH: 3,\n\t\t\tPUBACK: 4,\n\t\t\tPUBREC: 5,\n\t\t\tPUBREL: 6,\n\t\t\tPUBCOMP: 7,\n\t\t\tSUBSCRIBE: 8,\n\t\t\tSUBACK: 9,\n\t\t\tUNSUBSCRIBE: 10,\n\t\t\tUNSUBACK: 11,\n\t\t\tPINGREQ: 12,\n\t\t\tPINGRESP: 13,\n\t\t\tDISCONNECT: 14\n\t\t};\n\n\t\t// Collection of utility methods used to simplify module code\n\t\t// and promote the DRY pattern.\n\n\t\t/**\n\t * Validate an object's parameter names to ensure they\n\t * match a list of expected variables name for this option\n\t * type. Used to ensure option object passed into the API don't\n\t * contain erroneous parameters.\n\t * @param {Object} obj - User options object\n\t * @param {Object} keys - valid keys and types that may exist in obj.\n\t * @throws {Error} Invalid option parameter found.\n\t * @private\n\t */\n\t\tvar validate = function(obj, keys) {\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\tif (keys.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (typeof obj[key] !== keys[key])\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof obj[key], key]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar errorStr = \"Unknown property, \" + key + \". Valid properties are:\";\n\t\t\t\t\t\tfor (var validKey in keys)\n\t\t\t\t\t\t\tif (keys.hasOwnProperty(validKey))\n\t\t\t\t\t\t\t\terrorStr = errorStr+\" \"+validKey;\n\t\t\t\t\t\tthrow new Error(errorStr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Return a new function which runs the user function bound\n\t * to a fixed scope.\n\t * @param {function} User function\n\t * @param {object} Function scope\n\t * @return {function} User function bound to another scope\n\t * @private\n\t */\n\t\tvar scope = function (f, scope) {\n\t\t\treturn function () {\n\t\t\t\treturn f.apply(scope, arguments);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar ERROR = {\n\t\t\tOK: {code:0, text:\"AMQJSC0000I OK.\"},\n\t\t\tCONNECT_TIMEOUT: {code:1, text:\"AMQJSC0001E Connect timed out.\"},\n\t\t\tSUBSCRIBE_TIMEOUT: {code:2, text:\"AMQJS0002E Subscribe timed out.\"},\n\t\t\tUNSUBSCRIBE_TIMEOUT: {code:3, text:\"AMQJS0003E Unsubscribe timed out.\"},\n\t\t\tPING_TIMEOUT: {code:4, text:\"AMQJS0004E Ping timed out.\"},\n\t\t\tINTERNAL_ERROR: {code:5, text:\"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}\"},\n\t\t\tCONNACK_RETURNCODE: {code:6, text:\"AMQJS0006E Bad Connack return code:{0} {1}.\"},\n\t\t\tSOCKET_ERROR: {code:7, text:\"AMQJS0007E Socket error:{0}.\"},\n\t\t\tSOCKET_CLOSE: {code:8, text:\"AMQJS0008I Socket closed.\"},\n\t\t\tMALFORMED_UTF: {code:9, text:\"AMQJS0009E Malformed UTF data:{0} {1} {2}.\"},\n\t\t\tUNSUPPORTED: {code:10, text:\"AMQJS0010E {0} is not supported by this browser.\"},\n\t\t\tINVALID_STATE: {code:11, text:\"AMQJS0011E Invalid state {0}.\"},\n\t\t\tINVALID_TYPE: {code:12, text:\"AMQJS0012E Invalid type {0} for {1}.\"},\n\t\t\tINVALID_ARGUMENT: {code:13, text:\"AMQJS0013E Invalid argument {0} for {1}.\"},\n\t\t\tUNSUPPORTED_OPERATION: {code:14, text:\"AMQJS0014E Unsupported operation.\"},\n\t\t\tINVALID_STORED_DATA: {code:15, text:\"AMQJS0015E Invalid data in local storage key={0} value={1}.\"},\n\t\t\tINVALID_MQTT_MESSAGE_TYPE: {code:16, text:\"AMQJS0016E Invalid MQTT message type {0}.\"},\n\t\t\tMALFORMED_UNICODE: {code:17, text:\"AMQJS0017E Malformed Unicode string:{0} {1}.\"},\n\t\t\tBUFFER_FULL: {code:18, text:\"AMQJS0018E Message buffer is full, maximum buffer size: {0}.\"},\n\t\t};\n\n\t\t/** CONNACK RC Meaning. */\n\t\tvar CONNACK_RC = {\n\t\t\t0:\"Connection Accepted\",\n\t\t\t1:\"Connection Refused: unacceptable protocol version\",\n\t\t\t2:\"Connection Refused: identifier rejected\",\n\t\t\t3:\"Connection Refused: server unavailable\",\n\t\t\t4:\"Connection Refused: bad user name or password\",\n\t\t\t5:\"Connection Refused: not authorized\"\n\t\t};\n\n\t/**\n\t * Format an error message text.\n\t * @private\n\t * @param {error} ERROR value above.\n\t * @param {substitutions} [array] substituted into the text.\n\t * @return the text with the substitutions made.\n\t */\n\t\tvar format = function(error, substitutions) {\n\t\t\tvar text = error.text;\n\t\t\tif (substitutions) {\n\t\t\t\tvar field,start;\n\t\t\t\tfor (var i=0; i<substitutions.length; i++) {\n\t\t\t\t\tfield = \"{\"+i+\"}\";\n\t\t\t\t\tstart = text.indexOf(field);\n\t\t\t\t\tif(start > 0) {\n\t\t\t\t\t\tvar part1 = text.substring(0,start);\n\t\t\t\t\t\tvar part2 = text.substring(start+field.length);\n\t\t\t\t\t\ttext = part1+substitutions[i]+part2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn text;\n\t\t};\n\n\t\t//MQTT protocol and version          6    M    Q    I    s    d    p    3\n\t\tvar MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];\n\t\t//MQTT proto/version for 311         4    M    Q    T    T    4\n\t\tvar MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];\n\n\t\t/**\n\t * Construct an MQTT wire protocol message.\n\t * @param type MQTT packet type.\n\t * @param options optional wire message attributes.\n\t *\n\t * Optional properties\n\t *\n\t * messageIdentifier: message ID in the range [0..65535]\n\t * payloadMessage:\tApplication Message - PUBLISH only\n\t * connectStrings:\tarray of 0 or more Strings to be put into the CONNECT payload\n\t * topics:\t\t\tarray of strings (SUBSCRIBE, UNSUBSCRIBE)\n\t * requestQoS:\t\tarray of QoS values [0..2]\n\t *\n\t * \"Flag\" properties\n\t * cleanSession:\ttrue if present / false if absent (CONNECT)\n\t * willMessage:  \ttrue if present / false if absent (CONNECT)\n\t * isRetained:\t\ttrue if present / false if absent (CONNECT)\n\t * userName:\t\ttrue if present / false if absent (CONNECT)\n\t * password:\t\ttrue if present / false if absent (CONNECT)\n\t * keepAliveInterval:\tinteger [0..65535]  (CONNECT)\n\t *\n\t * @private\n\t * @ignore\n\t */\n\t\tvar WireMessage = function (type, options) {\n\t\t\tthis.type = type;\n\t\t\tfor (var name in options) {\n\t\t\t\tif (options.hasOwnProperty(name)) {\n\t\t\t\t\tthis[name] = options[name];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tWireMessage.prototype.encode = function() {\n\t\t// Compute the first byte of the fixed header\n\t\t\tvar first = ((this.type & 0x0f) << 4);\n\n\t\t\t/*\n\t\t * Now calculate the length of the variable header + payload by adding up the lengths\n\t\t * of all the component parts\n\t\t */\n\n\t\t\tvar remLength = 0;\n\t\t\tvar topicStrLength = [];\n\t\t\tvar destinationNameLength = 0;\n\t\t\tvar willMessagePayloadBytes;\n\n\t\t\t// if the message contains a messageIdentifier then we need two bytes for that\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tremLength += 2;\n\n\t\t\tswitch(this.type) {\n\t\t\t// If this a Connect then we need to include 12 bytes for its header\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tswitch(this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tremLength += MqttProtoIdentifierv3.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tremLength += MqttProtoIdentifierv4.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tremLength += UTF8Length(this.clientId) + 2;\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tremLength += UTF8Length(this.willMessage.destinationName) + 2;\n\t\t\t\t\t// Will message is always a string, sent as UTF-8 characters with a preceding length.\n\t\t\t\t\twillMessagePayloadBytes = this.willMessage.payloadBytes;\n\t\t\t\t\tif (!(willMessagePayloadBytes instanceof Uint8Array))\n\t\t\t\t\t\twillMessagePayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\t\tremLength += willMessagePayloadBytes.byteLength +2;\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.userName) + 2;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.password) + 2;\n\t\t\t\tbreak;\n\n\t\t\t// Subscribe, Unsubscribe can both contain topic strings\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tremLength += this.requestedQos.length; // 1 byte for each topic's Qos\n\t\t\t\t// QoS on Subscribe only\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif (this.payloadMessage.duplicate) first |= 0x08;\n\t\t\t\tfirst  = first |= (this.payloadMessage.qos << 1);\n\t\t\t\tif (this.payloadMessage.retained) first |= 0x01;\n\t\t\t\tdestinationNameLength = UTF8Length(this.payloadMessage.destinationName);\n\t\t\t\tremLength += destinationNameLength + 2;\n\t\t\t\tvar payloadBytes = this.payloadMessage.payloadBytes;\n\t\t\t\tremLength += payloadBytes.byteLength;\n\t\t\t\tif (payloadBytes instanceof ArrayBuffer)\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\telse if (!(payloadBytes instanceof Uint8Array))\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes.buffer);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Now we can allocate a buffer for the message\n\n\t\t\tvar mbi = encodeMBI(remLength);  // Convert the length to MQTT MBI format\n\t\t\tvar pos = mbi.length + 1;        // Offset of start of variable header\n\t\t\tvar buffer = new ArrayBuffer(remLength + pos);\n\t\t\tvar byteStream = new Uint8Array(buffer);    // view it as a sequence of bytes\n\n\t\t\t//Write the fixed header into the buffer\n\t\t\tbyteStream[0] = first;\n\t\t\tbyteStream.set(mbi,1);\n\n\t\t\t// If this is a PUBLISH then the variable header starts with a topic\n\t\t\tif (this.type == MESSAGE_TYPE.PUBLISH)\n\t\t\t\tpos = writeString(this.payloadMessage.destinationName, destinationNameLength, byteStream, pos);\n\t\t\t// If this is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time\n\n\t\t\telse if (this.type == MESSAGE_TYPE.CONNECT) {\n\t\t\t\tswitch (this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv3, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv3.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv4, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv4.length;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar connectFlags = 0;\n\t\t\t\tif (this.cleanSession)\n\t\t\t\t\tconnectFlags = 0x02;\n\t\t\t\tif (this.willMessage !== undefined ) {\n\t\t\t\t\tconnectFlags |= 0x04;\n\t\t\t\t\tconnectFlags |= (this.willMessage.qos<<3);\n\t\t\t\t\tif (this.willMessage.retained) {\n\t\t\t\t\t\tconnectFlags |= 0x20;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tconnectFlags |= 0x80;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tconnectFlags |= 0x40;\n\t\t\t\tbyteStream[pos++] = connectFlags;\n\t\t\t\tpos = writeUint16 (this.keepAliveInterval, byteStream, pos);\n\t\t\t}\n\n\t\t\t// Output the messageIdentifier - if there is one\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tpos = writeUint16 (this.messageIdentifier, byteStream, pos);\n\n\t\t\tswitch(this.type) {\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tpos = writeString(this.clientId, UTF8Length(this.clientId), byteStream, pos);\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tpos = writeString(this.willMessage.destinationName, UTF8Length(this.willMessage.destinationName), byteStream, pos);\n\t\t\t\t\tpos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);\n\t\t\t\t\tbyteStream.set(willMessagePayloadBytes, pos);\n\t\t\t\t\tpos += willMessagePayloadBytes.byteLength;\n\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tpos = writeString(this.userName, UTF8Length(this.userName), byteStream, pos);\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tpos = writeString(this.password, UTF8Length(this.password), byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// PUBLISH has a text or binary payload, if text do not add a 2 byte length field, just the UTF characters.\n\t\t\t\tbyteStream.set(payloadBytes, pos);\n\n\t\t\t\tbreak;\n\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREC:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREL:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t//    \t    \tbreak;\n\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\t// SUBSCRIBE has a list of topic strings and request QoS\n\t\t\t\tfor (var i=0; i<this.topics.length; i++) {\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\t\tbyteStream[pos++] = this.requestedQos[i];\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\t// UNSUBSCRIBE has a list of topic strings\n\t\t\t\tfor (var i=0; i<this.topics.length; i++)\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// Do nothing.\n\t\t\t}\n\n\t\t\treturn buffer;\n\t\t};\n\n\t\tfunction decodeMessage(input,pos) {\n\t\t\tvar startingPos = pos;\n\t\t\tvar first = input[pos];\n\t\t\tvar type = first >> 4;\n\t\t\tvar messageInfo = first &= 0x0f;\n\t\t\tpos += 1;\n\n\n\t\t\t// Decode the remaining length (MBI format)\n\n\t\t\tvar digit;\n\t\t\tvar remLength = 0;\n\t\t\tvar multiplier = 1;\n\t\t\tdo {\n\t\t\t\tif (pos == input.length) {\n\t\t\t\t\treturn [null,startingPos];\n\t\t\t\t}\n\t\t\t\tdigit = input[pos++];\n\t\t\t\tremLength += ((digit & 0x7F) * multiplier);\n\t\t\t\tmultiplier *= 128;\n\t\t\t} while ((digit & 0x80) !== 0);\n\n\t\t\tvar endPos = pos+remLength;\n\t\t\tif (endPos > input.length) {\n\t\t\t\treturn [null,startingPos];\n\t\t\t}\n\n\t\t\tvar wireMessage = new WireMessage(type);\n\t\t\tswitch(type) {\n\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\tvar connectAcknowledgeFlags = input[pos++];\n\t\t\t\tif (connectAcknowledgeFlags & 0x01)\n\t\t\t\t\twireMessage.sessionPresent = true;\n\t\t\t\twireMessage.returnCode = input[pos++];\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tvar qos = (messageInfo >> 1) & 0x03;\n\n\t\t\t\tvar len = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\tvar topicName = parseUTF8(input, pos, len);\n\t\t\t\tpos += len;\n\t\t\t\t// If QoS 1 or 2 there will be a messageIdentifier\n\t\t\t\tif (qos > 0) {\n\t\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\t\tpos += 2;\n\t\t\t\t}\n\n\t\t\t\tvar message = new Message(input.subarray(pos, endPos));\n\t\t\t\tif ((messageInfo & 0x01) == 0x01)\n\t\t\t\t\tmessage.retained = true;\n\t\t\t\tif ((messageInfo & 0x08) == 0x08)\n\t\t\t\t\tmessage.duplicate =  true;\n\t\t\t\tmessage.qos = qos;\n\t\t\t\tmessage.destinationName = topicName;\n\t\t\t\twireMessage.payloadMessage = message;\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.PUBACK:\n\t\t\tcase  MESSAGE_TYPE.PUBREC:\n\t\t\tcase  MESSAGE_TYPE.PUBREL:\n\t\t\tcase  MESSAGE_TYPE.PUBCOMP:\n\t\t\tcase  MESSAGE_TYPE.UNSUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.SUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\twireMessage.returnCode = input.subarray(pos, endPos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn [wireMessage,endPos];\n\t\t}\n\n\t\tfunction writeUint16(input, buffer, offset) {\n\t\t\tbuffer[offset++] = input >> 8;      //MSB\n\t\t\tbuffer[offset++] = input % 256;     //LSB\n\t\t\treturn offset;\n\t\t}\n\n\t\tfunction writeString(input, utf8Length, buffer, offset) {\n\t\t\toffset = writeUint16(utf8Length, buffer, offset);\n\t\t\tstringToUTF8(input, buffer, offset);\n\t\t\treturn offset + utf8Length;\n\t\t}\n\n\t\tfunction readUint16(buffer, offset) {\n\t\t\treturn 256*buffer[offset] + buffer[offset+1];\n\t\t}\n\n\t\t/**\n\t * Encodes an MQTT Multi-Byte Integer\n\t * @private\n\t */\n\t\tfunction encodeMBI(number) {\n\t\t\tvar output = new Array(1);\n\t\t\tvar numBytes = 0;\n\n\t\t\tdo {\n\t\t\t\tvar digit = number % 128;\n\t\t\t\tnumber = number >> 7;\n\t\t\t\tif (number > 0) {\n\t\t\t\t\tdigit |= 0x80;\n\t\t\t\t}\n\t\t\t\toutput[numBytes++] = digit;\n\t\t\t} while ( (number > 0) && (numBytes<4) );\n\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and calculates its length in bytes when encoded in UTF8.\n\t * @private\n\t */\n\t\tfunction UTF8Length(input) {\n\t\t\tvar output = 0;\n\t\t\tfor (var i = 0; i<input.length; i++)\n\t\t\t{\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\t\t\t\tif (charCode > 0x7FF)\n\t\t\t\t{\n\t\t\t\t\t// Surrogate pair means its a 4 byte character\n\t\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)\n\t\t\t\t\t{\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\toutput++;\n\t\t\t\t\t}\n\t\t\t\t\toutput +=3;\n\t\t\t\t}\n\t\t\t\telse if (charCode > 0x7F)\n\t\t\t\t\toutput +=2;\n\t\t\t\telse\n\t\t\t\t\toutput++;\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and writes it into an array as UTF8 encoded bytes.\n\t * @private\n\t */\n\t\tfunction stringToUTF8(input, output, start) {\n\t\t\tvar pos = start;\n\t\t\tfor (var i = 0; i<input.length; i++) {\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\n\t\t\t\t// Check for a surrogate pair.\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF) {\n\t\t\t\t\tvar lowCharCode = input.charCodeAt(++i);\n\t\t\t\t\tif (isNaN(lowCharCode)) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));\n\t\t\t\t\t}\n\t\t\t\t\tcharCode = ((charCode - 0xD800)<<10) + (lowCharCode - 0xDC00) + 0x10000;\n\n\t\t\t\t}\n\n\t\t\t\tif (charCode <= 0x7F) {\n\t\t\t\t\toutput[pos++] = charCode;\n\t\t\t\t} else if (charCode <= 0x7FF) {\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x1F | 0xC0;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else if (charCode <= 0xFFFF) {\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x0F | 0xE0;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else {\n\t\t\t\t\toutput[pos++] = charCode>>18 & 0x07 | 0xF0;\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\tfunction parseUTF8(input, offset, length) {\n\t\t\tvar output = \"\";\n\t\t\tvar utf16;\n\t\t\tvar pos = offset;\n\n\t\t\twhile (pos < offset+length)\n\t\t\t{\n\t\t\t\tvar byte1 = input[pos++];\n\t\t\t\tif (byte1 < 128)\n\t\t\t\t\tutf16 = byte1;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar byte2 = input[pos++]-128;\n\t\t\t\t\tif (byte2 < 0)\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),\"\"]));\n\t\t\t\t\tif (byte1 < 0xE0)             // 2 byte character\n\t\t\t\t\t\tutf16 = 64*(byte1-0xC0) + byte2;\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar byte3 = input[pos++]-128;\n\t\t\t\t\t\tif (byte3 < 0)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));\n\t\t\t\t\t\tif (byte1 < 0xF0)        // 3 byte character\n\t\t\t\t\t\t\tutf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar byte4 = input[pos++]-128;\n\t\t\t\t\t\t\tif (byte4 < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t\tif (byte1 < 0xF8)        // 4 byte character\n\t\t\t\t\t\t\t\tutf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;\n\t\t\t\t\t\t\telse                     // longer encodings are not supported\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (utf16 > 0xFFFF)   // 4 byte character - express as a surrogate pair\n\t\t\t\t{\n\t\t\t\t\tutf16 -= 0x10000;\n\t\t\t\t\toutput += String.fromCharCode(0xD800 + (utf16 >> 10)); // lead character\n\t\t\t\t\tutf16 = 0xDC00 + (utf16 & 0x3FF);  // trail character\n\t\t\t\t}\n\t\t\t\toutput += String.fromCharCode(utf16);\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Repeat keepalive requests, monitor responses.\n\t * @ignore\n\t */\n\t\tvar Pinger = function(client, keepAliveInterval) {\n\t\t\tthis._client = client;\n\t\t\tthis._keepAliveInterval = keepAliveInterval*1000;\n\t\t\tthis.isReset = false;\n\n\t\t\tvar pingReq = new WireMessage(MESSAGE_TYPE.PINGREQ).encode();\n\n\t\t\tvar doTimeout = function (pinger) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn doPing.apply(pinger);\n\t\t\t\t};\n\t\t\t};\n\n\t\t\t/** @ignore */\n\t\t\tvar doPing = function() {\n\t\t\t\tif (!this.isReset) {\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"Timed out\");\n\t\t\t\t\tthis._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));\n\t\t\t\t} else {\n\t\t\t\t\tthis.isReset = false;\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"send PINGREQ\");\n\t\t\t\t\tthis._client.socket.send(pingReq);\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.reset = function() {\n\t\t\t\tthis.isReset = true;\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t\tif (this._keepAliveInterval > 0)\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t};\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Monitor request completion.\n\t * @ignore\n\t */\n\t\tvar Timeout = function(client, timeoutSeconds, action, args) {\n\t\t\tif (!timeoutSeconds)\n\t\t\t\ttimeoutSeconds = 30;\n\n\t\t\tvar doTimeout = function (action, client, args) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn action.apply(client, args);\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t/**\n\t * Internal implementation of the Websockets MQTT V3.1 client.\n\t *\n\t * @name Paho.ClientImpl @constructor\n\t * @param {String} host the DNS nameof the webSocket host.\n\t * @param {Number} port the port number for that host.\n\t * @param {String} clientId the MQ client identifier.\n\t */\n\t\tvar ClientImpl = function (uri, host, port, path, clientId) {\n\t\t// Check dependencies are satisfied in this browser.\n\t\t\tif (!(\"WebSocket\" in global && global.WebSocket !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"WebSocket\"]));\n\t\t\t}\n\t\t\tif (!(\"ArrayBuffer\" in global && global.ArrayBuffer !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"ArrayBuffer\"]));\n\t\t\t}\n\t\t\tthis._trace(\"Paho.Client\", uri, host, port, path, clientId);\n\n\t\t\tthis.host = host;\n\t\t\tthis.port = port;\n\t\t\tthis.path = path;\n\t\t\tthis.uri = uri;\n\t\t\tthis.clientId = clientId;\n\t\t\tthis._wsuri = null;\n\n\t\t\t// Local storagekeys are qualified with the following string.\n\t\t\t// The conditional inclusion of path in the key is for backward\n\t\t\t// compatibility to when the path was not configurable and assumed to\n\t\t\t// be /mqtt\n\t\t\tthis._localKey=host+\":\"+port+(path!=\"/mqtt\"?\":\"+path:\"\")+\":\"+clientId+\":\";\n\n\t\t\t// Create private instance-only message queue\n\t\t\t// Internal queue of messages to be sent, in sending order.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\n\t\t\t// Messages we have sent and are expecting a response for, indexed by their respective message ids.\n\t\t\tthis._sentMessages = {};\n\n\t\t\t// Messages we have received and acknowleged and are expecting a confirm message for\n\t\t\t// indexed by their respective message ids.\n\t\t\tthis._receivedMessages = {};\n\n\t\t\t// Internal list of callbacks to be executed when messages\n\t\t\t// have been successfully sent over web socket, e.g. disconnect\n\t\t\t// when it doesn't have to wait for ACK, just message is dispatched.\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\t// Unique identifier for SEND messages, incrementing\n\t\t\t// counter as messages are sent.\n\t\t\tthis._message_identifier = 1;\n\n\t\t\t// Used to determine the transmission sequence of stored sent messages.\n\t\t\tthis._sequence = 0;\n\n\n\t\t\t// Load the local state, if any, from the saved version, only restore state relevant to this client.\n\t\t\tfor (var key in localStorage)\n\t\t\t\tif (   key.indexOf(\"Sent:\"+this._localKey) === 0 || key.indexOf(\"Received:\"+this._localKey) === 0)\n\t\t\t\t\tthis.restore(key);\n\t\t};\n\n\t\t// Messaging Client public instance members.\n\t\tClientImpl.prototype.host = null;\n\t\tClientImpl.prototype.port = null;\n\t\tClientImpl.prototype.path = null;\n\t\tClientImpl.prototype.uri = null;\n\t\tClientImpl.prototype.clientId = null;\n\n\t\t// Messaging Client private instance members.\n\t\tClientImpl.prototype.socket = null;\n\t\t/* true once we have received an acknowledgement to a CONNECT packet. */\n\t\tClientImpl.prototype.connected = false;\n\t\t/* The largest message identifier allowed, may not be larger than 2**16 but\n\t\t * if set smaller reduces the maximum number of outbound messages allowed.\n\t\t */\n\t\tClientImpl.prototype.maxMessageIdentifier = 65536;\n\t\tClientImpl.prototype.connectOptions = null;\n\t\tClientImpl.prototype.hostIndex = null;\n\t\tClientImpl.prototype.onConnected = null;\n\t\tClientImpl.prototype.onConnectionLost = null;\n\t\tClientImpl.prototype.onMessageDelivered = null;\n\t\tClientImpl.prototype.onMessageArrived = null;\n\t\tClientImpl.prototype.traceFunction = null;\n\t\tClientImpl.prototype._msg_queue = null;\n\t\tClientImpl.prototype._buffered_msg_queue = null;\n\t\tClientImpl.prototype._connectTimeout = null;\n\t\t/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */\n\t\tClientImpl.prototype.sendPinger = null;\n\t\t/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */\n\t\tClientImpl.prototype.receivePinger = null;\n\t\tClientImpl.prototype._reconnectInterval = 1; // Reconnect Delay, starts at 1 second\n\t\tClientImpl.prototype._reconnecting = false;\n\t\tClientImpl.prototype._reconnectTimeout = null;\n\t\tClientImpl.prototype.disconnectedPublishing = false;\n\t\tClientImpl.prototype.disconnectedBufferSize = 5000;\n\n\t\tClientImpl.prototype.receiveBuffer = null;\n\n\t\tClientImpl.prototype._traceBuffer = null;\n\t\tClientImpl.prototype._MAX_TRACE_ENTRIES = 100;\n\n\t\tClientImpl.prototype.connect = function (connectOptions) {\n\t\t\tvar connectOptionsMasked = this._traceMask(connectOptions, \"password\");\n\t\t\tthis._trace(\"Client.connect\", connectOptionsMasked, this.socket, this.connected);\n\n\t\t\tif (this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\t\t\tif (this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// connect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process to use new connect options.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tthis.connectOptions = connectOptions;\n\t\t\tthis._reconnectInterval = 1;\n\t\t\tthis._reconnecting = false;\n\t\t\tif (connectOptions.uris) {\n\t\t\t\tthis.hostIndex = 0;\n\t\t\t\tthis._doConnect(connectOptions.uris[0]);\n\t\t\t} else {\n\t\t\t\tthis._doConnect(this.uri);\n\t\t\t}\n\n\t\t};\n\n\t\tClientImpl.prototype.subscribe = function (filter, subscribeOptions) {\n\t\t\tthis._trace(\"Client.subscribe\", filter, subscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.SUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n            if (subscribeOptions.qos === undefined)\n                subscribeOptions.qos = 0;\n            wireMessage.requestedQos = [];\n            for (var i = 0; i < wireMessage.topics.length; i++)\n                wireMessage.requestedQos[i] = subscribeOptions.qos;\n\n\t\t\tif (subscribeOptions.onSuccess) {\n\t\t\t\twireMessage.onSuccess = function(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.onFailure) {\n\t\t\t\twireMessage.onFailure = function(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, subscribeOptions.timeout, subscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:subscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.SUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All subscriptions return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype.unsubscribe = function(filter, unsubscribeOptions) {\n\t\t\tthis._trace(\"Client.unsubscribe\", filter, unsubscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n\n\t\t\tif (unsubscribeOptions.onSuccess) {\n\t\t\t\twireMessage.callback = function() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};\n\t\t\t}\n\t\t\tif (unsubscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:unsubscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All unsubscribes return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.send = function (message) {\n\t\t\tthis._trace(\"Client.send\", message);\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.PUBLISH);\n\t\t\twireMessage.payloadMessage = message;\n\n\t\t\tif (this.connected) {\n\t\t\t// Mark qos 1 & 2 message as \"ACK required\"\n\t\t\t// For qos 0 message, invoke onMessageDelivered callback if there is one.\n\t\t\t// Then schedule the message.\n\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t} else if (this.onMessageDelivered) {\n\t\t\t\t\tthis._notify_msg_sent[wireMessage] = this.onMessageDelivered(wireMessage.payloadMessage);\n\t\t\t\t}\n\t\t\t\tthis._schedule_message(wireMessage);\n\t\t\t} else {\n\t\t\t// Currently disconnected, will not schedule this message\n\t\t\t// Check if reconnecting is in progress and disconnected publish is enabled.\n\t\t\t\tif (this._reconnecting && this.disconnectedPublishing) {\n\t\t\t\t// Check the limit which include the \"required ACK\" messages\n\t\t\t\t\tvar messageCount = Object.keys(this._sentMessages).length + this._buffered_msg_queue.length;\n\t\t\t\t\tif (messageCount > this.disconnectedBufferSize) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.BUFFER_FULL, [this.disconnectedBufferSize]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\t\t// Mark this message as \"ACK required\"\n\t\t\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\t\t\t\t\tthis._buffered_msg_queue.unshift(wireMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.disconnect = function () {\n\t\t\tthis._trace(\"Client.disconnect\");\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// disconnect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tif (!this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connecting or connected\"]));\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.DISCONNECT);\n\n\t\t\t// Run the disconnected call back as soon as the message has been sent,\n\t\t\t// in case of a failure later on in the disconnect processing.\n\t\t\t// as a consequence, the _disconected call back may be run several times.\n\t\t\tthis._notify_msg_sent[wireMessage] = scope(this._disconnected, this);\n\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.getTraceLog = function () {\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tthis._trace(\"Client.getTraceLog\", new Date());\n\t\t\t\tthis._trace(\"Client.getTraceLog in flight messages\", this._sentMessages.length);\n\t\t\t\tfor (var key in this._sentMessages)\n\t\t\t\t\tthis._trace(\"_sentMessages \",key, this._sentMessages[key]);\n\t\t\t\tfor (var key in this._receivedMessages)\n\t\t\t\t\tthis._trace(\"_receivedMessages \",key, this._receivedMessages[key]);\n\n\t\t\t\treturn this._traceBuffer;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.startTrace = function () {\n\t\t\tif ( this._traceBuffer === null ) {\n\t\t\t\tthis._traceBuffer = [];\n\t\t\t}\n\t\t\tthis._trace(\"Client.startTrace\", new Date(), version);\n\t\t};\n\n\t\tClientImpl.prototype.stopTrace = function () {\n\t\t\tdelete this._traceBuffer;\n\t\t};\n\n\t\tClientImpl.prototype._doConnect = function (wsurl) {\n\t\t// When the socket is open, this client will send the CONNECT WireMessage using the saved parameters.\n\t\t\tif (this.connectOptions.useSSL) {\n\t\t\t\tvar uriParts = wsurl.split(\":\");\n\t\t\t\turiParts[0] = \"wss\";\n\t\t\t\twsurl = uriParts.join(\":\");\n\t\t\t}\n\t\t\tthis._wsuri = wsurl;\n\t\t\tthis.connected = false;\n\n\n\n\t\t\tif (this.connectOptions.mqttVersion < 4) {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqttv3.1\"]);\n\t\t\t} else {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqtt\"]);\n\t\t\t}\n\t\t\tthis.socket.binaryType = \"arraybuffer\";\n\t\t\tthis.socket.onopen = scope(this._on_socket_open, this);\n\t\t\tthis.socket.onmessage = scope(this._on_socket_message, this);\n\t\t\tthis.socket.onerror = scope(this._on_socket_error, this);\n\t\t\tthis.socket.onclose = scope(this._on_socket_close, this);\n\n\t\t\tthis.sendPinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tthis.receivePinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\t\t\tthis._connectTimeout = new Timeout(this, this.connectOptions.timeout, this._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);\n\t\t};\n\n\n\t\t// Schedule a new message to be sent over the WebSockets\n\t\t// connection. CONNECT messages cause WebSocket connection\n\t\t// to be started. All other messages are queued internally\n\t\t// until this has happened. When WS connection starts, process\n\t\t// all outstanding messages.\n\t\tClientImpl.prototype._schedule_message = function (message) {\n\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\tthis._msg_queue.unshift(message);\n\t\t\t// Process outstanding messages in the queue if we have an  open socket, and have received CONNACK.\n\t\t\tif (this.connected) {\n\t\t\t\tthis._process_queue();\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.store = function(prefix, wireMessage) {\n\t\t\tvar storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};\n\n\t\t\tswitch(wireMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif(wireMessage.pubRecReceived)\n\t\t\t\t\tstoredMessage.pubRecReceived = true;\n\n\t\t\t\t// Convert the payload to a hex string.\n\t\t\t\tstoredMessage.payloadMessage = {};\n\t\t\t\tvar hex = \"\";\n\t\t\t\tvar messageBytes = wireMessage.payloadMessage.payloadBytes;\n\t\t\t\tfor (var i=0; i<messageBytes.length; i++) {\n\t\t\t\t\tif (messageBytes[i] <= 0xF)\n\t\t\t\t\t\thex = hex+\"0\"+messageBytes[i].toString(16);\n\t\t\t\t\telse\n\t\t\t\t\t\thex = hex+messageBytes[i].toString(16);\n\t\t\t\t}\n\t\t\t\tstoredMessage.payloadMessage.payloadHex = hex;\n\n\t\t\t\tstoredMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;\n\t\t\t\tstoredMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;\n\t\t\t\tif (wireMessage.payloadMessage.duplicate)\n\t\t\t\t\tstoredMessage.payloadMessage.duplicate = true;\n\t\t\t\tif (wireMessage.payloadMessage.retained)\n\t\t\t\t\tstoredMessage.payloadMessage.retained = true;\n\n\t\t\t\t// Add a sequence number to sent messages.\n\t\t\t\tif ( prefix.indexOf(\"Sent:\") === 0 ) {\n\t\t\t\t\tif ( wireMessage.sequence === undefined )\n\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\tstoredMessage.sequence = wireMessage.sequence;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [prefix+this._localKey+wireMessage.messageIdentifier, storedMessage]));\n\t\t\t}\n\t\t\tlocalStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));\n\t\t};\n\n\t\tClientImpl.prototype.restore = function(key) {\n\t\t\tvar value = localStorage.getItem(key);\n\t\t\tvar storedMessage = JSON.parse(value);\n\n\t\t\tvar wireMessage = new WireMessage(storedMessage.type, storedMessage);\n\n\t\t\tswitch(storedMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// Replace the payload message with a Message object.\n\t\t\t\tvar hex = storedMessage.payloadMessage.payloadHex;\n\t\t\t\tvar buffer = new ArrayBuffer((hex.length)/2);\n\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (hex.length >= 2) {\n\t\t\t\t\tvar x = parseInt(hex.substring(0, 2), 16);\n\t\t\t\t\thex = hex.substring(2, hex.length);\n\t\t\t\t\tbyteStream[i++] = x;\n\t\t\t\t}\n\t\t\t\tvar payloadMessage = new Message(byteStream);\n\n\t\t\t\tpayloadMessage.qos = storedMessage.payloadMessage.qos;\n\t\t\t\tpayloadMessage.destinationName = storedMessage.payloadMessage.destinationName;\n\t\t\t\tif (storedMessage.payloadMessage.duplicate)\n\t\t\t\t\tpayloadMessage.duplicate = true;\n\t\t\t\tif (storedMessage.payloadMessage.retained)\n\t\t\t\t\tpayloadMessage.retained = true;\n\t\t\t\twireMessage.payloadMessage = payloadMessage;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [key, value]));\n\t\t\t}\n\n\t\t\tif (key.indexOf(\"Sent:\"+this._localKey) === 0) {\n\t\t\t\twireMessage.payloadMessage.duplicate = true;\n\t\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t} else if (key.indexOf(\"Received:\"+this._localKey) === 0) {\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._process_queue = function () {\n\t\t\tvar message = null;\n\n\t\t\t// Send all queued messages down socket connection\n\t\t\twhile ((message = this._msg_queue.pop())) {\n\t\t\t\tthis._socket_send(message);\n\t\t\t\t// Notify listeners that message was successfully sent\n\t\t\t\tif (this._notify_msg_sent[message]) {\n\t\t\t\t\tthis._notify_msg_sent[message]();\n\t\t\t\t\tdelete this._notify_msg_sent[message];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Expect an ACK response for this message. Add message to the set of in progress\n\t * messages and set an unused identifier in this message.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._requires_ack = function (wireMessage) {\n\t\t\tvar messageCount = Object.keys(this._sentMessages).length;\n\t\t\tif (messageCount > this.maxMessageIdentifier)\n\t\t\t\tthrow Error (\"Too many messages:\"+messageCount);\n\n\t\t\twhile(this._sentMessages[this._message_identifier] !== undefined) {\n\t\t\t\tthis._message_identifier++;\n\t\t\t}\n\t\t\twireMessage.messageIdentifier = this._message_identifier;\n\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\tif (wireMessage.type === MESSAGE_TYPE.PUBLISH) {\n\t\t\t\tthis.store(\"Sent:\", wireMessage);\n\t\t\t}\n\t\t\tif (this._message_identifier === this.maxMessageIdentifier) {\n\t\t\t\tthis._message_identifier = 1;\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has been opened.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_open = function () {\n\t\t// Create the CONNECT message object.\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.CONNECT, this.connectOptions);\n\t\t\twireMessage.clientId = this.clientId;\n\t\t\tthis._socket_send(wireMessage);\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has received a complete packet.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_message = function (event) {\n\t\t\tthis._trace(\"Client._on_socket_message\", event.data);\n\t\t\tvar messages = this._deframeMessages(event.data);\n\t\t\tfor (var i = 0; i < messages.length; i+=1) {\n\t\t\t\tthis._handleMessage(messages[i]);\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._deframeMessages = function(data) {\n\t\t\tvar byteArray = new Uint8Array(data);\n\t\t\tvar messages = [];\n\t\t\tif (this.receiveBuffer) {\n\t\t\t\tvar newData = new Uint8Array(this.receiveBuffer.length+byteArray.length);\n\t\t\t\tnewData.set(this.receiveBuffer);\n\t\t\t\tnewData.set(byteArray,this.receiveBuffer.length);\n\t\t\t\tbyteArray = newData;\n\t\t\t\tdelete this.receiveBuffer;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar offset = 0;\n\t\t\t\twhile(offset < byteArray.length) {\n\t\t\t\t\tvar result = decodeMessage(byteArray,offset);\n\t\t\t\t\tvar wireMessage = result[0];\n\t\t\t\t\toffset = result[1];\n\t\t\t\t\tif (wireMessage !== null) {\n\t\t\t\t\t\tmessages.push(wireMessage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (offset < byteArray.length) {\n\t\t\t\t\tthis.receiveBuffer = byteArray.subarray(offset);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn messages;\n\t\t};\n\n\t\tClientImpl.prototype._handleMessage = function(wireMessage) {\n\n\t\t\tthis._trace(\"Client._handleMessage\", wireMessage);\n\n\t\t\ttry {\n\t\t\t\tswitch(wireMessage.type) {\n\t\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\t\tif (this._reconnectTimeout)\n\t\t\t\t\t\tthis._reconnectTimeout.cancel();\n\n\t\t\t\t\t// If we have started using clean session then clear up the local state.\n\t\t\t\t\tif (this.connectOptions.cleanSession) {\n\t\t\t\t\t\tfor (var key in this._sentMessages) {\n\t\t\t\t\t\t\tvar sentMessage = this._sentMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+sentMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._sentMessages = {};\n\n\t\t\t\t\t\tfor (var key in this._receivedMessages) {\n\t\t\t\t\t\t\tvar receivedMessage = this._receivedMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+receivedMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._receivedMessages = {};\n\t\t\t\t\t}\n\t\t\t\t\t// Client connected and ready for business.\n\t\t\t\t\tif (wireMessage.returnCode === 0) {\n\n\t\t\t\t\t\tthis.connected = true;\n\t\t\t\t\t\t// Jump to the end of the list of uris and stop looking for a good host.\n\n\t\t\t\t\t\tif (this.connectOptions.uris)\n\t\t\t\t\t\t\tthis.hostIndex = this.connectOptions.uris.length;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Resend messages.\n\t\t\t\t\tvar sequencedMessages = [];\n\t\t\t\t\tfor (var msgId in this._sentMessages) {\n\t\t\t\t\t\tif (this._sentMessages.hasOwnProperty(msgId))\n\t\t\t\t\t\t\tsequencedMessages.push(this._sentMessages[msgId]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Also schedule qos 0 buffered messages if any\n\t\t\t\t\tif (this._buffered_msg_queue.length > 0) {\n\t\t\t\t\t\tvar msg = null;\n\t\t\t\t\t\twhile ((msg = this._buffered_msg_queue.pop())) {\n\t\t\t\t\t\t\tsequencedMessages.push(msg);\n\t\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\t\tthis._notify_msg_sent[msg] = this.onMessageDelivered(msg.payloadMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sort sentMessages into the original sent order.\n\t\t\t\t\tvar sequencedMessages = sequencedMessages.sort(function(a,b) {return a.sequence - b.sequence;} );\n\t\t\t\t\tfor (var i=0, len=sequencedMessages.length; i<len; i++) {\n\t\t\t\t\t\tvar sentMessage = sequencedMessages[i];\n\t\t\t\t\t\tif (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {\n\t\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});\n\t\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._schedule_message(sentMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the connectOptions.onSuccess callback if there is one.\n\t\t\t\t\t// Will also now return if this connection was the result of an automatic\n\t\t\t\t\t// reconnect and which URI was successfully connected to.\n\t\t\t\t\tif (this.connectOptions.onSuccess) {\n\t\t\t\t\t\tthis.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar reconnected = false;\n\t\t\t\t\tif (this._reconnecting) {\n\t\t\t\t\t\treconnected = true;\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnecting = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the onConnected callback if there is one.\n\t\t\t\t\tthis._connected(reconnected, this._wsuri);\n\n\t\t\t\t\t// Process all queued messages now that the connection is established.\n\t\t\t\t\tthis._process_queue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t\tthis._receivePublish(wireMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBACK after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREC:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBREC after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tsentMessage.pubRecReceived = true;\n\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\t\tthis.store(\"Sent:\", sentMessage);\n\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\t\tvar receivedMessage = this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t// If this is a re flow of a PUBREL after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (receivedMessage) {\n\t\t\t\t\t\tthis._receiveMessage(receivedMessage);\n\t\t\t\t\t\tdelete this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\t// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.\n\t\t\t\t\tvar pubCompMessage = new WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\tthis._schedule_message(pubCompMessage);\n\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.SUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif(sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\t// This will need to be fixed when we add multiple topic support\n\t\t\t\t\t\tif (wireMessage.returnCode[0] === 0x80) {\n\t\t\t\t\t\t\tif (sentMessage.onFailure) {\n\t\t\t\t\t\t\t\tsentMessage.onFailure(wireMessage.returnCode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (sentMessage.onSuccess) {\n\t\t\t\t\t\t\tsentMessage.onSuccess(wireMessage.returnCode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.UNSUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif (sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\tif (sentMessage.callback) {\n\t\t\t\t\t\t\tsentMessage.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PINGRESP:\n\t\t\t\t/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */\n\t\t\t\t\tthis.sendPinger.reset();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\t// Clients do not expect to receive disconnect packets.\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_error = function (error) {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_close = function () {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._socket_send = function (wireMessage) {\n\n\t\t\tif (wireMessage.type == 1) {\n\t\t\t\tvar wireMessageMasked = this._traceMask(wireMessage, \"password\");\n\t\t\t\tthis._trace(\"Client._socket_send\", wireMessageMasked);\n\t\t\t}\n\t\t\telse this._trace(\"Client._socket_send\", wireMessage);\n\n\t\t\tthis.socket.send(wireMessage.encode());\n\t\t\t/* We have proved to the server we are alive. */\n\t\t\tthis.sendPinger.reset();\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receivePublish = function (wireMessage) {\n\t\t\tswitch(wireMessage.payloadMessage.qos) {\n\t\t\tcase \"undefined\":\n\t\t\tcase 0:\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\tvar pubAckMessage = new WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubAckMessage);\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t\tthis.store(\"Received:\", wireMessage);\n\t\t\t\tvar pubRecMessage = new WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubRecMessage);\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(\"Invaild qos=\" + wireMessage.payloadMessage.qos);\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receiveMessage = function (wireMessage) {\n\t\t\tif (this.onMessageArrived) {\n\t\t\t\tthis.onMessageArrived(wireMessage.payloadMessage);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has connected.\n\t * @param {reconnect} [boolean] indicate if this was a result of reconnect operation.\n\t * @param {uri} [string] fully qualified WebSocket URI of the server.\n\t */\n\t\tClientImpl.prototype._connected = function (reconnect, uri) {\n\t\t// Execute the onConnected callback if there is one.\n\t\t\tif (this.onConnected)\n\t\t\t\tthis.onConnected(reconnect, uri);\n\t\t};\n\n\t\t/**\n\t * Attempts to reconnect the client to the server.\n   * For each reconnect attempt, will double the reconnect interval\n   * up to 128 seconds.\n\t */\n\t\tClientImpl.prototype._reconnect = function () {\n\t\t\tthis._trace(\"Client._reconnect\");\n\t\t\tif (!this.connected) {\n\t\t\t\tthis._reconnecting = true;\n\t\t\t\tthis.sendPinger.cancel();\n\t\t\t\tthis.receivePinger.cancel();\n\t\t\t\tif (this._reconnectInterval < 128)\n\t\t\t\t\tthis._reconnectInterval = this._reconnectInterval * 2;\n\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has disconnected either at its own request or because the server\n\t * or network disconnected it. Remove all non-durable state.\n\t * @param {errorCode} [number] the error number.\n\t * @param {errorText} [string] the error text.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._disconnected = function (errorCode, errorText) {\n\t\t\tthis._trace(\"Client._disconnected\", errorCode, errorText);\n\n\t\t\tif (errorCode !== undefined && this._reconnecting) {\n\t\t\t\t//Continue automatic reconnect process\n\t\t\t\tthis._reconnectTimeout = new Timeout(this, this._reconnectInterval, this._reconnect);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendPinger.cancel();\n\t\t\tthis.receivePinger.cancel();\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\n\t\t\t// Clear message buffers.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\tif (this.socket) {\n\t\t\t// Cancel all socket callbacks so that they cannot be driven again by this socket.\n\t\t\t\tthis.socket.onopen = null;\n\t\t\t\tthis.socket.onmessage = null;\n\t\t\t\tthis.socket.onerror = null;\n\t\t\t\tthis.socket.onclose = null;\n\t\t\t\tif (this.socket.readyState === 1)\n\t\t\t\t\tthis.socket.close();\n\t\t\t\tdelete this.socket;\n\t\t\t}\n\n\t\t\tif (this.connectOptions.uris && this.hostIndex < this.connectOptions.uris.length-1) {\n\t\t\t// Try the next host.\n\t\t\t\tthis.hostIndex++;\n\t\t\t\tthis._doConnect(this.connectOptions.uris[this.hostIndex]);\n\t\t\t} else {\n\n\t\t\t\tif (errorCode === undefined) {\n\t\t\t\t\terrorCode = ERROR.OK.code;\n\t\t\t\t\terrorText = format(ERROR.OK);\n\t\t\t\t}\n\n\t\t\t\t// Run any application callbacks last as they may attempt to reconnect and hence create a new socket.\n\t\t\t\tif (this.connected) {\n\t\t\t\t\tthis.connected = false;\n\t\t\t\t\t// Execute the connectionLostCallback if there is one, and we were connected.\n\t\t\t\t\tif (this.onConnectionLost) {\n\t\t\t\t\t\tthis.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:this.connectOptions.reconnect, uri:this._wsuri});\n\t\t\t\t\t}\n\t\t\t\t\tif (errorCode !== ERROR.OK.code && this.connectOptions.reconnect) {\n\t\t\t\t\t// Start automatic reconnect process for the very first time since last successful connect.\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnect();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t// Otherwise we never had a connection, so indicate that the connect has failed.\n\t\t\t\t\tif (this.connectOptions.mqttVersion === 4 && this.connectOptions.mqttVersionExplicit === false) {\n\t\t\t\t\t\tthis._trace(\"Failed to connect V4, dropping back to V3\");\n\t\t\t\t\t\tthis.connectOptions.mqttVersion = 3;\n\t\t\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(this.connectOptions.onFailure) {\n\t\t\t\t\t\tthis.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._trace = function () {\n\t\t// Pass trace message back to client's callback function\n\t\t\tif (this.traceFunction) {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\tfor (var i in args)\n\t\t\t\t{\n\t\t\t\t\tif (typeof args[i] !== \"undefined\")\n\t\t\t\t\t\targs.splice(i, 1, JSON.stringify(args[i]));\n\t\t\t\t}\n\t\t\t\tvar record = args.join(\"\");\n\t\t\t\tthis.traceFunction ({severity: \"Debug\", message: record\t});\n\t\t\t}\n\n\t\t\t//buffer style trace\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tfor (var i = 0, max = arguments.length; i < max; i++) {\n\t\t\t\t\tif ( this._traceBuffer.length == this._MAX_TRACE_ENTRIES ) {\n\t\t\t\t\t\tthis._traceBuffer.shift();\n\t\t\t\t\t}\n\t\t\t\t\tif (i === 0) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse if (typeof arguments[i] === \"undefined\" ) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse this._traceBuffer.push(\"  \"+JSON.stringify(arguments[i]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._traceMask = function (traceObject, masked) {\n\t\t\tvar traceObjectMasked = {};\n\t\t\tfor (var attr in traceObject) {\n\t\t\t\tif (traceObject.hasOwnProperty(attr)) {\n\t\t\t\t\tif (attr == masked)\n\t\t\t\t\t\ttraceObjectMasked[attr] = \"******\";\n\t\t\t\t\telse\n\t\t\t\t\t\ttraceObjectMasked[attr] = traceObject[attr];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn traceObjectMasked;\n\t\t};\n\n\t\t// ------------------------------------------------------------------------\n\t\t// Public Programming interface.\n\t\t// ------------------------------------------------------------------------\n\n\t\t/**\n\t * The JavaScript application communicates to the server using a {@link Paho.Client} object.\n\t * <p>\n\t * Most applications will create just one Client object and then call its connect() method,\n\t * however applications can create more than one Client object if they wish.\n\t * In this case the combination of host, port and clientId attributes must be different for each Client object.\n\t * <p>\n\t * The send, subscribe and unsubscribe methods are implemented as asynchronous JavaScript methods\n\t * (even though the underlying protocol exchange might be synchronous in nature).\n\t * This means they signal their completion by calling back to the application,\n\t * via Success or Failure callback functions provided by the application on the method in question.\n\t * Such callbacks are called at most once per method invocation and do not persist beyond the lifetime\n\t * of the script that made the invocation.\n\t * <p>\n\t * In contrast there are some callback functions, most notably <i>onMessageArrived</i>,\n\t * that are defined on the {@link Paho.Client} object.\n\t * These may get called multiple times, and aren't directly related to specific method invocations made by the client.\n\t *\n\t * @name Paho.Client\n\t *\n\t * @constructor\n\t *\n\t * @param {string} host - the address of the messaging server, as a fully qualified WebSocket URI, as a DNS name or dotted decimal IP address.\n\t * @param {number} port - the port number to connect to - only required if host is not a URI\n\t * @param {string} path - the path on the host to connect to - only used if host is not a URI. Default: '/mqtt'.\n\t * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters in length.\n\t *\n\t * @property {string} host - <i>read only</i> the server's DNS hostname or dotted decimal IP address.\n\t * @property {number} port - <i>read only</i> the server's port.\n\t * @property {string} path - <i>read only</i> the server's path.\n\t * @property {string} clientId - <i>read only</i> used when connecting to the server.\n\t * @property {function} onConnectionLost - called when a connection has been lost.\n\t *                            after a connect() method has succeeded.\n\t *                            Establish the call back used when a connection has been lost. The connection may be\n\t *                            lost because the client initiates a disconnect or because the server or network\n\t *                            cause the client to be disconnected. The disconnect call back may be called without\n\t *                            the connectionComplete call back being invoked if, for example the client fails to\n\t *                            connect.\n\t *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:\n\t *                            <ol>\n\t *                            <li>errorCode\n\t *                            <li>errorMessage\n\t *                            </ol>\n\t * @property {function} onMessageDelivered - called when a message has been delivered.\n\t *                            All processing that this Client will ever do has been completed. So, for example,\n\t *                            in the case of a Qos=2 message sent by this client, the PubComp flow has been received from the server\n\t *                            and the message has been removed from persistent storage before this callback is invoked.\n\t *                            Parameters passed to the onMessageDelivered callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that was delivered.\n\t *                            </ol>\n\t * @property {function} onMessageArrived - called when a message has arrived in this Paho.client.\n\t *                            Parameters passed to the onMessageArrived callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that has arrived.\n\t *                            </ol>\n\t * @property {function} onConnected - called when a connection is successfully made to the server.\n\t *                                  after a connect() method.\n\t *                                  Parameters passed to the onConnected callback are:\n\t *                                  <ol>\n\t *                                  <li>reconnect (boolean) - If true, the connection was the result of a reconnect.</li>\n\t *                                  <li>URI (string) - The URI used to connect to the server.</li>\n\t *                                  </ol>\n\t * @property {boolean} disconnectedPublishing - if set, will enable disconnected publishing in\n\t *                                            in the event that the connection to the server is lost.\n\t * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected\n\t *                                             buffer will hold before rejecting new messages. Default size: 5000 messages\n\t * @property {function} trace - called whenever trace is called. TODO\n\t */\n\t\tvar Client = function (host, port, path, clientId) {\n\n\t\t\tvar uri;\n\n\t\t\tif (typeof host !== \"string\")\n\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof host, \"host\"]));\n\n\t\t\tif (arguments.length == 2) {\n\t\t\t// host: must be full ws:// uri\n\t\t\t// port: clientId\n\t\t\t\tclientId = port;\n\t\t\t\turi = host;\n\t\t\t\tvar match = uri.match(/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/);\n\t\t\t\tif (match) {\n\t\t\t\t\thost = match[4]||match[2];\n\t\t\t\t\tport = parseInt(match[7]);\n\t\t\t\t\tpath = match[8];\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[host,\"host\"]));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (arguments.length == 3) {\n\t\t\t\t\tclientId = path;\n\t\t\t\t\tpath = \"/mqtt\";\n\t\t\t\t}\n\t\t\t\tif (typeof port !== \"number\" || port < 0)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof port, \"port\"]));\n\t\t\t\tif (typeof path !== \"string\")\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof path, \"path\"]));\n\n\t\t\t\tvar ipv6AddSBracket = (host.indexOf(\":\") !== -1 && host.slice(0,1) !== \"[\" && host.slice(-1) !== \"]\");\n\t\t\t\turi = \"ws://\"+(ipv6AddSBracket?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t}\n\n\t\t\tvar clientIdLength = 0;\n\t\t\tfor (var i = 0; i<clientId.length; i++) {\n\t\t\t\tvar charCode = clientId.charCodeAt(i);\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)  {\n\t\t\t\t\ti++; // Surrogate pair.\n\t\t\t\t}\n\t\t\t\tclientIdLength++;\n\t\t\t}\n\t\t\tif (typeof clientId !== \"string\" || clientIdLength > 65535)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [clientId, \"clientId\"]));\n\n\t\t\tvar client = new ClientImpl(uri, host, port, path, clientId);\n\n\t\t\t//Public Properties\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"host\":{\n\t\t\t\t\tget: function() { return host; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"port\":{\n\t\t\t\t\tget: function() { return port; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"path\":{\n\t\t\t\t\tget: function() { return path; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"uri\":{\n\t\t\t\t\tget: function() { return uri; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"clientId\":{\n\t\t\t\t\tget: function() { return client.clientId; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"onConnected\":{\n\t\t\t\t\tget: function() { return client.onConnected; },\n\t\t\t\t\tset: function(newOnConnected) {\n\t\t\t\t\t\tif (typeof newOnConnected === \"function\")\n\t\t\t\t\t\t\tclient.onConnected = newOnConnected;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnected, \"onConnected\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedPublishing\":{\n\t\t\t\t\tget: function() { return client.disconnectedPublishing; },\n\t\t\t\t\tset: function(newDisconnectedPublishing) {\n\t\t\t\t\t\tclient.disconnectedPublishing = newDisconnectedPublishing;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedBufferSize\":{\n\t\t\t\t\tget: function() { return client.disconnectedBufferSize; },\n\t\t\t\t\tset: function(newDisconnectedBufferSize) {\n\t\t\t\t\t\tclient.disconnectedBufferSize = newDisconnectedBufferSize;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onConnectionLost\":{\n\t\t\t\t\tget: function() { return client.onConnectionLost; },\n\t\t\t\t\tset: function(newOnConnectionLost) {\n\t\t\t\t\t\tif (typeof newOnConnectionLost === \"function\")\n\t\t\t\t\t\t\tclient.onConnectionLost = newOnConnectionLost;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnectionLost, \"onConnectionLost\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageDelivered\":{\n\t\t\t\t\tget: function() { return client.onMessageDelivered; },\n\t\t\t\t\tset: function(newOnMessageDelivered) {\n\t\t\t\t\t\tif (typeof newOnMessageDelivered === \"function\")\n\t\t\t\t\t\t\tclient.onMessageDelivered = newOnMessageDelivered;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageDelivered, \"onMessageDelivered\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageArrived\":{\n\t\t\t\t\tget: function() { return client.onMessageArrived; },\n\t\t\t\t\tset: function(newOnMessageArrived) {\n\t\t\t\t\t\tif (typeof newOnMessageArrived === \"function\")\n\t\t\t\t\t\t\tclient.onMessageArrived = newOnMessageArrived;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageArrived, \"onMessageArrived\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"trace\":{\n\t\t\t\t\tget: function() { return client.traceFunction; },\n\t\t\t\t\tset: function(trace) {\n\t\t\t\t\t\tif(typeof trace === \"function\"){\n\t\t\t\t\t\t\tclient.traceFunction = trace;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof trace, \"onTrace\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t/**\n\t\t * Connect this Messaging client to its server.\n\t\t *\n\t\t * @name Paho.Client#connect\n\t\t * @function\n\t\t * @param {object} connectOptions - Attributes used with the connection.\n\t\t * @param {number} connectOptions.timeout - If the connect has not succeeded within this\n\t\t *                    number of seconds, it is deemed to have failed.\n\t\t *                    The default is 30 seconds.\n\t\t * @param {string} connectOptions.userName - Authentication username for this connection.\n\t\t * @param {string} connectOptions.password - Authentication password for this connection.\n\t\t * @param {Paho.Message} connectOptions.willMessage - sent by the server when the client\n\t\t *                    disconnects abnormally.\n\t\t * @param {number} connectOptions.keepAliveInterval - the server disconnects this client if\n\t\t *                    there is no activity for this number of seconds.\n\t\t *                    The default value of 60 seconds is assumed if not set.\n\t\t * @param {boolean} connectOptions.cleanSession - if true(default) the client and server\n\t\t *                    persistent state is deleted on successful connect.\n\t\t * @param {boolean} connectOptions.useSSL - if present and true, use an SSL Websocket connection.\n\t\t * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.\n\t\t * @param {function} connectOptions.onSuccess - called when the connect acknowledgement\n\t\t *                    has been received from the server.\n\t\t * A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onSuccess method in the connectOptions.\n\t\t * </ol>\n\t * @param {function} connectOptions.onFailure - called when the connect request has failed or timed out.\n\t\t * A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onFailure method in the connectOptions.\n\t\t * <li>errorCode a number indicating the nature of the error.\n\t\t * <li>errorMessage text describing the error.\n\t\t * </ol>\n\t * @param {array} connectOptions.hosts - If present this contains either a set of hostnames or fully qualified\n\t\t * WebSocket URIs (ws://iot.eclipse.org:80/ws), that are tried in order in place\n\t\t * of the host and port paramater on the construtor. The hosts are tried one at at time in order until\n\t\t * one of then succeeds.\n\t * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, this property\n\t\t * is not used.\n\t * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect\n\t * to the server if the connection is lost.\n\t *<ul>\n\t *<li>If set to false, the client will not attempt to automatically reconnect to the server in the event that the\n\t * connection is lost.</li>\n\t *<li>If set to true, in the event that the connection is lost, the client will attempt to reconnect to the server.\n\t * It will initially wait 1 second before it attempts to reconnect, for every failed reconnect attempt, the delay\n\t * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.</li>\n\t *</ul>\n\t * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.\n\t *<ul>\n\t *<li>3 - MQTT V3.1</li>\n\t *<li>4 - MQTT V3.1.1</li>\n\t *</ul>\n\t * @param {boolean} connectOptions.mqttVersionExplicit - If set to true, will force the connection to use the\n\t * selected MQTT Version or will fail to connect.\n\t * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris\n\t * (e.g. ws://iot.eclipse.org:80/ws), that are tried in order in place of the host and port parameter of the construtor.\n\t * The uris are tried one at a time in order until one of them succeeds. Do not use this in conjunction with hosts as\n\t * the hosts array will be converted to uris and will overwrite this property.\n\t\t * @throws {InvalidState} If the client is not in disconnected state. The client must have received connectionLost\n\t\t * or disconnected before calling connect for a second or subsequent time.\n\t\t */\n\t\t\tthis.connect = function (connectOptions) {\n\t\t\t\tconnectOptions = connectOptions || {} ;\n\t\t\t\tvalidate(connectOptions,  {timeout:\"number\",\n\t\t\t\t\tuserName:\"string\",\n\t\t\t\t\tpassword:\"string\",\n\t\t\t\t\twillMessage:\"object\",\n\t\t\t\t\tkeepAliveInterval:\"number\",\n\t\t\t\t\tcleanSession:\"boolean\",\n\t\t\t\t\tuseSSL:\"boolean\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\thosts:\"object\",\n\t\t\t\t\tports:\"object\",\n\t\t\t\t\treconnect:\"boolean\",\n\t\t\t\t\tmqttVersion:\"number\",\n\t\t\t\t\tmqttVersionExplicit:\"boolean\",\n\t\t\t\t\turis: \"object\"});\n\n\t\t\t\t// If no keep alive interval is set, assume 60 seconds.\n\t\t\t\tif (connectOptions.keepAliveInterval === undefined)\n\t\t\t\t\tconnectOptions.keepAliveInterval = 60;\n\n\t\t\t\tif (connectOptions.mqttVersion > 4 || connectOptions.mqttVersion < 3) {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, \"connectOptions.mqttVersion\"]));\n\t\t\t\t}\n\n\t\t\t\tif (connectOptions.mqttVersion === undefined) {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = false;\n\t\t\t\t\tconnectOptions.mqttVersion = 4;\n\t\t\t\t} else {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = true;\n\t\t\t\t}\n\n\t\t\t\t//Check that if password is set, so is username\n\t\t\t\tif (connectOptions.password !== undefined && connectOptions.userName === undefined)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, \"connectOptions.password\"]));\n\n\t\t\t\tif (connectOptions.willMessage) {\n\t\t\t\t\tif (!(connectOptions.willMessage instanceof Message))\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, \"connectOptions.willMessage\"]));\n\t\t\t\t\t// The will message must have a payload that can be represented as a string.\n\t\t\t\t\t// Cause the willMessage to throw an exception if this is not the case.\n\t\t\t\t\tconnectOptions.willMessage.stringPayload = null;\n\n\t\t\t\t\tif (typeof connectOptions.willMessage.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.willMessage.destinationName, \"connectOptions.willMessage.destinationName\"]));\n\t\t\t\t}\n\t\t\t\tif (typeof connectOptions.cleanSession === \"undefined\")\n\t\t\t\t\tconnectOptions.cleanSession = true;\n\t\t\t\tif (connectOptions.hosts) {\n\n\t\t\t\t\tif (!(connectOptions.hosts instanceof Array) )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\t\t\t\t\tif (connectOptions.hosts.length <1 )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\n\t\t\t\t\tvar usingURIs = false;\n\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\tif (typeof connectOptions.hosts[i] !== \"string\")\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\tif (/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/.test(connectOptions.hosts[i])) {\n\t\t\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\t\t\tusingURIs = true;\n\t\t\t\t\t\t\t} else if (!usingURIs) {\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (usingURIs) {\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!usingURIs) {\n\t\t\t\t\t\tif (!connectOptions.ports)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (!(connectOptions.ports instanceof Array) )\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (connectOptions.hosts.length !== connectOptions.ports.length)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\n\t\t\t\t\t\tconnectOptions.uris = [];\n\n\t\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\t\tif (typeof connectOptions.ports[i] !== \"number\" || connectOptions.ports[i] < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.ports[i], \"connectOptions.ports[\"+i+\"]\"]));\n\t\t\t\t\t\t\tvar host = connectOptions.hosts[i];\n\t\t\t\t\t\t\tvar port = connectOptions.ports[i];\n\n\t\t\t\t\t\t\tvar ipv6 = (host.indexOf(\":\") !== -1);\n\t\t\t\t\t\t\turi = \"ws://\"+(ipv6?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t\t\t\t\tconnectOptions.uris.push(uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconnectOptions.uris = connectOptions.hosts;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tclient.connect(connectOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Subscribe for messages, request receipt of a copy of messages sent to the destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#subscribe\n\t\t * @function\n\t\t * @param {string} filter describing the destinations to receive messages from.\n\t\t * <br>\n\t\t * @param {object} subscribeOptions - used to control the subscription\n\t\t *\n\t\t * @param {number} subscribeOptions.qos - the maximum qos of any publications sent\n\t\t *                                  as a result of making this subscription.\n\t\t * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t *                                  or onFailure callback.\n\t\t * @param {function} subscribeOptions.onSuccess - called when the subscribe acknowledgement\n\t\t *                                  has been received from the server.\n\t\t *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext if set in the subscribeOptions.\n\t\t *                                  </ol>\n\t\t * @param {function} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.\n\t\t *                                  A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext - if set in the subscribeOptions.\n\t\t *                                  <li>errorCode - a number indicating the nature of the error.\n\t\t *                                  <li>errorMessage - text describing the error.\n\t\t *                                  </ol>\n\t\t * @param {number} subscribeOptions.timeout - which, if present, determines the number of\n\t\t *                                  seconds after which the onFailure calback is called.\n\t\t *                                  The presence of a timeout does not prevent the onSuccess\n\t\t *                                  callback from being called when the subscribe completes.\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.subscribe = function (filter, subscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tsubscribeOptions = subscribeOptions || {} ;\n\t\t\t\tvalidate(subscribeOptions,  {qos:\"number\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (subscribeOptions.timeout && !subscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"subscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tif (typeof subscribeOptions.qos !== \"undefined\" && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, \"subscribeOptions.qos\"]));\n\t\t\t\tclient.subscribe(filter, subscribeOptions);\n\t\t\t};\n\n\t\t/**\n\t\t * Unsubscribe for messages, stop receiving messages sent to destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#unsubscribe\n\t\t * @function\n\t\t * @param {string} filter - describing the destinations to receive messages from.\n\t\t * @param {object} unsubscribeOptions - used to control the subscription\n\t\t * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t\t\t\t\t\t\t\t\t\t  or onFailure callback.\n\t\t * @param {function} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received from the server.\n\t\t *                                    A single response object parameter is passed to the\n\t\t *                                    onSuccess callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    </ol>\n\t\t * @param {function} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.\n\t\t *                                    A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    <li>errorCode - a number indicating the nature of the error.\n\t\t *                                    <li>errorMessage - text describing the error.\n\t\t *                                    </ol>\n\t\t * @param {number} unsubscribeOptions.timeout - which, if present, determines the number of seconds\n\t\t *                                    after which the onFailure callback is called. The presence of\n\t\t *                                    a timeout does not prevent the onSuccess callback from being\n\t\t *                                    called when the unsubscribe completes\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.unsubscribe = function (filter, unsubscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tunsubscribeOptions = unsubscribeOptions || {} ;\n\t\t\t\tvalidate(unsubscribeOptions,  {invocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"unsubscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tclient.unsubscribe(filter, unsubscribeOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Send a message to the consumers of the destination in the Message.\n\t\t *\n\t\t * @name Paho.Client#send\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the destination to which the message is to be sent.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be sent.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.send = function (topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Publish a message to the consumers of the destination in the Message.\n\t\t * Synonym for Paho.Mqtt.Client#send\n\t\t *\n\t\t * @name Paho.Client#publish\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the topic to which the message is to be published.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be published.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.publish = function(topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Normal disconnect of this Messaging client from its server.\n\t\t *\n\t\t * @name Paho.Client#disconnect\n\t\t * @function\n\t\t * @throws {InvalidState} if the client is already disconnected.\n\t\t */\n\t\t\tthis.disconnect = function () {\n\t\t\t\tclient.disconnect();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Get the contents of the trace log.\n\t\t *\n\t\t * @name Paho.Client#getTraceLog\n\t\t * @function\n\t\t * @return {Object[]} tracebuffer containing the time ordered trace records.\n\t\t */\n\t\t\tthis.getTraceLog = function () {\n\t\t\t\treturn client.getTraceLog();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Start tracing.\n\t\t *\n\t\t * @name Paho.Client#startTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.startTrace = function () {\n\t\t\t\tclient.startTrace();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Stop tracing.\n\t\t *\n\t\t * @name Paho.Client#stopTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.stopTrace = function () {\n\t\t\t\tclient.stopTrace();\n\t\t\t};\n\n\t\t\tthis.isConnected = function() {\n\t\t\t\treturn client.connected;\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * An application message, sent or received.\n\t * <p>\n\t * All attributes may be null, which implies the default values.\n\t *\n\t * @name Paho.Message\n\t * @constructor\n\t * @param {String|ArrayBuffer} payload The message data to be sent.\n\t * <p>\n\t * @property {string} payloadString <i>read only</i> The payload as a string if the payload consists of valid UTF-8 characters.\n\t * @property {ArrayBuffer} payloadBytes <i>read only</i> The payload as an ArrayBuffer.\n\t * <p>\n\t * @property {string} destinationName <b>mandatory</b> The name of the destination to which the message is to be sent\n\t *                    (for messages about to be sent) or the name of the destination from which the message has been received.\n\t *                    (for messages received by the onMessage function).\n\t * <p>\n\t * @property {number} qos The Quality of Service used to deliver the message.\n\t * <dl>\n\t *     <dt>0 Best effort (default).\n\t *     <dt>1 At least once.\n\t *     <dt>2 Exactly once.\n\t * </dl>\n\t * <p>\n\t * @property {Boolean} retained If true, the message is to be retained by the server and delivered\n\t *                     to both current and future subscriptions.\n\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t *                     A received message has the retained boolean set to true if the message was published\n\t *                     with the retained boolean set to true\n\t *                     and the subscrption was made after the message has been published.\n\t * <p>\n\t * @property {Boolean} duplicate <i>read only</i> If true, this message might be a duplicate of one which has already been received.\n\t *                     This is only set on messages received from the server.\n\t *\n\t */\n\t\tvar Message = function (newPayload) {\n\t\t\tvar payload;\n\t\t\tif (   typeof newPayload === \"string\" ||\n\t\tnewPayload instanceof ArrayBuffer ||\n\t\t(ArrayBuffer.isView(newPayload) && !(newPayload instanceof DataView))\n\t\t\t) {\n\t\t\t\tpayload = newPayload;\n\t\t\t} else {\n\t\t\t\tthrow (format(ERROR.INVALID_ARGUMENT, [newPayload, \"newPayload\"]));\n\t\t\t}\n\n\t\t\tvar destinationName;\n\t\t\tvar qos = 0;\n\t\t\tvar retained = false;\n\t\t\tvar duplicate = false;\n\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"payloadString\":{\n\t\t\t\t\tenumerable : true,\n\t\t\t\t\tget : function () {\n\t\t\t\t\t\tif (typeof payload === \"string\")\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn parseUTF8(payload, 0, payload.length);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"payloadBytes\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\tif (typeof payload === \"string\") {\n\t\t\t\t\t\t\tvar buffer = new ArrayBuffer(UTF8Length(payload));\n\t\t\t\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\t\t\t\tstringToUTF8(payload, byteStream, 0);\n\n\t\t\t\t\t\t\treturn byteStream;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"destinationName\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newDestinationName) {\n\t\t\t\t\t\tif (typeof newDestinationName === \"string\")\n\t\t\t\t\t\t\tdestinationName = newDestinationName;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, \"newDestinationName\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"qos\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return qos; },\n\t\t\t\t\tset: function(newQos) {\n\t\t\t\t\t\tif (newQos === 0 || newQos === 1 || newQos === 2 )\n\t\t\t\t\t\t\tqos = newQos;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+newQos);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"retained\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return retained; },\n\t\t\t\t\tset: function(newRetained) {\n\t\t\t\t\t\tif (typeof newRetained === \"boolean\")\n\t\t\t\t\t\t\tretained = newRetained;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newRetained, \"newRetained\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"topic\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newTopic) {destinationName=newTopic;}\n\t\t\t\t},\n\t\t\t\t\"duplicate\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return duplicate; },\n\t\t\t\t\tset: function(newDuplicate) {duplicate=newDuplicate;}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// Module contents.\n\t\treturn {\n\t\t\tClient: Client,\n\t\t\tMessage: Message\n\t\t};\n\t// eslint-disable-next-line no-nested-ternary\n\t})(typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {});\n\treturn PahoMQTT;\n});\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar punycode = require('punycode');\nvar util = require('./util');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__10__;","module.exports = __WEBPACK_EXTERNAL_MODULE__11__;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Observable = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// === Symbol Support ===\nvar hasSymbols = function () {\n  return typeof Symbol === 'function';\n};\n\nvar hasSymbol = function (name) {\n  return hasSymbols() && Boolean(Symbol[name]);\n};\n\nvar getSymbol = function (name) {\n  return hasSymbol(name) ? Symbol[name] : '@@' + name;\n};\n\nif (hasSymbols() && !hasSymbol('observable')) {\n  Symbol.observable = Symbol('observable');\n}\n\nvar SymbolIterator = getSymbol('iterator');\nvar SymbolObservable = getSymbol('observable');\nvar SymbolSpecies = getSymbol('species'); // === Abstract Operations ===\n\nfunction getMethod(obj, key) {\n  var value = obj[key];\n  if (value == null) return undefined;\n  if (typeof value !== 'function') throw new TypeError(value + ' is not a function');\n  return value;\n}\n\nfunction getSpecies(obj) {\n  var ctor = obj.constructor;\n\n  if (ctor !== undefined) {\n    ctor = ctor[SymbolSpecies];\n\n    if (ctor === null) {\n      ctor = undefined;\n    }\n  }\n\n  return ctor !== undefined ? ctor : Observable;\n}\n\nfunction isObservable(x) {\n  return x instanceof Observable; // SPEC: Brand check\n}\n\nfunction hostReportError(e) {\n  if (hostReportError.log) {\n    hostReportError.log(e);\n  } else {\n    setTimeout(function () {\n      throw e;\n    });\n  }\n}\n\nfunction enqueue(fn) {\n  Promise.resolve().then(function () {\n    try {\n      fn();\n    } catch (e) {\n      hostReportError(e);\n    }\n  });\n}\n\nfunction cleanupSubscription(subscription) {\n  var cleanup = subscription._cleanup;\n  if (cleanup === undefined) return;\n  subscription._cleanup = undefined;\n\n  if (!cleanup) {\n    return;\n  }\n\n  try {\n    if (typeof cleanup === 'function') {\n      cleanup();\n    } else {\n      var unsubscribe = getMethod(cleanup, 'unsubscribe');\n\n      if (unsubscribe) {\n        unsubscribe.call(cleanup);\n      }\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n}\n\nfunction closeSubscription(subscription) {\n  subscription._observer = undefined;\n  subscription._queue = undefined;\n  subscription._state = 'closed';\n}\n\nfunction flushSubscription(subscription) {\n  var queue = subscription._queue;\n\n  if (!queue) {\n    return;\n  }\n\n  subscription._queue = undefined;\n  subscription._state = 'ready';\n\n  for (var i = 0; i < queue.length; ++i) {\n    notifySubscription(subscription, queue[i].type, queue[i].value);\n    if (subscription._state === 'closed') break;\n  }\n}\n\nfunction notifySubscription(subscription, type, value) {\n  subscription._state = 'running';\n  var observer = subscription._observer;\n\n  try {\n    var m = getMethod(observer, type);\n\n    switch (type) {\n      case 'next':\n        if (m) m.call(observer, value);\n        break;\n\n      case 'error':\n        closeSubscription(subscription);\n        if (m) m.call(observer, value);else throw value;\n        break;\n\n      case 'complete':\n        closeSubscription(subscription);\n        if (m) m.call(observer);\n        break;\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n\n  if (subscription._state === 'closed') cleanupSubscription(subscription);else if (subscription._state === 'running') subscription._state = 'ready';\n}\n\nfunction onNotify(subscription, type, value) {\n  if (subscription._state === 'closed') return;\n\n  if (subscription._state === 'buffering') {\n    subscription._queue.push({\n      type: type,\n      value: value\n    });\n\n    return;\n  }\n\n  if (subscription._state !== 'ready') {\n    subscription._state = 'buffering';\n    subscription._queue = [{\n      type: type,\n      value: value\n    }];\n    enqueue(function () {\n      return flushSubscription(subscription);\n    });\n    return;\n  }\n\n  notifySubscription(subscription, type, value);\n}\n\nvar Subscription =\n/*#__PURE__*/\nfunction () {\n  function Subscription(observer, subscriber) {\n    _classCallCheck(this, Subscription);\n\n    // ASSERT: observer is an object\n    // ASSERT: subscriber is callable\n    this._cleanup = undefined;\n    this._observer = observer;\n    this._queue = undefined;\n    this._state = 'initializing';\n    var subscriptionObserver = new SubscriptionObserver(this);\n\n    try {\n      this._cleanup = subscriber.call(undefined, subscriptionObserver);\n    } catch (e) {\n      subscriptionObserver.error(e);\n    }\n\n    if (this._state === 'initializing') this._state = 'ready';\n  }\n\n  _createClass(Subscription, [{\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      if (this._state !== 'closed') {\n        closeSubscription(this);\n        cleanupSubscription(this);\n      }\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._state === 'closed';\n    }\n  }]);\n\n  return Subscription;\n}();\n\nvar SubscriptionObserver =\n/*#__PURE__*/\nfunction () {\n  function SubscriptionObserver(subscription) {\n    _classCallCheck(this, SubscriptionObserver);\n\n    this._subscription = subscription;\n  }\n\n  _createClass(SubscriptionObserver, [{\n    key: \"next\",\n    value: function next(value) {\n      onNotify(this._subscription, 'next', value);\n    }\n  }, {\n    key: \"error\",\n    value: function error(value) {\n      onNotify(this._subscription, 'error', value);\n    }\n  }, {\n    key: \"complete\",\n    value: function complete() {\n      onNotify(this._subscription, 'complete');\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._subscription._state === 'closed';\n    }\n  }]);\n\n  return SubscriptionObserver;\n}();\n\nvar Observable =\n/*#__PURE__*/\nfunction () {\n  function Observable(subscriber) {\n    _classCallCheck(this, Observable);\n\n    if (!(this instanceof Observable)) throw new TypeError('Observable cannot be called as a function');\n    if (typeof subscriber !== 'function') throw new TypeError('Observable initializer must be a function');\n    this._subscriber = subscriber;\n  }\n\n  _createClass(Observable, [{\n    key: \"subscribe\",\n    value: function subscribe(observer) {\n      if (typeof observer !== 'object' || observer === null) {\n        observer = {\n          next: observer,\n          error: arguments[1],\n          complete: arguments[2]\n        };\n      }\n\n      return new Subscription(observer, this._subscriber);\n    }\n  }, {\n    key: \"forEach\",\n    value: function forEach(fn) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (typeof fn !== 'function') {\n          reject(new TypeError(fn + ' is not a function'));\n          return;\n        }\n\n        function done() {\n          subscription.unsubscribe();\n          resolve();\n        }\n\n        var subscription = _this.subscribe({\n          next: function (value) {\n            try {\n              fn(value, done);\n            } catch (e) {\n              reject(e);\n              subscription.unsubscribe();\n            }\n          },\n          error: reject,\n          complete: resolve\n        });\n      });\n    }\n  }, {\n    key: \"map\",\n    value: function map(fn) {\n      var _this2 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this2.subscribe({\n          next: function (value) {\n            try {\n              value = fn(value);\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(fn) {\n      var _this3 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this3.subscribe({\n          next: function (value) {\n            try {\n              if (!fn(value)) return;\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"reduce\",\n    value: function reduce(fn) {\n      var _this4 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      var hasSeed = arguments.length > 1;\n      var hasValue = false;\n      var seed = arguments[1];\n      var acc = seed;\n      return new C(function (observer) {\n        return _this4.subscribe({\n          next: function (value) {\n            var first = !hasValue;\n            hasValue = true;\n\n            if (!first || hasSeed) {\n              try {\n                acc = fn(acc, value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            } else {\n              acc = value;\n            }\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            if (!hasValue && !hasSeed) return observer.error(new TypeError('Cannot reduce an empty sequence'));\n            observer.next(acc);\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"concat\",\n    value: function concat() {\n      var _this5 = this;\n\n      for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\n        sources[_key] = arguments[_key];\n      }\n\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscription;\n        var index = 0;\n\n        function startNext(next) {\n          subscription = next.subscribe({\n            next: function (v) {\n              observer.next(v);\n            },\n            error: function (e) {\n              observer.error(e);\n            },\n            complete: function () {\n              if (index === sources.length) {\n                subscription = undefined;\n                observer.complete();\n              } else {\n                startNext(C.from(sources[index++]));\n              }\n            }\n          });\n        }\n\n        startNext(_this5);\n        return function () {\n          if (subscription) {\n            subscription.unsubscribe();\n            subscription = undefined;\n          }\n        };\n      });\n    }\n  }, {\n    key: \"flatMap\",\n    value: function flatMap(fn) {\n      var _this6 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscriptions = [];\n\n        var outer = _this6.subscribe({\n          next: function (value) {\n            if (fn) {\n              try {\n                value = fn(value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            }\n\n            var inner = C.from(value).subscribe({\n              next: function (value) {\n                observer.next(value);\n              },\n              error: function (e) {\n                observer.error(e);\n              },\n              complete: function () {\n                var i = subscriptions.indexOf(inner);\n                if (i >= 0) subscriptions.splice(i, 1);\n                completeIfDone();\n              }\n            });\n            subscriptions.push(inner);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            completeIfDone();\n          }\n        });\n\n        function completeIfDone() {\n          if (outer.closed && subscriptions.length === 0) observer.complete();\n        }\n\n        return function () {\n          subscriptions.forEach(function (s) {\n            return s.unsubscribe();\n          });\n          outer.unsubscribe();\n        };\n      });\n    }\n  }, {\n    key: SymbolObservable,\n    value: function () {\n      return this;\n    }\n  }], [{\n    key: \"from\",\n    value: function from(x) {\n      var C = typeof this === 'function' ? this : Observable;\n      if (x == null) throw new TypeError(x + ' is not an object');\n      var method = getMethod(x, SymbolObservable);\n\n      if (method) {\n        var observable = method.call(x);\n        if (Object(observable) !== observable) throw new TypeError(observable + ' is not an object');\n        if (isObservable(observable) && observable.constructor === C) return observable;\n        return new C(function (observer) {\n          return observable.subscribe(observer);\n        });\n      }\n\n      if (hasSymbol('iterator')) {\n        method = getMethod(x, SymbolIterator);\n\n        if (method) {\n          return new C(function (observer) {\n            enqueue(function () {\n              if (observer.closed) return;\n              var _iteratorNormalCompletion = true;\n              var _didIteratorError = false;\n              var _iteratorError = undefined;\n\n              try {\n                for (var _iterator = method.call(x)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  var _item = _step.value;\n                  observer.next(_item);\n                  if (observer.closed) return;\n                }\n              } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion && _iterator.return != null) {\n                    _iterator.return();\n                  }\n                } finally {\n                  if (_didIteratorError) {\n                    throw _iteratorError;\n                  }\n                }\n              }\n\n              observer.complete();\n            });\n          });\n        }\n      }\n\n      if (Array.isArray(x)) {\n        return new C(function (observer) {\n          enqueue(function () {\n            if (observer.closed) return;\n\n            for (var i = 0; i < x.length; ++i) {\n              observer.next(x[i]);\n              if (observer.closed) return;\n            }\n\n            observer.complete();\n          });\n        });\n      }\n\n      throw new TypeError(x + ' is not observable');\n    }\n  }, {\n    key: \"of\",\n    value: function of() {\n      for (var _len2 = arguments.length, items = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        items[_key2] = arguments[_key2];\n      }\n\n      var C = typeof this === 'function' ? this : Observable;\n      return new C(function (observer) {\n        enqueue(function () {\n          if (observer.closed) return;\n\n          for (var i = 0; i < items.length; ++i) {\n            observer.next(items[i]);\n            if (observer.closed) return;\n          }\n\n          observer.complete();\n        });\n      });\n    }\n  }, {\n    key: SymbolSpecies,\n    get: function () {\n      return this;\n    }\n  }]);\n\n  return Observable;\n}();\n\nexports.Observable = Observable;\n\nif (hasSymbols()) {\n  Object.defineProperty(Observable, Symbol('extensions'), {\n    value: {\n      symbol: SymbolObservable,\n      hostReportError: hostReportError\n    },\n    configurable: true\n  });\n}","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/uuidjs/uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","'use strict';\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","import zenObservable from 'zen-observable';\n\nvar Observable = zenObservable;\n\nexport default Observable;\nexport { Observable };\n//# sourceMappingURL=bundle.esm.js.map\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('AbstractPubSubProvider');\nvar AbstractPubSubProvider = /** @class */ (function () {\n    function AbstractPubSubProvider(options) {\n        if (options === void 0) { options = {}; }\n        this._config = options;\n    }\n    AbstractPubSubProvider.prototype.configure = function (config) {\n        if (config === void 0) { config = {}; }\n        this._config = __assign(__assign({}, config), this._config);\n        logger.debug(\"configure \" + this.getProviderName(), this._config);\n        return this.options;\n    };\n    AbstractPubSubProvider.prototype.getCategory = function () {\n        return 'PubSub';\n    };\n    Object.defineProperty(AbstractPubSubProvider.prototype, \"options\", {\n        get: function () {\n            return __assign({}, this._config);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AbstractPubSubProvider;\n}());\nexport { AbstractPubSubProvider };\n//# sourceMappingURL=PubSubProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport * as Paho from 'paho-mqtt';\nimport { v4 as uuid } from 'uuid';\nimport Observable from 'zen-observable-ts';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('MqttOverWSProvider');\nexport function mqttTopicMatch(filter, topic) {\n    var filterArray = filter.split('/');\n    var length = filterArray.length;\n    var topicArray = topic.split('/');\n    for (var i = 0; i < length; ++i) {\n        var left = filterArray[i];\n        var right = topicArray[i];\n        if (left === '#')\n            return topicArray.length >= length;\n        if (left !== '+' && left !== right)\n            return false;\n    }\n    return length === topicArray.length;\n}\nvar ClientsQueue = /** @class */ (function () {\n    function ClientsQueue() {\n        this.promises = new Map();\n    }\n    ClientsQueue.prototype.get = function (clientId, clientFactory) {\n        return __awaiter(this, void 0, void 0, function () {\n            var promise;\n            return __generator(this, function (_a) {\n                promise = this.promises.get(clientId);\n                if (promise) {\n                    return [2 /*return*/, promise];\n                }\n                promise = clientFactory(clientId);\n                this.promises.set(clientId, promise);\n                return [2 /*return*/, promise];\n            });\n        });\n    };\n    Object.defineProperty(ClientsQueue.prototype, \"allClients\", {\n        get: function () {\n            return Array.from(this.promises.keys());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ClientsQueue.prototype.remove = function (clientId) {\n        this.promises.delete(clientId);\n    };\n    return ClientsQueue;\n}());\nvar topicSymbol = typeof Symbol !== 'undefined' ? Symbol('topic') : '@@topic';\nvar MqttOverWSProvider = /** @class */ (function (_super) {\n    __extends(MqttOverWSProvider, _super);\n    function MqttOverWSProvider(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, __assign(__assign({}, options), { clientId: options.clientId || uuid() })) || this;\n        _this._clientsQueue = new ClientsQueue();\n        _this._topicObservers = new Map();\n        _this._clientIdObservers = new Map();\n        return _this;\n    }\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientId\", {\n        get: function () {\n            return this.options.clientId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"endpoint\", {\n        get: function () {\n            return this.options.aws_pubsub_endpoint;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientsQueue\", {\n        get: function () {\n            return this._clientsQueue;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MqttOverWSProvider.prototype.getTopicForValue = function (value) {\n        return typeof value === 'object' && value[topicSymbol];\n    };\n    MqttOverWSProvider.prototype.getProviderName = function () {\n        return 'MqttOverWSProvider';\n    };\n    MqttOverWSProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            logger.warn(clientId, JSON.stringify(__assign({ errorCode: errorCode }, args), null, 2));\n            var topicsToDelete_1 = [];\n            var clientIdObservers = this._clientIdObservers.get(clientId);\n            if (!clientIdObservers) {\n                return;\n            }\n            clientIdObservers.forEach(function (observer) {\n                observer.error('Disconnected, error code: ' + errorCode);\n                // removing observers for disconnected clientId\n                _this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                    observerForTopic.delete(observer);\n                    if (observerForTopic.size === 0) {\n                        topicsToDelete_1.push(observerTopic);\n                    }\n                });\n            });\n            // forgiving any trace of clientId\n            this._clientIdObservers.delete(clientId);\n            // Removing topics that are not listen by an observer\n            topicsToDelete_1.forEach(function (topic) {\n                _this._topicObservers.delete(topic);\n            });\n        }\n    };\n    MqttOverWSProvider.prototype.newClient = function (_a) {\n        var url = _a.url, clientId = _a.clientId;\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug('Creating new MQTT client', clientId);\n                        client = new Paho.Client(url, clientId);\n                        // client.trace = (args) => logger.debug(clientId, JSON.stringify(args, null, 2));\n                        client.onMessageArrived = function (_a) {\n                            var topic = _a.destinationName, msg = _a.payloadString;\n                            _this._onMessage(topic, msg);\n                        };\n                        client.onConnectionLost = function (_a) {\n                            var errorCode = _a.errorCode, args = __rest(_a, [\"errorCode\"]);\n                            _this.onDisconnect(__assign({ clientId: clientId, errorCode: errorCode }, args));\n                        };\n                        return [4 /*yield*/, new Promise(function (resolve, reject) {\n                                client.connect({\n                                    useSSL: _this.isSSLEnabled,\n                                    mqttVersion: 3,\n                                    onSuccess: function () { return resolve(client); },\n                                    onFailure: reject,\n                                });\n                            })];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/, client];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.connect = function (clientId, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function (clientId) {\n                            return _this.newClient(__assign(__assign({}, options), { clientId: clientId }));\n                        })];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        if (client && client.isConnected()) {\n                            client.disconnect();\n                        }\n                        this.clientsQueue.remove(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.publish = function (topics, msg) {\n        return __awaiter(this, void 0, void 0, function () {\n            var targetTopics, message, url, client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        targetTopics = [].concat(topics);\n                        message = JSON.stringify(msg);\n                        return [4 /*yield*/, this.endpoint];\n                    case 1:\n                        url = _a.sent();\n                        return [4 /*yield*/, this.connect(this.clientId, { url: url })];\n                    case 2:\n                        client = _a.sent();\n                        logger.debug('Publishing to topic(s)', targetTopics.join(','), message);\n                        targetTopics.forEach(function (topic) { return client.send(topic, message); });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype._onMessage = function (topic, msg) {\n        try {\n            var matchedTopicObservers_1 = [];\n            this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                if (mqttTopicMatch(observerTopic, topic)) {\n                    matchedTopicObservers_1.push(observerForTopic);\n                }\n            });\n            var parsedMessage_1 = JSON.parse(msg);\n            if (typeof parsedMessage_1 === 'object') {\n                parsedMessage_1[topicSymbol] = topic;\n            }\n            matchedTopicObservers_1.forEach(function (observersForTopic) {\n                observersForTopic.forEach(function (observer) { return observer.next(parsedMessage_1); });\n            });\n        }\n        catch (error) {\n            logger.warn('Error handling message', error, msg);\n        }\n    };\n    MqttOverWSProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var targetTopics = [].concat(topics);\n        logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n        return new Observable(function (observer) {\n            targetTopics.forEach(function (topic) {\n                // this._topicObservers is used to notify the observers according to the topic received on the message\n                var observersForTopic = _this._topicObservers.get(topic);\n                if (!observersForTopic) {\n                    observersForTopic = new Set();\n                    _this._topicObservers.set(topic, observersForTopic);\n                }\n                observersForTopic.add(observer);\n            });\n            // @ts-ignore\n            var client;\n            var _a = options.clientId, clientId = _a === void 0 ? _this.clientId : _a;\n            // this._clientIdObservers is used to close observers when client gets disconnected\n            var observersForClientId = _this._clientIdObservers.get(clientId);\n            if (!observersForClientId) {\n                observersForClientId = new Set();\n            }\n            observersForClientId.add(observer);\n            _this._clientIdObservers.set(clientId, observersForClientId);\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, url, _b, e_1;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            _a = options.url;\n                            if (!(_a === void 0)) return [3 /*break*/, 2];\n                            return [4 /*yield*/, this.endpoint];\n                        case 1:\n                            _b = _c.sent();\n                            return [3 /*break*/, 3];\n                        case 2:\n                            _b = _a;\n                            _c.label = 3;\n                        case 3:\n                            url = _b;\n                            _c.label = 4;\n                        case 4:\n                            _c.trys.push([4, 6, , 7]);\n                            return [4 /*yield*/, this.connect(clientId, { url: url })];\n                        case 5:\n                            client = _c.sent();\n                            targetTopics.forEach(function (topic) {\n                                client.subscribe(topic);\n                            });\n                            return [3 /*break*/, 7];\n                        case 6:\n                            e_1 = _c.sent();\n                            observer.error(e_1);\n                            return [3 /*break*/, 7];\n                        case 7: return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                if (client) {\n                    _this._clientIdObservers.get(clientId).delete(observer);\n                    // No more observers per client => client not needed anymore\n                    if (_this._clientIdObservers.get(clientId).size === 0) {\n                        _this.disconnect(clientId);\n                        _this._clientIdObservers.delete(clientId);\n                    }\n                    targetTopics.forEach(function (topic) {\n                        var observersForTopic = _this._topicObservers.get(topic) ||\n                            new Set();\n                        observersForTopic.delete(observer);\n                        // if no observers exists for the topic, topic should be removed\n                        if (observersForTopic.size === 0) {\n                            _this._topicObservers.delete(topic);\n                            if (client.isConnected()) {\n                                client.unsubscribe(topic);\n                            }\n                        }\n                    });\n                }\n                return null;\n            };\n        });\n    };\n    return MqttOverWSProvider;\n}(AbstractPubSubProvider));\nexport { MqttOverWSProvider };\n//# sourceMappingURL=MqttOverWSProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport Observable from 'zen-observable-ts';\nimport { GraphQLError } from 'graphql';\nimport * as url from 'url';\nimport { v4 as uuid } from 'uuid';\nimport { Buffer } from 'buffer';\nimport { Logger, Credentials, Signer, Hub, Constants, USER_AGENT_HEADER, jitteredExponentialRetry, NonRetryableError, } from '@aws-amplify/core';\nimport Cache from '@aws-amplify/cache';\nimport Auth from '@aws-amplify/auth';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { CONTROL_MSG } from '../index';\nvar logger = new Logger('AWSAppSyncRealTimeProvider');\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' &&\n    typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nvar dispatchApiEvent = function (event, data, message) {\n    Hub.dispatch('api', { event: event, data: data, message: message }, 'PubSub', AMPLIFY_SYMBOL);\n};\nvar MAX_DELAY_MS = 5000;\nvar NON_RETRYABLE_CODES = [400, 401, 403];\nvar MESSAGE_TYPES;\n(function (MESSAGE_TYPES) {\n    /**\n     * Client -> Server message.\n     * This message type is the first message after handshake and this will initialize AWS AppSync RealTime communication\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_INIT\"] = \"connection_init\";\n    /**\n     * Server -> Client message\n     * This message type is in case there is an issue with AWS AppSync RealTime when establishing connection\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ERROR\"] = \"connection_error\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_CONNECTION_INIT message\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ACK\"] = \"connection_ack\";\n    /**\n     * Client -> Server message.\n     * This message type is for register subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_START\"] = \"start\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_START message\n     */\n    MESSAGE_TYPES[\"GQL_START_ACK\"] = \"start_ack\";\n    /**\n     * Server -> Client message.\n     * This message type is for subscription message from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_DATA\"] = \"data\";\n    /**\n     * Server -> Client message.\n     * This message type helps the client to know is still receiving messages from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_KEEP_ALIVE\"] = \"ka\";\n    /**\n     * Client -> Server message.\n     * This message type is for unregister subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_STOP\"] = \"stop\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_STOP message\n     */\n    MESSAGE_TYPES[\"GQL_COMPLETE\"] = \"complete\";\n    /**\n     * Server -> Client message.\n     * This message type is for sending error messages from AWS AppSync RealTime to the client\n     */\n    MESSAGE_TYPES[\"GQL_ERROR\"] = \"error\";\n})(MESSAGE_TYPES || (MESSAGE_TYPES = {}));\nvar SUBSCRIPTION_STATUS;\n(function (SUBSCRIPTION_STATUS) {\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"PENDING\"] = 0] = \"PENDING\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"CONNECTED\"] = 1] = \"CONNECTED\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"FAILED\"] = 2] = \"FAILED\";\n})(SUBSCRIPTION_STATUS || (SUBSCRIPTION_STATUS = {}));\nvar SOCKET_STATUS;\n(function (SOCKET_STATUS) {\n    SOCKET_STATUS[SOCKET_STATUS[\"CLOSED\"] = 0] = \"CLOSED\";\n    SOCKET_STATUS[SOCKET_STATUS[\"READY\"] = 1] = \"READY\";\n    SOCKET_STATUS[SOCKET_STATUS[\"CONNECTING\"] = 2] = \"CONNECTING\";\n})(SOCKET_STATUS || (SOCKET_STATUS = {}));\nvar AWS_APPSYNC_REALTIME_HEADERS = {\n    accept: 'application/json, text/javascript',\n    'content-encoding': 'amz-1.0',\n    'content-type': 'application/json; charset=UTF-8',\n};\n/**\n * Time in milleseconds to wait for GQL_CONNECTION_INIT message\n */\nvar CONNECTION_INIT_TIMEOUT = 15000;\n/**\n * Time in milleseconds to wait for GQL_START_ACK message\n */\nvar START_ACK_TIMEOUT = 15000;\n/**\n * Default Time in milleseconds to wait for GQL_CONNECTION_KEEP_ALIVE message\n */\nvar DEFAULT_KEEP_ALIVE_TIMEOUT = 5 * 60 * 1000;\nvar AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncRealTimeProvider, _super);\n    function AWSAppSyncRealTimeProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.socketStatus = SOCKET_STATUS.CLOSED;\n        _this.keepAliveTimeout = DEFAULT_KEEP_ALIVE_TIMEOUT;\n        _this.subscriptionObserverMap = new Map();\n        _this.promiseArray = [];\n        return _this;\n    }\n    AWSAppSyncRealTimeProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncRealTimeProvider';\n    };\n    AWSAppSyncRealTimeProvider.prototype.newClient = function () {\n        throw new Error('Not used here');\n    };\n    AWSAppSyncRealTimeProvider.prototype.publish = function (_topics, _msg, _options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype.subscribe = function (_topics, options) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint;\n        return new Observable(function (observer) {\n            if (!appSyncGraphqlEndpoint) {\n                observer.error({\n                    errors: [\n                        __assign({}, new GraphQLError(\"Subscribe only available for AWS AppSync endpoint\")),\n                    ],\n                });\n                observer.complete();\n            }\n            else {\n                var subscriptionId_1 = uuid();\n                _this._startSubscriptionWithAWSAppSyncRealTime({\n                    options: options,\n                    observer: observer,\n                    subscriptionId: subscriptionId_1,\n                });\n                return function () { return __awaiter(_this, void 0, void 0, function () {\n                    var subscriptionState, err_1;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                _a.trys.push([0, 2, 3, 4]);\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                return [4 /*yield*/, this._waitForSubscriptionToBeConnected(subscriptionId_1)];\n                            case 1:\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                _a.sent();\n                                subscriptionState = (this.subscriptionObserverMap.get(subscriptionId_1) || {}).subscriptionState;\n                                if (!subscriptionState) {\n                                    // subscription already unsubscribed\n                                    return [2 /*return*/];\n                                }\n                                if (subscriptionState === SUBSCRIPTION_STATUS.CONNECTED) {\n                                    this._sendUnsubscriptionMessage(subscriptionId_1);\n                                }\n                                else {\n                                    throw new Error('Subscription never connected');\n                                }\n                                return [3 /*break*/, 4];\n                            case 2:\n                                err_1 = _a.sent();\n                                logger.debug(\"Error while unsubscribing \" + err_1);\n                                return [3 /*break*/, 4];\n                            case 3:\n                                this._removeSubscriptionObserver(subscriptionId_1);\n                                return [7 /*endfinally*/];\n                            case 4: return [2 /*return*/];\n                        }\n                    });\n                }); };\n            }\n        });\n    };\n    Object.defineProperty(AWSAppSyncRealTimeProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncRealTimeProvider.prototype._startSubscriptionWithAWSAppSyncRealTime = function (_a) {\n        var options = _a.options, observer = _a.observer, subscriptionId = _a.subscriptionId;\n        return __awaiter(this, void 0, void 0, function () {\n            var appSyncGraphqlEndpoint, authenticationType, query, variables, apiKey, region, _b, graphql_headers, _c, additionalHeaders, subscriptionState, data, dataString, headerObj, _d, _e, subscriptionMessage, stringToAWSRealTime, err_2, _f, message, subscriptionFailedCallback_1, _g, subscriptionFailedCallback, subscriptionReadyCallback;\n            var _h;\n            var _this = this;\n            return __generator(this, function (_j) {\n                switch (_j.label) {\n                    case 0:\n                        appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint, authenticationType = options.authenticationType, query = options.query, variables = options.variables, apiKey = options.apiKey, region = options.region, _b = options.graphql_headers, graphql_headers = _b === void 0 ? function () { return ({}); } : _b, _c = options.additionalHeaders, additionalHeaders = _c === void 0 ? {} : _c;\n                        subscriptionState = SUBSCRIPTION_STATUS.PENDING;\n                        data = {\n                            query: query,\n                            variables: variables,\n                        };\n                        // Having a subscription id map will make it simple to forward messages received\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            query: query,\n                            variables: variables,\n                            subscriptionState: subscriptionState,\n                            startAckTimeoutId: null,\n                        });\n                        dataString = JSON.stringify(data);\n                        _d = [{}];\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                payload: dataString,\n                                canonicalUri: '',\n                                region: region,\n                            })];\n                    case 1:\n                        _e = [__assign.apply(void 0, _d.concat([(_j.sent())]))];\n                        return [4 /*yield*/, graphql_headers()];\n                    case 2:\n                        headerObj = __assign.apply(void 0, [__assign.apply(void 0, [__assign.apply(void 0, _e.concat([(_j.sent())])), additionalHeaders]), (_h = {}, _h[USER_AGENT_HEADER] = Constants.userAgent, _h)]);\n                        subscriptionMessage = {\n                            id: subscriptionId,\n                            payload: {\n                                data: dataString,\n                                extensions: {\n                                    authorization: __assign({}, headerObj),\n                                },\n                            },\n                            type: MESSAGE_TYPES.GQL_START,\n                        };\n                        stringToAWSRealTime = JSON.stringify(subscriptionMessage);\n                        _j.label = 3;\n                    case 3:\n                        _j.trys.push([3, 5, , 6]);\n                        return [4 /*yield*/, this._initializeWebSocketConnection({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                region: region,\n                            })];\n                    case 4:\n                        _j.sent();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_2 = _j.sent();\n                        logger.debug({ err: err_2 });\n                        _f = err_2.message, message = _f === void 0 ? '' : _f;\n                        observer.error({\n                            errors: [\n                                __assign({}, new GraphQLError(\"Connection failed: \" + message)),\n                            ],\n                        });\n                        observer.complete();\n                        subscriptionFailedCallback_1 = (this.subscriptionObserverMap.get(subscriptionId) || {}).subscriptionFailedCallback;\n                        // Notify concurrent unsubscription\n                        if (typeof subscriptionFailedCallback_1 === 'function') {\n                            subscriptionFailedCallback_1();\n                        }\n                        return [2 /*return*/];\n                    case 6:\n                        _g = this.subscriptionObserverMap.get(subscriptionId), subscriptionFailedCallback = _g.subscriptionFailedCallback, subscriptionReadyCallback = _g.subscriptionReadyCallback;\n                        // This must be done before sending the message in order to be listening immediately\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            subscriptionState: subscriptionState,\n                            variables: variables,\n                            query: query,\n                            subscriptionReadyCallback: subscriptionReadyCallback,\n                            subscriptionFailedCallback: subscriptionFailedCallback,\n                            startAckTimeoutId: setTimeout(function () {\n                                _this._timeoutStartSubscriptionAck.call(_this, subscriptionId);\n                            }, START_ACK_TIMEOUT),\n                        });\n                        this.awsRealTimeSocket.send(stringToAWSRealTime);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // Waiting that subscription has been connected before trying to unsubscribe\n    AWSAppSyncRealTimeProvider.prototype._waitForSubscriptionToBeConnected = function (subscriptionId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var subscriptionState;\n            var _this = this;\n            return __generator(this, function (_a) {\n                subscriptionState = this.subscriptionObserverMap.get(subscriptionId).subscriptionState;\n                // This in case unsubscribe is invoked before sending start subscription message\n                if (subscriptionState === SUBSCRIPTION_STATUS.PENDING) {\n                    return [2 /*return*/, new Promise(function (res, rej) {\n                            var _a = _this.subscriptionObserverMap.get(subscriptionId), observer = _a.observer, subscriptionState = _a.subscriptionState, variables = _a.variables, query = _a.query;\n                            _this.subscriptionObserverMap.set(subscriptionId, {\n                                observer: observer,\n                                subscriptionState: subscriptionState,\n                                variables: variables,\n                                query: query,\n                                subscriptionReadyCallback: res,\n                                subscriptionFailedCallback: rej,\n                            });\n                        })];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._sendUnsubscriptionMessage = function (subscriptionId) {\n        try {\n            if (this.awsRealTimeSocket &&\n                this.awsRealTimeSocket.readyState === WebSocket.OPEN &&\n                this.socketStatus === SOCKET_STATUS.READY) {\n                // Preparing unsubscribe message to stop receiving messages for that subscription\n                var unsubscribeMessage = {\n                    id: subscriptionId,\n                    type: MESSAGE_TYPES.GQL_STOP,\n                };\n                var stringToAWSRealTime = JSON.stringify(unsubscribeMessage);\n                this.awsRealTimeSocket.send(stringToAWSRealTime);\n            }\n        }\n        catch (err) {\n            // If GQL_STOP is not sent because of disconnection issue, then there is nothing the client can do\n            logger.debug({ err: err });\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._removeSubscriptionObserver = function (subscriptionId) {\n        this.subscriptionObserverMap.delete(subscriptionId);\n        // Verifying 1000ms after removing subscription in case there are new subscription unmount/mount\n        setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n    };\n    AWSAppSyncRealTimeProvider.prototype._closeSocketIfRequired = function () {\n        if (this.subscriptionObserverMap.size > 0) {\n            // Active subscriptions on the WebSocket\n            return;\n        }\n        if (!this.awsRealTimeSocket) {\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n            return;\n        }\n        if (this.awsRealTimeSocket.bufferedAmount > 0) {\n            // Still data on the WebSocket\n            setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n        }\n        else {\n            logger.debug('closing WebSocket...');\n            clearTimeout(this.keepAliveTimeoutId);\n            var tempSocket = this.awsRealTimeSocket;\n            // Cleaning callbacks to avoid race condition, socket still exists\n            tempSocket.onclose = undefined;\n            tempSocket.onerror = undefined;\n            tempSocket.close(1000);\n            this.awsRealTimeSocket = null;\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._handleIncomingSubscriptionMessage = function (message) {\n        logger.debug(\"subscription message from AWS AppSync RealTime: \" + message.data);\n        var _a = JSON.parse(message.data), _b = _a.id, id = _b === void 0 ? '' : _b, payload = _a.payload, type = _a.type;\n        var _c = this.subscriptionObserverMap.get(id) || {}, _d = _c.observer, observer = _d === void 0 ? null : _d, _e = _c.query, query = _e === void 0 ? '' : _e, _f = _c.variables, variables = _f === void 0 ? {} : _f, startAckTimeoutId = _c.startAckTimeoutId, subscriptionReadyCallback = _c.subscriptionReadyCallback, subscriptionFailedCallback = _c.subscriptionFailedCallback;\n        logger.debug({ id: id, observer: observer, query: query, variables: variables });\n        if (type === MESSAGE_TYPES.GQL_DATA && payload && payload.data) {\n            if (observer) {\n                observer.next(payload);\n            }\n            else {\n                logger.debug(\"observer not found for id: \" + id);\n            }\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_START_ACK) {\n            logger.debug(\"subscription ready for \" + JSON.stringify({ query: query, variables: variables }));\n            if (typeof subscriptionReadyCallback === 'function') {\n                subscriptionReadyCallback();\n            }\n            clearTimeout(startAckTimeoutId);\n            dispatchApiEvent(CONTROL_MSG.SUBSCRIPTION_ACK, { query: query, variables: variables }, 'Connection established for subscription');\n            var subscriptionState = SUBSCRIPTION_STATUS.CONNECTED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: null,\n                subscriptionState: subscriptionState,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n            });\n            // TODO: emit event on hub but it requires to store the id first\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_CONNECTION_KEEP_ALIVE) {\n            clearTimeout(this.keepAliveTimeoutId);\n            this.keepAliveTimeoutId = setTimeout(this._errorDisconnect.bind(this, CONTROL_MSG.TIMEOUT_DISCONNECT), this.keepAliveTimeout);\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_ERROR) {\n            var subscriptionState = SUBSCRIPTION_STATUS.FAILED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: startAckTimeoutId,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n                subscriptionState: subscriptionState,\n            });\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(\"Connection failed: \" + JSON.stringify(payload))),\n                ],\n            });\n            clearTimeout(startAckTimeoutId);\n            observer.complete();\n            if (typeof subscriptionFailedCallback === 'function') {\n                subscriptionFailedCallback();\n            }\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._errorDisconnect = function (msg) {\n        logger.debug(\"Disconnect error: \" + msg);\n        this.subscriptionObserverMap.forEach(function (_a) {\n            var observer = _a.observer;\n            if (!observer.closed) {\n                observer.error({\n                    errors: [__assign({}, new GraphQLError(msg))],\n                });\n            }\n        });\n        this.subscriptionObserverMap.clear();\n        if (this.awsRealTimeSocket) {\n            this.awsRealTimeSocket.close();\n        }\n        this.socketStatus = SOCKET_STATUS.CLOSED;\n    };\n    AWSAppSyncRealTimeProvider.prototype._timeoutStartSubscriptionAck = function (subscriptionId) {\n        var _a = this.subscriptionObserverMap.get(subscriptionId) || {}, observer = _a.observer, query = _a.query, variables = _a.variables;\n        if (!observer) {\n            return;\n        }\n        this.subscriptionObserverMap.set(subscriptionId, {\n            observer: observer,\n            query: query,\n            variables: variables,\n            subscriptionState: SUBSCRIPTION_STATUS.FAILED,\n        });\n        if (observer && !observer.closed) {\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(\"Subscription timeout \" + JSON.stringify({ query: query, variables: variables }))),\n                ],\n            });\n            // Cleanup will be automatically executed\n            observer.complete();\n        }\n        logger.debug('timeoutStartSubscription', JSON.stringify({ query: query, variables: variables }));\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeWebSocketConnection = function (_a) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, authenticationType = _a.authenticationType, apiKey = _a.apiKey, region = _a.region;\n        if (this.socketStatus === SOCKET_STATUS.READY) {\n            return;\n        }\n        return new Promise(function (res, rej) { return __awaiter(_this, void 0, void 0, function () {\n            var protocol, discoverableEndpoint, payloadString, headerString, _a, _b, headerQs, payloadQs, awsRealTimeUrl, err_3;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this.promiseArray.push({ res: res, rej: rej });\n                        if (!(this.socketStatus === SOCKET_STATUS.CLOSED)) return [3 /*break*/, 5];\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 4, , 5]);\n                        this.socketStatus = SOCKET_STATUS.CONNECTING;\n                        protocol = this.isSSLEnabled ? 'wss://' : 'ws://';\n                        discoverableEndpoint = appSyncGraphqlEndpoint\n                            .replace('https://', protocol)\n                            .replace('http://', protocol)\n                            .replace('appsync-api', 'appsync-realtime-api')\n                            .replace('gogi-beta', 'grt-beta');\n                        payloadString = '{}';\n                        _b = (_a = JSON).stringify;\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                authenticationType: authenticationType,\n                                payload: payloadString,\n                                canonicalUri: '/connect',\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                region: region,\n                            })];\n                    case 2:\n                        headerString = _b.apply(_a, [_c.sent()]);\n                        headerQs = Buffer.from(headerString).toString('base64');\n                        payloadQs = Buffer.from(payloadString).toString('base64');\n                        awsRealTimeUrl = discoverableEndpoint + \"?header=\" + headerQs + \"&payload=\" + payloadQs;\n                        return [4 /*yield*/, this._initializeRetryableHandshake({ awsRealTimeUrl: awsRealTimeUrl })];\n                    case 3:\n                        _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var res = _a.res;\n                            logger.debug('Notifying connection successful');\n                            res();\n                        });\n                        this.socketStatus = SOCKET_STATUS.READY;\n                        this.promiseArray = [];\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_3 = _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var rej = _a.rej;\n                            return rej(err_3);\n                        });\n                        this.promiseArray = [];\n                        if (this.awsRealTimeSocket &&\n                            this.awsRealTimeSocket.readyState === WebSocket.OPEN) {\n                            this.awsRealTimeSocket.close(3001);\n                        }\n                        this.awsRealTimeSocket = null;\n                        this.socketStatus = SOCKET_STATUS.CLOSED;\n                        throw err_3;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        }); });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeRetryableHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializaling retryable Handshake\");\n                        return [4 /*yield*/, jitteredExponentialRetry(this._initializeHandshake.bind(this), [{ awsRealTimeUrl: awsRealTimeUrl }], MAX_DELAY_MS)];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            var err_4, errorType, errorCode;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializing handshake \" + awsRealTimeUrl);\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, , 5]);\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var newSocket = new WebSocket(awsRealTimeUrl, 'graphql-ws');\n                                    newSocket.onerror = function () {\n                                        logger.debug(\"WebSocket connection error\");\n                                    };\n                                    newSocket.onclose = function () {\n                                        rej(new Error('Connection handshake error'));\n                                    };\n                                    newSocket.onopen = function () {\n                                        _this.awsRealTimeSocket = newSocket;\n                                        return res();\n                                    };\n                                });\n                            })()];\n                    case 2:\n                        _b.sent();\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var ackOk = false;\n                                    _this.awsRealTimeSocket.onerror = function (error) {\n                                        logger.debug(\"WebSocket error \" + JSON.stringify(error));\n                                    };\n                                    _this.awsRealTimeSocket.onclose = function (event) {\n                                        logger.debug(\"WebSocket closed \" + event.reason);\n                                        rej(new Error(JSON.stringify(event)));\n                                    };\n                                    _this.awsRealTimeSocket.onmessage = function (message) {\n                                        logger.debug(\"subscription message from AWS AppSyncRealTime: \" + message.data + \" \");\n                                        var data = JSON.parse(message.data);\n                                        var type = data.type, _a = data.payload, _b = (_a === void 0 ? {} : _a).connectionTimeoutMs, connectionTimeoutMs = _b === void 0 ? DEFAULT_KEEP_ALIVE_TIMEOUT : _b;\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ACK) {\n                                            ackOk = true;\n                                            _this.keepAliveTimeout = connectionTimeoutMs;\n                                            _this.awsRealTimeSocket.onmessage = _this._handleIncomingSubscriptionMessage.bind(_this);\n                                            _this.awsRealTimeSocket.onerror = function (err) {\n                                                logger.debug(err);\n                                                _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);\n                                            };\n                                            res('Cool, connected to AWS AppSyncRealTime');\n                                            return;\n                                        }\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ERROR) {\n                                            var _c = data.payload, _d = (_c === void 0 ? {} : _c).errors, _e = __read(_d === void 0 ? [] : _d, 1), _f = _e[0], _g = _f === void 0 ? {} : _f, _h = _g.errorType, errorType = _h === void 0 ? '' : _h, _j = _g.errorCode, errorCode = _j === void 0 ? 0 : _j;\n                                            rej({ errorType: errorType, errorCode: errorCode });\n                                        }\n                                    };\n                                    var gqlInit = {\n                                        type: MESSAGE_TYPES.GQL_CONNECTION_INIT,\n                                    };\n                                    _this.awsRealTimeSocket.send(JSON.stringify(gqlInit));\n                                    function checkAckOk() {\n                                        if (!ackOk) {\n                                            rej(new Error(\"Connection timeout: ack from AWSRealTime was not received on \" + CONNECTION_INIT_TIMEOUT + \" ms\"));\n                                        }\n                                    }\n                                    setTimeout(checkAckOk.bind(_this), CONNECTION_INIT_TIMEOUT);\n                                });\n                            })()];\n                    case 3:\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        _b.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_4 = _b.sent();\n                        errorType = err_4.errorType, errorCode = err_4.errorCode;\n                        if (NON_RETRYABLE_CODES.includes(errorCode)) {\n                            throw new NonRetryableError(errorType);\n                        }\n                        else if (errorType) {\n                            throw new Error(errorType);\n                        }\n                        else {\n                            throw err_4;\n                        }\n                        return [3 /*break*/, 5];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeHeaderBasedAuth = function (_a) {\n        var authenticationType = _a.authenticationType, payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, apiKey = _a.apiKey, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var headerHandler, handler, host, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        headerHandler = {\n                            API_KEY: this._awsRealTimeApiKeyHeader.bind(this),\n                            AWS_IAM: this._awsRealTimeIAMHeader.bind(this),\n                            OPENID_CONNECT: this._awsRealTimeOPENIDHeader.bind(this),\n                            AMAZON_COGNITO_USER_POOLS: this._awsRealTimeCUPHeader.bind(this),\n                        };\n                        handler = headerHandler[authenticationType];\n                        if (typeof handler !== 'function') {\n                            logger.debug(\"Authentication type \" + authenticationType + \" not supported\");\n                            return [2 /*return*/, ''];\n                        }\n                        host = url.parse(appSyncGraphqlEndpoint).host;\n                        return [4 /*yield*/, handler({\n                                payload: payload,\n                                canonicalUri: canonicalUri,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                apiKey: apiKey,\n                                region: region,\n                                host: host,\n                            })];\n                    case 1:\n                        result = _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeCUPHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var session;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Auth.currentSession()];\n                    case 1:\n                        session = _b.sent();\n                        return [2 /*return*/, {\n                                Authorization: session.getAccessToken().getJwtToken(),\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeOPENIDHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var federatedInfo;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Cache.getItem('federatedInfo')];\n                    case 1:\n                        federatedInfo = _b.sent();\n                        if (!federatedInfo || !federatedInfo.token) {\n                            throw new Error('No federated jwt');\n                        }\n                        return [2 /*return*/, {\n                                Authorization: federatedInfo.token,\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeApiKeyHeader = function (_a) {\n        var apiKey = _a.apiKey, host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var dt, dtStr;\n            return __generator(this, function (_b) {\n                dt = new Date();\n                dtStr = dt.toISOString().replace(/[:\\-]|\\.\\d{3}/g, '');\n                return [2 /*return*/, {\n                        host: host,\n                        'x-amz-date': dtStr,\n                        'x-api-key': apiKey,\n                    }];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeIAMHeader = function (_a) {\n        var payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var endpointInfo, credentialsOK, creds, request, signed_params;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        endpointInfo = {\n                            region: region,\n                            service: 'appsync',\n                        };\n                        return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _b.sent();\n                        if (!credentialsOK) {\n                            throw new Error('No credentials');\n                        }\n                        return [4 /*yield*/, Credentials.get().then(function (credentials) { return ({\n                                secret_key: credentials.secretAccessKey,\n                                access_key: credentials.accessKeyId,\n                                session_token: credentials.sessionToken,\n                            }); })];\n                    case 2:\n                        creds = _b.sent();\n                        request = {\n                            url: \"\" + appSyncGraphqlEndpoint + canonicalUri,\n                            data: payload,\n                            method: 'POST',\n                            headers: __assign({}, AWS_APPSYNC_REALTIME_HEADERS),\n                        };\n                        signed_params = Signer.sign(request, creds, endpointInfo);\n                        return [2 /*return*/, signed_params.headers];\n                }\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    AWSAppSyncRealTimeProvider.prototype._ensureCredentials = function () {\n        return Credentials.get()\n            .then(function (credentials) {\n            if (!credentials)\n                return false;\n            var cred = Credentials.shear(credentials);\n            logger.debug('set credentials for AWSAppSyncRealTimeProvider', cred);\n            return true;\n        })\n            .catch(function (err) {\n            logger.warn('ensure credentials error', err);\n            return false;\n        });\n    };\n    return AWSAppSyncRealTimeProvider;\n}(AbstractPubSubProvider));\nexport { AWSAppSyncRealTimeProvider };\n//# sourceMappingURL=AWSAppSyncRealTimeProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport Observable from 'zen-observable-ts';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nvar logger = new Logger('AWSAppSyncProvider');\nvar AWSAppSyncProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncProvider, _super);\n    function AWSAppSyncProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._topicClient = new Map();\n        _this._topicAlias = new Map();\n        return _this;\n    }\n    Object.defineProperty(AWSAppSyncProvider.prototype, \"endpoint\", {\n        get: function () {\n            throw new Error('Not supported');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncProvider';\n    };\n    AWSAppSyncProvider.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype._cleanUp = function (clientId) {\n        var _this = this;\n        var topicsForClient = Array.from(this._topicClient.entries())\n            .filter(function (_a) {\n            var _b = __read(_a, 2), c = _b[1];\n            return c.clientId === clientId;\n        })\n            .map(function (_a) {\n            var _b = __read(_a, 1), t = _b[0];\n            return t;\n        });\n        topicsForClient.forEach(function (t) { return _this._cleanUpForTopic(t); });\n    };\n    AWSAppSyncProvider.prototype._cleanUpForTopic = function (topic) {\n        this._topicClient.delete(topic);\n        this._topicAlias.delete(topic);\n    };\n    AWSAppSyncProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            var topicsForClient = Array.from(this._topicClient.entries())\n                .filter(function (_a) {\n                var _b = __read(_a, 2), c = _b[1];\n                return c.clientId === clientId;\n            })\n                .map(function (_a) {\n                var _b = __read(_a, 1), t = _b[0];\n                return t;\n            });\n            topicsForClient.forEach(function (topic) {\n                if (_this._topicObservers.has(topic)) {\n                    _this._topicObservers.get(topic).forEach(function (obs) {\n                        if (!obs.closed) {\n                            obs.error(args);\n                        }\n                    });\n                    _this._topicObservers.delete(topic);\n                }\n            });\n            this._cleanUp(clientId);\n        }\n    };\n    AWSAppSyncProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        return [4 /*yield*/, _super.prototype.disconnect.call(this, clientId)];\n                    case 2:\n                        _a.sent();\n                        this._cleanUp(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var result = new Observable(function (observer) {\n            var targetTopics = [].concat(topics);\n            logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, mqttConnections, newSubscriptions, newAliases, map;\n                var _this = this;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            // Add these topics to map\n                            targetTopics.forEach(function (t) {\n                                if (!_this._topicObservers.has(t)) {\n                                    _this._topicObservers.set(t, new Set());\n                                }\n                                _this._topicObservers.get(t).add(observer);\n                            });\n                            _a = options.mqttConnections, mqttConnections = _a === void 0 ? [] : _a, newSubscriptions = options.newSubscriptions;\n                            newAliases = Object.entries(newSubscriptions).map(function (_a) {\n                                var _b = __read(_a, 2), alias = _b[0], v = _b[1];\n                                return [v.topic, alias];\n                            });\n                            // Merge new aliases with old ones\n                            this._topicAlias = new Map(__spread(Array.from(this._topicAlias.entries()), newAliases));\n                            map = Object.entries(targetTopics.reduce(function (acc, elem) {\n                                var connectionInfoForTopic = mqttConnections.find(function (c) { return c.topics.indexOf(elem) > -1; });\n                                if (connectionInfoForTopic) {\n                                    var clientId = connectionInfoForTopic.client, url = connectionInfoForTopic.url;\n                                    if (!acc[clientId]) {\n                                        acc[clientId] = {\n                                            url: url,\n                                            topics: new Set(),\n                                        };\n                                    }\n                                    acc[clientId].topics.add(elem);\n                                }\n                                return acc;\n                            }, {}));\n                            // reconnect everything we have in the map\n                            return [4 /*yield*/, Promise.all(map.map(function (_a) {\n                                    var _b = __read(_a, 2), clientId = _b[0], _c = _b[1], url = _c.url, topics = _c.topics;\n                                    return __awaiter(_this, void 0, void 0, function () {\n                                        var client, err_1;\n                                        var _this = this;\n                                        return __generator(this, function (_d) {\n                                            switch (_d.label) {\n                                                case 0:\n                                                    client = null;\n                                                    _d.label = 1;\n                                                case 1:\n                                                    _d.trys.push([1, 3, , 4]);\n                                                    return [4 /*yield*/, this.connect(clientId, {\n                                                            clientId: clientId,\n                                                            url: url,\n                                                        })];\n                                                case 2:\n                                                    client = _d.sent();\n                                                    return [3 /*break*/, 4];\n                                                case 3:\n                                                    err_1 = _d.sent();\n                                                    observer.error({ message: 'Failed to connect', error: err_1 });\n                                                    observer.complete();\n                                                    return [2 /*return*/, undefined];\n                                                case 4:\n                                                    // subscribe to all topics for this client\n                                                    // store topic-client mapping\n                                                    topics.forEach(function (topic) {\n                                                        if (client.isConnected()) {\n                                                            client.subscribe(topic);\n                                                            _this._topicClient.set(topic, client);\n                                                        }\n                                                    });\n                                                    return [2 /*return*/, client];\n                                            }\n                                        });\n                                    });\n                                }))];\n                        case 1:\n                            // reconnect everything we have in the map\n                            _b.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                targetTopics.forEach(function (t) {\n                    var client = _this._topicClient.get(t);\n                    if (client && client.isConnected()) {\n                        client.unsubscribe(t);\n                        _this._topicClient.delete(t);\n                        if (!Array.from(_this._topicClient.values()).some(function (c) { return c === client; })) {\n                            _this.disconnect(client.clientId);\n                        }\n                    }\n                    _this._topicObservers.delete(t);\n                });\n            };\n        });\n        return Observable.from(result).map(function (value) {\n            var topic = _this.getTopicForValue(value);\n            var alias = _this._topicAlias.get(topic);\n            value.data = Object.entries(value.data).reduce(function (obj, _a) {\n                var _b = __read(_a, 2), origKey = _b[0], val = _b[1];\n                return ((obj[(alias || origKey)] = val), obj);\n            }, {});\n            return value;\n        });\n    };\n    return AWSAppSyncProvider;\n}(MqttOverWSProvider));\nexport { AWSAppSyncProvider };\n//# sourceMappingURL=AWSAppSyncProvider.js.map","/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { PubSub } from './PubSub';\nexport * from './Providers';\nvar CONTROL_MSG;\n(function (CONTROL_MSG) {\n    CONTROL_MSG[\"CONNECTION_CLOSED\"] = \"Connection closed\";\n    CONTROL_MSG[\"TIMEOUT_DISCONNECT\"] = \"Timeout disconnect\";\n    CONTROL_MSG[\"SUBSCRIPTION_ACK\"] = \"Subscription ack\";\n})(CONTROL_MSG || (CONTROL_MSG = {}));\nexport { PubSub, CONTROL_MSG };\n/**\n * @deprecated use named import\n */\nexport default PubSub;\n//# sourceMappingURL=index.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n// import '../Common/Polyfills';\nimport Observable from 'zen-observable-ts';\nimport { Amplify, ConsoleLogger as Logger, INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER, INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER, } from '@aws-amplify/core';\nimport { AWSAppSyncProvider, AWSAppSyncRealTimeProvider } from './Providers';\nvar logger = new Logger('PubSub');\nvar PubSubClass = /** @class */ (function () {\n    /**\n     * Initialize PubSub with AWS configurations\n     *\n     * @param {PubSubOptions} options - Configuration object for PubSub\n     */\n    function PubSubClass(options) {\n        this._options = options;\n        logger.debug('PubSub Options', this._options);\n        this._pluggables = [];\n        this.subscribe = this.subscribe.bind(this);\n        Amplify.register(this);\n    }\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncProvider) {\n                this._awsAppSyncProvider = new AWSAppSyncProvider(this._options);\n            }\n            return this._awsAppSyncProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncRealTimeProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncRealTimeProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncRealTimeProvider) {\n                this._awsAppSyncRealTimeProvider = new AWSAppSyncRealTimeProvider(this._options);\n            }\n            return this._awsAppSyncRealTimeProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PubSubClass.prototype.getModuleName = function () {\n        return 'PubSub';\n    };\n    /**\n     * Configure PubSub part with configurations\n     *\n     * @param {PubSubOptions} config - Configuration for PubSub\n     * @return {Object} - The current configuration\n     */\n    PubSubClass.prototype.configure = function (options) {\n        var _this = this;\n        var opt = options ? options.PubSub || options : {};\n        logger.debug('configure PubSub', { opt: opt });\n        this._options = Object.assign({}, this._options, opt);\n        this._pluggables.map(function (pluggable) { return pluggable.configure(_this._options); });\n        return this._options;\n    };\n    /**\n     * add plugin into Analytics category\n     * @param {Object} pluggable - an instance of the plugin\n     */\n    PubSubClass.prototype.addPluggable = function (pluggable) {\n        return __awaiter(this, void 0, void 0, function () {\n            var config;\n            return __generator(this, function (_a) {\n                if (pluggable && pluggable.getCategory() === 'PubSub') {\n                    this._pluggables.push(pluggable);\n                    config = pluggable.configure(this._options);\n                    return [2 /*return*/, config];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    PubSubClass.prototype.getProviderByName = function (providerName) {\n        if (providerName === INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER) {\n            return this.awsAppSyncProvider;\n        }\n        if (providerName === INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER) {\n            return this.awsAppSyncRealTimeProvider;\n        }\n        return this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === providerName; });\n    };\n    PubSubClass.prototype.getProviders = function (options) {\n        if (options === void 0) { options = {}; }\n        var providerName = options.provider;\n        if (!providerName) {\n            return this._pluggables;\n        }\n        var provider = this.getProviderByName(providerName);\n        if (!provider) {\n            throw new Error(\"Could not find provider named \" + providerName);\n        }\n        return [provider];\n    };\n    PubSubClass.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, Promise.all(this.getProviders(options).map(function (provider) {\n                        return provider.publish(topics, msg, options);\n                    }))];\n            });\n        });\n    };\n    PubSubClass.prototype.subscribe = function (topics, options) {\n        logger.debug('subscribe options', options);\n        var providers = this.getProviders(options);\n        return new Observable(function (observer) {\n            var observables = providers.map(function (provider) { return ({\n                provider: provider,\n                observable: provider.subscribe(topics, options),\n            }); });\n            var subscriptions = observables.map(function (_a) {\n                var provider = _a.provider, observable = _a.observable;\n                return observable.subscribe({\n                    start: console.error,\n                    next: function (value) { return observer.next({ provider: provider, value: value }); },\n                    error: function (error) { return observer.error({ provider: provider, error: error }); },\n                });\n            });\n            return function () {\n                return subscriptions.forEach(function (subscription) { return subscription.unsubscribe(); });\n            };\n        });\n    };\n    return PubSubClass;\n}());\nexport { PubSubClass };\nexport var PubSub = new PubSubClass(null);\n//# sourceMappingURL=PubSub.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nimport { Signer, Credentials } from '@aws-amplify/core';\nvar SERVICE_NAME = 'iotdevicegateway';\nvar AWSIoTProvider = /** @class */ (function (_super) {\n    __extends(AWSIoTProvider, _super);\n    function AWSIoTProvider() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(AWSIoTProvider.prototype, \"region\", {\n        get: function () {\n            return this.options.aws_pubsub_region;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSIoTProvider.prototype.getProviderName = function () {\n        return 'AWSIoTProvider';\n    };\n    Object.defineProperty(AWSIoTProvider.prototype, \"endpoint\", {\n        get: function () {\n            var _this = this;\n            return (function () { return __awaiter(_this, void 0, void 0, function () {\n                var endpoint, serviceInfo, _a, access_key, secret_key, session_token, result;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            endpoint = this.options.aws_pubsub_endpoint;\n                            serviceInfo = {\n                                service: SERVICE_NAME,\n                                region: this.region,\n                            };\n                            return [4 /*yield*/, Credentials.get()];\n                        case 1:\n                            _a = _b.sent(), access_key = _a.accessKeyId, secret_key = _a.secretAccessKey, session_token = _a.sessionToken;\n                            result = Signer.signUrl(endpoint, { access_key: access_key, secret_key: secret_key, session_token: session_token }, serviceInfo);\n                            return [2 /*return*/, result];\n                    }\n                });\n            }); })();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AWSIoTProvider;\n}(MqttOverWSProvider));\nexport { AWSIoTProvider };\n//# sourceMappingURL=AWSIotProvider.js.map"],"sourceRoot":""}
\ No newline at end of file
+{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external \"@aws-amplify/core\"","webpack:///external \"graphql\"","webpack:///./node_modules/uuid/index.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/buffer/index.js","webpack:///external \"@aws-amplify/auth\"","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js","webpack:///./node_modules/zen-observable-ts/node_modules/zen-observable/index.js","webpack:///./node_modules/paho-mqtt/paho-mqtt.js","webpack:///./node_modules/url/url.js","webpack:///external \"@aws-amplify/cache\"","webpack:///./node_modules/zen-observable-ts/node_modules/zen-observable/lib/Observable.js","webpack:///./node_modules/uuid/v1.js","webpack:///./node_modules/uuid/v4.js","webpack:///./node_modules/node-libs-browser/node_modules/punycode/punycode.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/url/util.js","webpack:///./node_modules/querystring-es3/index.js","webpack:///./node_modules/querystring-es3/decode.js","webpack:///./node_modules/querystring-es3/encode.js","webpack:///./node_modules/base64-js/index.js","webpack:///./node_modules/ieee754/index.js","webpack:///./node_modules/isarray/index.js","webpack:///./node_modules/zen-observable-ts/lib/bundle.esm.js","webpack:///../../src/Providers/PubSubProvider.ts","webpack:///../../src/Providers/MqttOverWSProvider.ts","webpack:///../../src/Providers/AWSAppSyncRealTimeProvider.ts","webpack:///../../src/Providers/AWSAppSyncProvider.ts","webpack:///../src/PubSub.ts","webpack:///../src/index.ts","webpack:///../../src/Providers/AWSIotProvider.ts"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__5__","__WEBPACK_EXTERNAL_MODULE__11__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","v1","v4","uuid","g","Function","e","window","base64","ieee754","isArray","kMaxLength","Buffer","TYPED_ARRAY_SUPPORT","createBuffer","that","length","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","Error","allocUnsafe","from","TypeError","ArrayBuffer","array","byteOffset","byteLength","undefined","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","slice","fromString","obj","isBuffer","len","checked","copy","buffer","val","type","data","fromObject","assertSize","size","toString","isView","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","b","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","indexOf","lastIndexOf","arr","indexSize","arrLength","valLength","String","read","buf","readUInt16BE","foundIndex","found","j","hexWrite","offset","Number","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","push","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","Math","min","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","fromCharCode","apply","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","fill","allocUnsafeSlow","_isBuffer","compare","a","x","y","concat","list","pos","swap16","swap32","swap64","arguments","equals","inspect","max","match","join","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","Array","_arr","ret","out","toHex","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","set","code","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","trim","replace","stringtrim","base64clean","src","dst","getRandomValues","crypto","msCrypto","rnds8","rnds","random","byteToHex","bth","Observable","localStorage","setItem","item","getItem","removeItem","MESSAGE_TYPE","validate","keys","errorStr","validKey","format","ERROR","INVALID_TYPE","scope","f","OK","text","CONNECT_TIMEOUT","SUBSCRIBE_TIMEOUT","UNSUBSCRIBE_TIMEOUT","PING_TIMEOUT","INTERNAL_ERROR","CONNACK_RETURNCODE","SOCKET_ERROR","SOCKET_CLOSE","MALFORMED_UTF","UNSUPPORTED","INVALID_STATE","INVALID_ARGUMENT","UNSUPPORTED_OPERATION","INVALID_STORED_DATA","INVALID_MQTT_MESSAGE_TYPE","MALFORMED_UNICODE","BUFFER_FULL","CONNACK_RC","0","1","2","3","4","5","error","substitutions","field","part1","substring","part2","MqttProtoIdentifierv3","MqttProtoIdentifierv4","WireMessage","options","decodeMessage","input","digit","startingPos","first","messageInfo","remLength","multiplier","endPos","wireMessage","sessionPresent","returnCode","qos","readUint16","topicName","parseUTF8","messageIdentifier","message","Message","retained","duplicate","destinationName","payloadMessage","writeUint16","writeString","utf8Length","stringToUTF8","UTF8Length","output","charCode","lowCharCode","utf16","byte1","byte2","byte3","byte4","encode","willMessagePayloadBytes","topicStrLength","destinationNameLength","mqttVersion","clientId","willMessage","payloadBytes","userName","password","topics","requestedQos","mbi","number","numBytes","encodeMBI","byteStream","connectFlags","cleanSession","keepAliveInterval","Pinger","client","_client","_keepAliveInterval","isReset","pingReq","doTimeout","pinger","doPing","_trace","socket","send","timeout","setTimeout","_disconnected","reset","clearTimeout","cancel","Timeout","timeoutSeconds","action","args","ClientImpl","uri","host","port","path","WebSocket","_wsuri","_localKey","_msg_queue","_buffered_msg_queue","_sentMessages","_receivedMessages","_notify_msg_sent","_message_identifier","_sequence","restore","connected","maxMessageIdentifier","connectOptions","hostIndex","onConnected","onConnectionLost","onMessageDelivered","onMessageArrived","traceFunction","_connectTimeout","sendPinger","receivePinger","_reconnectInterval","_reconnecting","_reconnectTimeout","disconnectedPublishing","disconnectedBufferSize","receiveBuffer","_traceBuffer","_MAX_TRACE_ENTRIES","connect","connectOptionsMasked","_traceMask","uris","_doConnect","subscribe","filter","subscribeOptions","constructor","onSuccess","grantedQos","invocationContext","onFailure","errorCode","errorMessage","timeOut","_requires_ack","_schedule_message","unsubscribe","unsubscribeOptions","callback","sequence","unshift","disconnect","getTraceLog","Date","startTrace","stopTrace","wsurl","useSSL","uriParts","split","binaryType","onopen","_on_socket_open","onmessage","_on_socket_message","onerror","_on_socket_error","onclose","_on_socket_close","_process_queue","store","prefix","storedMessage","version","pubRecReceived","hex","messageBytes","payloadHex","JSON","stringify","parse","pop","_socket_send","messageCount","event","messages","_deframeMessages","_handleMessage","newData","result","errorStack","stack","sentMessage","receivedMessage","sequencedMessages","msgId","msg","sort","pubRelMessage","reconnected","_connected","_receivePublish","_receiveMessage","pubCompMessage","wireMessageMasked","pubAckMessage","pubRecMessage","reconnect","_reconnect","errorText","readyState","close","mqttVersionExplicit","splice","record","severity","shift","traceObject","masked","traceObjectMasked","attr","newPayload","payload","DataView","defineProperties","newDestinationName","newQos","newRetained","newTopic","newDuplicate","Client","ipv6AddSBracket","clientIdLength","newOnConnected","newDisconnectedPublishing","newDisconnectedBufferSize","newOnConnectionLost","newOnMessageDelivered","newOnMessageArrived","trace","hosts","ports","stringPayload","usingURIs","test","ipv6","topic","publish","isConnected","self","punycode","util","Url","protocol","slashes","auth","hostname","hash","search","query","pathname","href","urlParse","resolve","source","relative","resolveObject","isString","protocolPattern","portPattern","simplePathPattern","unwise","autoEscape","nonHostChars","hostEndingChars","hostnamePartPattern","hostnamePartStart","unsafeProtocol","hostlessProtocol","slashedProtocol","querystring","url","parseQueryString","slashesDenoteHost","isObject","u","queryIndex","splitter","uSplit","rest","simplePath","exec","proto","lowerProto","atSign","hostEnd","hec","decodeURIComponent","parseHost","ipv6Hostname","hostparts","part","newpart","k","validParts","notHost","bit","toASCII","h","ae","esc","encodeURIComponent","escape","qm","charAt","rel","tkeys","tk","tkey","rkeys","rk","rkey","v","relPath","isSourceAbs","isRelAbs","mustEndAbs","removeAllDots","srcPath","psychotic","isNullOrUndefined","authInHost","isNull","last","hasTrailingSlash","up","isAbsolute","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","writable","_createClass","protoProps","staticProps","hasSymbols","hasSymbol","Boolean","getSymbol","observable","SymbolIterator","SymbolObservable","SymbolSpecies","getMethod","getSpecies","ctor","isObservable","hostReportError","log","enqueue","fn","Promise","then","cleanupSubscription","subscription","cleanup","_cleanup","closeSubscription","_observer","_queue","_state","notifySubscription","observer","onNotify","queue","flushSubscription","Subscription","subscriber","subscriptionObserver","SubscriptionObserver","_subscription","_subscriber","next","complete","_this","reject","done","_this2","_this3","_this4","C","hasSeed","hasValue","seed","acc","_this5","_len","sources","_key","index","startNext","_this6","subscriptions","outer","inner","completeIfDone","closed","forEach","method","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","_item","err","return","_len2","items","_key2","symbol","_nodeId","_clockseq","rng","bytesToUuid","_lastMSecs","_lastNSecs","node","clockseq","seedBytes","msecs","getTime","nsecs","dt","tl","tmh","ii","nodeType","freeGlobal","maxInt","regexPunycode","regexNonASCII","regexSeparators","errors","stringFromCharCode","map","mapDomain","parts","ucs2decode","extra","counter","ucs2encode","digitToBasic","flag","adapt","delta","numPoints","firstTime","baseMinusTMin","base","decode","basic","oldi","w","baseMinusT","inputLength","bias","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","webpackPolyfill","deprecate","paths","children","prop","qs","sep","eq","regexp","maxKeys","kstr","vstr","idx","xs","stringifyPrimitive","objectKeys","ks","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","num","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","abs","LN2"],"mappings":"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","file":"aws-amplify-pubsub.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@aws-amplify/core\"), require(\"graphql\"), require(\"@aws-amplify/auth\"), require(\"@aws-amplify/cache\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"aws_amplify_pubsub\", [\"@aws-amplify/core\", \"graphql\", \"@aws-amplify/auth\", \"@aws-amplify/cache\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"aws_amplify_pubsub\"] = factory(require(\"@aws-amplify/core\"), require(\"graphql\"), require(\"@aws-amplify/auth\"), require(\"@aws-amplify/cache\"));\n\telse\n\t\troot[\"aws_amplify_pubsub\"] = factory(root[\"@aws-amplify/core\"], root[\"graphql\"], root[\"@aws-amplify/auth\"], root[\"@aws-amplify/cache\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__5__, __WEBPACK_EXTERNAL_MODULE__11__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__5__;","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]]\n  ]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","module.exports = require('./lib/Observable.js').Observable;\n","/*******************************************************************************\n * Copyright (c) 2013 IBM Corp.\n *\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * and Eclipse Distribution License v1.0 which accompany this distribution.\n *\n * The Eclipse Public License is available at\n *    http://www.eclipse.org/legal/epl-v10.html\n * and the Eclipse Distribution License is available at\n *   http://www.eclipse.org/org/documents/edl-v10.php.\n *\n * Contributors:\n *    Andrew Banks - initial API and implementation and initial documentation\n *******************************************************************************/\n\n\n// Only expose a single object name in the global namespace.\n// Everything must go through this module. Global Paho module\n// only has a single public function, client, which returns\n// a Paho client object given connection details.\n\n/**\n * Send and receive messages using web browsers.\n * <p>\n * This programming interface lets a JavaScript client application use the MQTT V3.1 or\n * V3.1.1 protocol to connect to an MQTT-supporting messaging server.\n *\n * The function supported includes:\n * <ol>\n * <li>Connecting to and disconnecting from a server. The server is identified by its host name and port number.\n * <li>Specifying options that relate to the communications link with the server,\n * for example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.\n * <li>Subscribing to and receiving messages from MQTT Topics.\n * <li>Publishing messages to MQTT Topics.\n * </ol>\n * <p>\n * The API consists of two main objects:\n * <dl>\n * <dt><b>{@link Paho.Client}</b></dt>\n * <dd>This contains methods that provide the functionality of the API,\n * including provision of callbacks that notify the application when a message\n * arrives from or is delivered to the messaging server,\n * or when the status of its connection to the messaging server changes.</dd>\n * <dt><b>{@link Paho.Message}</b></dt>\n * <dd>This encapsulates the payload of the message along with various attributes\n * associated with its delivery, in particular the destination to which it has\n * been (or is about to be) sent.</dd>\n * </dl>\n * <p>\n * The programming interface validates parameters passed to it, and will throw\n * an Error containing an error message intended for developer use, if it detects\n * an error with any parameter.\n * <p>\n * Example:\n *\n * <code><pre>\nvar client = new Paho.MQTT.Client(location.hostname, Number(location.port), \"clientId\");\nclient.onConnectionLost = onConnectionLost;\nclient.onMessageArrived = onMessageArrived;\nclient.connect({onSuccess:onConnect});\n\nfunction onConnect() {\n  // Once a connection has been made, make a subscription and send a message.\n  console.log(\"onConnect\");\n  client.subscribe(\"/World\");\n  var message = new Paho.MQTT.Message(\"Hello\");\n  message.destinationName = \"/World\";\n  client.send(message);\n};\nfunction onConnectionLost(responseObject) {\n  if (responseObject.errorCode !== 0)\n\tconsole.log(\"onConnectionLost:\"+responseObject.errorMessage);\n};\nfunction onMessageArrived(message) {\n  console.log(\"onMessageArrived:\"+message.payloadString);\n  client.disconnect();\n};\n * </pre></code>\n * @namespace Paho\n */\n\n/* jshint shadow:true */\n(function ExportLibrary(root, factory) {\n\tif(typeof exports === \"object\" && typeof module === \"object\"){\n\t\tmodule.exports = factory();\n\t} else if (typeof define === \"function\" && define.amd){\n\t\tdefine(factory);\n\t} else if (typeof exports === \"object\"){\n\t\texports = factory();\n\t} else {\n\t\t//if (typeof root.Paho === \"undefined\"){\n\t\t//\troot.Paho = {};\n\t\t//}\n\t\troot.Paho = factory();\n\t}\n})(this, function LibraryFactory(){\n\n\n\tvar PahoMQTT = (function (global) {\n\n\t// Private variables below, these are only visible inside the function closure\n\t// which is used to define the module.\n\tvar version = \"@VERSION@-@BUILDLEVEL@\";\n\n\t/**\n\t * @private\n\t */\n\tvar localStorage = global.localStorage || (function () {\n\t\tvar data = {};\n\n\t\treturn {\n\t\t\tsetItem: function (key, item) { data[key] = item; },\n\t\t\tgetItem: function (key) { return data[key]; },\n\t\t\tremoveItem: function (key) { delete data[key]; },\n\t\t};\n\t})();\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar MESSAGE_TYPE = {\n\t\t\tCONNECT: 1,\n\t\t\tCONNACK: 2,\n\t\t\tPUBLISH: 3,\n\t\t\tPUBACK: 4,\n\t\t\tPUBREC: 5,\n\t\t\tPUBREL: 6,\n\t\t\tPUBCOMP: 7,\n\t\t\tSUBSCRIBE: 8,\n\t\t\tSUBACK: 9,\n\t\t\tUNSUBSCRIBE: 10,\n\t\t\tUNSUBACK: 11,\n\t\t\tPINGREQ: 12,\n\t\t\tPINGRESP: 13,\n\t\t\tDISCONNECT: 14\n\t\t};\n\n\t\t// Collection of utility methods used to simplify module code\n\t\t// and promote the DRY pattern.\n\n\t\t/**\n\t * Validate an object's parameter names to ensure they\n\t * match a list of expected variables name for this option\n\t * type. Used to ensure option object passed into the API don't\n\t * contain erroneous parameters.\n\t * @param {Object} obj - User options object\n\t * @param {Object} keys - valid keys and types that may exist in obj.\n\t * @throws {Error} Invalid option parameter found.\n\t * @private\n\t */\n\t\tvar validate = function(obj, keys) {\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\tif (keys.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (typeof obj[key] !== keys[key])\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof obj[key], key]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar errorStr = \"Unknown property, \" + key + \". Valid properties are:\";\n\t\t\t\t\t\tfor (var validKey in keys)\n\t\t\t\t\t\t\tif (keys.hasOwnProperty(validKey))\n\t\t\t\t\t\t\t\terrorStr = errorStr+\" \"+validKey;\n\t\t\t\t\t\tthrow new Error(errorStr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Return a new function which runs the user function bound\n\t * to a fixed scope.\n\t * @param {function} User function\n\t * @param {object} Function scope\n\t * @return {function} User function bound to another scope\n\t * @private\n\t */\n\t\tvar scope = function (f, scope) {\n\t\t\treturn function () {\n\t\t\t\treturn f.apply(scope, arguments);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar ERROR = {\n\t\t\tOK: {code:0, text:\"AMQJSC0000I OK.\"},\n\t\t\tCONNECT_TIMEOUT: {code:1, text:\"AMQJSC0001E Connect timed out.\"},\n\t\t\tSUBSCRIBE_TIMEOUT: {code:2, text:\"AMQJS0002E Subscribe timed out.\"},\n\t\t\tUNSUBSCRIBE_TIMEOUT: {code:3, text:\"AMQJS0003E Unsubscribe timed out.\"},\n\t\t\tPING_TIMEOUT: {code:4, text:\"AMQJS0004E Ping timed out.\"},\n\t\t\tINTERNAL_ERROR: {code:5, text:\"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}\"},\n\t\t\tCONNACK_RETURNCODE: {code:6, text:\"AMQJS0006E Bad Connack return code:{0} {1}.\"},\n\t\t\tSOCKET_ERROR: {code:7, text:\"AMQJS0007E Socket error:{0}.\"},\n\t\t\tSOCKET_CLOSE: {code:8, text:\"AMQJS0008I Socket closed.\"},\n\t\t\tMALFORMED_UTF: {code:9, text:\"AMQJS0009E Malformed UTF data:{0} {1} {2}.\"},\n\t\t\tUNSUPPORTED: {code:10, text:\"AMQJS0010E {0} is not supported by this browser.\"},\n\t\t\tINVALID_STATE: {code:11, text:\"AMQJS0011E Invalid state {0}.\"},\n\t\t\tINVALID_TYPE: {code:12, text:\"AMQJS0012E Invalid type {0} for {1}.\"},\n\t\t\tINVALID_ARGUMENT: {code:13, text:\"AMQJS0013E Invalid argument {0} for {1}.\"},\n\t\t\tUNSUPPORTED_OPERATION: {code:14, text:\"AMQJS0014E Unsupported operation.\"},\n\t\t\tINVALID_STORED_DATA: {code:15, text:\"AMQJS0015E Invalid data in local storage key={0} value={1}.\"},\n\t\t\tINVALID_MQTT_MESSAGE_TYPE: {code:16, text:\"AMQJS0016E Invalid MQTT message type {0}.\"},\n\t\t\tMALFORMED_UNICODE: {code:17, text:\"AMQJS0017E Malformed Unicode string:{0} {1}.\"},\n\t\t\tBUFFER_FULL: {code:18, text:\"AMQJS0018E Message buffer is full, maximum buffer size: {0}.\"},\n\t\t};\n\n\t\t/** CONNACK RC Meaning. */\n\t\tvar CONNACK_RC = {\n\t\t\t0:\"Connection Accepted\",\n\t\t\t1:\"Connection Refused: unacceptable protocol version\",\n\t\t\t2:\"Connection Refused: identifier rejected\",\n\t\t\t3:\"Connection Refused: server unavailable\",\n\t\t\t4:\"Connection Refused: bad user name or password\",\n\t\t\t5:\"Connection Refused: not authorized\"\n\t\t};\n\n\t/**\n\t * Format an error message text.\n\t * @private\n\t * @param {error} ERROR value above.\n\t * @param {substitutions} [array] substituted into the text.\n\t * @return the text with the substitutions made.\n\t */\n\t\tvar format = function(error, substitutions) {\n\t\t\tvar text = error.text;\n\t\t\tif (substitutions) {\n\t\t\t\tvar field,start;\n\t\t\t\tfor (var i=0; i<substitutions.length; i++) {\n\t\t\t\t\tfield = \"{\"+i+\"}\";\n\t\t\t\t\tstart = text.indexOf(field);\n\t\t\t\t\tif(start > 0) {\n\t\t\t\t\t\tvar part1 = text.substring(0,start);\n\t\t\t\t\t\tvar part2 = text.substring(start+field.length);\n\t\t\t\t\t\ttext = part1+substitutions[i]+part2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn text;\n\t\t};\n\n\t\t//MQTT protocol and version          6    M    Q    I    s    d    p    3\n\t\tvar MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];\n\t\t//MQTT proto/version for 311         4    M    Q    T    T    4\n\t\tvar MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];\n\n\t\t/**\n\t * Construct an MQTT wire protocol message.\n\t * @param type MQTT packet type.\n\t * @param options optional wire message attributes.\n\t *\n\t * Optional properties\n\t *\n\t * messageIdentifier: message ID in the range [0..65535]\n\t * payloadMessage:\tApplication Message - PUBLISH only\n\t * connectStrings:\tarray of 0 or more Strings to be put into the CONNECT payload\n\t * topics:\t\t\tarray of strings (SUBSCRIBE, UNSUBSCRIBE)\n\t * requestQoS:\t\tarray of QoS values [0..2]\n\t *\n\t * \"Flag\" properties\n\t * cleanSession:\ttrue if present / false if absent (CONNECT)\n\t * willMessage:  \ttrue if present / false if absent (CONNECT)\n\t * isRetained:\t\ttrue if present / false if absent (CONNECT)\n\t * userName:\t\ttrue if present / false if absent (CONNECT)\n\t * password:\t\ttrue if present / false if absent (CONNECT)\n\t * keepAliveInterval:\tinteger [0..65535]  (CONNECT)\n\t *\n\t * @private\n\t * @ignore\n\t */\n\t\tvar WireMessage = function (type, options) {\n\t\t\tthis.type = type;\n\t\t\tfor (var name in options) {\n\t\t\t\tif (options.hasOwnProperty(name)) {\n\t\t\t\t\tthis[name] = options[name];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tWireMessage.prototype.encode = function() {\n\t\t// Compute the first byte of the fixed header\n\t\t\tvar first = ((this.type & 0x0f) << 4);\n\n\t\t\t/*\n\t\t * Now calculate the length of the variable header + payload by adding up the lengths\n\t\t * of all the component parts\n\t\t */\n\n\t\t\tvar remLength = 0;\n\t\t\tvar topicStrLength = [];\n\t\t\tvar destinationNameLength = 0;\n\t\t\tvar willMessagePayloadBytes;\n\n\t\t\t// if the message contains a messageIdentifier then we need two bytes for that\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tremLength += 2;\n\n\t\t\tswitch(this.type) {\n\t\t\t// If this a Connect then we need to include 12 bytes for its header\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tswitch(this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tremLength += MqttProtoIdentifierv3.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tremLength += MqttProtoIdentifierv4.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tremLength += UTF8Length(this.clientId) + 2;\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tremLength += UTF8Length(this.willMessage.destinationName) + 2;\n\t\t\t\t\t// Will message is always a string, sent as UTF-8 characters with a preceding length.\n\t\t\t\t\twillMessagePayloadBytes = this.willMessage.payloadBytes;\n\t\t\t\t\tif (!(willMessagePayloadBytes instanceof Uint8Array))\n\t\t\t\t\t\twillMessagePayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\t\tremLength += willMessagePayloadBytes.byteLength +2;\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.userName) + 2;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.password) + 2;\n\t\t\t\tbreak;\n\n\t\t\t// Subscribe, Unsubscribe can both contain topic strings\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tremLength += this.requestedQos.length; // 1 byte for each topic's Qos\n\t\t\t\t// QoS on Subscribe only\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif (this.payloadMessage.duplicate) first |= 0x08;\n\t\t\t\tfirst  = first |= (this.payloadMessage.qos << 1);\n\t\t\t\tif (this.payloadMessage.retained) first |= 0x01;\n\t\t\t\tdestinationNameLength = UTF8Length(this.payloadMessage.destinationName);\n\t\t\t\tremLength += destinationNameLength + 2;\n\t\t\t\tvar payloadBytes = this.payloadMessage.payloadBytes;\n\t\t\t\tremLength += payloadBytes.byteLength;\n\t\t\t\tif (payloadBytes instanceof ArrayBuffer)\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\telse if (!(payloadBytes instanceof Uint8Array))\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes.buffer);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Now we can allocate a buffer for the message\n\n\t\t\tvar mbi = encodeMBI(remLength);  // Convert the length to MQTT MBI format\n\t\t\tvar pos = mbi.length + 1;        // Offset of start of variable header\n\t\t\tvar buffer = new ArrayBuffer(remLength + pos);\n\t\t\tvar byteStream = new Uint8Array(buffer);    // view it as a sequence of bytes\n\n\t\t\t//Write the fixed header into the buffer\n\t\t\tbyteStream[0] = first;\n\t\t\tbyteStream.set(mbi,1);\n\n\t\t\t// If this is a PUBLISH then the variable header starts with a topic\n\t\t\tif (this.type == MESSAGE_TYPE.PUBLISH)\n\t\t\t\tpos = writeString(this.payloadMessage.destinationName, destinationNameLength, byteStream, pos);\n\t\t\t// If this is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time\n\n\t\t\telse if (this.type == MESSAGE_TYPE.CONNECT) {\n\t\t\t\tswitch (this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv3, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv3.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv4, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv4.length;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar connectFlags = 0;\n\t\t\t\tif (this.cleanSession)\n\t\t\t\t\tconnectFlags = 0x02;\n\t\t\t\tif (this.willMessage !== undefined ) {\n\t\t\t\t\tconnectFlags |= 0x04;\n\t\t\t\t\tconnectFlags |= (this.willMessage.qos<<3);\n\t\t\t\t\tif (this.willMessage.retained) {\n\t\t\t\t\t\tconnectFlags |= 0x20;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tconnectFlags |= 0x80;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tconnectFlags |= 0x40;\n\t\t\t\tbyteStream[pos++] = connectFlags;\n\t\t\t\tpos = writeUint16 (this.keepAliveInterval, byteStream, pos);\n\t\t\t}\n\n\t\t\t// Output the messageIdentifier - if there is one\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tpos = writeUint16 (this.messageIdentifier, byteStream, pos);\n\n\t\t\tswitch(this.type) {\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tpos = writeString(this.clientId, UTF8Length(this.clientId), byteStream, pos);\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tpos = writeString(this.willMessage.destinationName, UTF8Length(this.willMessage.destinationName), byteStream, pos);\n\t\t\t\t\tpos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);\n\t\t\t\t\tbyteStream.set(willMessagePayloadBytes, pos);\n\t\t\t\t\tpos += willMessagePayloadBytes.byteLength;\n\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tpos = writeString(this.userName, UTF8Length(this.userName), byteStream, pos);\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tpos = writeString(this.password, UTF8Length(this.password), byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// PUBLISH has a text or binary payload, if text do not add a 2 byte length field, just the UTF characters.\n\t\t\t\tbyteStream.set(payloadBytes, pos);\n\n\t\t\t\tbreak;\n\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREC:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREL:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t//    \t    \tbreak;\n\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\t// SUBSCRIBE has a list of topic strings and request QoS\n\t\t\t\tfor (var i=0; i<this.topics.length; i++) {\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\t\tbyteStream[pos++] = this.requestedQos[i];\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\t// UNSUBSCRIBE has a list of topic strings\n\t\t\t\tfor (var i=0; i<this.topics.length; i++)\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// Do nothing.\n\t\t\t}\n\n\t\t\treturn buffer;\n\t\t};\n\n\t\tfunction decodeMessage(input,pos) {\n\t\t\tvar startingPos = pos;\n\t\t\tvar first = input[pos];\n\t\t\tvar type = first >> 4;\n\t\t\tvar messageInfo = first &= 0x0f;\n\t\t\tpos += 1;\n\n\n\t\t\t// Decode the remaining length (MBI format)\n\n\t\t\tvar digit;\n\t\t\tvar remLength = 0;\n\t\t\tvar multiplier = 1;\n\t\t\tdo {\n\t\t\t\tif (pos == input.length) {\n\t\t\t\t\treturn [null,startingPos];\n\t\t\t\t}\n\t\t\t\tdigit = input[pos++];\n\t\t\t\tremLength += ((digit & 0x7F) * multiplier);\n\t\t\t\tmultiplier *= 128;\n\t\t\t} while ((digit & 0x80) !== 0);\n\n\t\t\tvar endPos = pos+remLength;\n\t\t\tif (endPos > input.length) {\n\t\t\t\treturn [null,startingPos];\n\t\t\t}\n\n\t\t\tvar wireMessage = new WireMessage(type);\n\t\t\tswitch(type) {\n\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\tvar connectAcknowledgeFlags = input[pos++];\n\t\t\t\tif (connectAcknowledgeFlags & 0x01)\n\t\t\t\t\twireMessage.sessionPresent = true;\n\t\t\t\twireMessage.returnCode = input[pos++];\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tvar qos = (messageInfo >> 1) & 0x03;\n\n\t\t\t\tvar len = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\tvar topicName = parseUTF8(input, pos, len);\n\t\t\t\tpos += len;\n\t\t\t\t// If QoS 1 or 2 there will be a messageIdentifier\n\t\t\t\tif (qos > 0) {\n\t\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\t\tpos += 2;\n\t\t\t\t}\n\n\t\t\t\tvar message = new Message(input.subarray(pos, endPos));\n\t\t\t\tif ((messageInfo & 0x01) == 0x01)\n\t\t\t\t\tmessage.retained = true;\n\t\t\t\tif ((messageInfo & 0x08) == 0x08)\n\t\t\t\t\tmessage.duplicate =  true;\n\t\t\t\tmessage.qos = qos;\n\t\t\t\tmessage.destinationName = topicName;\n\t\t\t\twireMessage.payloadMessage = message;\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.PUBACK:\n\t\t\tcase  MESSAGE_TYPE.PUBREC:\n\t\t\tcase  MESSAGE_TYPE.PUBREL:\n\t\t\tcase  MESSAGE_TYPE.PUBCOMP:\n\t\t\tcase  MESSAGE_TYPE.UNSUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.SUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\twireMessage.returnCode = input.subarray(pos, endPos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn [wireMessage,endPos];\n\t\t}\n\n\t\tfunction writeUint16(input, buffer, offset) {\n\t\t\tbuffer[offset++] = input >> 8;      //MSB\n\t\t\tbuffer[offset++] = input % 256;     //LSB\n\t\t\treturn offset;\n\t\t}\n\n\t\tfunction writeString(input, utf8Length, buffer, offset) {\n\t\t\toffset = writeUint16(utf8Length, buffer, offset);\n\t\t\tstringToUTF8(input, buffer, offset);\n\t\t\treturn offset + utf8Length;\n\t\t}\n\n\t\tfunction readUint16(buffer, offset) {\n\t\t\treturn 256*buffer[offset] + buffer[offset+1];\n\t\t}\n\n\t\t/**\n\t * Encodes an MQTT Multi-Byte Integer\n\t * @private\n\t */\n\t\tfunction encodeMBI(number) {\n\t\t\tvar output = new Array(1);\n\t\t\tvar numBytes = 0;\n\n\t\t\tdo {\n\t\t\t\tvar digit = number % 128;\n\t\t\t\tnumber = number >> 7;\n\t\t\t\tif (number > 0) {\n\t\t\t\t\tdigit |= 0x80;\n\t\t\t\t}\n\t\t\t\toutput[numBytes++] = digit;\n\t\t\t} while ( (number > 0) && (numBytes<4) );\n\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and calculates its length in bytes when encoded in UTF8.\n\t * @private\n\t */\n\t\tfunction UTF8Length(input) {\n\t\t\tvar output = 0;\n\t\t\tfor (var i = 0; i<input.length; i++)\n\t\t\t{\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\t\t\t\tif (charCode > 0x7FF)\n\t\t\t\t{\n\t\t\t\t\t// Surrogate pair means its a 4 byte character\n\t\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)\n\t\t\t\t\t{\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\toutput++;\n\t\t\t\t\t}\n\t\t\t\t\toutput +=3;\n\t\t\t\t}\n\t\t\t\telse if (charCode > 0x7F)\n\t\t\t\t\toutput +=2;\n\t\t\t\telse\n\t\t\t\t\toutput++;\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and writes it into an array as UTF8 encoded bytes.\n\t * @private\n\t */\n\t\tfunction stringToUTF8(input, output, start) {\n\t\t\tvar pos = start;\n\t\t\tfor (var i = 0; i<input.length; i++) {\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\n\t\t\t\t// Check for a surrogate pair.\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF) {\n\t\t\t\t\tvar lowCharCode = input.charCodeAt(++i);\n\t\t\t\t\tif (isNaN(lowCharCode)) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));\n\t\t\t\t\t}\n\t\t\t\t\tcharCode = ((charCode - 0xD800)<<10) + (lowCharCode - 0xDC00) + 0x10000;\n\n\t\t\t\t}\n\n\t\t\t\tif (charCode <= 0x7F) {\n\t\t\t\t\toutput[pos++] = charCode;\n\t\t\t\t} else if (charCode <= 0x7FF) {\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x1F | 0xC0;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else if (charCode <= 0xFFFF) {\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x0F | 0xE0;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else {\n\t\t\t\t\toutput[pos++] = charCode>>18 & 0x07 | 0xF0;\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\tfunction parseUTF8(input, offset, length) {\n\t\t\tvar output = \"\";\n\t\t\tvar utf16;\n\t\t\tvar pos = offset;\n\n\t\t\twhile (pos < offset+length)\n\t\t\t{\n\t\t\t\tvar byte1 = input[pos++];\n\t\t\t\tif (byte1 < 128)\n\t\t\t\t\tutf16 = byte1;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar byte2 = input[pos++]-128;\n\t\t\t\t\tif (byte2 < 0)\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),\"\"]));\n\t\t\t\t\tif (byte1 < 0xE0)             // 2 byte character\n\t\t\t\t\t\tutf16 = 64*(byte1-0xC0) + byte2;\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar byte3 = input[pos++]-128;\n\t\t\t\t\t\tif (byte3 < 0)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));\n\t\t\t\t\t\tif (byte1 < 0xF0)        // 3 byte character\n\t\t\t\t\t\t\tutf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar byte4 = input[pos++]-128;\n\t\t\t\t\t\t\tif (byte4 < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t\tif (byte1 < 0xF8)        // 4 byte character\n\t\t\t\t\t\t\t\tutf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;\n\t\t\t\t\t\t\telse                     // longer encodings are not supported\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (utf16 > 0xFFFF)   // 4 byte character - express as a surrogate pair\n\t\t\t\t{\n\t\t\t\t\tutf16 -= 0x10000;\n\t\t\t\t\toutput += String.fromCharCode(0xD800 + (utf16 >> 10)); // lead character\n\t\t\t\t\tutf16 = 0xDC00 + (utf16 & 0x3FF);  // trail character\n\t\t\t\t}\n\t\t\t\toutput += String.fromCharCode(utf16);\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Repeat keepalive requests, monitor responses.\n\t * @ignore\n\t */\n\t\tvar Pinger = function(client, keepAliveInterval) {\n\t\t\tthis._client = client;\n\t\t\tthis._keepAliveInterval = keepAliveInterval*1000;\n\t\t\tthis.isReset = false;\n\n\t\t\tvar pingReq = new WireMessage(MESSAGE_TYPE.PINGREQ).encode();\n\n\t\t\tvar doTimeout = function (pinger) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn doPing.apply(pinger);\n\t\t\t\t};\n\t\t\t};\n\n\t\t\t/** @ignore */\n\t\t\tvar doPing = function() {\n\t\t\t\tif (!this.isReset) {\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"Timed out\");\n\t\t\t\t\tthis._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));\n\t\t\t\t} else {\n\t\t\t\t\tthis.isReset = false;\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"send PINGREQ\");\n\t\t\t\t\tthis._client.socket.send(pingReq);\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.reset = function() {\n\t\t\t\tthis.isReset = true;\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t\tif (this._keepAliveInterval > 0)\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t};\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Monitor request completion.\n\t * @ignore\n\t */\n\t\tvar Timeout = function(client, timeoutSeconds, action, args) {\n\t\t\tif (!timeoutSeconds)\n\t\t\t\ttimeoutSeconds = 30;\n\n\t\t\tvar doTimeout = function (action, client, args) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn action.apply(client, args);\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t/**\n\t * Internal implementation of the Websockets MQTT V3.1 client.\n\t *\n\t * @name Paho.ClientImpl @constructor\n\t * @param {String} host the DNS nameof the webSocket host.\n\t * @param {Number} port the port number for that host.\n\t * @param {String} clientId the MQ client identifier.\n\t */\n\t\tvar ClientImpl = function (uri, host, port, path, clientId) {\n\t\t// Check dependencies are satisfied in this browser.\n\t\t\tif (!(\"WebSocket\" in global && global.WebSocket !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"WebSocket\"]));\n\t\t\t}\n\t\t\tif (!(\"ArrayBuffer\" in global && global.ArrayBuffer !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"ArrayBuffer\"]));\n\t\t\t}\n\t\t\tthis._trace(\"Paho.Client\", uri, host, port, path, clientId);\n\n\t\t\tthis.host = host;\n\t\t\tthis.port = port;\n\t\t\tthis.path = path;\n\t\t\tthis.uri = uri;\n\t\t\tthis.clientId = clientId;\n\t\t\tthis._wsuri = null;\n\n\t\t\t// Local storagekeys are qualified with the following string.\n\t\t\t// The conditional inclusion of path in the key is for backward\n\t\t\t// compatibility to when the path was not configurable and assumed to\n\t\t\t// be /mqtt\n\t\t\tthis._localKey=host+\":\"+port+(path!=\"/mqtt\"?\":\"+path:\"\")+\":\"+clientId+\":\";\n\n\t\t\t// Create private instance-only message queue\n\t\t\t// Internal queue of messages to be sent, in sending order.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\n\t\t\t// Messages we have sent and are expecting a response for, indexed by their respective message ids.\n\t\t\tthis._sentMessages = {};\n\n\t\t\t// Messages we have received and acknowleged and are expecting a confirm message for\n\t\t\t// indexed by their respective message ids.\n\t\t\tthis._receivedMessages = {};\n\n\t\t\t// Internal list of callbacks to be executed when messages\n\t\t\t// have been successfully sent over web socket, e.g. disconnect\n\t\t\t// when it doesn't have to wait for ACK, just message is dispatched.\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\t// Unique identifier for SEND messages, incrementing\n\t\t\t// counter as messages are sent.\n\t\t\tthis._message_identifier = 1;\n\n\t\t\t// Used to determine the transmission sequence of stored sent messages.\n\t\t\tthis._sequence = 0;\n\n\n\t\t\t// Load the local state, if any, from the saved version, only restore state relevant to this client.\n\t\t\tfor (var key in localStorage)\n\t\t\t\tif (   key.indexOf(\"Sent:\"+this._localKey) === 0 || key.indexOf(\"Received:\"+this._localKey) === 0)\n\t\t\t\t\tthis.restore(key);\n\t\t};\n\n\t\t// Messaging Client public instance members.\n\t\tClientImpl.prototype.host = null;\n\t\tClientImpl.prototype.port = null;\n\t\tClientImpl.prototype.path = null;\n\t\tClientImpl.prototype.uri = null;\n\t\tClientImpl.prototype.clientId = null;\n\n\t\t// Messaging Client private instance members.\n\t\tClientImpl.prototype.socket = null;\n\t\t/* true once we have received an acknowledgement to a CONNECT packet. */\n\t\tClientImpl.prototype.connected = false;\n\t\t/* The largest message identifier allowed, may not be larger than 2**16 but\n\t\t * if set smaller reduces the maximum number of outbound messages allowed.\n\t\t */\n\t\tClientImpl.prototype.maxMessageIdentifier = 65536;\n\t\tClientImpl.prototype.connectOptions = null;\n\t\tClientImpl.prototype.hostIndex = null;\n\t\tClientImpl.prototype.onConnected = null;\n\t\tClientImpl.prototype.onConnectionLost = null;\n\t\tClientImpl.prototype.onMessageDelivered = null;\n\t\tClientImpl.prototype.onMessageArrived = null;\n\t\tClientImpl.prototype.traceFunction = null;\n\t\tClientImpl.prototype._msg_queue = null;\n\t\tClientImpl.prototype._buffered_msg_queue = null;\n\t\tClientImpl.prototype._connectTimeout = null;\n\t\t/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */\n\t\tClientImpl.prototype.sendPinger = null;\n\t\t/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */\n\t\tClientImpl.prototype.receivePinger = null;\n\t\tClientImpl.prototype._reconnectInterval = 1; // Reconnect Delay, starts at 1 second\n\t\tClientImpl.prototype._reconnecting = false;\n\t\tClientImpl.prototype._reconnectTimeout = null;\n\t\tClientImpl.prototype.disconnectedPublishing = false;\n\t\tClientImpl.prototype.disconnectedBufferSize = 5000;\n\n\t\tClientImpl.prototype.receiveBuffer = null;\n\n\t\tClientImpl.prototype._traceBuffer = null;\n\t\tClientImpl.prototype._MAX_TRACE_ENTRIES = 100;\n\n\t\tClientImpl.prototype.connect = function (connectOptions) {\n\t\t\tvar connectOptionsMasked = this._traceMask(connectOptions, \"password\");\n\t\t\tthis._trace(\"Client.connect\", connectOptionsMasked, this.socket, this.connected);\n\n\t\t\tif (this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\t\t\tif (this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// connect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process to use new connect options.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tthis.connectOptions = connectOptions;\n\t\t\tthis._reconnectInterval = 1;\n\t\t\tthis._reconnecting = false;\n\t\t\tif (connectOptions.uris) {\n\t\t\t\tthis.hostIndex = 0;\n\t\t\t\tthis._doConnect(connectOptions.uris[0]);\n\t\t\t} else {\n\t\t\t\tthis._doConnect(this.uri);\n\t\t\t}\n\n\t\t};\n\n\t\tClientImpl.prototype.subscribe = function (filter, subscribeOptions) {\n\t\t\tthis._trace(\"Client.subscribe\", filter, subscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.SUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n            if (subscribeOptions.qos === undefined)\n                subscribeOptions.qos = 0;\n            wireMessage.requestedQos = [];\n            for (var i = 0; i < wireMessage.topics.length; i++)\n                wireMessage.requestedQos[i] = subscribeOptions.qos;\n\n\t\t\tif (subscribeOptions.onSuccess) {\n\t\t\t\twireMessage.onSuccess = function(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.onFailure) {\n\t\t\t\twireMessage.onFailure = function(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, subscribeOptions.timeout, subscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:subscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.SUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All subscriptions return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype.unsubscribe = function(filter, unsubscribeOptions) {\n\t\t\tthis._trace(\"Client.unsubscribe\", filter, unsubscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n\n\t\t\tif (unsubscribeOptions.onSuccess) {\n\t\t\t\twireMessage.callback = function() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};\n\t\t\t}\n\t\t\tif (unsubscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:unsubscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All unsubscribes return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.send = function (message) {\n\t\t\tthis._trace(\"Client.send\", message);\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.PUBLISH);\n\t\t\twireMessage.payloadMessage = message;\n\n\t\t\tif (this.connected) {\n\t\t\t// Mark qos 1 & 2 message as \"ACK required\"\n\t\t\t// For qos 0 message, invoke onMessageDelivered callback if there is one.\n\t\t\t// Then schedule the message.\n\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t} else if (this.onMessageDelivered) {\n\t\t\t\t\tthis._notify_msg_sent[wireMessage] = this.onMessageDelivered(wireMessage.payloadMessage);\n\t\t\t\t}\n\t\t\t\tthis._schedule_message(wireMessage);\n\t\t\t} else {\n\t\t\t// Currently disconnected, will not schedule this message\n\t\t\t// Check if reconnecting is in progress and disconnected publish is enabled.\n\t\t\t\tif (this._reconnecting && this.disconnectedPublishing) {\n\t\t\t\t// Check the limit which include the \"required ACK\" messages\n\t\t\t\t\tvar messageCount = Object.keys(this._sentMessages).length + this._buffered_msg_queue.length;\n\t\t\t\t\tif (messageCount > this.disconnectedBufferSize) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.BUFFER_FULL, [this.disconnectedBufferSize]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\t\t// Mark this message as \"ACK required\"\n\t\t\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\t\t\t\t\tthis._buffered_msg_queue.unshift(wireMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.disconnect = function () {\n\t\t\tthis._trace(\"Client.disconnect\");\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// disconnect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tif (!this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connecting or connected\"]));\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.DISCONNECT);\n\n\t\t\t// Run the disconnected call back as soon as the message has been sent,\n\t\t\t// in case of a failure later on in the disconnect processing.\n\t\t\t// as a consequence, the _disconected call back may be run several times.\n\t\t\tthis._notify_msg_sent[wireMessage] = scope(this._disconnected, this);\n\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.getTraceLog = function () {\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tthis._trace(\"Client.getTraceLog\", new Date());\n\t\t\t\tthis._trace(\"Client.getTraceLog in flight messages\", this._sentMessages.length);\n\t\t\t\tfor (var key in this._sentMessages)\n\t\t\t\t\tthis._trace(\"_sentMessages \",key, this._sentMessages[key]);\n\t\t\t\tfor (var key in this._receivedMessages)\n\t\t\t\t\tthis._trace(\"_receivedMessages \",key, this._receivedMessages[key]);\n\n\t\t\t\treturn this._traceBuffer;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.startTrace = function () {\n\t\t\tif ( this._traceBuffer === null ) {\n\t\t\t\tthis._traceBuffer = [];\n\t\t\t}\n\t\t\tthis._trace(\"Client.startTrace\", new Date(), version);\n\t\t};\n\n\t\tClientImpl.prototype.stopTrace = function () {\n\t\t\tdelete this._traceBuffer;\n\t\t};\n\n\t\tClientImpl.prototype._doConnect = function (wsurl) {\n\t\t// When the socket is open, this client will send the CONNECT WireMessage using the saved parameters.\n\t\t\tif (this.connectOptions.useSSL) {\n\t\t\t\tvar uriParts = wsurl.split(\":\");\n\t\t\t\turiParts[0] = \"wss\";\n\t\t\t\twsurl = uriParts.join(\":\");\n\t\t\t}\n\t\t\tthis._wsuri = wsurl;\n\t\t\tthis.connected = false;\n\n\n\n\t\t\tif (this.connectOptions.mqttVersion < 4) {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqttv3.1\"]);\n\t\t\t} else {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqtt\"]);\n\t\t\t}\n\t\t\tthis.socket.binaryType = \"arraybuffer\";\n\t\t\tthis.socket.onopen = scope(this._on_socket_open, this);\n\t\t\tthis.socket.onmessage = scope(this._on_socket_message, this);\n\t\t\tthis.socket.onerror = scope(this._on_socket_error, this);\n\t\t\tthis.socket.onclose = scope(this._on_socket_close, this);\n\n\t\t\tthis.sendPinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tthis.receivePinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\t\t\tthis._connectTimeout = new Timeout(this, this.connectOptions.timeout, this._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);\n\t\t};\n\n\n\t\t// Schedule a new message to be sent over the WebSockets\n\t\t// connection. CONNECT messages cause WebSocket connection\n\t\t// to be started. All other messages are queued internally\n\t\t// until this has happened. When WS connection starts, process\n\t\t// all outstanding messages.\n\t\tClientImpl.prototype._schedule_message = function (message) {\n\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\tthis._msg_queue.unshift(message);\n\t\t\t// Process outstanding messages in the queue if we have an  open socket, and have received CONNACK.\n\t\t\tif (this.connected) {\n\t\t\t\tthis._process_queue();\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.store = function(prefix, wireMessage) {\n\t\t\tvar storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};\n\n\t\t\tswitch(wireMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif(wireMessage.pubRecReceived)\n\t\t\t\t\tstoredMessage.pubRecReceived = true;\n\n\t\t\t\t// Convert the payload to a hex string.\n\t\t\t\tstoredMessage.payloadMessage = {};\n\t\t\t\tvar hex = \"\";\n\t\t\t\tvar messageBytes = wireMessage.payloadMessage.payloadBytes;\n\t\t\t\tfor (var i=0; i<messageBytes.length; i++) {\n\t\t\t\t\tif (messageBytes[i] <= 0xF)\n\t\t\t\t\t\thex = hex+\"0\"+messageBytes[i].toString(16);\n\t\t\t\t\telse\n\t\t\t\t\t\thex = hex+messageBytes[i].toString(16);\n\t\t\t\t}\n\t\t\t\tstoredMessage.payloadMessage.payloadHex = hex;\n\n\t\t\t\tstoredMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;\n\t\t\t\tstoredMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;\n\t\t\t\tif (wireMessage.payloadMessage.duplicate)\n\t\t\t\t\tstoredMessage.payloadMessage.duplicate = true;\n\t\t\t\tif (wireMessage.payloadMessage.retained)\n\t\t\t\t\tstoredMessage.payloadMessage.retained = true;\n\n\t\t\t\t// Add a sequence number to sent messages.\n\t\t\t\tif ( prefix.indexOf(\"Sent:\") === 0 ) {\n\t\t\t\t\tif ( wireMessage.sequence === undefined )\n\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\tstoredMessage.sequence = wireMessage.sequence;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [prefix+this._localKey+wireMessage.messageIdentifier, storedMessage]));\n\t\t\t}\n\t\t\tlocalStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));\n\t\t};\n\n\t\tClientImpl.prototype.restore = function(key) {\n\t\t\tvar value = localStorage.getItem(key);\n\t\t\tvar storedMessage = JSON.parse(value);\n\n\t\t\tvar wireMessage = new WireMessage(storedMessage.type, storedMessage);\n\n\t\t\tswitch(storedMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// Replace the payload message with a Message object.\n\t\t\t\tvar hex = storedMessage.payloadMessage.payloadHex;\n\t\t\t\tvar buffer = new ArrayBuffer((hex.length)/2);\n\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (hex.length >= 2) {\n\t\t\t\t\tvar x = parseInt(hex.substring(0, 2), 16);\n\t\t\t\t\thex = hex.substring(2, hex.length);\n\t\t\t\t\tbyteStream[i++] = x;\n\t\t\t\t}\n\t\t\t\tvar payloadMessage = new Message(byteStream);\n\n\t\t\t\tpayloadMessage.qos = storedMessage.payloadMessage.qos;\n\t\t\t\tpayloadMessage.destinationName = storedMessage.payloadMessage.destinationName;\n\t\t\t\tif (storedMessage.payloadMessage.duplicate)\n\t\t\t\t\tpayloadMessage.duplicate = true;\n\t\t\t\tif (storedMessage.payloadMessage.retained)\n\t\t\t\t\tpayloadMessage.retained = true;\n\t\t\t\twireMessage.payloadMessage = payloadMessage;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [key, value]));\n\t\t\t}\n\n\t\t\tif (key.indexOf(\"Sent:\"+this._localKey) === 0) {\n\t\t\t\twireMessage.payloadMessage.duplicate = true;\n\t\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t} else if (key.indexOf(\"Received:\"+this._localKey) === 0) {\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._process_queue = function () {\n\t\t\tvar message = null;\n\n\t\t\t// Send all queued messages down socket connection\n\t\t\twhile ((message = this._msg_queue.pop())) {\n\t\t\t\tthis._socket_send(message);\n\t\t\t\t// Notify listeners that message was successfully sent\n\t\t\t\tif (this._notify_msg_sent[message]) {\n\t\t\t\t\tthis._notify_msg_sent[message]();\n\t\t\t\t\tdelete this._notify_msg_sent[message];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Expect an ACK response for this message. Add message to the set of in progress\n\t * messages and set an unused identifier in this message.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._requires_ack = function (wireMessage) {\n\t\t\tvar messageCount = Object.keys(this._sentMessages).length;\n\t\t\tif (messageCount > this.maxMessageIdentifier)\n\t\t\t\tthrow Error (\"Too many messages:\"+messageCount);\n\n\t\t\twhile(this._sentMessages[this._message_identifier] !== undefined) {\n\t\t\t\tthis._message_identifier++;\n\t\t\t}\n\t\t\twireMessage.messageIdentifier = this._message_identifier;\n\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\tif (wireMessage.type === MESSAGE_TYPE.PUBLISH) {\n\t\t\t\tthis.store(\"Sent:\", wireMessage);\n\t\t\t}\n\t\t\tif (this._message_identifier === this.maxMessageIdentifier) {\n\t\t\t\tthis._message_identifier = 1;\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has been opened.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_open = function () {\n\t\t// Create the CONNECT message object.\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.CONNECT, this.connectOptions);\n\t\t\twireMessage.clientId = this.clientId;\n\t\t\tthis._socket_send(wireMessage);\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has received a complete packet.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_message = function (event) {\n\t\t\tthis._trace(\"Client._on_socket_message\", event.data);\n\t\t\tvar messages = this._deframeMessages(event.data);\n\t\t\tfor (var i = 0; i < messages.length; i+=1) {\n\t\t\t\tthis._handleMessage(messages[i]);\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._deframeMessages = function(data) {\n\t\t\tvar byteArray = new Uint8Array(data);\n\t\t\tvar messages = [];\n\t\t\tif (this.receiveBuffer) {\n\t\t\t\tvar newData = new Uint8Array(this.receiveBuffer.length+byteArray.length);\n\t\t\t\tnewData.set(this.receiveBuffer);\n\t\t\t\tnewData.set(byteArray,this.receiveBuffer.length);\n\t\t\t\tbyteArray = newData;\n\t\t\t\tdelete this.receiveBuffer;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar offset = 0;\n\t\t\t\twhile(offset < byteArray.length) {\n\t\t\t\t\tvar result = decodeMessage(byteArray,offset);\n\t\t\t\t\tvar wireMessage = result[0];\n\t\t\t\t\toffset = result[1];\n\t\t\t\t\tif (wireMessage !== null) {\n\t\t\t\t\t\tmessages.push(wireMessage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (offset < byteArray.length) {\n\t\t\t\t\tthis.receiveBuffer = byteArray.subarray(offset);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn messages;\n\t\t};\n\n\t\tClientImpl.prototype._handleMessage = function(wireMessage) {\n\n\t\t\tthis._trace(\"Client._handleMessage\", wireMessage);\n\n\t\t\ttry {\n\t\t\t\tswitch(wireMessage.type) {\n\t\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\t\tif (this._reconnectTimeout)\n\t\t\t\t\t\tthis._reconnectTimeout.cancel();\n\n\t\t\t\t\t// If we have started using clean session then clear up the local state.\n\t\t\t\t\tif (this.connectOptions.cleanSession) {\n\t\t\t\t\t\tfor (var key in this._sentMessages) {\n\t\t\t\t\t\t\tvar sentMessage = this._sentMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+sentMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._sentMessages = {};\n\n\t\t\t\t\t\tfor (var key in this._receivedMessages) {\n\t\t\t\t\t\t\tvar receivedMessage = this._receivedMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+receivedMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._receivedMessages = {};\n\t\t\t\t\t}\n\t\t\t\t\t// Client connected and ready for business.\n\t\t\t\t\tif (wireMessage.returnCode === 0) {\n\n\t\t\t\t\t\tthis.connected = true;\n\t\t\t\t\t\t// Jump to the end of the list of uris and stop looking for a good host.\n\n\t\t\t\t\t\tif (this.connectOptions.uris)\n\t\t\t\t\t\t\tthis.hostIndex = this.connectOptions.uris.length;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Resend messages.\n\t\t\t\t\tvar sequencedMessages = [];\n\t\t\t\t\tfor (var msgId in this._sentMessages) {\n\t\t\t\t\t\tif (this._sentMessages.hasOwnProperty(msgId))\n\t\t\t\t\t\t\tsequencedMessages.push(this._sentMessages[msgId]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Also schedule qos 0 buffered messages if any\n\t\t\t\t\tif (this._buffered_msg_queue.length > 0) {\n\t\t\t\t\t\tvar msg = null;\n\t\t\t\t\t\twhile ((msg = this._buffered_msg_queue.pop())) {\n\t\t\t\t\t\t\tsequencedMessages.push(msg);\n\t\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\t\tthis._notify_msg_sent[msg] = this.onMessageDelivered(msg.payloadMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sort sentMessages into the original sent order.\n\t\t\t\t\tvar sequencedMessages = sequencedMessages.sort(function(a,b) {return a.sequence - b.sequence;} );\n\t\t\t\t\tfor (var i=0, len=sequencedMessages.length; i<len; i++) {\n\t\t\t\t\t\tvar sentMessage = sequencedMessages[i];\n\t\t\t\t\t\tif (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {\n\t\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});\n\t\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._schedule_message(sentMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the connectOptions.onSuccess callback if there is one.\n\t\t\t\t\t// Will also now return if this connection was the result of an automatic\n\t\t\t\t\t// reconnect and which URI was successfully connected to.\n\t\t\t\t\tif (this.connectOptions.onSuccess) {\n\t\t\t\t\t\tthis.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar reconnected = false;\n\t\t\t\t\tif (this._reconnecting) {\n\t\t\t\t\t\treconnected = true;\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnecting = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the onConnected callback if there is one.\n\t\t\t\t\tthis._connected(reconnected, this._wsuri);\n\n\t\t\t\t\t// Process all queued messages now that the connection is established.\n\t\t\t\t\tthis._process_queue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t\tthis._receivePublish(wireMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBACK after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREC:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBREC after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tsentMessage.pubRecReceived = true;\n\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\t\tthis.store(\"Sent:\", sentMessage);\n\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\t\tvar receivedMessage = this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t// If this is a re flow of a PUBREL after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (receivedMessage) {\n\t\t\t\t\t\tthis._receiveMessage(receivedMessage);\n\t\t\t\t\t\tdelete this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\t// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.\n\t\t\t\t\tvar pubCompMessage = new WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\tthis._schedule_message(pubCompMessage);\n\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.SUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif(sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\t// This will need to be fixed when we add multiple topic support\n\t\t\t\t\t\tif (wireMessage.returnCode[0] === 0x80) {\n\t\t\t\t\t\t\tif (sentMessage.onFailure) {\n\t\t\t\t\t\t\t\tsentMessage.onFailure(wireMessage.returnCode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (sentMessage.onSuccess) {\n\t\t\t\t\t\t\tsentMessage.onSuccess(wireMessage.returnCode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.UNSUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif (sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\tif (sentMessage.callback) {\n\t\t\t\t\t\t\tsentMessage.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PINGRESP:\n\t\t\t\t/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */\n\t\t\t\t\tthis.sendPinger.reset();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\t// Clients do not expect to receive disconnect packets.\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_error = function (error) {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_close = function () {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._socket_send = function (wireMessage) {\n\n\t\t\tif (wireMessage.type == 1) {\n\t\t\t\tvar wireMessageMasked = this._traceMask(wireMessage, \"password\");\n\t\t\t\tthis._trace(\"Client._socket_send\", wireMessageMasked);\n\t\t\t}\n\t\t\telse this._trace(\"Client._socket_send\", wireMessage);\n\n\t\t\tthis.socket.send(wireMessage.encode());\n\t\t\t/* We have proved to the server we are alive. */\n\t\t\tthis.sendPinger.reset();\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receivePublish = function (wireMessage) {\n\t\t\tswitch(wireMessage.payloadMessage.qos) {\n\t\t\tcase \"undefined\":\n\t\t\tcase 0:\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\tvar pubAckMessage = new WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubAckMessage);\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t\tthis.store(\"Received:\", wireMessage);\n\t\t\t\tvar pubRecMessage = new WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubRecMessage);\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(\"Invaild qos=\" + wireMessage.payloadMessage.qos);\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receiveMessage = function (wireMessage) {\n\t\t\tif (this.onMessageArrived) {\n\t\t\t\tthis.onMessageArrived(wireMessage.payloadMessage);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has connected.\n\t * @param {reconnect} [boolean] indicate if this was a result of reconnect operation.\n\t * @param {uri} [string] fully qualified WebSocket URI of the server.\n\t */\n\t\tClientImpl.prototype._connected = function (reconnect, uri) {\n\t\t// Execute the onConnected callback if there is one.\n\t\t\tif (this.onConnected)\n\t\t\t\tthis.onConnected(reconnect, uri);\n\t\t};\n\n\t\t/**\n\t * Attempts to reconnect the client to the server.\n   * For each reconnect attempt, will double the reconnect interval\n   * up to 128 seconds.\n\t */\n\t\tClientImpl.prototype._reconnect = function () {\n\t\t\tthis._trace(\"Client._reconnect\");\n\t\t\tif (!this.connected) {\n\t\t\t\tthis._reconnecting = true;\n\t\t\t\tthis.sendPinger.cancel();\n\t\t\t\tthis.receivePinger.cancel();\n\t\t\t\tif (this._reconnectInterval < 128)\n\t\t\t\t\tthis._reconnectInterval = this._reconnectInterval * 2;\n\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has disconnected either at its own request or because the server\n\t * or network disconnected it. Remove all non-durable state.\n\t * @param {errorCode} [number] the error number.\n\t * @param {errorText} [string] the error text.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._disconnected = function (errorCode, errorText) {\n\t\t\tthis._trace(\"Client._disconnected\", errorCode, errorText);\n\n\t\t\tif (errorCode !== undefined && this._reconnecting) {\n\t\t\t\t//Continue automatic reconnect process\n\t\t\t\tthis._reconnectTimeout = new Timeout(this, this._reconnectInterval, this._reconnect);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendPinger.cancel();\n\t\t\tthis.receivePinger.cancel();\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\n\t\t\t// Clear message buffers.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\tif (this.socket) {\n\t\t\t// Cancel all socket callbacks so that they cannot be driven again by this socket.\n\t\t\t\tthis.socket.onopen = null;\n\t\t\t\tthis.socket.onmessage = null;\n\t\t\t\tthis.socket.onerror = null;\n\t\t\t\tthis.socket.onclose = null;\n\t\t\t\tif (this.socket.readyState === 1)\n\t\t\t\t\tthis.socket.close();\n\t\t\t\tdelete this.socket;\n\t\t\t}\n\n\t\t\tif (this.connectOptions.uris && this.hostIndex < this.connectOptions.uris.length-1) {\n\t\t\t// Try the next host.\n\t\t\t\tthis.hostIndex++;\n\t\t\t\tthis._doConnect(this.connectOptions.uris[this.hostIndex]);\n\t\t\t} else {\n\n\t\t\t\tif (errorCode === undefined) {\n\t\t\t\t\terrorCode = ERROR.OK.code;\n\t\t\t\t\terrorText = format(ERROR.OK);\n\t\t\t\t}\n\n\t\t\t\t// Run any application callbacks last as they may attempt to reconnect and hence create a new socket.\n\t\t\t\tif (this.connected) {\n\t\t\t\t\tthis.connected = false;\n\t\t\t\t\t// Execute the connectionLostCallback if there is one, and we were connected.\n\t\t\t\t\tif (this.onConnectionLost) {\n\t\t\t\t\t\tthis.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:this.connectOptions.reconnect, uri:this._wsuri});\n\t\t\t\t\t}\n\t\t\t\t\tif (errorCode !== ERROR.OK.code && this.connectOptions.reconnect) {\n\t\t\t\t\t// Start automatic reconnect process for the very first time since last successful connect.\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnect();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t// Otherwise we never had a connection, so indicate that the connect has failed.\n\t\t\t\t\tif (this.connectOptions.mqttVersion === 4 && this.connectOptions.mqttVersionExplicit === false) {\n\t\t\t\t\t\tthis._trace(\"Failed to connect V4, dropping back to V3\");\n\t\t\t\t\t\tthis.connectOptions.mqttVersion = 3;\n\t\t\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(this.connectOptions.onFailure) {\n\t\t\t\t\t\tthis.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._trace = function () {\n\t\t// Pass trace message back to client's callback function\n\t\t\tif (this.traceFunction) {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\tfor (var i in args)\n\t\t\t\t{\n\t\t\t\t\tif (typeof args[i] !== \"undefined\")\n\t\t\t\t\t\targs.splice(i, 1, JSON.stringify(args[i]));\n\t\t\t\t}\n\t\t\t\tvar record = args.join(\"\");\n\t\t\t\tthis.traceFunction ({severity: \"Debug\", message: record\t});\n\t\t\t}\n\n\t\t\t//buffer style trace\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tfor (var i = 0, max = arguments.length; i < max; i++) {\n\t\t\t\t\tif ( this._traceBuffer.length == this._MAX_TRACE_ENTRIES ) {\n\t\t\t\t\t\tthis._traceBuffer.shift();\n\t\t\t\t\t}\n\t\t\t\t\tif (i === 0) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse if (typeof arguments[i] === \"undefined\" ) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse this._traceBuffer.push(\"  \"+JSON.stringify(arguments[i]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._traceMask = function (traceObject, masked) {\n\t\t\tvar traceObjectMasked = {};\n\t\t\tfor (var attr in traceObject) {\n\t\t\t\tif (traceObject.hasOwnProperty(attr)) {\n\t\t\t\t\tif (attr == masked)\n\t\t\t\t\t\ttraceObjectMasked[attr] = \"******\";\n\t\t\t\t\telse\n\t\t\t\t\t\ttraceObjectMasked[attr] = traceObject[attr];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn traceObjectMasked;\n\t\t};\n\n\t\t// ------------------------------------------------------------------------\n\t\t// Public Programming interface.\n\t\t// ------------------------------------------------------------------------\n\n\t\t/**\n\t * The JavaScript application communicates to the server using a {@link Paho.Client} object.\n\t * <p>\n\t * Most applications will create just one Client object and then call its connect() method,\n\t * however applications can create more than one Client object if they wish.\n\t * In this case the combination of host, port and clientId attributes must be different for each Client object.\n\t * <p>\n\t * The send, subscribe and unsubscribe methods are implemented as asynchronous JavaScript methods\n\t * (even though the underlying protocol exchange might be synchronous in nature).\n\t * This means they signal their completion by calling back to the application,\n\t * via Success or Failure callback functions provided by the application on the method in question.\n\t * Such callbacks are called at most once per method invocation and do not persist beyond the lifetime\n\t * of the script that made the invocation.\n\t * <p>\n\t * In contrast there are some callback functions, most notably <i>onMessageArrived</i>,\n\t * that are defined on the {@link Paho.Client} object.\n\t * These may get called multiple times, and aren't directly related to specific method invocations made by the client.\n\t *\n\t * @name Paho.Client\n\t *\n\t * @constructor\n\t *\n\t * @param {string} host - the address of the messaging server, as a fully qualified WebSocket URI, as a DNS name or dotted decimal IP address.\n\t * @param {number} port - the port number to connect to - only required if host is not a URI\n\t * @param {string} path - the path on the host to connect to - only used if host is not a URI. Default: '/mqtt'.\n\t * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters in length.\n\t *\n\t * @property {string} host - <i>read only</i> the server's DNS hostname or dotted decimal IP address.\n\t * @property {number} port - <i>read only</i> the server's port.\n\t * @property {string} path - <i>read only</i> the server's path.\n\t * @property {string} clientId - <i>read only</i> used when connecting to the server.\n\t * @property {function} onConnectionLost - called when a connection has been lost.\n\t *                            after a connect() method has succeeded.\n\t *                            Establish the call back used when a connection has been lost. The connection may be\n\t *                            lost because the client initiates a disconnect or because the server or network\n\t *                            cause the client to be disconnected. The disconnect call back may be called without\n\t *                            the connectionComplete call back being invoked if, for example the client fails to\n\t *                            connect.\n\t *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:\n\t *                            <ol>\n\t *                            <li>errorCode\n\t *                            <li>errorMessage\n\t *                            </ol>\n\t * @property {function} onMessageDelivered - called when a message has been delivered.\n\t *                            All processing that this Client will ever do has been completed. So, for example,\n\t *                            in the case of a Qos=2 message sent by this client, the PubComp flow has been received from the server\n\t *                            and the message has been removed from persistent storage before this callback is invoked.\n\t *                            Parameters passed to the onMessageDelivered callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that was delivered.\n\t *                            </ol>\n\t * @property {function} onMessageArrived - called when a message has arrived in this Paho.client.\n\t *                            Parameters passed to the onMessageArrived callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that has arrived.\n\t *                            </ol>\n\t * @property {function} onConnected - called when a connection is successfully made to the server.\n\t *                                  after a connect() method.\n\t *                                  Parameters passed to the onConnected callback are:\n\t *                                  <ol>\n\t *                                  <li>reconnect (boolean) - If true, the connection was the result of a reconnect.</li>\n\t *                                  <li>URI (string) - The URI used to connect to the server.</li>\n\t *                                  </ol>\n\t * @property {boolean} disconnectedPublishing - if set, will enable disconnected publishing in\n\t *                                            in the event that the connection to the server is lost.\n\t * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected\n\t *                                             buffer will hold before rejecting new messages. Default size: 5000 messages\n\t * @property {function} trace - called whenever trace is called. TODO\n\t */\n\t\tvar Client = function (host, port, path, clientId) {\n\n\t\t\tvar uri;\n\n\t\t\tif (typeof host !== \"string\")\n\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof host, \"host\"]));\n\n\t\t\tif (arguments.length == 2) {\n\t\t\t// host: must be full ws:// uri\n\t\t\t// port: clientId\n\t\t\t\tclientId = port;\n\t\t\t\turi = host;\n\t\t\t\tvar match = uri.match(/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/);\n\t\t\t\tif (match) {\n\t\t\t\t\thost = match[4]||match[2];\n\t\t\t\t\tport = parseInt(match[7]);\n\t\t\t\t\tpath = match[8];\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[host,\"host\"]));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (arguments.length == 3) {\n\t\t\t\t\tclientId = path;\n\t\t\t\t\tpath = \"/mqtt\";\n\t\t\t\t}\n\t\t\t\tif (typeof port !== \"number\" || port < 0)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof port, \"port\"]));\n\t\t\t\tif (typeof path !== \"string\")\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof path, \"path\"]));\n\n\t\t\t\tvar ipv6AddSBracket = (host.indexOf(\":\") !== -1 && host.slice(0,1) !== \"[\" && host.slice(-1) !== \"]\");\n\t\t\t\turi = \"ws://\"+(ipv6AddSBracket?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t}\n\n\t\t\tvar clientIdLength = 0;\n\t\t\tfor (var i = 0; i<clientId.length; i++) {\n\t\t\t\tvar charCode = clientId.charCodeAt(i);\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)  {\n\t\t\t\t\ti++; // Surrogate pair.\n\t\t\t\t}\n\t\t\t\tclientIdLength++;\n\t\t\t}\n\t\t\tif (typeof clientId !== \"string\" || clientIdLength > 65535)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [clientId, \"clientId\"]));\n\n\t\t\tvar client = new ClientImpl(uri, host, port, path, clientId);\n\n\t\t\t//Public Properties\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"host\":{\n\t\t\t\t\tget: function() { return host; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"port\":{\n\t\t\t\t\tget: function() { return port; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"path\":{\n\t\t\t\t\tget: function() { return path; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"uri\":{\n\t\t\t\t\tget: function() { return uri; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"clientId\":{\n\t\t\t\t\tget: function() { return client.clientId; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"onConnected\":{\n\t\t\t\t\tget: function() { return client.onConnected; },\n\t\t\t\t\tset: function(newOnConnected) {\n\t\t\t\t\t\tif (typeof newOnConnected === \"function\")\n\t\t\t\t\t\t\tclient.onConnected = newOnConnected;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnected, \"onConnected\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedPublishing\":{\n\t\t\t\t\tget: function() { return client.disconnectedPublishing; },\n\t\t\t\t\tset: function(newDisconnectedPublishing) {\n\t\t\t\t\t\tclient.disconnectedPublishing = newDisconnectedPublishing;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedBufferSize\":{\n\t\t\t\t\tget: function() { return client.disconnectedBufferSize; },\n\t\t\t\t\tset: function(newDisconnectedBufferSize) {\n\t\t\t\t\t\tclient.disconnectedBufferSize = newDisconnectedBufferSize;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onConnectionLost\":{\n\t\t\t\t\tget: function() { return client.onConnectionLost; },\n\t\t\t\t\tset: function(newOnConnectionLost) {\n\t\t\t\t\t\tif (typeof newOnConnectionLost === \"function\")\n\t\t\t\t\t\t\tclient.onConnectionLost = newOnConnectionLost;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnectionLost, \"onConnectionLost\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageDelivered\":{\n\t\t\t\t\tget: function() { return client.onMessageDelivered; },\n\t\t\t\t\tset: function(newOnMessageDelivered) {\n\t\t\t\t\t\tif (typeof newOnMessageDelivered === \"function\")\n\t\t\t\t\t\t\tclient.onMessageDelivered = newOnMessageDelivered;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageDelivered, \"onMessageDelivered\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageArrived\":{\n\t\t\t\t\tget: function() { return client.onMessageArrived; },\n\t\t\t\t\tset: function(newOnMessageArrived) {\n\t\t\t\t\t\tif (typeof newOnMessageArrived === \"function\")\n\t\t\t\t\t\t\tclient.onMessageArrived = newOnMessageArrived;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageArrived, \"onMessageArrived\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"trace\":{\n\t\t\t\t\tget: function() { return client.traceFunction; },\n\t\t\t\t\tset: function(trace) {\n\t\t\t\t\t\tif(typeof trace === \"function\"){\n\t\t\t\t\t\t\tclient.traceFunction = trace;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof trace, \"onTrace\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t/**\n\t\t * Connect this Messaging client to its server.\n\t\t *\n\t\t * @name Paho.Client#connect\n\t\t * @function\n\t\t * @param {object} connectOptions - Attributes used with the connection.\n\t\t * @param {number} connectOptions.timeout - If the connect has not succeeded within this\n\t\t *                    number of seconds, it is deemed to have failed.\n\t\t *                    The default is 30 seconds.\n\t\t * @param {string} connectOptions.userName - Authentication username for this connection.\n\t\t * @param {string} connectOptions.password - Authentication password for this connection.\n\t\t * @param {Paho.Message} connectOptions.willMessage - sent by the server when the client\n\t\t *                    disconnects abnormally.\n\t\t * @param {number} connectOptions.keepAliveInterval - the server disconnects this client if\n\t\t *                    there is no activity for this number of seconds.\n\t\t *                    The default value of 60 seconds is assumed if not set.\n\t\t * @param {boolean} connectOptions.cleanSession - if true(default) the client and server\n\t\t *                    persistent state is deleted on successful connect.\n\t\t * @param {boolean} connectOptions.useSSL - if present and true, use an SSL Websocket connection.\n\t\t * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.\n\t\t * @param {function} connectOptions.onSuccess - called when the connect acknowledgement\n\t\t *                    has been received from the server.\n\t\t * A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onSuccess method in the connectOptions.\n\t\t * </ol>\n\t * @param {function} connectOptions.onFailure - called when the connect request has failed or timed out.\n\t\t * A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onFailure method in the connectOptions.\n\t\t * <li>errorCode a number indicating the nature of the error.\n\t\t * <li>errorMessage text describing the error.\n\t\t * </ol>\n\t * @param {array} connectOptions.hosts - If present this contains either a set of hostnames or fully qualified\n\t\t * WebSocket URIs (ws://iot.eclipse.org:80/ws), that are tried in order in place\n\t\t * of the host and port paramater on the construtor. The hosts are tried one at at time in order until\n\t\t * one of then succeeds.\n\t * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, this property\n\t\t * is not used.\n\t * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect\n\t * to the server if the connection is lost.\n\t *<ul>\n\t *<li>If set to false, the client will not attempt to automatically reconnect to the server in the event that the\n\t * connection is lost.</li>\n\t *<li>If set to true, in the event that the connection is lost, the client will attempt to reconnect to the server.\n\t * It will initially wait 1 second before it attempts to reconnect, for every failed reconnect attempt, the delay\n\t * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.</li>\n\t *</ul>\n\t * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.\n\t *<ul>\n\t *<li>3 - MQTT V3.1</li>\n\t *<li>4 - MQTT V3.1.1</li>\n\t *</ul>\n\t * @param {boolean} connectOptions.mqttVersionExplicit - If set to true, will force the connection to use the\n\t * selected MQTT Version or will fail to connect.\n\t * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris\n\t * (e.g. ws://iot.eclipse.org:80/ws), that are tried in order in place of the host and port parameter of the construtor.\n\t * The uris are tried one at a time in order until one of them succeeds. Do not use this in conjunction with hosts as\n\t * the hosts array will be converted to uris and will overwrite this property.\n\t\t * @throws {InvalidState} If the client is not in disconnected state. The client must have received connectionLost\n\t\t * or disconnected before calling connect for a second or subsequent time.\n\t\t */\n\t\t\tthis.connect = function (connectOptions) {\n\t\t\t\tconnectOptions = connectOptions || {} ;\n\t\t\t\tvalidate(connectOptions,  {timeout:\"number\",\n\t\t\t\t\tuserName:\"string\",\n\t\t\t\t\tpassword:\"string\",\n\t\t\t\t\twillMessage:\"object\",\n\t\t\t\t\tkeepAliveInterval:\"number\",\n\t\t\t\t\tcleanSession:\"boolean\",\n\t\t\t\t\tuseSSL:\"boolean\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\thosts:\"object\",\n\t\t\t\t\tports:\"object\",\n\t\t\t\t\treconnect:\"boolean\",\n\t\t\t\t\tmqttVersion:\"number\",\n\t\t\t\t\tmqttVersionExplicit:\"boolean\",\n\t\t\t\t\turis: \"object\"});\n\n\t\t\t\t// If no keep alive interval is set, assume 60 seconds.\n\t\t\t\tif (connectOptions.keepAliveInterval === undefined)\n\t\t\t\t\tconnectOptions.keepAliveInterval = 60;\n\n\t\t\t\tif (connectOptions.mqttVersion > 4 || connectOptions.mqttVersion < 3) {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, \"connectOptions.mqttVersion\"]));\n\t\t\t\t}\n\n\t\t\t\tif (connectOptions.mqttVersion === undefined) {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = false;\n\t\t\t\t\tconnectOptions.mqttVersion = 4;\n\t\t\t\t} else {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = true;\n\t\t\t\t}\n\n\t\t\t\t//Check that if password is set, so is username\n\t\t\t\tif (connectOptions.password !== undefined && connectOptions.userName === undefined)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, \"connectOptions.password\"]));\n\n\t\t\t\tif (connectOptions.willMessage) {\n\t\t\t\t\tif (!(connectOptions.willMessage instanceof Message))\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, \"connectOptions.willMessage\"]));\n\t\t\t\t\t// The will message must have a payload that can be represented as a string.\n\t\t\t\t\t// Cause the willMessage to throw an exception if this is not the case.\n\t\t\t\t\tconnectOptions.willMessage.stringPayload = null;\n\n\t\t\t\t\tif (typeof connectOptions.willMessage.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.willMessage.destinationName, \"connectOptions.willMessage.destinationName\"]));\n\t\t\t\t}\n\t\t\t\tif (typeof connectOptions.cleanSession === \"undefined\")\n\t\t\t\t\tconnectOptions.cleanSession = true;\n\t\t\t\tif (connectOptions.hosts) {\n\n\t\t\t\t\tif (!(connectOptions.hosts instanceof Array) )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\t\t\t\t\tif (connectOptions.hosts.length <1 )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\n\t\t\t\t\tvar usingURIs = false;\n\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\tif (typeof connectOptions.hosts[i] !== \"string\")\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\tif (/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/.test(connectOptions.hosts[i])) {\n\t\t\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\t\t\tusingURIs = true;\n\t\t\t\t\t\t\t} else if (!usingURIs) {\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (usingURIs) {\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!usingURIs) {\n\t\t\t\t\t\tif (!connectOptions.ports)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (!(connectOptions.ports instanceof Array) )\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (connectOptions.hosts.length !== connectOptions.ports.length)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\n\t\t\t\t\t\tconnectOptions.uris = [];\n\n\t\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\t\tif (typeof connectOptions.ports[i] !== \"number\" || connectOptions.ports[i] < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.ports[i], \"connectOptions.ports[\"+i+\"]\"]));\n\t\t\t\t\t\t\tvar host = connectOptions.hosts[i];\n\t\t\t\t\t\t\tvar port = connectOptions.ports[i];\n\n\t\t\t\t\t\t\tvar ipv6 = (host.indexOf(\":\") !== -1);\n\t\t\t\t\t\t\turi = \"ws://\"+(ipv6?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t\t\t\t\tconnectOptions.uris.push(uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconnectOptions.uris = connectOptions.hosts;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tclient.connect(connectOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Subscribe for messages, request receipt of a copy of messages sent to the destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#subscribe\n\t\t * @function\n\t\t * @param {string} filter describing the destinations to receive messages from.\n\t\t * <br>\n\t\t * @param {object} subscribeOptions - used to control the subscription\n\t\t *\n\t\t * @param {number} subscribeOptions.qos - the maximum qos of any publications sent\n\t\t *                                  as a result of making this subscription.\n\t\t * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t *                                  or onFailure callback.\n\t\t * @param {function} subscribeOptions.onSuccess - called when the subscribe acknowledgement\n\t\t *                                  has been received from the server.\n\t\t *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext if set in the subscribeOptions.\n\t\t *                                  </ol>\n\t\t * @param {function} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.\n\t\t *                                  A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext - if set in the subscribeOptions.\n\t\t *                                  <li>errorCode - a number indicating the nature of the error.\n\t\t *                                  <li>errorMessage - text describing the error.\n\t\t *                                  </ol>\n\t\t * @param {number} subscribeOptions.timeout - which, if present, determines the number of\n\t\t *                                  seconds after which the onFailure calback is called.\n\t\t *                                  The presence of a timeout does not prevent the onSuccess\n\t\t *                                  callback from being called when the subscribe completes.\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.subscribe = function (filter, subscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tsubscribeOptions = subscribeOptions || {} ;\n\t\t\t\tvalidate(subscribeOptions,  {qos:\"number\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (subscribeOptions.timeout && !subscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"subscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tif (typeof subscribeOptions.qos !== \"undefined\" && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, \"subscribeOptions.qos\"]));\n\t\t\t\tclient.subscribe(filter, subscribeOptions);\n\t\t\t};\n\n\t\t/**\n\t\t * Unsubscribe for messages, stop receiving messages sent to destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#unsubscribe\n\t\t * @function\n\t\t * @param {string} filter - describing the destinations to receive messages from.\n\t\t * @param {object} unsubscribeOptions - used to control the subscription\n\t\t * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t\t\t\t\t\t\t\t\t\t  or onFailure callback.\n\t\t * @param {function} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received from the server.\n\t\t *                                    A single response object parameter is passed to the\n\t\t *                                    onSuccess callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    </ol>\n\t\t * @param {function} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.\n\t\t *                                    A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    <li>errorCode - a number indicating the nature of the error.\n\t\t *                                    <li>errorMessage - text describing the error.\n\t\t *                                    </ol>\n\t\t * @param {number} unsubscribeOptions.timeout - which, if present, determines the number of seconds\n\t\t *                                    after which the onFailure callback is called. The presence of\n\t\t *                                    a timeout does not prevent the onSuccess callback from being\n\t\t *                                    called when the unsubscribe completes\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.unsubscribe = function (filter, unsubscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tunsubscribeOptions = unsubscribeOptions || {} ;\n\t\t\t\tvalidate(unsubscribeOptions,  {invocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"unsubscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tclient.unsubscribe(filter, unsubscribeOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Send a message to the consumers of the destination in the Message.\n\t\t *\n\t\t * @name Paho.Client#send\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the destination to which the message is to be sent.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be sent.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.send = function (topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Publish a message to the consumers of the destination in the Message.\n\t\t * Synonym for Paho.Mqtt.Client#send\n\t\t *\n\t\t * @name Paho.Client#publish\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the topic to which the message is to be published.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be published.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.publish = function(topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Normal disconnect of this Messaging client from its server.\n\t\t *\n\t\t * @name Paho.Client#disconnect\n\t\t * @function\n\t\t * @throws {InvalidState} if the client is already disconnected.\n\t\t */\n\t\t\tthis.disconnect = function () {\n\t\t\t\tclient.disconnect();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Get the contents of the trace log.\n\t\t *\n\t\t * @name Paho.Client#getTraceLog\n\t\t * @function\n\t\t * @return {Object[]} tracebuffer containing the time ordered trace records.\n\t\t */\n\t\t\tthis.getTraceLog = function () {\n\t\t\t\treturn client.getTraceLog();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Start tracing.\n\t\t *\n\t\t * @name Paho.Client#startTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.startTrace = function () {\n\t\t\t\tclient.startTrace();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Stop tracing.\n\t\t *\n\t\t * @name Paho.Client#stopTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.stopTrace = function () {\n\t\t\t\tclient.stopTrace();\n\t\t\t};\n\n\t\t\tthis.isConnected = function() {\n\t\t\t\treturn client.connected;\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * An application message, sent or received.\n\t * <p>\n\t * All attributes may be null, which implies the default values.\n\t *\n\t * @name Paho.Message\n\t * @constructor\n\t * @param {String|ArrayBuffer} payload The message data to be sent.\n\t * <p>\n\t * @property {string} payloadString <i>read only</i> The payload as a string if the payload consists of valid UTF-8 characters.\n\t * @property {ArrayBuffer} payloadBytes <i>read only</i> The payload as an ArrayBuffer.\n\t * <p>\n\t * @property {string} destinationName <b>mandatory</b> The name of the destination to which the message is to be sent\n\t *                    (for messages about to be sent) or the name of the destination from which the message has been received.\n\t *                    (for messages received by the onMessage function).\n\t * <p>\n\t * @property {number} qos The Quality of Service used to deliver the message.\n\t * <dl>\n\t *     <dt>0 Best effort (default).\n\t *     <dt>1 At least once.\n\t *     <dt>2 Exactly once.\n\t * </dl>\n\t * <p>\n\t * @property {Boolean} retained If true, the message is to be retained by the server and delivered\n\t *                     to both current and future subscriptions.\n\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t *                     A received message has the retained boolean set to true if the message was published\n\t *                     with the retained boolean set to true\n\t *                     and the subscrption was made after the message has been published.\n\t * <p>\n\t * @property {Boolean} duplicate <i>read only</i> If true, this message might be a duplicate of one which has already been received.\n\t *                     This is only set on messages received from the server.\n\t *\n\t */\n\t\tvar Message = function (newPayload) {\n\t\t\tvar payload;\n\t\t\tif (   typeof newPayload === \"string\" ||\n\t\tnewPayload instanceof ArrayBuffer ||\n\t\t(ArrayBuffer.isView(newPayload) && !(newPayload instanceof DataView))\n\t\t\t) {\n\t\t\t\tpayload = newPayload;\n\t\t\t} else {\n\t\t\t\tthrow (format(ERROR.INVALID_ARGUMENT, [newPayload, \"newPayload\"]));\n\t\t\t}\n\n\t\t\tvar destinationName;\n\t\t\tvar qos = 0;\n\t\t\tvar retained = false;\n\t\t\tvar duplicate = false;\n\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"payloadString\":{\n\t\t\t\t\tenumerable : true,\n\t\t\t\t\tget : function () {\n\t\t\t\t\t\tif (typeof payload === \"string\")\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn parseUTF8(payload, 0, payload.length);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"payloadBytes\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\tif (typeof payload === \"string\") {\n\t\t\t\t\t\t\tvar buffer = new ArrayBuffer(UTF8Length(payload));\n\t\t\t\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\t\t\t\tstringToUTF8(payload, byteStream, 0);\n\n\t\t\t\t\t\t\treturn byteStream;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"destinationName\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newDestinationName) {\n\t\t\t\t\t\tif (typeof newDestinationName === \"string\")\n\t\t\t\t\t\t\tdestinationName = newDestinationName;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, \"newDestinationName\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"qos\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return qos; },\n\t\t\t\t\tset: function(newQos) {\n\t\t\t\t\t\tif (newQos === 0 || newQos === 1 || newQos === 2 )\n\t\t\t\t\t\t\tqos = newQos;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+newQos);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"retained\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return retained; },\n\t\t\t\t\tset: function(newRetained) {\n\t\t\t\t\t\tif (typeof newRetained === \"boolean\")\n\t\t\t\t\t\t\tretained = newRetained;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newRetained, \"newRetained\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"topic\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newTopic) {destinationName=newTopic;}\n\t\t\t\t},\n\t\t\t\t\"duplicate\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return duplicate; },\n\t\t\t\t\tset: function(newDuplicate) {duplicate=newDuplicate;}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// Module contents.\n\t\treturn {\n\t\t\tClient: Client,\n\t\t\tMessage: Message\n\t\t};\n\t// eslint-disable-next-line no-nested-ternary\n\t})(typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {});\n\treturn PahoMQTT;\n});\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar punycode = require('punycode');\nvar util = require('./util');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__11__;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Observable = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// === Symbol Support ===\nvar hasSymbols = function () {\n  return typeof Symbol === 'function';\n};\n\nvar hasSymbol = function (name) {\n  return hasSymbols() && Boolean(Symbol[name]);\n};\n\nvar getSymbol = function (name) {\n  return hasSymbol(name) ? Symbol[name] : '@@' + name;\n};\n\nif (hasSymbols() && !hasSymbol('observable')) {\n  Symbol.observable = Symbol('observable');\n}\n\nvar SymbolIterator = getSymbol('iterator');\nvar SymbolObservable = getSymbol('observable');\nvar SymbolSpecies = getSymbol('species'); // === Abstract Operations ===\n\nfunction getMethod(obj, key) {\n  var value = obj[key];\n  if (value == null) return undefined;\n  if (typeof value !== 'function') throw new TypeError(value + ' is not a function');\n  return value;\n}\n\nfunction getSpecies(obj) {\n  var ctor = obj.constructor;\n\n  if (ctor !== undefined) {\n    ctor = ctor[SymbolSpecies];\n\n    if (ctor === null) {\n      ctor = undefined;\n    }\n  }\n\n  return ctor !== undefined ? ctor : Observable;\n}\n\nfunction isObservable(x) {\n  return x instanceof Observable; // SPEC: Brand check\n}\n\nfunction hostReportError(e) {\n  if (hostReportError.log) {\n    hostReportError.log(e);\n  } else {\n    setTimeout(function () {\n      throw e;\n    });\n  }\n}\n\nfunction enqueue(fn) {\n  Promise.resolve().then(function () {\n    try {\n      fn();\n    } catch (e) {\n      hostReportError(e);\n    }\n  });\n}\n\nfunction cleanupSubscription(subscription) {\n  var cleanup = subscription._cleanup;\n  if (cleanup === undefined) return;\n  subscription._cleanup = undefined;\n\n  if (!cleanup) {\n    return;\n  }\n\n  try {\n    if (typeof cleanup === 'function') {\n      cleanup();\n    } else {\n      var unsubscribe = getMethod(cleanup, 'unsubscribe');\n\n      if (unsubscribe) {\n        unsubscribe.call(cleanup);\n      }\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n}\n\nfunction closeSubscription(subscription) {\n  subscription._observer = undefined;\n  subscription._queue = undefined;\n  subscription._state = 'closed';\n}\n\nfunction flushSubscription(subscription) {\n  var queue = subscription._queue;\n\n  if (!queue) {\n    return;\n  }\n\n  subscription._queue = undefined;\n  subscription._state = 'ready';\n\n  for (var i = 0; i < queue.length; ++i) {\n    notifySubscription(subscription, queue[i].type, queue[i].value);\n    if (subscription._state === 'closed') break;\n  }\n}\n\nfunction notifySubscription(subscription, type, value) {\n  subscription._state = 'running';\n  var observer = subscription._observer;\n\n  try {\n    var m = getMethod(observer, type);\n\n    switch (type) {\n      case 'next':\n        if (m) m.call(observer, value);\n        break;\n\n      case 'error':\n        closeSubscription(subscription);\n        if (m) m.call(observer, value);else throw value;\n        break;\n\n      case 'complete':\n        closeSubscription(subscription);\n        if (m) m.call(observer);\n        break;\n    }\n  } catch (e) {\n    hostReportError(e);\n  }\n\n  if (subscription._state === 'closed') cleanupSubscription(subscription);else if (subscription._state === 'running') subscription._state = 'ready';\n}\n\nfunction onNotify(subscription, type, value) {\n  if (subscription._state === 'closed') return;\n\n  if (subscription._state === 'buffering') {\n    subscription._queue.push({\n      type: type,\n      value: value\n    });\n\n    return;\n  }\n\n  if (subscription._state !== 'ready') {\n    subscription._state = 'buffering';\n    subscription._queue = [{\n      type: type,\n      value: value\n    }];\n    enqueue(function () {\n      return flushSubscription(subscription);\n    });\n    return;\n  }\n\n  notifySubscription(subscription, type, value);\n}\n\nvar Subscription =\n/*#__PURE__*/\nfunction () {\n  function Subscription(observer, subscriber) {\n    _classCallCheck(this, Subscription);\n\n    // ASSERT: observer is an object\n    // ASSERT: subscriber is callable\n    this._cleanup = undefined;\n    this._observer = observer;\n    this._queue = undefined;\n    this._state = 'initializing';\n    var subscriptionObserver = new SubscriptionObserver(this);\n\n    try {\n      this._cleanup = subscriber.call(undefined, subscriptionObserver);\n    } catch (e) {\n      subscriptionObserver.error(e);\n    }\n\n    if (this._state === 'initializing') this._state = 'ready';\n  }\n\n  _createClass(Subscription, [{\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      if (this._state !== 'closed') {\n        closeSubscription(this);\n        cleanupSubscription(this);\n      }\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._state === 'closed';\n    }\n  }]);\n\n  return Subscription;\n}();\n\nvar SubscriptionObserver =\n/*#__PURE__*/\nfunction () {\n  function SubscriptionObserver(subscription) {\n    _classCallCheck(this, SubscriptionObserver);\n\n    this._subscription = subscription;\n  }\n\n  _createClass(SubscriptionObserver, [{\n    key: \"next\",\n    value: function next(value) {\n      onNotify(this._subscription, 'next', value);\n    }\n  }, {\n    key: \"error\",\n    value: function error(value) {\n      onNotify(this._subscription, 'error', value);\n    }\n  }, {\n    key: \"complete\",\n    value: function complete() {\n      onNotify(this._subscription, 'complete');\n    }\n  }, {\n    key: \"closed\",\n    get: function () {\n      return this._subscription._state === 'closed';\n    }\n  }]);\n\n  return SubscriptionObserver;\n}();\n\nvar Observable =\n/*#__PURE__*/\nfunction () {\n  function Observable(subscriber) {\n    _classCallCheck(this, Observable);\n\n    if (!(this instanceof Observable)) throw new TypeError('Observable cannot be called as a function');\n    if (typeof subscriber !== 'function') throw new TypeError('Observable initializer must be a function');\n    this._subscriber = subscriber;\n  }\n\n  _createClass(Observable, [{\n    key: \"subscribe\",\n    value: function subscribe(observer) {\n      if (typeof observer !== 'object' || observer === null) {\n        observer = {\n          next: observer,\n          error: arguments[1],\n          complete: arguments[2]\n        };\n      }\n\n      return new Subscription(observer, this._subscriber);\n    }\n  }, {\n    key: \"forEach\",\n    value: function forEach(fn) {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (typeof fn !== 'function') {\n          reject(new TypeError(fn + ' is not a function'));\n          return;\n        }\n\n        function done() {\n          subscription.unsubscribe();\n          resolve();\n        }\n\n        var subscription = _this.subscribe({\n          next: function (value) {\n            try {\n              fn(value, done);\n            } catch (e) {\n              reject(e);\n              subscription.unsubscribe();\n            }\n          },\n          error: reject,\n          complete: resolve\n        });\n      });\n    }\n  }, {\n    key: \"map\",\n    value: function map(fn) {\n      var _this2 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this2.subscribe({\n          next: function (value) {\n            try {\n              value = fn(value);\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(fn) {\n      var _this3 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        return _this3.subscribe({\n          next: function (value) {\n            try {\n              if (!fn(value)) return;\n            } catch (e) {\n              return observer.error(e);\n            }\n\n            observer.next(value);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"reduce\",\n    value: function reduce(fn) {\n      var _this4 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      var hasSeed = arguments.length > 1;\n      var hasValue = false;\n      var seed = arguments[1];\n      var acc = seed;\n      return new C(function (observer) {\n        return _this4.subscribe({\n          next: function (value) {\n            var first = !hasValue;\n            hasValue = true;\n\n            if (!first || hasSeed) {\n              try {\n                acc = fn(acc, value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            } else {\n              acc = value;\n            }\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            if (!hasValue && !hasSeed) return observer.error(new TypeError('Cannot reduce an empty sequence'));\n            observer.next(acc);\n            observer.complete();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"concat\",\n    value: function concat() {\n      var _this5 = this;\n\n      for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\n        sources[_key] = arguments[_key];\n      }\n\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscription;\n        var index = 0;\n\n        function startNext(next) {\n          subscription = next.subscribe({\n            next: function (v) {\n              observer.next(v);\n            },\n            error: function (e) {\n              observer.error(e);\n            },\n            complete: function () {\n              if (index === sources.length) {\n                subscription = undefined;\n                observer.complete();\n              } else {\n                startNext(C.from(sources[index++]));\n              }\n            }\n          });\n        }\n\n        startNext(_this5);\n        return function () {\n          if (subscription) {\n            subscription.unsubscribe();\n            subscription = undefined;\n          }\n        };\n      });\n    }\n  }, {\n    key: \"flatMap\",\n    value: function flatMap(fn) {\n      var _this6 = this;\n\n      if (typeof fn !== 'function') throw new TypeError(fn + ' is not a function');\n      var C = getSpecies(this);\n      return new C(function (observer) {\n        var subscriptions = [];\n\n        var outer = _this6.subscribe({\n          next: function (value) {\n            if (fn) {\n              try {\n                value = fn(value);\n              } catch (e) {\n                return observer.error(e);\n              }\n            }\n\n            var inner = C.from(value).subscribe({\n              next: function (value) {\n                observer.next(value);\n              },\n              error: function (e) {\n                observer.error(e);\n              },\n              complete: function () {\n                var i = subscriptions.indexOf(inner);\n                if (i >= 0) subscriptions.splice(i, 1);\n                completeIfDone();\n              }\n            });\n            subscriptions.push(inner);\n          },\n          error: function (e) {\n            observer.error(e);\n          },\n          complete: function () {\n            completeIfDone();\n          }\n        });\n\n        function completeIfDone() {\n          if (outer.closed && subscriptions.length === 0) observer.complete();\n        }\n\n        return function () {\n          subscriptions.forEach(function (s) {\n            return s.unsubscribe();\n          });\n          outer.unsubscribe();\n        };\n      });\n    }\n  }, {\n    key: SymbolObservable,\n    value: function () {\n      return this;\n    }\n  }], [{\n    key: \"from\",\n    value: function from(x) {\n      var C = typeof this === 'function' ? this : Observable;\n      if (x == null) throw new TypeError(x + ' is not an object');\n      var method = getMethod(x, SymbolObservable);\n\n      if (method) {\n        var observable = method.call(x);\n        if (Object(observable) !== observable) throw new TypeError(observable + ' is not an object');\n        if (isObservable(observable) && observable.constructor === C) return observable;\n        return new C(function (observer) {\n          return observable.subscribe(observer);\n        });\n      }\n\n      if (hasSymbol('iterator')) {\n        method = getMethod(x, SymbolIterator);\n\n        if (method) {\n          return new C(function (observer) {\n            enqueue(function () {\n              if (observer.closed) return;\n              var _iteratorNormalCompletion = true;\n              var _didIteratorError = false;\n              var _iteratorError = undefined;\n\n              try {\n                for (var _iterator = method.call(x)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  var _item = _step.value;\n                  observer.next(_item);\n                  if (observer.closed) return;\n                }\n              } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion && _iterator.return != null) {\n                    _iterator.return();\n                  }\n                } finally {\n                  if (_didIteratorError) {\n                    throw _iteratorError;\n                  }\n                }\n              }\n\n              observer.complete();\n            });\n          });\n        }\n      }\n\n      if (Array.isArray(x)) {\n        return new C(function (observer) {\n          enqueue(function () {\n            if (observer.closed) return;\n\n            for (var i = 0; i < x.length; ++i) {\n              observer.next(x[i]);\n              if (observer.closed) return;\n            }\n\n            observer.complete();\n          });\n        });\n      }\n\n      throw new TypeError(x + ' is not observable');\n    }\n  }, {\n    key: \"of\",\n    value: function of() {\n      for (var _len2 = arguments.length, items = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        items[_key2] = arguments[_key2];\n      }\n\n      var C = typeof this === 'function' ? this : Observable;\n      return new C(function (observer) {\n        enqueue(function () {\n          if (observer.closed) return;\n\n          for (var i = 0; i < items.length; ++i) {\n            observer.next(items[i]);\n            if (observer.closed) return;\n          }\n\n          observer.complete();\n        });\n      });\n    }\n  }, {\n    key: SymbolSpecies,\n    get: function () {\n      return this;\n    }\n  }]);\n\n  return Observable;\n}();\n\nexports.Observable = Observable;\n\nif (hasSymbols()) {\n  Object.defineProperty(Observable, Symbol('extensions'), {\n    value: {\n      symbol: SymbolObservable,\n      hostReportError: hostReportError\n    },\n    configurable: true\n  });\n}","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/uuidjs/uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","'use strict';\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","import zenObservable from 'zen-observable';\n\nvar Observable = zenObservable;\n\nexport default Observable;\nexport { Observable };\n//# sourceMappingURL=bundle.esm.js.map\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('AbstractPubSubProvider');\nvar AbstractPubSubProvider = /** @class */ (function () {\n    function AbstractPubSubProvider(options) {\n        if (options === void 0) { options = {}; }\n        this._config = options;\n    }\n    AbstractPubSubProvider.prototype.configure = function (config) {\n        if (config === void 0) { config = {}; }\n        this._config = __assign(__assign({}, config), this._config);\n        logger.debug(\"configure \" + this.getProviderName(), this._config);\n        return this.options;\n    };\n    AbstractPubSubProvider.prototype.getCategory = function () {\n        return 'PubSub';\n    };\n    Object.defineProperty(AbstractPubSubProvider.prototype, \"options\", {\n        get: function () {\n            return __assign({}, this._config);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AbstractPubSubProvider;\n}());\nexport { AbstractPubSubProvider };\n//# sourceMappingURL=PubSubProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport * as Paho from 'paho-mqtt';\nimport { v4 as uuid } from 'uuid';\nimport Observable from 'zen-observable-ts';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('MqttOverWSProvider');\nexport function mqttTopicMatch(filter, topic) {\n    var filterArray = filter.split('/');\n    var length = filterArray.length;\n    var topicArray = topic.split('/');\n    for (var i = 0; i < length; ++i) {\n        var left = filterArray[i];\n        var right = topicArray[i];\n        if (left === '#')\n            return topicArray.length >= length;\n        if (left !== '+' && left !== right)\n            return false;\n    }\n    return length === topicArray.length;\n}\nvar ClientsQueue = /** @class */ (function () {\n    function ClientsQueue() {\n        this.promises = new Map();\n    }\n    ClientsQueue.prototype.get = function (clientId, clientFactory) {\n        return __awaiter(this, void 0, void 0, function () {\n            var promise;\n            return __generator(this, function (_a) {\n                promise = this.promises.get(clientId);\n                if (promise) {\n                    return [2 /*return*/, promise];\n                }\n                promise = clientFactory(clientId);\n                this.promises.set(clientId, promise);\n                return [2 /*return*/, promise];\n            });\n        });\n    };\n    Object.defineProperty(ClientsQueue.prototype, \"allClients\", {\n        get: function () {\n            return Array.from(this.promises.keys());\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ClientsQueue.prototype.remove = function (clientId) {\n        this.promises.delete(clientId);\n    };\n    return ClientsQueue;\n}());\nvar topicSymbol = typeof Symbol !== 'undefined' ? Symbol('topic') : '@@topic';\nvar MqttOverWSProvider = /** @class */ (function (_super) {\n    __extends(MqttOverWSProvider, _super);\n    function MqttOverWSProvider(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, __assign(__assign({}, options), { clientId: options.clientId || uuid() })) || this;\n        _this._clientsQueue = new ClientsQueue();\n        _this._topicObservers = new Map();\n        _this._clientIdObservers = new Map();\n        return _this;\n    }\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientId\", {\n        get: function () {\n            return this.options.clientId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"endpoint\", {\n        get: function () {\n            return this.options.aws_pubsub_endpoint;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"clientsQueue\", {\n        get: function () {\n            return this._clientsQueue;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MqttOverWSProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MqttOverWSProvider.prototype.getTopicForValue = function (value) {\n        return typeof value === 'object' && value[topicSymbol];\n    };\n    MqttOverWSProvider.prototype.getProviderName = function () {\n        return 'MqttOverWSProvider';\n    };\n    MqttOverWSProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            logger.warn(clientId, JSON.stringify(__assign({ errorCode: errorCode }, args), null, 2));\n            var topicsToDelete_1 = [];\n            var clientIdObservers = this._clientIdObservers.get(clientId);\n            if (!clientIdObservers) {\n                return;\n            }\n            clientIdObservers.forEach(function (observer) {\n                observer.error('Disconnected, error code: ' + errorCode);\n                // removing observers for disconnected clientId\n                _this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                    observerForTopic.delete(observer);\n                    if (observerForTopic.size === 0) {\n                        topicsToDelete_1.push(observerTopic);\n                    }\n                });\n            });\n            // forgiving any trace of clientId\n            this._clientIdObservers.delete(clientId);\n            // Removing topics that are not listen by an observer\n            topicsToDelete_1.forEach(function (topic) {\n                _this._topicObservers.delete(topic);\n            });\n        }\n    };\n    MqttOverWSProvider.prototype.newClient = function (_a) {\n        var url = _a.url, clientId = _a.clientId;\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug('Creating new MQTT client', clientId);\n                        client = new Paho.Client(url, clientId);\n                        // client.trace = (args) => logger.debug(clientId, JSON.stringify(args, null, 2));\n                        client.onMessageArrived = function (_a) {\n                            var topic = _a.destinationName, msg = _a.payloadString;\n                            _this._onMessage(topic, msg);\n                        };\n                        client.onConnectionLost = function (_a) {\n                            var errorCode = _a.errorCode, args = __rest(_a, [\"errorCode\"]);\n                            _this.onDisconnect(__assign({ clientId: clientId, errorCode: errorCode }, args));\n                        };\n                        return [4 /*yield*/, new Promise(function (resolve, reject) {\n                                client.connect({\n                                    useSSL: _this.isSSLEnabled,\n                                    mqttVersion: 3,\n                                    onSuccess: function () { return resolve(client); },\n                                    onFailure: reject,\n                                });\n                            })];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/, client];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.connect = function (clientId, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function (clientId) {\n                            return _this.newClient(__assign(__assign({}, options), { clientId: clientId }));\n                        })];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        if (client && client.isConnected()) {\n                            client.disconnect();\n                        }\n                        this.clientsQueue.remove(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype.publish = function (topics, msg) {\n        return __awaiter(this, void 0, void 0, function () {\n            var targetTopics, message, url, client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        targetTopics = [].concat(topics);\n                        message = JSON.stringify(msg);\n                        return [4 /*yield*/, this.endpoint];\n                    case 1:\n                        url = _a.sent();\n                        return [4 /*yield*/, this.connect(this.clientId, { url: url })];\n                    case 2:\n                        client = _a.sent();\n                        logger.debug('Publishing to topic(s)', targetTopics.join(','), message);\n                        targetTopics.forEach(function (topic) { return client.send(topic, message); });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MqttOverWSProvider.prototype._onMessage = function (topic, msg) {\n        try {\n            var matchedTopicObservers_1 = [];\n            this._topicObservers.forEach(function (observerForTopic, observerTopic) {\n                if (mqttTopicMatch(observerTopic, topic)) {\n                    matchedTopicObservers_1.push(observerForTopic);\n                }\n            });\n            var parsedMessage_1 = JSON.parse(msg);\n            if (typeof parsedMessage_1 === 'object') {\n                parsedMessage_1[topicSymbol] = topic;\n            }\n            matchedTopicObservers_1.forEach(function (observersForTopic) {\n                observersForTopic.forEach(function (observer) { return observer.next(parsedMessage_1); });\n            });\n        }\n        catch (error) {\n            logger.warn('Error handling message', error, msg);\n        }\n    };\n    MqttOverWSProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var targetTopics = [].concat(topics);\n        logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n        return new Observable(function (observer) {\n            targetTopics.forEach(function (topic) {\n                // this._topicObservers is used to notify the observers according to the topic received on the message\n                var observersForTopic = _this._topicObservers.get(topic);\n                if (!observersForTopic) {\n                    observersForTopic = new Set();\n                    _this._topicObservers.set(topic, observersForTopic);\n                }\n                observersForTopic.add(observer);\n            });\n            // @ts-ignore\n            var client;\n            var _a = options.clientId, clientId = _a === void 0 ? _this.clientId : _a;\n            // this._clientIdObservers is used to close observers when client gets disconnected\n            var observersForClientId = _this._clientIdObservers.get(clientId);\n            if (!observersForClientId) {\n                observersForClientId = new Set();\n            }\n            observersForClientId.add(observer);\n            _this._clientIdObservers.set(clientId, observersForClientId);\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, url, _b, e_1;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            _a = options.url;\n                            if (!(_a === void 0)) return [3 /*break*/, 2];\n                            return [4 /*yield*/, this.endpoint];\n                        case 1:\n                            _b = _c.sent();\n                            return [3 /*break*/, 3];\n                        case 2:\n                            _b = _a;\n                            _c.label = 3;\n                        case 3:\n                            url = _b;\n                            _c.label = 4;\n                        case 4:\n                            _c.trys.push([4, 6, , 7]);\n                            return [4 /*yield*/, this.connect(clientId, { url: url })];\n                        case 5:\n                            client = _c.sent();\n                            targetTopics.forEach(function (topic) {\n                                client.subscribe(topic);\n                            });\n                            return [3 /*break*/, 7];\n                        case 6:\n                            e_1 = _c.sent();\n                            observer.error(e_1);\n                            return [3 /*break*/, 7];\n                        case 7: return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                if (client) {\n                    _this._clientIdObservers.get(clientId).delete(observer);\n                    // No more observers per client => client not needed anymore\n                    if (_this._clientIdObservers.get(clientId).size === 0) {\n                        _this.disconnect(clientId);\n                        _this._clientIdObservers.delete(clientId);\n                    }\n                    targetTopics.forEach(function (topic) {\n                        var observersForTopic = _this._topicObservers.get(topic) ||\n                            new Set();\n                        observersForTopic.delete(observer);\n                        // if no observers exists for the topic, topic should be removed\n                        if (observersForTopic.size === 0) {\n                            _this._topicObservers.delete(topic);\n                            if (client.isConnected()) {\n                                client.unsubscribe(topic);\n                            }\n                        }\n                    });\n                }\n                return null;\n            };\n        });\n    };\n    return MqttOverWSProvider;\n}(AbstractPubSubProvider));\nexport { MqttOverWSProvider };\n//# sourceMappingURL=MqttOverWSProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport Observable from 'zen-observable-ts';\nimport { GraphQLError } from 'graphql';\nimport * as url from 'url';\nimport { v4 as uuid } from 'uuid';\nimport { Buffer } from 'buffer';\nimport { Logger, Credentials, Signer, Hub, Constants, USER_AGENT_HEADER, jitteredExponentialRetry, NonRetryableError, } from '@aws-amplify/core';\nimport Cache from '@aws-amplify/cache';\nimport Auth from '@aws-amplify/auth';\nimport { AbstractPubSubProvider } from './PubSubProvider';\nimport { CONTROL_MSG } from '../index';\nvar logger = new Logger('AWSAppSyncRealTimeProvider');\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' &&\n    typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nvar dispatchApiEvent = function (event, data, message) {\n    Hub.dispatch('api', { event: event, data: data, message: message }, 'PubSub', AMPLIFY_SYMBOL);\n};\nvar MAX_DELAY_MS = 5000;\nvar NON_RETRYABLE_CODES = [400, 401, 403];\nvar MESSAGE_TYPES;\n(function (MESSAGE_TYPES) {\n    /**\n     * Client -> Server message.\n     * This message type is the first message after handshake and this will initialize AWS AppSync RealTime communication\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_INIT\"] = \"connection_init\";\n    /**\n     * Server -> Client message\n     * This message type is in case there is an issue with AWS AppSync RealTime when establishing connection\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ERROR\"] = \"connection_error\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_CONNECTION_INIT message\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_ACK\"] = \"connection_ack\";\n    /**\n     * Client -> Server message.\n     * This message type is for register subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_START\"] = \"start\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_START message\n     */\n    MESSAGE_TYPES[\"GQL_START_ACK\"] = \"start_ack\";\n    /**\n     * Server -> Client message.\n     * This message type is for subscription message from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_DATA\"] = \"data\";\n    /**\n     * Server -> Client message.\n     * This message type helps the client to know is still receiving messages from AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_CONNECTION_KEEP_ALIVE\"] = \"ka\";\n    /**\n     * Client -> Server message.\n     * This message type is for unregister subscriptions with AWS AppSync RealTime\n     */\n    MESSAGE_TYPES[\"GQL_STOP\"] = \"stop\";\n    /**\n     * Server -> Client message.\n     * This message type is for the ack response from AWS AppSync RealTime for GQL_STOP message\n     */\n    MESSAGE_TYPES[\"GQL_COMPLETE\"] = \"complete\";\n    /**\n     * Server -> Client message.\n     * This message type is for sending error messages from AWS AppSync RealTime to the client\n     */\n    MESSAGE_TYPES[\"GQL_ERROR\"] = \"error\";\n})(MESSAGE_TYPES || (MESSAGE_TYPES = {}));\nvar SUBSCRIPTION_STATUS;\n(function (SUBSCRIPTION_STATUS) {\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"PENDING\"] = 0] = \"PENDING\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"CONNECTED\"] = 1] = \"CONNECTED\";\n    SUBSCRIPTION_STATUS[SUBSCRIPTION_STATUS[\"FAILED\"] = 2] = \"FAILED\";\n})(SUBSCRIPTION_STATUS || (SUBSCRIPTION_STATUS = {}));\nvar SOCKET_STATUS;\n(function (SOCKET_STATUS) {\n    SOCKET_STATUS[SOCKET_STATUS[\"CLOSED\"] = 0] = \"CLOSED\";\n    SOCKET_STATUS[SOCKET_STATUS[\"READY\"] = 1] = \"READY\";\n    SOCKET_STATUS[SOCKET_STATUS[\"CONNECTING\"] = 2] = \"CONNECTING\";\n})(SOCKET_STATUS || (SOCKET_STATUS = {}));\nvar AWS_APPSYNC_REALTIME_HEADERS = {\n    accept: 'application/json, text/javascript',\n    'content-encoding': 'amz-1.0',\n    'content-type': 'application/json; charset=UTF-8',\n};\n/**\n * Time in milleseconds to wait for GQL_CONNECTION_INIT message\n */\nvar CONNECTION_INIT_TIMEOUT = 15000;\n/**\n * Time in milleseconds to wait for GQL_START_ACK message\n */\nvar START_ACK_TIMEOUT = 15000;\n/**\n * Default Time in milleseconds to wait for GQL_CONNECTION_KEEP_ALIVE message\n */\nvar DEFAULT_KEEP_ALIVE_TIMEOUT = 5 * 60 * 1000;\nvar AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncRealTimeProvider, _super);\n    function AWSAppSyncRealTimeProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.socketStatus = SOCKET_STATUS.CLOSED;\n        _this.keepAliveTimeout = DEFAULT_KEEP_ALIVE_TIMEOUT;\n        _this.subscriptionObserverMap = new Map();\n        _this.promiseArray = [];\n        return _this;\n    }\n    AWSAppSyncRealTimeProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncRealTimeProvider';\n    };\n    AWSAppSyncRealTimeProvider.prototype.newClient = function () {\n        throw new Error('Not used here');\n    };\n    AWSAppSyncRealTimeProvider.prototype.publish = function (_topics, _msg, _options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype.subscribe = function (_topics, options) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint;\n        return new Observable(function (observer) {\n            if (!appSyncGraphqlEndpoint) {\n                observer.error({\n                    errors: [\n                        __assign({}, new GraphQLError(\"Subscribe only available for AWS AppSync endpoint\")),\n                    ],\n                });\n                observer.complete();\n            }\n            else {\n                var subscriptionId_1 = uuid();\n                _this._startSubscriptionWithAWSAppSyncRealTime({\n                    options: options,\n                    observer: observer,\n                    subscriptionId: subscriptionId_1,\n                }).catch(function (err) {\n                    observer.error({\n                        errors: [\n                            __assign({}, new GraphQLError(CONTROL_MSG.REALTIME_SUBSCRIPTION_INIT_ERROR + \": \" + err)),\n                        ],\n                    });\n                    observer.complete();\n                });\n                return function () { return __awaiter(_this, void 0, void 0, function () {\n                    var subscriptionState, err_1;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                _a.trys.push([0, 2, 3, 4]);\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                return [4 /*yield*/, this._waitForSubscriptionToBeConnected(subscriptionId_1)];\n                            case 1:\n                                // Waiting that subscription has been connected before trying to unsubscribe\n                                _a.sent();\n                                subscriptionState = (this.subscriptionObserverMap.get(subscriptionId_1) || {}).subscriptionState;\n                                if (!subscriptionState) {\n                                    // subscription already unsubscribed\n                                    return [2 /*return*/];\n                                }\n                                if (subscriptionState === SUBSCRIPTION_STATUS.CONNECTED) {\n                                    this._sendUnsubscriptionMessage(subscriptionId_1);\n                                }\n                                else {\n                                    throw new Error('Subscription never connected');\n                                }\n                                return [3 /*break*/, 4];\n                            case 2:\n                                err_1 = _a.sent();\n                                logger.debug(\"Error while unsubscribing \" + err_1);\n                                return [3 /*break*/, 4];\n                            case 3:\n                                this._removeSubscriptionObserver(subscriptionId_1);\n                                return [7 /*endfinally*/];\n                            case 4: return [2 /*return*/];\n                        }\n                    });\n                }); };\n            }\n        });\n    };\n    Object.defineProperty(AWSAppSyncRealTimeProvider.prototype, \"isSSLEnabled\", {\n        get: function () {\n            return !this.options\n                .aws_appsync_dangerously_connect_to_http_endpoint_for_testing;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncRealTimeProvider.prototype._startSubscriptionWithAWSAppSyncRealTime = function (_a) {\n        var options = _a.options, observer = _a.observer, subscriptionId = _a.subscriptionId;\n        return __awaiter(this, void 0, void 0, function () {\n            var appSyncGraphqlEndpoint, authenticationType, query, variables, apiKey, region, _b, graphql_headers, _c, additionalHeaders, subscriptionState, data, dataString, headerObj, _d, _e, subscriptionMessage, stringToAWSRealTime, err_2, _f, message, subscriptionFailedCallback_1, _g, subscriptionFailedCallback, subscriptionReadyCallback;\n            var _h;\n            var _this = this;\n            return __generator(this, function (_j) {\n                switch (_j.label) {\n                    case 0:\n                        appSyncGraphqlEndpoint = options.appSyncGraphqlEndpoint, authenticationType = options.authenticationType, query = options.query, variables = options.variables, apiKey = options.apiKey, region = options.region, _b = options.graphql_headers, graphql_headers = _b === void 0 ? function () { return ({}); } : _b, _c = options.additionalHeaders, additionalHeaders = _c === void 0 ? {} : _c;\n                        subscriptionState = SUBSCRIPTION_STATUS.PENDING;\n                        data = {\n                            query: query,\n                            variables: variables,\n                        };\n                        // Having a subscription id map will make it simple to forward messages received\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            query: query,\n                            variables: variables,\n                            subscriptionState: subscriptionState,\n                            startAckTimeoutId: null,\n                        });\n                        dataString = JSON.stringify(data);\n                        _d = [{}];\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                payload: dataString,\n                                canonicalUri: '',\n                                region: region,\n                            })];\n                    case 1:\n                        _e = [__assign.apply(void 0, _d.concat([(_j.sent())]))];\n                        return [4 /*yield*/, graphql_headers()];\n                    case 2:\n                        headerObj = __assign.apply(void 0, [__assign.apply(void 0, [__assign.apply(void 0, _e.concat([(_j.sent())])), additionalHeaders]), (_h = {}, _h[USER_AGENT_HEADER] = Constants.userAgent, _h)]);\n                        subscriptionMessage = {\n                            id: subscriptionId,\n                            payload: {\n                                data: dataString,\n                                extensions: {\n                                    authorization: __assign({}, headerObj),\n                                },\n                            },\n                            type: MESSAGE_TYPES.GQL_START,\n                        };\n                        stringToAWSRealTime = JSON.stringify(subscriptionMessage);\n                        _j.label = 3;\n                    case 3:\n                        _j.trys.push([3, 5, , 6]);\n                        return [4 /*yield*/, this._initializeWebSocketConnection({\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                authenticationType: authenticationType,\n                                region: region,\n                            })];\n                    case 4:\n                        _j.sent();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_2 = _j.sent();\n                        logger.debug({ err: err_2 });\n                        _f = err_2.message, message = _f === void 0 ? '' : _f;\n                        observer.error({\n                            errors: [\n                                __assign({}, new GraphQLError(CONTROL_MSG.CONNECTION_FAILED + \": \" + message)),\n                            ],\n                        });\n                        observer.complete();\n                        subscriptionFailedCallback_1 = (this.subscriptionObserverMap.get(subscriptionId) || {}).subscriptionFailedCallback;\n                        // Notify concurrent unsubscription\n                        if (typeof subscriptionFailedCallback_1 === 'function') {\n                            subscriptionFailedCallback_1();\n                        }\n                        return [2 /*return*/];\n                    case 6:\n                        _g = this.subscriptionObserverMap.get(subscriptionId), subscriptionFailedCallback = _g.subscriptionFailedCallback, subscriptionReadyCallback = _g.subscriptionReadyCallback;\n                        // This must be done before sending the message in order to be listening immediately\n                        this.subscriptionObserverMap.set(subscriptionId, {\n                            observer: observer,\n                            subscriptionState: subscriptionState,\n                            variables: variables,\n                            query: query,\n                            subscriptionReadyCallback: subscriptionReadyCallback,\n                            subscriptionFailedCallback: subscriptionFailedCallback,\n                            startAckTimeoutId: setTimeout(function () {\n                                _this._timeoutStartSubscriptionAck.call(_this, subscriptionId);\n                            }, START_ACK_TIMEOUT),\n                        });\n                        if (this.awsRealTimeSocket) {\n                            this.awsRealTimeSocket.send(stringToAWSRealTime);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // Waiting that subscription has been connected before trying to unsubscribe\n    AWSAppSyncRealTimeProvider.prototype._waitForSubscriptionToBeConnected = function (subscriptionId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var subscriptionState;\n            var _this = this;\n            return __generator(this, function (_a) {\n                subscriptionState = this.subscriptionObserverMap.get(subscriptionId).subscriptionState;\n                // This in case unsubscribe is invoked before sending start subscription message\n                if (subscriptionState === SUBSCRIPTION_STATUS.PENDING) {\n                    return [2 /*return*/, new Promise(function (res, rej) {\n                            var _a = _this.subscriptionObserverMap.get(subscriptionId), observer = _a.observer, subscriptionState = _a.subscriptionState, variables = _a.variables, query = _a.query;\n                            _this.subscriptionObserverMap.set(subscriptionId, {\n                                observer: observer,\n                                subscriptionState: subscriptionState,\n                                variables: variables,\n                                query: query,\n                                subscriptionReadyCallback: res,\n                                subscriptionFailedCallback: rej,\n                            });\n                        })];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._sendUnsubscriptionMessage = function (subscriptionId) {\n        try {\n            if (this.awsRealTimeSocket &&\n                this.awsRealTimeSocket.readyState === WebSocket.OPEN &&\n                this.socketStatus === SOCKET_STATUS.READY) {\n                // Preparing unsubscribe message to stop receiving messages for that subscription\n                var unsubscribeMessage = {\n                    id: subscriptionId,\n                    type: MESSAGE_TYPES.GQL_STOP,\n                };\n                var stringToAWSRealTime = JSON.stringify(unsubscribeMessage);\n                this.awsRealTimeSocket.send(stringToAWSRealTime);\n            }\n        }\n        catch (err) {\n            // If GQL_STOP is not sent because of disconnection issue, then there is nothing the client can do\n            logger.debug({ err: err });\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._removeSubscriptionObserver = function (subscriptionId) {\n        this.subscriptionObserverMap.delete(subscriptionId);\n        // Verifying 1000ms after removing subscription in case there are new subscription unmount/mount\n        setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n    };\n    AWSAppSyncRealTimeProvider.prototype._closeSocketIfRequired = function () {\n        if (this.subscriptionObserverMap.size > 0) {\n            // Active subscriptions on the WebSocket\n            return;\n        }\n        if (!this.awsRealTimeSocket) {\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n            return;\n        }\n        if (this.awsRealTimeSocket.bufferedAmount > 0) {\n            // Still data on the WebSocket\n            setTimeout(this._closeSocketIfRequired.bind(this), 1000);\n        }\n        else {\n            logger.debug('closing WebSocket...');\n            clearTimeout(this.keepAliveTimeoutId);\n            var tempSocket = this.awsRealTimeSocket;\n            // Cleaning callbacks to avoid race condition, socket still exists\n            tempSocket.onclose = undefined;\n            tempSocket.onerror = undefined;\n            tempSocket.close(1000);\n            this.awsRealTimeSocket = null;\n            this.socketStatus = SOCKET_STATUS.CLOSED;\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._handleIncomingSubscriptionMessage = function (message) {\n        logger.debug(\"subscription message from AWS AppSync RealTime: \" + message.data);\n        var _a = JSON.parse(message.data), _b = _a.id, id = _b === void 0 ? '' : _b, payload = _a.payload, type = _a.type;\n        var _c = this.subscriptionObserverMap.get(id) || {}, _d = _c.observer, observer = _d === void 0 ? null : _d, _e = _c.query, query = _e === void 0 ? '' : _e, _f = _c.variables, variables = _f === void 0 ? {} : _f, startAckTimeoutId = _c.startAckTimeoutId, subscriptionReadyCallback = _c.subscriptionReadyCallback, subscriptionFailedCallback = _c.subscriptionFailedCallback;\n        logger.debug({ id: id, observer: observer, query: query, variables: variables });\n        if (type === MESSAGE_TYPES.GQL_DATA && payload && payload.data) {\n            if (observer) {\n                observer.next(payload);\n            }\n            else {\n                logger.debug(\"observer not found for id: \" + id);\n            }\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_START_ACK) {\n            logger.debug(\"subscription ready for \" + JSON.stringify({ query: query, variables: variables }));\n            if (typeof subscriptionReadyCallback === 'function') {\n                subscriptionReadyCallback();\n            }\n            clearTimeout(startAckTimeoutId);\n            dispatchApiEvent(CONTROL_MSG.SUBSCRIPTION_ACK, { query: query, variables: variables }, 'Connection established for subscription');\n            var subscriptionState = SUBSCRIPTION_STATUS.CONNECTED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: null,\n                subscriptionState: subscriptionState,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n            });\n            // TODO: emit event on hub but it requires to store the id first\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_CONNECTION_KEEP_ALIVE) {\n            clearTimeout(this.keepAliveTimeoutId);\n            this.keepAliveTimeoutId = setTimeout(this._errorDisconnect.bind(this, CONTROL_MSG.TIMEOUT_DISCONNECT), this.keepAliveTimeout);\n            return;\n        }\n        if (type === MESSAGE_TYPES.GQL_ERROR) {\n            var subscriptionState = SUBSCRIPTION_STATUS.FAILED;\n            this.subscriptionObserverMap.set(id, {\n                observer: observer,\n                query: query,\n                variables: variables,\n                startAckTimeoutId: startAckTimeoutId,\n                subscriptionReadyCallback: subscriptionReadyCallback,\n                subscriptionFailedCallback: subscriptionFailedCallback,\n                subscriptionState: subscriptionState,\n            });\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(CONTROL_MSG.CONNECTION_FAILED + \": \" + JSON.stringify(payload))),\n                ],\n            });\n            clearTimeout(startAckTimeoutId);\n            observer.complete();\n            if (typeof subscriptionFailedCallback === 'function') {\n                subscriptionFailedCallback();\n            }\n        }\n    };\n    AWSAppSyncRealTimeProvider.prototype._errorDisconnect = function (msg) {\n        logger.debug(\"Disconnect error: \" + msg);\n        this.subscriptionObserverMap.forEach(function (_a) {\n            var observer = _a.observer;\n            if (observer && !observer.closed) {\n                observer.error({\n                    errors: [__assign({}, new GraphQLError(msg))],\n                });\n            }\n        });\n        this.subscriptionObserverMap.clear();\n        if (this.awsRealTimeSocket) {\n            this.awsRealTimeSocket.close();\n        }\n        this.socketStatus = SOCKET_STATUS.CLOSED;\n    };\n    AWSAppSyncRealTimeProvider.prototype._timeoutStartSubscriptionAck = function (subscriptionId) {\n        var _a = this.subscriptionObserverMap.get(subscriptionId) || {}, observer = _a.observer, query = _a.query, variables = _a.variables;\n        if (!observer) {\n            return;\n        }\n        this.subscriptionObserverMap.set(subscriptionId, {\n            observer: observer,\n            query: query,\n            variables: variables,\n            subscriptionState: SUBSCRIPTION_STATUS.FAILED,\n        });\n        if (observer && !observer.closed) {\n            observer.error({\n                errors: [\n                    __assign({}, new GraphQLError(\"Subscription timeout \" + JSON.stringify({ query: query, variables: variables }))),\n                ],\n            });\n            // Cleanup will be automatically executed\n            observer.complete();\n        }\n        logger.debug('timeoutStartSubscription', JSON.stringify({ query: query, variables: variables }));\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeWebSocketConnection = function (_a) {\n        var _this = this;\n        var appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, authenticationType = _a.authenticationType, apiKey = _a.apiKey, region = _a.region;\n        if (this.socketStatus === SOCKET_STATUS.READY) {\n            return;\n        }\n        return new Promise(function (res, rej) { return __awaiter(_this, void 0, void 0, function () {\n            var protocol, discoverableEndpoint, payloadString, headerString, _a, _b, headerQs, payloadQs, awsRealTimeUrl, err_3;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this.promiseArray.push({ res: res, rej: rej });\n                        if (!(this.socketStatus === SOCKET_STATUS.CLOSED)) return [3 /*break*/, 5];\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 4, , 5]);\n                        this.socketStatus = SOCKET_STATUS.CONNECTING;\n                        protocol = this.isSSLEnabled ? 'wss://' : 'ws://';\n                        discoverableEndpoint = appSyncGraphqlEndpoint\n                            .replace('https://', protocol)\n                            .replace('http://', protocol)\n                            .replace('appsync-api', 'appsync-realtime-api')\n                            .replace('gogi-beta', 'grt-beta');\n                        payloadString = '{}';\n                        _b = (_a = JSON).stringify;\n                        return [4 /*yield*/, this._awsRealTimeHeaderBasedAuth({\n                                authenticationType: authenticationType,\n                                payload: payloadString,\n                                canonicalUri: '/connect',\n                                apiKey: apiKey,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                region: region,\n                            })];\n                    case 2:\n                        headerString = _b.apply(_a, [_c.sent()]);\n                        headerQs = Buffer.from(headerString).toString('base64');\n                        payloadQs = Buffer.from(payloadString).toString('base64');\n                        awsRealTimeUrl = discoverableEndpoint + \"?header=\" + headerQs + \"&payload=\" + payloadQs;\n                        return [4 /*yield*/, this._initializeRetryableHandshake({ awsRealTimeUrl: awsRealTimeUrl })];\n                    case 3:\n                        _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var res = _a.res;\n                            logger.debug('Notifying connection successful');\n                            res();\n                        });\n                        this.socketStatus = SOCKET_STATUS.READY;\n                        this.promiseArray = [];\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_3 = _c.sent();\n                        this.promiseArray.forEach(function (_a) {\n                            var rej = _a.rej;\n                            return rej(err_3);\n                        });\n                        this.promiseArray = [];\n                        if (this.awsRealTimeSocket &&\n                            this.awsRealTimeSocket.readyState === WebSocket.OPEN) {\n                            this.awsRealTimeSocket.close(3001);\n                        }\n                        this.awsRealTimeSocket = null;\n                        this.socketStatus = SOCKET_STATUS.CLOSED;\n                        return [3 /*break*/, 5];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        }); });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeRetryableHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializaling retryable Handshake\");\n                        return [4 /*yield*/, jitteredExponentialRetry(this._initializeHandshake.bind(this), [{ awsRealTimeUrl: awsRealTimeUrl }], MAX_DELAY_MS)];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._initializeHandshake = function (_a) {\n        var awsRealTimeUrl = _a.awsRealTimeUrl;\n        return __awaiter(this, void 0, void 0, function () {\n            var err_4, errorType, errorCode;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug(\"Initializing handshake \" + awsRealTimeUrl);\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, , 5]);\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var newSocket = new WebSocket(awsRealTimeUrl, 'graphql-ws');\n                                    newSocket.onerror = function () {\n                                        logger.debug(\"WebSocket connection error\");\n                                    };\n                                    newSocket.onclose = function () {\n                                        rej(new Error('Connection handshake error'));\n                                    };\n                                    newSocket.onopen = function () {\n                                        _this.awsRealTimeSocket = newSocket;\n                                        return res();\n                                    };\n                                });\n                            })()];\n                    case 2:\n                        _b.sent();\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        return [4 /*yield*/, (function () {\n                                return new Promise(function (res, rej) {\n                                    var ackOk = false;\n                                    _this.awsRealTimeSocket.onerror = function (error) {\n                                        logger.debug(\"WebSocket error \" + JSON.stringify(error));\n                                    };\n                                    _this.awsRealTimeSocket.onclose = function (event) {\n                                        logger.debug(\"WebSocket closed \" + event.reason);\n                                        rej(new Error(JSON.stringify(event)));\n                                    };\n                                    _this.awsRealTimeSocket.onmessage = function (message) {\n                                        logger.debug(\"subscription message from AWS AppSyncRealTime: \" + message.data + \" \");\n                                        var data = JSON.parse(message.data);\n                                        var type = data.type, _a = data.payload, _b = (_a === void 0 ? {} : _a).connectionTimeoutMs, connectionTimeoutMs = _b === void 0 ? DEFAULT_KEEP_ALIVE_TIMEOUT : _b;\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ACK) {\n                                            ackOk = true;\n                                            _this.keepAliveTimeout = connectionTimeoutMs;\n                                            _this.awsRealTimeSocket.onmessage = _this._handleIncomingSubscriptionMessage.bind(_this);\n                                            _this.awsRealTimeSocket.onerror = function (err) {\n                                                logger.debug(err);\n                                                _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);\n                                            };\n                                            _this.awsRealTimeSocket.onclose = function (event) {\n                                                logger.debug(\"WebSocket closed \" + event.reason);\n                                                _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);\n                                            };\n                                            res('Cool, connected to AWS AppSyncRealTime');\n                                            return;\n                                        }\n                                        if (type === MESSAGE_TYPES.GQL_CONNECTION_ERROR) {\n                                            var _c = data.payload, _d = (_c === void 0 ? {} : _c).errors, _e = __read(_d === void 0 ? [] : _d, 1), _f = _e[0], _g = _f === void 0 ? {} : _f, _h = _g.errorType, errorType = _h === void 0 ? '' : _h, _j = _g.errorCode, errorCode = _j === void 0 ? 0 : _j;\n                                            rej({ errorType: errorType, errorCode: errorCode });\n                                        }\n                                    };\n                                    var gqlInit = {\n                                        type: MESSAGE_TYPES.GQL_CONNECTION_INIT,\n                                    };\n                                    _this.awsRealTimeSocket.send(JSON.stringify(gqlInit));\n                                    function checkAckOk() {\n                                        if (!ackOk) {\n                                            rej(new Error(\"Connection timeout: ack from AWSRealTime was not received on \" + CONNECTION_INIT_TIMEOUT + \" ms\"));\n                                        }\n                                    }\n                                    setTimeout(checkAckOk.bind(_this), CONNECTION_INIT_TIMEOUT);\n                                });\n                            })()];\n                    case 3:\n                        // Step 2: wait for ack from AWS AppSyncReaTime after sending init\n                        _b.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        err_4 = _b.sent();\n                        errorType = err_4.errorType, errorCode = err_4.errorCode;\n                        if (NON_RETRYABLE_CODES.includes(errorCode)) {\n                            throw new NonRetryableError(errorType);\n                        }\n                        else if (errorType) {\n                            throw new Error(errorType);\n                        }\n                        else {\n                            throw err_4;\n                        }\n                        return [3 /*break*/, 5];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeHeaderBasedAuth = function (_a) {\n        var authenticationType = _a.authenticationType, payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, apiKey = _a.apiKey, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var headerHandler, handler, host, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        headerHandler = {\n                            API_KEY: this._awsRealTimeApiKeyHeader.bind(this),\n                            AWS_IAM: this._awsRealTimeIAMHeader.bind(this),\n                            OPENID_CONNECT: this._awsRealTimeOPENIDHeader.bind(this),\n                            AMAZON_COGNITO_USER_POOLS: this._awsRealTimeCUPHeader.bind(this),\n                        };\n                        handler = headerHandler[authenticationType];\n                        if (typeof handler !== 'function') {\n                            logger.debug(\"Authentication type \" + authenticationType + \" not supported\");\n                            return [2 /*return*/, ''];\n                        }\n                        host = url.parse(appSyncGraphqlEndpoint).host;\n                        return [4 /*yield*/, handler({\n                                payload: payload,\n                                canonicalUri: canonicalUri,\n                                appSyncGraphqlEndpoint: appSyncGraphqlEndpoint,\n                                apiKey: apiKey,\n                                region: region,\n                                host: host,\n                            })];\n                    case 1:\n                        result = _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeCUPHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var session;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Auth.currentSession()];\n                    case 1:\n                        session = _b.sent();\n                        return [2 /*return*/, {\n                                Authorization: session.getAccessToken().getJwtToken(),\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeOPENIDHeader = function (_a) {\n        var host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var token, federatedInfo, currentUser;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, Cache.getItem('federatedInfo')];\n                    case 1:\n                        federatedInfo = _b.sent();\n                        if (!federatedInfo) return [3 /*break*/, 2];\n                        token = federatedInfo.token;\n                        return [3 /*break*/, 4];\n                    case 2: return [4 /*yield*/, Auth.currentAuthenticatedUser()];\n                    case 3:\n                        currentUser = _b.sent();\n                        if (currentUser) {\n                            token = currentUser.token;\n                        }\n                        _b.label = 4;\n                    case 4:\n                        if (!token) {\n                            throw new Error('No federated jwt');\n                        }\n                        return [2 /*return*/, {\n                                Authorization: token,\n                                host: host,\n                            }];\n                }\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeApiKeyHeader = function (_a) {\n        var apiKey = _a.apiKey, host = _a.host;\n        return __awaiter(this, void 0, void 0, function () {\n            var dt, dtStr;\n            return __generator(this, function (_b) {\n                dt = new Date();\n                dtStr = dt.toISOString().replace(/[:\\-]|\\.\\d{3}/g, '');\n                return [2 /*return*/, {\n                        host: host,\n                        'x-amz-date': dtStr,\n                        'x-api-key': apiKey,\n                    }];\n            });\n        });\n    };\n    AWSAppSyncRealTimeProvider.prototype._awsRealTimeIAMHeader = function (_a) {\n        var payload = _a.payload, canonicalUri = _a.canonicalUri, appSyncGraphqlEndpoint = _a.appSyncGraphqlEndpoint, region = _a.region;\n        return __awaiter(this, void 0, void 0, function () {\n            var endpointInfo, credentialsOK, creds, request, signed_params;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        endpointInfo = {\n                            region: region,\n                            service: 'appsync',\n                        };\n                        return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _b.sent();\n                        if (!credentialsOK) {\n                            throw new Error('No credentials');\n                        }\n                        return [4 /*yield*/, Credentials.get().then(function (credentials) { return ({\n                                secret_key: credentials.secretAccessKey,\n                                access_key: credentials.accessKeyId,\n                                session_token: credentials.sessionToken,\n                            }); })];\n                    case 2:\n                        creds = _b.sent();\n                        request = {\n                            url: \"\" + appSyncGraphqlEndpoint + canonicalUri,\n                            data: payload,\n                            method: 'POST',\n                            headers: __assign({}, AWS_APPSYNC_REALTIME_HEADERS),\n                        };\n                        signed_params = Signer.sign(request, creds, endpointInfo);\n                        return [2 /*return*/, signed_params.headers];\n                }\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    AWSAppSyncRealTimeProvider.prototype._ensureCredentials = function () {\n        return Credentials.get()\n            .then(function (credentials) {\n            if (!credentials)\n                return false;\n            var cred = Credentials.shear(credentials);\n            logger.debug('set credentials for AWSAppSyncRealTimeProvider', cred);\n            return true;\n        })\n            .catch(function (err) {\n            logger.warn('ensure credentials error', err);\n            return false;\n        });\n    };\n    return AWSAppSyncRealTimeProvider;\n}(AbstractPubSubProvider));\nexport { AWSAppSyncRealTimeProvider };\n//# sourceMappingURL=AWSAppSyncRealTimeProvider.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport Observable from 'zen-observable-ts';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nvar logger = new Logger('AWSAppSyncProvider');\nvar AWSAppSyncProvider = /** @class */ (function (_super) {\n    __extends(AWSAppSyncProvider, _super);\n    function AWSAppSyncProvider() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._topicClient = new Map();\n        _this._topicAlias = new Map();\n        return _this;\n    }\n    Object.defineProperty(AWSAppSyncProvider.prototype, \"endpoint\", {\n        get: function () {\n            throw new Error('Not supported');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSAppSyncProvider.prototype.getProviderName = function () {\n        return 'AWSAppSyncProvider';\n    };\n    AWSAppSyncProvider.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Operation not supported');\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype._cleanUp = function (clientId) {\n        var _this = this;\n        var topicsForClient = Array.from(this._topicClient.entries())\n            .filter(function (_a) {\n            var _b = __read(_a, 2), c = _b[1];\n            return c.clientId === clientId;\n        })\n            .map(function (_a) {\n            var _b = __read(_a, 1), t = _b[0];\n            return t;\n        });\n        topicsForClient.forEach(function (t) { return _this._cleanUpForTopic(t); });\n    };\n    AWSAppSyncProvider.prototype._cleanUpForTopic = function (topic) {\n        this._topicClient.delete(topic);\n        this._topicAlias.delete(topic);\n    };\n    AWSAppSyncProvider.prototype.onDisconnect = function (_a) {\n        var _this = this;\n        var clientId = _a.clientId, errorCode = _a.errorCode, args = __rest(_a, [\"clientId\", \"errorCode\"]);\n        if (errorCode !== 0) {\n            var topicsForClient = Array.from(this._topicClient.entries())\n                .filter(function (_a) {\n                var _b = __read(_a, 2), c = _b[1];\n                return c.clientId === clientId;\n            })\n                .map(function (_a) {\n                var _b = __read(_a, 1), t = _b[0];\n                return t;\n            });\n            topicsForClient.forEach(function (topic) {\n                if (_this._topicObservers.has(topic)) {\n                    _this._topicObservers.get(topic).forEach(function (obs) {\n                        if (!obs.closed) {\n                            obs.error(args);\n                        }\n                    });\n                    _this._topicObservers.delete(topic);\n                }\n            });\n            this._cleanUp(clientId);\n        }\n    };\n    AWSAppSyncProvider.prototype.disconnect = function (clientId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var client;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.clientsQueue.get(clientId, function () { return null; })];\n                    case 1:\n                        client = _a.sent();\n                        return [4 /*yield*/, _super.prototype.disconnect.call(this, clientId)];\n                    case 2:\n                        _a.sent();\n                        this._cleanUp(clientId);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AWSAppSyncProvider.prototype.subscribe = function (topics, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var result = new Observable(function (observer) {\n            var targetTopics = [].concat(topics);\n            logger.debug('Subscribing to topic(s)', targetTopics.join(','));\n            (function () { return __awaiter(_this, void 0, void 0, function () {\n                var _a, mqttConnections, newSubscriptions, newAliases, map;\n                var _this = this;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            // Add these topics to map\n                            targetTopics.forEach(function (t) {\n                                if (!_this._topicObservers.has(t)) {\n                                    _this._topicObservers.set(t, new Set());\n                                }\n                                _this._topicObservers.get(t).add(observer);\n                            });\n                            _a = options.mqttConnections, mqttConnections = _a === void 0 ? [] : _a, newSubscriptions = options.newSubscriptions;\n                            newAliases = Object.entries(newSubscriptions).map(function (_a) {\n                                var _b = __read(_a, 2), alias = _b[0], v = _b[1];\n                                return [v.topic, alias];\n                            });\n                            // Merge new aliases with old ones\n                            this._topicAlias = new Map(__spread(Array.from(this._topicAlias.entries()), newAliases));\n                            map = Object.entries(targetTopics.reduce(function (acc, elem) {\n                                var connectionInfoForTopic = mqttConnections.find(function (c) { return c.topics.indexOf(elem) > -1; });\n                                if (connectionInfoForTopic) {\n                                    var clientId = connectionInfoForTopic.client, url = connectionInfoForTopic.url;\n                                    if (!acc[clientId]) {\n                                        acc[clientId] = {\n                                            url: url,\n                                            topics: new Set(),\n                                        };\n                                    }\n                                    acc[clientId].topics.add(elem);\n                                }\n                                return acc;\n                            }, {}));\n                            // reconnect everything we have in the map\n                            return [4 /*yield*/, Promise.all(map.map(function (_a) {\n                                    var _b = __read(_a, 2), clientId = _b[0], _c = _b[1], url = _c.url, topics = _c.topics;\n                                    return __awaiter(_this, void 0, void 0, function () {\n                                        var client, err_1;\n                                        var _this = this;\n                                        return __generator(this, function (_d) {\n                                            switch (_d.label) {\n                                                case 0:\n                                                    client = null;\n                                                    _d.label = 1;\n                                                case 1:\n                                                    _d.trys.push([1, 3, , 4]);\n                                                    return [4 /*yield*/, this.connect(clientId, {\n                                                            clientId: clientId,\n                                                            url: url,\n                                                        })];\n                                                case 2:\n                                                    client = _d.sent();\n                                                    return [3 /*break*/, 4];\n                                                case 3:\n                                                    err_1 = _d.sent();\n                                                    observer.error({ message: 'Failed to connect', error: err_1 });\n                                                    observer.complete();\n                                                    return [2 /*return*/, undefined];\n                                                case 4:\n                                                    // subscribe to all topics for this client\n                                                    // store topic-client mapping\n                                                    topics.forEach(function (topic) {\n                                                        if (client.isConnected()) {\n                                                            client.subscribe(topic);\n                                                            _this._topicClient.set(topic, client);\n                                                        }\n                                                    });\n                                                    return [2 /*return*/, client];\n                                            }\n                                        });\n                                    });\n                                }))];\n                        case 1:\n                            // reconnect everything we have in the map\n                            _b.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); })();\n            return function () {\n                logger.debug('Unsubscribing from topic(s)', targetTopics.join(','));\n                targetTopics.forEach(function (t) {\n                    var client = _this._topicClient.get(t);\n                    if (client && client.isConnected()) {\n                        client.unsubscribe(t);\n                        _this._topicClient.delete(t);\n                        if (!Array.from(_this._topicClient.values()).some(function (c) { return c === client; })) {\n                            _this.disconnect(client.clientId);\n                        }\n                    }\n                    _this._topicObservers.delete(t);\n                });\n            };\n        });\n        return Observable.from(result).map(function (value) {\n            var topic = _this.getTopicForValue(value);\n            var alias = _this._topicAlias.get(topic);\n            value.data = Object.entries(value.data).reduce(function (obj, _a) {\n                var _b = __read(_a, 2), origKey = _b[0], val = _b[1];\n                return ((obj[(alias || origKey)] = val), obj);\n            }, {});\n            return value;\n        });\n    };\n    return AWSAppSyncProvider;\n}(MqttOverWSProvider));\nexport { AWSAppSyncProvider };\n//# sourceMappingURL=AWSAppSyncProvider.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n// import '../Common/Polyfills';\nimport Observable from 'zen-observable-ts';\nimport { Amplify, browserOrNode, ConsoleLogger as Logger, INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER, INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER, } from '@aws-amplify/core';\nimport { AWSAppSyncProvider, AWSAppSyncRealTimeProvider } from './Providers';\nvar isNode = browserOrNode().isNode;\nvar logger = new Logger('PubSub');\nvar PubSubClass = /** @class */ (function () {\n    /**\n     * Initialize PubSub with AWS configurations\n     *\n     * @param {PubSubOptions} options - Configuration object for PubSub\n     */\n    function PubSubClass(options) {\n        this._options = options;\n        logger.debug('PubSub Options', this._options);\n        this._pluggables = [];\n        this.subscribe = this.subscribe.bind(this);\n    }\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncProvider) {\n                this._awsAppSyncProvider = new AWSAppSyncProvider(this._options);\n            }\n            return this._awsAppSyncProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PubSubClass.prototype, \"awsAppSyncRealTimeProvider\", {\n        /**\n         * Lazy instantiate AWSAppSyncRealTimeProvider when it is required by the API category\n         */\n        get: function () {\n            if (!this._awsAppSyncRealTimeProvider) {\n                this._awsAppSyncRealTimeProvider = new AWSAppSyncRealTimeProvider(this._options);\n            }\n            return this._awsAppSyncRealTimeProvider;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PubSubClass.prototype.getModuleName = function () {\n        return 'PubSub';\n    };\n    /**\n     * Configure PubSub part with configurations\n     *\n     * @param {PubSubOptions} config - Configuration for PubSub\n     * @return {Object} - The current configuration\n     */\n    PubSubClass.prototype.configure = function (options) {\n        var _this = this;\n        var opt = options ? options.PubSub || options : {};\n        logger.debug('configure PubSub', { opt: opt });\n        this._options = Object.assign({}, this._options, opt);\n        this._pluggables.map(function (pluggable) { return pluggable.configure(_this._options); });\n        return this._options;\n    };\n    /**\n     * add plugin into Analytics category\n     * @param {Object} pluggable - an instance of the plugin\n     */\n    PubSubClass.prototype.addPluggable = function (pluggable) {\n        return __awaiter(this, void 0, void 0, function () {\n            var config;\n            return __generator(this, function (_a) {\n                if (pluggable && pluggable.getCategory() === 'PubSub') {\n                    this._pluggables.push(pluggable);\n                    config = pluggable.configure(this._options);\n                    return [2 /*return*/, config];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    PubSubClass.prototype.getProviderByName = function (providerName) {\n        if (providerName === INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER) {\n            return this.awsAppSyncProvider;\n        }\n        if (providerName === INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER) {\n            return this.awsAppSyncRealTimeProvider;\n        }\n        return this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === providerName; });\n    };\n    PubSubClass.prototype.getProviders = function (options) {\n        if (options === void 0) { options = {}; }\n        var providerName = options.provider;\n        if (!providerName) {\n            return this._pluggables;\n        }\n        var provider = this.getProviderByName(providerName);\n        if (!provider) {\n            throw new Error(\"Could not find provider named \" + providerName);\n        }\n        return [provider];\n    };\n    PubSubClass.prototype.publish = function (topics, msg, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, Promise.all(this.getProviders(options).map(function (provider) {\n                        return provider.publish(topics, msg, options);\n                    }))];\n            });\n        });\n    };\n    PubSubClass.prototype.subscribe = function (topics, options) {\n        if (isNode && this._options && this._options.ssr) {\n            throw new Error('Subscriptions are not supported for Server-Side Rendering (SSR)');\n        }\n        logger.debug('subscribe options', options);\n        var providers = this.getProviders(options);\n        return new Observable(function (observer) {\n            var observables = providers.map(function (provider) { return ({\n                provider: provider,\n                observable: provider.subscribe(topics, options),\n            }); });\n            var subscriptions = observables.map(function (_a) {\n                var provider = _a.provider, observable = _a.observable;\n                return observable.subscribe({\n                    start: console.error,\n                    next: function (value) { return observer.next({ provider: provider, value: value }); },\n                    error: function (error) { return observer.error({ provider: provider, error: error }); },\n                });\n            });\n            return function () {\n                return subscriptions.forEach(function (subscription) { return subscription.unsubscribe(); });\n            };\n        });\n    };\n    return PubSubClass;\n}());\nexport { PubSubClass };\nexport var PubSub = new PubSubClass(null);\nAmplify.register(PubSub);\n//# sourceMappingURL=PubSub.js.map","/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { PubSub } from './PubSub';\nexport * from './Providers';\nvar CONTROL_MSG;\n(function (CONTROL_MSG) {\n    CONTROL_MSG[\"CONNECTION_CLOSED\"] = \"Connection closed\";\n    CONTROL_MSG[\"CONNECTION_FAILED\"] = \"Connection failed\";\n    CONTROL_MSG[\"REALTIME_SUBSCRIPTION_INIT_ERROR\"] = \"AppSync Realtime subscription init error\";\n    CONTROL_MSG[\"SUBSCRIPTION_ACK\"] = \"Subscription ack\";\n    CONTROL_MSG[\"TIMEOUT_DISCONNECT\"] = \"Timeout disconnect\";\n})(CONTROL_MSG || (CONTROL_MSG = {}));\nexport { PubSub, CONTROL_MSG };\n/**\n * @deprecated use named import\n */\nexport default PubSub;\n//# sourceMappingURL=index.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { MqttOverWSProvider } from './MqttOverWSProvider';\nimport { Signer, Credentials } from '@aws-amplify/core';\nvar SERVICE_NAME = 'iotdevicegateway';\nvar AWSIoTProvider = /** @class */ (function (_super) {\n    __extends(AWSIoTProvider, _super);\n    function AWSIoTProvider() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(AWSIoTProvider.prototype, \"region\", {\n        get: function () {\n            return this.options.aws_pubsub_region;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AWSIoTProvider.prototype.getProviderName = function () {\n        return 'AWSIoTProvider';\n    };\n    Object.defineProperty(AWSIoTProvider.prototype, \"endpoint\", {\n        get: function () {\n            var _this = this;\n            return (function () { return __awaiter(_this, void 0, void 0, function () {\n                var endpoint, serviceInfo, _a, access_key, secret_key, session_token, result;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            endpoint = this.options.aws_pubsub_endpoint;\n                            serviceInfo = {\n                                service: SERVICE_NAME,\n                                region: this.region,\n                            };\n                            return [4 /*yield*/, Credentials.get()];\n                        case 1:\n                            _a = _b.sent(), access_key = _a.accessKeyId, secret_key = _a.secretAccessKey, session_token = _a.sessionToken;\n                            result = Signer.signUrl(endpoint, { access_key: access_key, secret_key: secret_key, session_token: session_token }, serviceInfo);\n                            return [2 /*return*/, result];\n                    }\n                });\n            }); })();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AWSIoTProvider;\n}(MqttOverWSProvider));\nexport { AWSIoTProvider };\n//# sourceMappingURL=AWSIotProvider.js.map"],"sourceRoot":""}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js b/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js
index 34f8a4b..d044d6d 100644
--- a/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js
+++ b/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js
@@ -229,6 +229,13 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                     options: options,
                     observer: observer,
                     subscriptionId: subscriptionId_1,
+                }).catch(function (err) {
+                    observer.error({
+                        errors: [
+                            __assign({}, new GraphQLError(CONTROL_MSG.REALTIME_SUBSCRIPTION_INIT_ERROR + ": " + err)),
+                        ],
+                    });
+                    observer.complete();
                 });
                 return function () { return __awaiter(_this, void 0, void 0, function () {
                     var subscriptionState, err_1;
@@ -342,7 +349,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                         _f = err_2.message, message = _f === void 0 ? '' : _f;
                         observer.error({
                             errors: [
-                                __assign({}, new GraphQLError("Connection failed: " + message)),
+                                __assign({}, new GraphQLError(CONTROL_MSG.CONNECTION_FAILED + ": " + message)),
                             ],
                         });
                         observer.complete();
@@ -366,7 +373,9 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                                 _this._timeoutStartSubscriptionAck.call(_this, subscriptionId);
                             }, START_ACK_TIMEOUT),
                         });
-                        this.awsRealTimeSocket.send(stringToAWSRealTime);
+                        if (this.awsRealTimeSocket) {
+                            this.awsRealTimeSocket.send(stringToAWSRealTime);
+                        }
                         return [2 /*return*/];
                 }
             });
@@ -498,7 +507,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
             });
             observer.error({
                 errors: [
-                    __assign({}, new GraphQLError("Connection failed: " + JSON.stringify(payload))),
+                    __assign({}, new GraphQLError(CONTROL_MSG.CONNECTION_FAILED + ": " + JSON.stringify(payload))),
                 ],
             });
             clearTimeout(startAckTimeoutId);
@@ -512,7 +521,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
         logger.debug("Disconnect error: " + msg);
         this.subscriptionObserverMap.forEach(function (_a) {
             var observer = _a.observer;
-            if (!observer.closed) {
+            if (observer && !observer.closed) {
                 observer.error({
                     errors: [__assign({}, new GraphQLError(msg))],
                 });
@@ -608,7 +617,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                         }
                         this.awsRealTimeSocket = null;
                         this.socketStatus = SOCKET_STATUS.CLOSED;
-                        throw err_3;
+                        return [3 /*break*/, 5];
                     case 5: return [2 /*return*/];
                 }
             });
@@ -681,6 +690,10 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                                                 logger.debug(err);
                                                 _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);
                                             };
+                                            _this.awsRealTimeSocket.onclose = function (event) {
+                                                logger.debug("WebSocket closed " + event.reason);
+                                                _this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);
+                                            };
                                             res('Cool, connected to AWS AppSyncRealTime');
                                             return;
                                         }
@@ -777,17 +790,28 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
     AWSAppSyncRealTimeProvider.prototype._awsRealTimeOPENIDHeader = function (_a) {
         var host = _a.host;
         return __awaiter(this, void 0, void 0, function () {
-            var federatedInfo;
+            var token, federatedInfo, currentUser;
             return __generator(this, function (_b) {
                 switch (_b.label) {
                     case 0: return [4 /*yield*/, Cache.getItem('federatedInfo')];
                     case 1:
                         federatedInfo = _b.sent();
-                        if (!federatedInfo || !federatedInfo.token) {
+                        if (!federatedInfo) return [3 /*break*/, 2];
+                        token = federatedInfo.token;
+                        return [3 /*break*/, 4];
+                    case 2: return [4 /*yield*/, Auth.currentAuthenticatedUser()];
+                    case 3:
+                        currentUser = _b.sent();
+                        if (currentUser) {
+                            token = currentUser.token;
+                        }
+                        _b.label = 4;
+                    case 4:
+                        if (!token) {
                             throw new Error('No federated jwt');
                         }
                         return [2 /*return*/, {
-                                Authorization: federatedInfo.token,
+                                Authorization: token,
                                 host: host,
                             }];
                 }
diff --git a/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js.map b/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js.map
index 86b1e5e..f20220c 100644
--- a/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js.map
+++ b/node_modules/@aws-amplify/pubsub/lib-esm/Providers/AWSAppSyncRealTimeProvider.js.map
@@ -1 +1 @@
-{"version":3,"file":"AWSAppSyncRealTimeProvider.js","sourceRoot":"","sources":["../../src/Providers/AWSAppSyncRealTimeProvider.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;GAWG;AACH,OAAO,UAA6B,MAAM,mBAAmB,CAAC;AAC9D,OAAO,EAAE,YAAY,EAAE,MAAM,SAAS,CAAC;AACvC,OAAO,KAAK,GAAG,MAAM,KAAK,CAAC;AAC3B,OAAO,EAAE,EAAE,IAAI,IAAI,EAAE,MAAM,MAAM,CAAC;AAClC,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAEhC,OAAO,EACN,MAAM,EACN,WAAW,EACX,MAAM,EACN,GAAG,EACH,SAAS,EACT,iBAAiB,EACjB,wBAAwB,EACxB,iBAAiB,GACjB,MAAM,mBAAmB,CAAC;AAC3B,OAAO,KAAK,MAAM,oBAAoB,CAAC;AACvC,OAAO,IAAI,MAAM,mBAAmB,CAAC;AACrC,OAAO,EAAE,sBAAsB,EAAE,MAAM,kBAAkB,CAAC;AAC1D,OAAO,EAAE,WAAW,EAAE,MAAM,UAAU,CAAC;AAEvC,IAAM,MAAM,GAAG,IAAI,MAAM,CAAC,4BAA4B,CAAC,CAAC;AAExD,IAAM,cAAc,GAAG,CAAC,OAAO,MAAM,KAAK,WAAW;IACrD,OAAO,MAAM,CAAC,GAAG,KAAK,UAAU;IAC/B,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,iBAAiB,CAAC;IAC/B,CAAC,CAAC,mBAAmB,CAAW,CAAC;AAElC,IAAM,gBAAgB,GAAG,UAAC,KAAa,EAAE,IAAS,EAAE,OAAe;IAClE,GAAG,CAAC,QAAQ,CAAC,KAAK,EAAE,EAAE,KAAK,OAAA,EAAE,IAAI,MAAA,EAAE,OAAO,SAAA,EAAE,EAAE,QAAQ,EAAE,cAAc,CAAC,CAAC;AACzE,CAAC,CAAC;AAEF,IAAM,YAAY,GAAG,IAAI,CAAC;AAE1B,IAAM,mBAAmB,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;AAY5C,IAAK,aAmDJ;AAnDD,WAAK,aAAa;IACjB;;;OAGG;IACH,wDAAuC,CAAA;IACvC;;;OAGG;IACH,0DAAyC,CAAA;IACzC;;;OAGG;IACH,sDAAqC,CAAA;IACrC;;;OAGG;IACH,oCAAmB,CAAA;IACnB;;;OAGG;IACH,4CAA2B,CAAA;IAC3B;;;OAGG;IACH,kCAAiB,CAAA;IACjB;;;OAGG;IACH,iDAAgC,CAAA;IAChC;;;OAGG;IACH,kCAAiB,CAAA;IACjB;;;OAGG;IACH,0CAAyB,CAAA;IACzB;;;OAGG;IACH,oCAAmB,CAAA;AACpB,CAAC,EAnDI,aAAa,KAAb,aAAa,QAmDjB;AAED,IAAK,mBAIJ;AAJD,WAAK,mBAAmB;IACvB,mEAAO,CAAA;IACP,uEAAS,CAAA;IACT,iEAAM,CAAA;AACP,CAAC,EAJI,mBAAmB,KAAnB,mBAAmB,QAIvB;AAED,IAAK,aAIJ;AAJD,WAAK,aAAa;IACjB,qDAAM,CAAA;IACN,mDAAK,CAAA;IACL,6DAAU,CAAA;AACX,CAAC,EAJI,aAAa,KAAb,aAAa,QAIjB;AAED,IAAM,4BAA4B,GAAG;IACpC,MAAM,EAAE,mCAAmC;IAC3C,kBAAkB,EAAE,SAAS;IAC7B,cAAc,EAAE,iCAAiC;CACjD,CAAC;AAEF;;GAEG;AACH,IAAM,uBAAuB,GAAG,KAAK,CAAC;AAEtC;;GAEG;AACH,IAAM,iBAAiB,GAAG,KAAK,CAAC;AAEhC;;GAEG;AACH,IAAM,0BAA0B,GAAG,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC;AAEjD;IAAgD,8CAAsB;IAAtE;QAAA,qEAisBC;QA/rBQ,kBAAY,GAAkB,aAAa,CAAC,MAAM,CAAC;QAEnD,sBAAgB,GAAG,0BAA0B,CAAC;QAC9C,6BAAuB,GAA+B,IAAI,GAAG,EAAE,CAAC;QAChE,kBAAY,GAA4C,EAAE,CAAC;;IA2rBpE,CAAC;IAzrBA,oDAAe,GAAf;QACC,OAAO,4BAA4B,CAAC;IACrC,CAAC;IAED,8CAAS,GAAT;QACC,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;IAClC,CAAC;IAEY,4CAAO,GAApB,UAAqB,OAA0B,EAAE,IAAS,EAAE,QAAc;;;gBACzE,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;;;KAC3C;IAED,8CAAS,GAAT,UACC,OAA0B,EAC1B,OAA0B;QAF3B,iBAqDC;QAjDQ,IAAA,uDAAsB,CAAa;QAE3C,OAAO,IAAI,UAAU,CAAC,UAAA,QAAQ;YAC7B,IAAI,CAAC,sBAAsB,EAAE;gBAC5B,QAAQ,CAAC,KAAK,CAAC;oBACd,MAAM,EAAE;qCAEH,IAAI,YAAY,CAClB,mDAAmD,CACnD;qBAEF;iBACD,CAAC,CAAC;gBACH,QAAQ,CAAC,QAAQ,EAAE,CAAC;aACpB;iBAAM;gBACN,IAAM,gBAAc,GAAG,IAAI,EAAE,CAAC;gBAC9B,KAAI,CAAC,wCAAwC,CAAC;oBAC7C,OAAO,SAAA;oBACP,QAAQ,UAAA;oBACR,cAAc,kBAAA;iBACd,CAAC,CAAC;gBAEH,OAAO;;;;;;gCAGL,4EAA4E;gCAC5E,qBAAM,IAAI,CAAC,iCAAiC,CAAC,gBAAc,CAAC,EAAA;;gCAD5D,4EAA4E;gCAC5E,SAA4D,CAAC;gCAErD,iBAAiB,GACxB,CAAA,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,gBAAc,CAAC,IAAI,EAAE,CAAA,kBAD9B,CAC+B;gCAExD,IAAI,CAAC,iBAAiB,EAAE;oCACvB,oCAAoC;oCACpC,sBAAO;iCACP;gCAED,IAAI,iBAAiB,KAAK,mBAAmB,CAAC,SAAS,EAAE;oCACxD,IAAI,CAAC,0BAA0B,CAAC,gBAAc,CAAC,CAAC;iCAChD;qCAAM;oCACN,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;iCAChD;;;;gCAED,MAAM,CAAC,KAAK,CAAC,+BAA6B,KAAK,CAAC,CAAC;;;gCAEjD,IAAI,CAAC,2BAA2B,CAAC,gBAAc,CAAC,CAAC;;;;;qBAElD,CAAC;aACF;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,sBAAc,oDAAY;aAA1B;YACC,OAAO,CAAC,IAAI,CAAC,OAAO;iBAClB,4DAA4D,CAAC;QAChE,CAAC;;;OAAA;IACa,6EAAwC,GAAtD,UAAuD,EAItD;YAHA,oBAAO,EACP,sBAAQ,EACR,kCAAc;;;;;;;;wBAGb,sBAAsB,GAQnB,OAAO,uBARY,EACtB,kBAAkB,GAOf,OAAO,mBAPQ,EAClB,KAAK,GAMF,OAAO,MANL,EACL,SAAS,GAKN,OAAO,UALD,EACT,MAAM,GAIH,OAAO,OAJJ,EACN,MAAM,GAGH,OAAO,OAHJ,EACN,KAEG,OAAO,gBAFkB,EAA5B,eAAe,mBAAG,cAAM,OAAA,CAAC,EAAE,CAAC,EAAJ,CAAI,KAAA,EAC5B,KACG,OAAO,kBADY,EAAtB,iBAAiB,mBAAG,EAAE,KAAA,CACX;wBAEN,iBAAiB,GAAwB,mBAAmB,CAAC,OAAO,CAAC;wBACrE,IAAI,GAAG;4BACZ,KAAK,OAAA;4BACL,SAAS,WAAA;yBACT,CAAC;wBACF,gFAAgF;wBAChF,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,cAAc,EAAE;4BAChD,QAAQ,UAAA;4BACR,KAAK,OAAA;4BACL,SAAS,WAAA;4BACT,iBAAiB,mBAAA;4BACjB,iBAAiB,EAAE,IAAI;yBACvB,CAAC,CAAC;wBAIG,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;;wBAEnC,qBAAM,IAAI,CAAC,2BAA2B,CAAC;gCAC1C,MAAM,QAAA;gCACN,sBAAsB,wBAAA;gCACtB,kBAAkB,oBAAA;gCAClB,OAAO,EAAE,UAAU;gCACnB,YAAY,EAAE,EAAE;gCAChB,MAAM,QAAA;6BACN,CAAC,EAAA;;gEAPC,CAAC,SAOF,CAAC;wBACC,qBAAM,eAAe,EAAE,EAAA;;wBATtB,SAAS,qFASX,CAAC,SAAuB,CAAC,KACzB,iBAAiB,iBACnB,iBAAiB,IAAG,SAAS,CAAC,SAAS,OACxC;wBAEK,mBAAmB,GAAG;4BAC3B,EAAE,EAAE,cAAc;4BAClB,OAAO,EAAE;gCACR,IAAI,EAAE,UAAU;gCAChB,UAAU,EAAE;oCACX,aAAa,eACT,SAAS,CACZ;iCACD;6BACD;4BACD,IAAI,EAAE,aAAa,CAAC,SAAS;yBAC7B,CAAC;wBAEI,mBAAmB,GAAG,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;;;;wBAG/D,qBAAM,IAAI,CAAC,8BAA8B,CAAC;gCACzC,MAAM,QAAA;gCACN,sBAAsB,wBAAA;gCACtB,kBAAkB,oBAAA;gCAClB,MAAM,QAAA;6BACN,CAAC,EAAA;;wBALF,SAKE,CAAC;;;;wBAEH,MAAM,CAAC,KAAK,CAAC,EAAE,GAAG,OAAA,EAAE,CAAC,CAAC;wBACd,KAAiB,KAAG,QAAR,EAAZ,OAAO,mBAAG,EAAE,KAAA,CAAS;wBAC7B,QAAQ,CAAC,KAAK,CAAC;4BACd,MAAM,EAAE;6CAEH,IAAI,YAAY,CAAC,wBAAsB,OAAS,CAAC;6BAErD;yBACD,CAAC,CAAC;wBACH,QAAQ,CAAC,QAAQ,EAAE,CAAC;wBAEZ,+BACP,CAAA,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,cAAc,CAAC,IAAI,EAAE,CAAA,2BADrB,CACsB;wBAExD,mCAAmC;wBACnC,IAAI,OAAO,4BAA0B,KAAK,UAAU,EAAE;4BACrD,4BAA0B,EAAE,CAAC;yBAC7B;wBACD,sBAAO;;wBAOF,KAGF,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,cAAc,CAAC,EAFnD,0BAA0B,gCAAA,EAC1B,yBAAyB,+BAAA,CAC2B;wBAErD,oFAAoF;wBACpF,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,cAAc,EAAE;4BAChD,QAAQ,UAAA;4BACR,iBAAiB,mBAAA;4BACjB,SAAS,WAAA;4BACT,KAAK,OAAA;4BACL,yBAAyB,2BAAA;4BACzB,0BAA0B,4BAAA;4BAC1B,iBAAiB,EAAE,UAAU,CAAC;gCAC7B,KAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,KAAI,EAAE,cAAc,CAAC,CAAC;4BAC9D,CAAC,EAAE,iBAAiB,CAAC;yBACrB,CAAC,CAAC;wBACH,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;;;;;KACjD;IAED,4EAA4E;IAC9D,sEAAiC,GAA/C,UAAgD,cAAc;;;;;gBACrD,iBAAiB,GAAK,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAC7D,cAAc,CACd,kBAFwB,CAEvB;gBACF,gFAAgF;gBAChF,IAAI,iBAAiB,KAAK,mBAAmB,CAAC,OAAO,EAAE;oBACtD,sBAAO,IAAI,OAAO,CAAC,UAAC,GAAG,EAAE,GAAG;4BACrB,IAAA,sDAK8C,EAJnD,sBAAQ,EACR,wCAAiB,EACjB,wBAAS,EACT,gBACmD,CAAC;4BACrD,KAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,cAAc,EAAE;gCAChD,QAAQ,UAAA;gCACR,iBAAiB,mBAAA;gCACjB,SAAS,WAAA;gCACT,KAAK,OAAA;gCACL,yBAAyB,EAAE,GAAG;gCAC9B,0BAA0B,EAAE,GAAG;6BAC/B,CAAC,CAAC;wBACJ,CAAC,CAAC,EAAC;iBACH;;;;KACD;IAEO,+DAA0B,GAAlC,UAAmC,cAAc;QAChD,IAAI;YACH,IACC,IAAI,CAAC,iBAAiB;gBACtB,IAAI,CAAC,iBAAiB,CAAC,UAAU,KAAK,SAAS,CAAC,IAAI;gBACpD,IAAI,CAAC,YAAY,KAAK,aAAa,CAAC,KAAK,EACxC;gBACD,iFAAiF;gBACjF,IAAM,kBAAkB,GAAG;oBAC1B,EAAE,EAAE,cAAc;oBAClB,IAAI,EAAE,aAAa,CAAC,QAAQ;iBAC5B,CAAC;gBACF,IAAM,mBAAmB,GAAG,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;gBAC/D,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;aACjD;SACD;QAAC,OAAO,GAAG,EAAE;YACb,kGAAkG;YAClG,MAAM,CAAC,KAAK,CAAC,EAAE,GAAG,KAAA,EAAE,CAAC,CAAC;SACtB;IACF,CAAC;IAEO,gEAA2B,GAAnC,UAAoC,cAAc;QACjD,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;QAEpD,gGAAgG;QAChG,UAAU,CAAC,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;IAC1D,CAAC;IAEO,2DAAsB,GAA9B;QACC,IAAI,IAAI,CAAC,uBAAuB,CAAC,IAAI,GAAG,CAAC,EAAE;YAC1C,wCAAwC;YACxC,OAAO;SACP;QAED,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;YAC5B,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC,MAAM,CAAC;YACzC,OAAO;SACP;QACD,IAAI,IAAI,CAAC,iBAAiB,CAAC,cAAc,GAAG,CAAC,EAAE;YAC9C,8BAA8B;YAC9B,UAAU,CAAC,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;SACzD;aAAM;YACN,MAAM,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAAC;YACrC,YAAY,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YACtC,IAAM,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC;YAC1C,kEAAkE;YAClE,UAAU,CAAC,OAAO,GAAG,SAAS,CAAC;YAC/B,UAAU,CAAC,OAAO,GAAG,SAAS,CAAC;YAC/B,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACvB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;YAC9B,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC,MAAM,CAAC;SACzC;IACF,CAAC;IAEO,uEAAkC,GAA1C,UAA2C,OAAqB;QAC/D,MAAM,CAAC,KAAK,CACX,qDAAmD,OAAO,CAAC,IAAM,CACjE,CAAC;QACI,IAAA,6BAAqD,EAAnD,UAAO,EAAP,4BAAO,EAAE,oBAAO,EAAE,cAAiC,CAAC;QACtD,IAAA,+CAOwC,EAN7C,gBAAe,EAAf,oCAAe,EACf,aAAU,EAAV,+BAAU,EACV,iBAAc,EAAd,mCAAc,EACd,wCAAiB,EACjB,wDAAyB,EACzB,0DAC6C,CAAC;QAE/C,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE,IAAA,EAAE,QAAQ,UAAA,EAAE,KAAK,OAAA,EAAE,SAAS,WAAA,EAAE,CAAC,CAAC;QAEjD,IAAI,IAAI,KAAK,aAAa,CAAC,QAAQ,IAAI,OAAO,IAAI,OAAO,CAAC,IAAI,EAAE;YAC/D,IAAI,QAAQ,EAAE;gBACb,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;aACvB;iBAAM;gBACN,MAAM,CAAC,KAAK,CAAC,gCAA8B,EAAI,CAAC,CAAC;aACjD;YACD,OAAO;SACP;QAED,IAAI,IAAI,KAAK,aAAa,CAAC,aAAa,EAAE;YACzC,MAAM,CAAC,KAAK,CACX,4BAA0B,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,OAAA,EAAE,SAAS,WAAA,EAAE,CAAG,CAChE,CAAC;YACF,IAAI,OAAO,yBAAyB,KAAK,UAAU,EAAE;gBACpD,yBAAyB,EAAE,CAAC;aAC5B;YACD,YAAY,CAAC,iBAAiB,CAAC,CAAC;YAChC,gBAAgB,CACf,WAAW,CAAC,gBAAgB,EAC5B,EAAE,KAAK,OAAA,EAAE,SAAS,WAAA,EAAE,EACpB,yCAAyC,CACzC,CAAC;YACF,IAAM,iBAAiB,GAAG,mBAAmB,CAAC,SAAS,CAAC;YACxD,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,EAAE,EAAE;gBACpC,QAAQ,UAAA;gBACR,KAAK,OAAA;gBACL,SAAS,WAAA;gBACT,iBAAiB,EAAE,IAAI;gBACvB,iBAAiB,mBAAA;gBACjB,yBAAyB,2BAAA;gBACzB,0BAA0B,4BAAA;aAC1B,CAAC,CAAC;YAEH,gEAAgE;YAChE,OAAO;SACP;QAED,IAAI,IAAI,KAAK,aAAa,CAAC,yBAAyB,EAAE;YACrD,YAAY,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YACtC,IAAI,CAAC,kBAAkB,GAAG,UAAU,CACnC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,EAAE,WAAW,CAAC,kBAAkB,CAAC,EAChE,IAAI,CAAC,gBAAgB,CACrB,CAAC;YACF,OAAO;SACP;QAED,IAAI,IAAI,KAAK,aAAa,CAAC,SAAS,EAAE;YACrC,IAAM,iBAAiB,GAAG,mBAAmB,CAAC,MAAM,CAAC;YACrD,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,EAAE,EAAE;gBACpC,QAAQ,UAAA;gBACR,KAAK,OAAA;gBACL,SAAS,WAAA;gBACT,iBAAiB,mBAAA;gBACjB,yBAAyB,2BAAA;gBACzB,0BAA0B,4BAAA;gBAC1B,iBAAiB,mBAAA;aACjB,CAAC,CAAC;YAEH,QAAQ,CAAC,KAAK,CAAC;gBACd,MAAM,EAAE;iCAEH,IAAI,YAAY,CAClB,wBAAsB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAG,CAC/C;iBAEF;aACD,CAAC,CAAC;YACH,YAAY,CAAC,iBAAiB,CAAC,CAAC;YAEhC,QAAQ,CAAC,QAAQ,EAAE,CAAC;YACpB,IAAI,OAAO,0BAA0B,KAAK,UAAU,EAAE;gBACrD,0BAA0B,EAAE,CAAC;aAC7B;SACD;IACF,CAAC;IAEO,qDAAgB,GAAxB,UAAyB,GAAW;QACnC,MAAM,CAAC,KAAK,CAAC,uBAAqB,GAAK,CAAC,CAAC;QACzC,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,UAAC,EAAY;gBAAV,sBAAQ;YAC/C,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;gBACrB,QAAQ,CAAC,KAAK,CAAC;oBACd,MAAM,EAAE,cAAM,IAAI,YAAY,CAAC,GAAG,CAAC,EAAG;iBACtC,CAAC,CAAC;aACH;QACF,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,CAAC;QACrC,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC3B,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;SAC/B;QAED,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC,MAAM,CAAC;IAC1C,CAAC;IAEO,iEAA4B,GAApC,UAAqC,cAAc;QAC5C,IAAA,2DACiD,EAD/C,sBAAQ,EAAE,gBAAK,EAAE,wBAC8B,CAAC;QACxD,IAAI,CAAC,QAAQ,EAAE;YACd,OAAO;SACP;QACD,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,cAAc,EAAE;YAChD,QAAQ,UAAA;YACR,KAAK,OAAA;YACL,SAAS,WAAA;YACT,iBAAiB,EAAE,mBAAmB,CAAC,MAAM;SAC7C,CAAC,CAAC;QAEH,IAAI,QAAQ,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;YACjC,QAAQ,CAAC,KAAK,CAAC;gBACd,MAAM,EAAE;iCAEH,IAAI,YAAY,CAClB,0BAAwB,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,OAAA,EAAE,SAAS,WAAA,EAAE,CAAG,CAC9D;iBAEF;aACD,CAAC,CAAC;YACH,yCAAyC;YACzC,QAAQ,CAAC,QAAQ,EAAE,CAAC;SACpB;QACD,MAAM,CAAC,KAAK,CACX,0BAA0B,EAC1B,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,OAAA,EAAE,SAAS,WAAA,EAAE,CAAC,CACpC,CAAC;IACH,CAAC;IAEO,mEAA8B,GAAtC,UAAuC,EAKtC;QALD,iBA+DC;YA9DA,kDAAsB,EACtB,0CAAkB,EAClB,kBAAM,EACN,kBAAM;QAEN,IAAI,IAAI,CAAC,YAAY,KAAK,aAAa,CAAC,KAAK,EAAE;YAC9C,OAAO;SACP;QACD,OAAO,IAAI,OAAO,CAAC,UAAO,GAAG,EAAE,GAAG;;;;;wBACjC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,GAAG,KAAA,EAAE,GAAG,KAAA,EAAE,CAAC,CAAC;6BAEjC,CAAA,IAAI,CAAC,YAAY,KAAK,aAAa,CAAC,MAAM,CAAA,EAA1C,wBAA0C;;;;wBAE5C,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC,UAAU,CAAC;wBAEvC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAC;wBAClD,oBAAoB,GAAG,sBAAsB;6BACjD,OAAO,CAAC,UAAU,EAAE,QAAQ,CAAC;6BAC7B,OAAO,CAAC,SAAS,EAAE,QAAQ,CAAC;6BAC5B,OAAO,CAAC,aAAa,EAAE,sBAAsB,CAAC;6BAC9C,OAAO,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC;wBAE7B,aAAa,GAAG,IAAI,CAAC;wBACN,KAAA,CAAA,KAAA,IAAI,CAAA,CAAC,SAAS,CAAA;wBAClC,qBAAM,IAAI,CAAC,2BAA2B,CAAC;gCACtC,kBAAkB,oBAAA;gCAClB,OAAO,EAAE,aAAa;gCACtB,YAAY,EAAE,UAAU;gCACxB,MAAM,QAAA;gCACN,sBAAsB,wBAAA;gCACtB,MAAM,QAAA;6BACN,CAAC,EAAA;;wBARG,YAAY,GAAG,cACpB,SAOE,EACF;wBACK,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;wBAExD,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;wBAC1D,cAAc,GAAM,oBAAoB,gBAAW,QAAQ,iBAAY,SAAW,CAAC;wBAEzF,qBAAM,IAAI,CAAC,6BAA6B,CAAC,EAAE,cAAc,gBAAA,EAAE,CAAC,EAAA;;wBAA5D,SAA4D,CAAC;wBAE7D,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,EAAO;gCAAL,YAAG;4BAC/B,MAAM,CAAC,KAAK,CAAC,iCAAiC,CAAC,CAAC;4BAChD,GAAG,EAAE,CAAC;wBACP,CAAC,CAAC,CAAC;wBACH,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC,KAAK,CAAC;wBACxC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;;;;wBAEvB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,EAAO;gCAAL,YAAG;4BAAO,OAAA,GAAG,CAAC,KAAG,CAAC;wBAAR,CAAQ,CAAC,CAAC;wBACjD,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;wBACvB,IACC,IAAI,CAAC,iBAAiB;4BACtB,IAAI,CAAC,iBAAiB,CAAC,UAAU,KAAK,SAAS,CAAC,IAAI,EACnD;4BACD,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;yBACnC;wBACD,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;wBAC9B,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC,MAAM,CAAC;wBAEzC,MAAM,KAAG,CAAC;;;;aAGZ,CAAC,CAAC;IACJ,CAAC;IAEa,kEAA6B,GAA3C,UAA4C,EAAkB;YAAhB,kCAAc;;;;;wBAC3D,MAAM,CAAC,KAAK,CAAC,oCAAoC,CAAC,CAAC;wBACnD,qBAAM,wBAAwB,CAC7B,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,EACpC,CAAC,EAAE,cAAc,gBAAA,EAAE,CAAC,EACpB,YAAY,CACZ,EAAA;;wBAJD,SAIC,CAAC;;;;;KACF;IAEa,yDAAoB,GAAlC,UAAmC,EAAkB;YAAhB,kCAAc;;;;;;;wBAClD,MAAM,CAAC,KAAK,CAAC,4BAA0B,cAAgB,CAAC,CAAC;;;;wBAIxD,qBAAM,CAAC;gCACN,OAAO,IAAI,OAAO,CAAC,UAAC,GAAG,EAAE,GAAG;oCAC3B,IAAM,SAAS,GAAG,IAAI,SAAS,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;oCAC9D,SAAS,CAAC,OAAO,GAAG;wCACnB,MAAM,CAAC,KAAK,CAAC,4BAA4B,CAAC,CAAC;oCAC5C,CAAC,CAAC;oCACF,SAAS,CAAC,OAAO,GAAG;wCACnB,GAAG,CAAC,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC,CAAC;oCAC9C,CAAC,CAAC;oCACF,SAAS,CAAC,MAAM,GAAG;wCAClB,KAAI,CAAC,iBAAiB,GAAG,SAAS,CAAC;wCACnC,OAAO,GAAG,EAAE,CAAC;oCACd,CAAC,CAAC;gCACH,CAAC,CAAC,CAAC;4BACJ,CAAC,CAAC,EAAE,EAAA;;wBAdJ,SAcI,CAAC;wBAEL,kEAAkE;wBAClE,qBAAM,CAAC;gCACN,OAAO,IAAI,OAAO,CAAC,UAAC,GAAG,EAAE,GAAG;oCAC3B,IAAI,KAAK,GAAG,KAAK,CAAC;oCAClB,KAAI,CAAC,iBAAiB,CAAC,OAAO,GAAG,UAAA,KAAK;wCACrC,MAAM,CAAC,KAAK,CAAC,qBAAmB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAG,CAAC,CAAC;oCAC1D,CAAC,CAAC;oCACF,KAAI,CAAC,iBAAiB,CAAC,OAAO,GAAG,UAAA,KAAK;wCACrC,MAAM,CAAC,KAAK,CAAC,sBAAoB,KAAK,CAAC,MAAQ,CAAC,CAAC;wCACjD,GAAG,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oCACvC,CAAC,CAAC;oCAEF,KAAI,CAAC,iBAAiB,CAAC,SAAS,GAAG,UAAC,OAAqB;wCACxD,MAAM,CAAC,KAAK,CACX,oDAAkD,OAAO,CAAC,IAAI,MAAG,CACjE,CAAC;wCACF,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;wCAErC,IAAA,gBAAI,EACJ,iBAEM,EADL,kDAAgD,EAAhD,qEACK,CACE;wCACT,IAAI,IAAI,KAAK,aAAa,CAAC,kBAAkB,EAAE;4CAC9C,KAAK,GAAG,IAAI,CAAC;4CACb,KAAI,CAAC,gBAAgB,GAAG,mBAAmB,CAAC;4CAC5C,KAAI,CAAC,iBAAiB,CAAC,SAAS,GAAG,KAAI,CAAC,kCAAkC,CAAC,IAAI,CAC9E,KAAI,CACJ,CAAC;4CACF,KAAI,CAAC,iBAAiB,CAAC,OAAO,GAAG,UAAA,GAAG;gDACnC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gDAClB,KAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;4CACtD,CAAC,CAAC;4CACF,GAAG,CAAC,wCAAwC,CAAC,CAAC;4CAC9C,OAAO;yCACP;wCAED,IAAI,IAAI,KAAK,aAAa,CAAC,oBAAoB,EAAE;4CAE/C,IAAA,iBAEM,EADL,qCAAqD,EAArD,uCAAqD,EAA5C,UAAsC,EAAtC,4BAAsC,EAApC,iBAAc,EAAd,mCAAc,EAAE,iBAAa,EAAb,kCACtB,CACE;4CAET,GAAG,CAAC,EAAE,SAAS,WAAA,EAAE,SAAS,WAAA,EAAE,CAAC,CAAC;yCAC9B;oCACF,CAAC,CAAC;oCAEF,IAAM,OAAO,GAAG;wCACf,IAAI,EAAE,aAAa,CAAC,mBAAmB;qCACvC,CAAC;oCACF,KAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;oCAErD,SAAS,UAAU;wCAClB,IAAI,CAAC,KAAK,EAAE;4CACX,GAAG,CACF,IAAI,KAAK,CACR,kEAAgE,uBAAuB,QAAK,CAC5F,CACD,CAAC;yCACF;oCACF,CAAC;oCAED,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,KAAI,CAAC,EAAE,uBAAuB,CAAC,CAAC;gCAC5D,CAAC,CAAC,CAAC;4BACJ,CAAC,CAAC,EAAE,EAAA;;wBAjEJ,kEAAkE;wBAClE,SAgEI,CAAC;;;;wBAEG,SAAS,GAAgB,KAAG,UAAnB,EAAE,SAAS,GAAK,KAAG,UAAR,CAAS;wBAErC,IAAI,mBAAmB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;4BAC5C,MAAM,IAAI,iBAAiB,CAAC,SAAS,CAAC,CAAC;yBACvC;6BAAM,IAAI,SAAS,EAAE;4BACrB,MAAM,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC;yBAC3B;6BAAM;4BACN,MAAM,KAAG,CAAC;yBACV;;;;;;KAEF;IAEa,gEAA2B,GAAzC,UAA0C,EAOzC;YANA,0CAAkB,EAClB,oBAAO,EACP,8BAAY,EACZ,kDAAsB,EACtB,kBAAM,EACN,kBAAM;;;;;;wBAEA,aAAa,GAAG;4BACrB,OAAO,EAAE,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC;4BACjD,OAAO,EAAE,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC;4BAC9C,cAAc,EAAE,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC;4BACxD,yBAAyB,EAAE,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC;yBAChE,CAAC;wBAEI,OAAO,GAAG,aAAa,CAAC,kBAAkB,CAAC,CAAC;wBAElD,IAAI,OAAO,OAAO,KAAK,UAAU,EAAE;4BAClC,MAAM,CAAC,KAAK,CAAC,yBAAuB,kBAAkB,mBAAgB,CAAC,CAAC;4BACxE,sBAAO,EAAE,EAAC;yBACV;wBAEO,IAAI,GAAK,GAAG,CAAC,KAAK,CAAC,sBAAsB,CAAC,KAAtC,CAAuC;wBAEpC,qBAAM,OAAO,CAAC;gCAC5B,OAAO,SAAA;gCACP,YAAY,cAAA;gCACZ,sBAAsB,wBAAA;gCACtB,MAAM,QAAA;gCACN,MAAM,QAAA;gCACN,IAAI,MAAA;6BACJ,CAAC,EAAA;;wBAPI,MAAM,GAAG,SAOb;wBAEF,sBAAO,MAAM,EAAC;;;;KACd;IAEa,0DAAqB,GAAnC,UAAoC,EAAQ;YAAN,cAAI;;;;;4BACzB,qBAAM,IAAI,CAAC,cAAc,EAAE,EAAA;;wBAArC,OAAO,GAAG,SAA2B;wBAC3C,sBAAO;gCACN,aAAa,EAAE,OAAO,CAAC,cAAc,EAAE,CAAC,WAAW,EAAE;gCACrD,IAAI,MAAA;6BACJ,EAAC;;;;KACF;IAEa,6DAAwB,GAAtC,UAAuC,EAAQ;YAAN,cAAI;;;;;4BACtB,qBAAM,KAAK,CAAC,OAAO,CAAC,eAAe,CAAC,EAAA;;wBAApD,aAAa,GAAG,SAAoC;wBAE1D,IAAI,CAAC,aAAa,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE;4BAC3C,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;yBACpC;wBACD,sBAAO;gCACN,aAAa,EAAE,aAAa,CAAC,KAAK;gCAClC,IAAI,MAAA;6BACJ,EAAC;;;;KACF;IAEa,6DAAwB,GAAtC,UAAuC,EAAgB;YAAd,kBAAM,EAAE,cAAI;;;;gBAC9C,EAAE,GAAG,IAAI,IAAI,EAAE,CAAC;gBAChB,KAAK,GAAG,EAAE,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAAC;gBAE7D,sBAAO;wBACN,IAAI,MAAA;wBACJ,YAAY,EAAE,KAAK;wBACnB,WAAW,EAAE,MAAM;qBACnB,EAAC;;;KACF;IAEa,0DAAqB,GAAnC,UAAoC,EAKnC;YAJA,oBAAO,EACP,8BAAY,EACZ,kDAAsB,EACtB,kBAAM;;;;;;wBAEA,YAAY,GAAG;4BACpB,MAAM,QAAA;4BACN,OAAO,EAAE,SAAS;yBAClB,CAAC;wBAEoB,qBAAM,IAAI,CAAC,kBAAkB,EAAE,EAAA;;wBAA/C,aAAa,GAAG,SAA+B;wBACrD,IAAI,CAAC,aAAa,EAAE;4BACnB,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;yBAClC;wBACa,qBAAM,WAAW,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,UAAA,WAAW,IAAI,OAAA,CAAC;gCAC1D,UAAU,EAAE,WAAW,CAAC,eAAe;gCACvC,UAAU,EAAE,WAAW,CAAC,WAAW;gCACnC,aAAa,EAAE,WAAW,CAAC,YAAY;6BACvC,CAAC,EAJwD,CAIxD,CAAC,EAAA;;wBAJG,KAAK,GAAG,SAIX;wBAEG,OAAO,GAAG;4BACf,GAAG,EAAE,KAAG,sBAAsB,GAAG,YAAc;4BAC/C,IAAI,EAAE,OAAO;4BACb,MAAM,EAAE,MAAM;4BACd,OAAO,eAAO,4BAA4B,CAAE;yBAC5C,CAAC;wBAEI,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;wBAChE,sBAAO,aAAa,CAAC,OAAO,EAAC;;;;KAC7B;IAED;;OAEG;IACH,uDAAkB,GAAlB;QACC,OAAO,WAAW,CAAC,GAAG,EAAE;aACtB,IAAI,CAAC,UAAA,WAAW;YAChB,IAAI,CAAC,WAAW;gBAAE,OAAO,KAAK,CAAC;YAC/B,IAAM,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;YAC5C,MAAM,CAAC,KAAK,CAAC,gDAAgD,EAAE,IAAI,CAAC,CAAC;YAErE,OAAO,IAAI,CAAC;QACb,CAAC,CAAC;aACD,KAAK,CAAC,UAAA,GAAG;YACT,MAAM,CAAC,IAAI,CAAC,0BAA0B,EAAE,GAAG,CAAC,CAAC;YAC7C,OAAO,KAAK,CAAC;QACd,CAAC,CAAC,CAAC;IACL,CAAC;IACF,iCAAC;AAAD,CAAC,AAjsBD,CAAgD,sBAAsB,GAisBrE"}
\ No newline at end of file
+{"version":3,"file":"AWSAppSyncRealTimeProvider.js","sourceRoot":"","sources":["../../src/Providers/AWSAppSyncRealTimeProvider.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js b/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js
index 5751256..b11e46e 100644
--- a/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js
+++ b/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js
@@ -48,8 +48,9 @@ var __generator = (this && this.__generator) || function (thisArg, body) {
  */
 // import '../Common/Polyfills';
 import Observable from 'zen-observable-ts';
-import { Amplify, ConsoleLogger as Logger, INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER, INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER, } from '@aws-amplify/core';
+import { Amplify, browserOrNode, ConsoleLogger as Logger, INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER, INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER, } from '@aws-amplify/core';
 import { AWSAppSyncProvider, AWSAppSyncRealTimeProvider } from './Providers';
+var isNode = browserOrNode().isNode;
 var logger = new Logger('PubSub');
 var PubSubClass = /** @class */ (function () {
     /**
@@ -62,7 +63,6 @@ var PubSubClass = /** @class */ (function () {
         logger.debug('PubSub Options', this._options);
         this._pluggables = [];
         this.subscribe = this.subscribe.bind(this);
-        Amplify.register(this);
     }
     Object.defineProperty(PubSubClass.prototype, "awsAppSyncProvider", {
         /**
@@ -155,6 +155,9 @@ var PubSubClass = /** @class */ (function () {
         });
     };
     PubSubClass.prototype.subscribe = function (topics, options) {
+        if (isNode && this._options && this._options.ssr) {
+            throw new Error('Subscriptions are not supported for Server-Side Rendering (SSR)');
+        }
         logger.debug('subscribe options', options);
         var providers = this.getProviders(options);
         return new Observable(function (observer) {
@@ -179,4 +182,5 @@ var PubSubClass = /** @class */ (function () {
 }());
 export { PubSubClass };
 export var PubSub = new PubSubClass(null);
+Amplify.register(PubSub);
 //# sourceMappingURL=PubSub.js.map
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js.map b/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js.map
index 230b66e..a06eec0 100644
--- a/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js.map
+++ b/node_modules/@aws-amplify/pubsub/lib-esm/PubSub.js.map
@@ -1 +1 @@
-{"version":3,"file":"PubSub.js","sourceRoot":"","sources":["../src/PubSub.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"PubSub.js","sourceRoot":"","sources":["../src/PubSub.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib-esm/index.d.ts b/node_modules/@aws-amplify/pubsub/lib-esm/index.d.ts
index 546663b..80b49d3 100644
--- a/node_modules/@aws-amplify/pubsub/lib-esm/index.d.ts
+++ b/node_modules/@aws-amplify/pubsub/lib-esm/index.d.ts
@@ -2,8 +2,10 @@ import { PubSub } from './PubSub';
 export * from './Providers';
 declare enum CONTROL_MSG {
     CONNECTION_CLOSED = "Connection closed",
-    TIMEOUT_DISCONNECT = "Timeout disconnect",
-    SUBSCRIPTION_ACK = "Subscription ack"
+    CONNECTION_FAILED = "Connection failed",
+    REALTIME_SUBSCRIPTION_INIT_ERROR = "AppSync Realtime subscription init error",
+    SUBSCRIPTION_ACK = "Subscription ack",
+    TIMEOUT_DISCONNECT = "Timeout disconnect"
 }
 export { PubSub, CONTROL_MSG };
 /**
diff --git a/node_modules/@aws-amplify/pubsub/lib-esm/index.js b/node_modules/@aws-amplify/pubsub/lib-esm/index.js
index 61a967b..c07e668 100644
--- a/node_modules/@aws-amplify/pubsub/lib-esm/index.js
+++ b/node_modules/@aws-amplify/pubsub/lib-esm/index.js
@@ -15,8 +15,10 @@ export * from './Providers';
 var CONTROL_MSG;
 (function (CONTROL_MSG) {
     CONTROL_MSG["CONNECTION_CLOSED"] = "Connection closed";
-    CONTROL_MSG["TIMEOUT_DISCONNECT"] = "Timeout disconnect";
+    CONTROL_MSG["CONNECTION_FAILED"] = "Connection failed";
+    CONTROL_MSG["REALTIME_SUBSCRIPTION_INIT_ERROR"] = "AppSync Realtime subscription init error";
     CONTROL_MSG["SUBSCRIPTION_ACK"] = "Subscription ack";
+    CONTROL_MSG["TIMEOUT_DISCONNECT"] = "Timeout disconnect";
 })(CONTROL_MSG || (CONTROL_MSG = {}));
 export { PubSub, CONTROL_MSG };
 /**
diff --git a/node_modules/@aws-amplify/pubsub/lib-esm/index.js.map b/node_modules/@aws-amplify/pubsub/lib-esm/index.js.map
index fbbb6cf..cf256a3 100644
--- a/node_modules/@aws-amplify/pubsub/lib-esm/index.js.map
+++ b/node_modules/@aws-amplify/pubsub/lib-esm/index.js.map
@@ -1 +1 @@
-{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;GAWG;AACH,OAAO,EAAE,MAAM,EAAE,MAAM,UAAU,CAAC;AAElC,cAAc,aAAa,CAAC;AAE5B,IAAK,WAIJ;AAJD,WAAK,WAAW;IACf,sDAAuC,CAAA;IACvC,wDAAyC,CAAA;IACzC,oDAAqC,CAAA;AACtC,CAAC,EAJI,WAAW,KAAX,WAAW,QAIf;AAED,OAAO,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;AAE/B;;GAEG;AACH,eAAe,MAAM,CAAC"}
\ No newline at end of file
+{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;GAWG;AACH,OAAO,EAAE,MAAM,EAAE,MAAM,UAAU,CAAC;AAElC,cAAc,aAAa,CAAC;AAE5B,IAAK,WAMJ;AAND,WAAK,WAAW;IACf,sDAAuC,CAAA;IACvC,sDAAuC,CAAA;IACvC,4FAA6E,CAAA;IAC7E,oDAAqC,CAAA;IACrC,wDAAyC,CAAA;AAC1C,CAAC,EANI,WAAW,KAAX,WAAW,QAMf;AAED,OAAO,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;AAE/B;;GAEG;AACH,eAAe,MAAM,CAAC"}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js b/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js
index 4ec2176..e3c581b 100644
--- a/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js
+++ b/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js
@@ -241,6 +241,13 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                     options: options,
                     observer: observer,
                     subscriptionId: subscriptionId_1,
+                }).catch(function (err) {
+                    observer.error({
+                        errors: [
+                            __assign({}, new graphql_1.GraphQLError(index_1.CONTROL_MSG.REALTIME_SUBSCRIPTION_INIT_ERROR + ": " + err)),
+                        ],
+                    });
+                    observer.complete();
                 });
                 return function () { return __awaiter(_this, void 0, void 0, function () {
                     var subscriptionState, err_1;
@@ -354,7 +361,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                         _f = err_2.message, message = _f === void 0 ? '' : _f;
                         observer.error({
                             errors: [
-                                __assign({}, new graphql_1.GraphQLError("Connection failed: " + message)),
+                                __assign({}, new graphql_1.GraphQLError(index_1.CONTROL_MSG.CONNECTION_FAILED + ": " + message)),
                             ],
                         });
                         observer.complete();
@@ -378,7 +385,9 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                                 _this._timeoutStartSubscriptionAck.call(_this, subscriptionId);
                             }, START_ACK_TIMEOUT),
                         });
-                        this.awsRealTimeSocket.send(stringToAWSRealTime);
+                        if (this.awsRealTimeSocket) {
+                            this.awsRealTimeSocket.send(stringToAWSRealTime);
+                        }
                         return [2 /*return*/];
                 }
             });
@@ -510,7 +519,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
             });
             observer.error({
                 errors: [
-                    __assign({}, new graphql_1.GraphQLError("Connection failed: " + JSON.stringify(payload))),
+                    __assign({}, new graphql_1.GraphQLError(index_1.CONTROL_MSG.CONNECTION_FAILED + ": " + JSON.stringify(payload))),
                 ],
             });
             clearTimeout(startAckTimeoutId);
@@ -524,7 +533,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
         logger.debug("Disconnect error: " + msg);
         this.subscriptionObserverMap.forEach(function (_a) {
             var observer = _a.observer;
-            if (!observer.closed) {
+            if (observer && !observer.closed) {
                 observer.error({
                     errors: [__assign({}, new graphql_1.GraphQLError(msg))],
                 });
@@ -620,7 +629,7 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                         }
                         this.awsRealTimeSocket = null;
                         this.socketStatus = SOCKET_STATUS.CLOSED;
-                        throw err_3;
+                        return [3 /*break*/, 5];
                     case 5: return [2 /*return*/];
                 }
             });
@@ -693,6 +702,10 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
                                                 logger.debug(err);
                                                 _this._errorDisconnect(index_1.CONTROL_MSG.CONNECTION_CLOSED);
                                             };
+                                            _this.awsRealTimeSocket.onclose = function (event) {
+                                                logger.debug("WebSocket closed " + event.reason);
+                                                _this._errorDisconnect(index_1.CONTROL_MSG.CONNECTION_CLOSED);
+                                            };
                                             res('Cool, connected to AWS AppSyncRealTime');
                                             return;
                                         }
@@ -789,17 +802,28 @@ var AWSAppSyncRealTimeProvider = /** @class */ (function (_super) {
     AWSAppSyncRealTimeProvider.prototype._awsRealTimeOPENIDHeader = function (_a) {
         var host = _a.host;
         return __awaiter(this, void 0, void 0, function () {
-            var federatedInfo;
+            var token, federatedInfo, currentUser;
             return __generator(this, function (_b) {
                 switch (_b.label) {
                     case 0: return [4 /*yield*/, cache_1.default.getItem('federatedInfo')];
                     case 1:
                         federatedInfo = _b.sent();
-                        if (!federatedInfo || !federatedInfo.token) {
+                        if (!federatedInfo) return [3 /*break*/, 2];
+                        token = federatedInfo.token;
+                        return [3 /*break*/, 4];
+                    case 2: return [4 /*yield*/, auth_1.default.currentAuthenticatedUser()];
+                    case 3:
+                        currentUser = _b.sent();
+                        if (currentUser) {
+                            token = currentUser.token;
+                        }
+                        _b.label = 4;
+                    case 4:
+                        if (!token) {
                             throw new Error('No federated jwt');
                         }
                         return [2 /*return*/, {
-                                Authorization: federatedInfo.token,
+                                Authorization: token,
                                 host: host,
                             }];
                 }
diff --git a/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js.map b/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js.map
index e1b19d3..ad64424 100644
--- a/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js.map
+++ b/node_modules/@aws-amplify/pubsub/lib/Providers/AWSAppSyncRealTimeProvider.js.map
@@ -1 +1 @@
-{"version":3,"file":"AWSAppSyncRealTimeProvider.js","sourceRoot":"","sources":["../../src/Providers/AWSAppSyncRealTimeProvider.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"AWSAppSyncRealTimeProvider.js","sourceRoot":"","sources":["../../src/Providers/AWSAppSyncRealTimeProvider.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib/PubSub.js b/node_modules/@aws-amplify/pubsub/lib/PubSub.js
index 19626a3..7ea9171 100644
--- a/node_modules/@aws-amplify/pubsub/lib/PubSub.js
+++ b/node_modules/@aws-amplify/pubsub/lib/PubSub.js
@@ -55,6 +55,7 @@ Object.defineProperty(exports, "__esModule", { value: true });
 var zen_observable_ts_1 = __importDefault(require("zen-observable-ts"));
 var core_1 = require("@aws-amplify/core");
 var Providers_1 = require("./Providers");
+var isNode = core_1.browserOrNode().isNode;
 var logger = new core_1.ConsoleLogger('PubSub');
 var PubSubClass = /** @class */ (function () {
     /**
@@ -67,7 +68,6 @@ var PubSubClass = /** @class */ (function () {
         logger.debug('PubSub Options', this._options);
         this._pluggables = [];
         this.subscribe = this.subscribe.bind(this);
-        core_1.Amplify.register(this);
     }
     Object.defineProperty(PubSubClass.prototype, "awsAppSyncProvider", {
         /**
@@ -160,6 +160,9 @@ var PubSubClass = /** @class */ (function () {
         });
     };
     PubSubClass.prototype.subscribe = function (topics, options) {
+        if (isNode && this._options && this._options.ssr) {
+            throw new Error('Subscriptions are not supported for Server-Side Rendering (SSR)');
+        }
         logger.debug('subscribe options', options);
         var providers = this.getProviders(options);
         return new zen_observable_ts_1.default(function (observer) {
@@ -184,4 +187,5 @@ var PubSubClass = /** @class */ (function () {
 }());
 exports.PubSubClass = PubSubClass;
 exports.PubSub = new PubSubClass(null);
+core_1.Amplify.register(exports.PubSub);
 //# sourceMappingURL=PubSub.js.map
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib/PubSub.js.map b/node_modules/@aws-amplify/pubsub/lib/PubSub.js.map
index cb22dfd..dbe0340 100644
--- a/node_modules/@aws-amplify/pubsub/lib/PubSub.js.map
+++ b/node_modules/@aws-amplify/pubsub/lib/PubSub.js.map
@@ -1 +1 @@
-{"version":3,"file":"PubSub.js","sourceRoot":"","sources":["../src/PubSub.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"PubSub.js","sourceRoot":"","sources":["../src/PubSub.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;GAWG;AACH,gCAAgC;AAChC,wEAA2C;AAE3C,0CAM2B;AAE3B,yCAA6E;AAErE,IAAA,sCAAM,CAAqB;AACnC,IAAM,MAAM,GAAG,IAAI,oBAAM,CAAC,QAAQ,CAAC,CAAC;AAEpC;IAqCC;;;;OAIG;IACH,qBAAY,OAAsB;QACjC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,MAAM,CAAC,KAAK,CAAC,gBAAgB,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC9C,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5C,CAAC;IA7BD,sBAAY,2CAAkB;QAH9B;;WAEG;aACH;YACC,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;gBAC9B,IAAI,CAAC,mBAAmB,GAAG,IAAI,8BAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aACjE;YACD,OAAO,IAAI,CAAC,mBAAmB,CAAC;QACjC,CAAC;;;OAAA;IAKD,sBAAY,mDAA0B;QAHtC;;WAEG;aACH;YACC,IAAI,CAAC,IAAI,CAAC,2BAA2B,EAAE;gBACtC,IAAI,CAAC,2BAA2B,GAAG,IAAI,sCAA0B,CAChE,IAAI,CAAC,QAAQ,CACb,CAAC;aACF;YACD,OAAO,IAAI,CAAC,2BAA2B,CAAC;QACzC,CAAC;;;OAAA;IAcM,mCAAa,GAApB;QACC,OAAO,QAAQ,CAAC;IACjB,CAAC;IAED;;;;;OAKG;IACH,+BAAS,GAAT,UAAU,OAAsB;QAAhC,iBASC;QARA,IAAM,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;QACrD,MAAM,CAAC,KAAK,CAAC,kBAAkB,EAAE,EAAE,GAAG,KAAA,EAAE,CAAC,CAAC;QAE1C,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;QAEtD,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,SAAS,CAAC,KAAI,CAAC,QAAQ,CAAC,EAAlC,CAAkC,CAAC,CAAC;QAEtE,OAAO,IAAI,CAAC,QAAQ,CAAC;IACtB,CAAC;IAED;;;OAGG;IACU,kCAAY,GAAzB,UAA0B,SAAyB;;;;gBAClD,IAAI,SAAS,IAAI,SAAS,CAAC,WAAW,EAAE,KAAK,QAAQ,EAAE;oBACtD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;oBAE3B,MAAM,GAAG,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oBAElD,sBAAO,MAAM,EAAC;iBACd;;;;KACD;IAEO,uCAAiB,GAAzB,UAA0B,YAAY;QACrC,IAAI,YAAY,KAAK,2CAAoC,EAAE;YAC1D,OAAO,IAAI,CAAC,kBAAkB,CAAC;SAC/B;QACD,IAAI,YAAY,KAAK,oDAA6C,EAAE;YACnE,OAAO,IAAI,CAAC,0BAA0B,CAAC;SACvC;QAED,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAC3B,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,eAAe,EAAE,KAAK,YAAY,EAA5C,CAA4C,CACzD,CAAC;IACH,CAAC;IAEO,kCAAY,GAApB,UAAqB,OAA8B;QAA9B,wBAAA,EAAA,YAA8B;QAC1C,IAAA,+BAAsB,CAAa;QAC3C,IAAI,CAAC,YAAY,EAAE;YAClB,OAAO,IAAI,CAAC,WAAW,CAAC;SACxB;QAED,IAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;QACtD,IAAI,CAAC,QAAQ,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,mCAAiC,YAAc,CAAC,CAAC;SACjE;QAED,OAAO,CAAC,QAAQ,CAAC,CAAC;IACnB,CAAC;IAEK,6BAAO,GAAb,UACC,MAAyB,EACzB,GAAQ,EACR,OAA0B;;;gBAE1B,sBAAO,OAAO,CAAC,GAAG,CACjB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,UAAA,QAAQ;wBACtC,OAAA,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,EAAE,OAAO,CAAC;oBAAtC,CAAsC,CACtC,CACD,EAAC;;;KACF;IAED,+BAAS,GAAT,UACC,MAAyB,EACzB,OAA0B;QAE1B,IAAI,MAAM,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE;YACjD,MAAM,IAAI,KAAK,CACd,iEAAiE,CACjE,CAAC;SACF;QAED,MAAM,CAAC,KAAK,CAAC,mBAAmB,EAAE,OAAO,CAAC,CAAC;QAE3C,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QAE7C,OAAO,IAAI,2BAAU,CAAC,UAAA,QAAQ;YAC7B,IAAM,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,CAAC;gBAC9C,QAAQ,UAAA;gBACR,UAAU,EAAE,QAAQ,CAAC,SAAS,CAAC,MAAM,EAAE,OAAO,CAAC;aAC/C,CAAC,EAH4C,CAG5C,CAAC,CAAC;YAEJ,IAAM,aAAa,GAAG,WAAW,CAAC,GAAG,CAAC,UAAC,EAAwB;oBAAtB,sBAAQ,EAAE,0BAAU;gBAC5D,OAAA,UAAU,CAAC,SAAS,CAAC;oBACpB,KAAK,EAAE,OAAO,CAAC,KAAK;oBACpB,IAAI,EAAE,UAAA,KAAK,IAAI,OAAA,QAAQ,CAAC,IAAI,CAAC,EAAE,QAAQ,UAAA,EAAE,KAAK,OAAA,EAAE,CAAC,EAAlC,CAAkC;oBACjD,KAAK,EAAE,UAAA,KAAK,IAAI,OAAA,QAAQ,CAAC,KAAK,CAAC,EAAE,QAAQ,UAAA,EAAE,KAAK,OAAA,EAAE,CAAC,EAAnC,CAAmC;iBAEnD,CAAC;YALF,CAKE,CACF,CAAC;YAEF,OAAO;gBACN,OAAA,aAAa,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,WAAW,EAAE,EAA1B,CAA0B,CAAC;YAAjE,CAAiE,CAAC;QACpE,CAAC,CAAC,CAAC;IACJ,CAAC;IACF,kBAAC;AAAD,CAAC,AA5JD,IA4JC;AA5JY,kCAAW;AA8JX,QAAA,MAAM,GAAG,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC;AAC5C,cAAO,CAAC,QAAQ,CAAC,cAAM,CAAC,CAAC"}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/lib/index.d.ts b/node_modules/@aws-amplify/pubsub/lib/index.d.ts
index 546663b..80b49d3 100644
--- a/node_modules/@aws-amplify/pubsub/lib/index.d.ts
+++ b/node_modules/@aws-amplify/pubsub/lib/index.d.ts
@@ -2,8 +2,10 @@ import { PubSub } from './PubSub';
 export * from './Providers';
 declare enum CONTROL_MSG {
     CONNECTION_CLOSED = "Connection closed",
-    TIMEOUT_DISCONNECT = "Timeout disconnect",
-    SUBSCRIPTION_ACK = "Subscription ack"
+    CONNECTION_FAILED = "Connection failed",
+    REALTIME_SUBSCRIPTION_INIT_ERROR = "AppSync Realtime subscription init error",
+    SUBSCRIPTION_ACK = "Subscription ack",
+    TIMEOUT_DISCONNECT = "Timeout disconnect"
 }
 export { PubSub, CONTROL_MSG };
 /**
diff --git a/node_modules/@aws-amplify/pubsub/lib/index.js b/node_modules/@aws-amplify/pubsub/lib/index.js
index 6605744..8064b5f 100644
--- a/node_modules/@aws-amplify/pubsub/lib/index.js
+++ b/node_modules/@aws-amplify/pubsub/lib/index.js
@@ -21,8 +21,10 @@ __export(require("./Providers"));
 var CONTROL_MSG;
 (function (CONTROL_MSG) {
     CONTROL_MSG["CONNECTION_CLOSED"] = "Connection closed";
-    CONTROL_MSG["TIMEOUT_DISCONNECT"] = "Timeout disconnect";
+    CONTROL_MSG["CONNECTION_FAILED"] = "Connection failed";
+    CONTROL_MSG["REALTIME_SUBSCRIPTION_INIT_ERROR"] = "AppSync Realtime subscription init error";
     CONTROL_MSG["SUBSCRIPTION_ACK"] = "Subscription ack";
+    CONTROL_MSG["TIMEOUT_DISCONNECT"] = "Timeout disconnect";
 })(CONTROL_MSG || (CONTROL_MSG = {}));
 exports.CONTROL_MSG = CONTROL_MSG;
 /**
diff --git a/node_modules/@aws-amplify/pubsub/lib/index.js.map b/node_modules/@aws-amplify/pubsub/lib/index.js.map
index 24594fd..5ecdd12 100644
--- a/node_modules/@aws-amplify/pubsub/lib/index.js.map
+++ b/node_modules/@aws-amplify/pubsub/lib/index.js.map
@@ -1 +1 @@
-{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;;;;AAAA;;;;;;;;;;;GAWG;AACH,mCAAkC;AAUzB,iBAVA,eAAM,CAUA;AARf,iCAA4B;AAE5B,IAAK,WAIJ;AAJD,WAAK,WAAW;IACf,sDAAuC,CAAA;IACvC,wDAAyC,CAAA;IACzC,oDAAqC,CAAA;AACtC,CAAC,EAJI,WAAW,KAAX,WAAW,QAIf;AAEgB,kCAAW;AAE5B;;GAEG;AACH,kBAAe,eAAM,CAAC"}
\ No newline at end of file
+{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;;;;AAAA;;;;;;;;;;;GAWG;AACH,mCAAkC;AAYzB,iBAZA,eAAM,CAYA;AAVf,iCAA4B;AAE5B,IAAK,WAMJ;AAND,WAAK,WAAW;IACf,sDAAuC,CAAA;IACvC,sDAAuC,CAAA;IACvC,4FAA6E,CAAA;IAC7E,oDAAqC,CAAA;IACrC,wDAAyC,CAAA;AAC1C,CAAC,EANI,WAAW,KAAX,WAAW,QAMf;AAEgB,kCAAW;AAE5B;;GAEG;AACH,kBAAe,eAAM,CAAC"}
\ No newline at end of file
diff --git a/node_modules/@aws-amplify/pubsub/src/Providers/AWSAppSyncRealTimeProvider.ts b/node_modules/@aws-amplify/pubsub/src/Providers/AWSAppSyncRealTimeProvider.ts
index dbe610f..bd603b7 100644
--- a/node_modules/@aws-amplify/pubsub/src/Providers/AWSAppSyncRealTimeProvider.ts
+++ b/node_modules/@aws-amplify/pubsub/src/Providers/AWSAppSyncRealTimeProvider.ts
@@ -186,6 +186,17 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 					options,
 					observer,
 					subscriptionId,
+				}).catch(err => {
+					observer.error({
+						errors: [
+							{
+								...new GraphQLError(
+									`${CONTROL_MSG.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${err}`
+								),
+							},
+						],
+					});
+					observer.complete();
 				});
 
 				return async () => {
@@ -296,7 +307,7 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 			observer.error({
 				errors: [
 					{
-						...new GraphQLError(`Connection failed: ${message}`),
+						...new GraphQLError(`${CONTROL_MSG.CONNECTION_FAILED}: ${message}`),
 					},
 				],
 			});
@@ -333,7 +344,9 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 				this._timeoutStartSubscriptionAck.call(this, subscriptionId);
 			}, START_ACK_TIMEOUT),
 		});
-		this.awsRealTimeSocket.send(stringToAWSRealTime);
+		if (this.awsRealTimeSocket) {
+			this.awsRealTimeSocket.send(stringToAWSRealTime);
+		}
 	}
 
 	// Waiting that subscription has been connected before trying to unsubscribe
@@ -494,7 +507,7 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 				errors: [
 					{
 						...new GraphQLError(
-							`Connection failed: ${JSON.stringify(payload)}`
+							`${CONTROL_MSG.CONNECTION_FAILED}: ${JSON.stringify(payload)}`
 						),
 					},
 				],
@@ -511,7 +524,7 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 	private _errorDisconnect(msg: string) {
 		logger.debug(`Disconnect error: ${msg}`);
 		this.subscriptionObserverMap.forEach(({ observer }) => {
-			if (!observer.closed) {
+			if (observer && !observer.closed) {
 				observer.error({
 					errors: [{ ...new GraphQLError(msg) }],
 				});
@@ -615,8 +628,6 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 					}
 					this.awsRealTimeSocket = null;
 					this.socketStatus = SOCKET_STATUS.CLOSED;
-
-					throw err;
 				}
 			}
 		});
@@ -685,6 +696,10 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 								logger.debug(err);
 								this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);
 							};
+							this.awsRealTimeSocket.onclose = event => {
+								logger.debug(`WebSocket closed ${event.reason}`);
+								this._errorDisconnect(CONTROL_MSG.CONNECTION_CLOSED);
+							};
 							res('Cool, connected to AWS AppSyncRealTime');
 							return;
 						}
@@ -776,13 +791,22 @@ export class AWSAppSyncRealTimeProvider extends AbstractPubSubProvider {
 	}
 
 	private async _awsRealTimeOPENIDHeader({ host }) {
+		let token;
+		// backwards compatibility
 		const federatedInfo = await Cache.getItem('federatedInfo');
-
-		if (!federatedInfo || !federatedInfo.token) {
+		if (federatedInfo) {
+			token = federatedInfo.token;
+		} else {
+			const currentUser = await Auth.currentAuthenticatedUser();
+			if (currentUser) {
+				token = currentUser.token;
+			}
+		}
+		if (!token) {
 			throw new Error('No federated jwt');
 		}
 		return {
-			Authorization: federatedInfo.token,
+			Authorization: token,
 			host,
 		};
 	}
diff --git a/node_modules/@aws-amplify/pubsub/src/PubSub.ts b/node_modules/@aws-amplify/pubsub/src/PubSub.ts
index 3716557..bee1ab0 100644
--- a/node_modules/@aws-amplify/pubsub/src/PubSub.ts
+++ b/node_modules/@aws-amplify/pubsub/src/PubSub.ts
@@ -15,6 +15,7 @@ import Observable from 'zen-observable-ts';
 
 import {
 	Amplify,
+	browserOrNode,
 	ConsoleLogger as Logger,
 	INTERNAL_AWS_APPSYNC_PUBSUB_PROVIDER,
 	INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER,
@@ -22,6 +23,7 @@ import {
 import { PubSubProvider, PubSubOptions, ProvidertOptions } from './types';
 import { AWSAppSyncProvider, AWSAppSyncRealTimeProvider } from './Providers';
 
+const { isNode } = browserOrNode();
 const logger = new Logger('PubSub');
 
 export class PubSubClass {
@@ -71,7 +73,6 @@ export class PubSubClass {
 		logger.debug('PubSub Options', this._options);
 		this._pluggables = [];
 		this.subscribe = this.subscribe.bind(this);
-		Amplify.register(this);
 	}
 
 	public getModuleName() {
@@ -152,6 +153,12 @@ export class PubSubClass {
 		topics: string[] | string,
 		options?: ProvidertOptions
 	): Observable<any> {
+		if (isNode && this._options && this._options.ssr) {
+			throw new Error(
+				'Subscriptions are not supported for Server-Side Rendering (SSR)'
+			);
+		}
+
 		logger.debug('subscribe options', options);
 
 		const providers = this.getProviders(options);
@@ -178,3 +185,4 @@ export class PubSubClass {
 }
 
 export const PubSub = new PubSubClass(null);
+Amplify.register(PubSub);
diff --git a/node_modules/@aws-amplify/pubsub/src/index.ts b/node_modules/@aws-amplify/pubsub/src/index.ts
index d09bf1a..d44e2a1 100644
--- a/node_modules/@aws-amplify/pubsub/src/index.ts
+++ b/node_modules/@aws-amplify/pubsub/src/index.ts
@@ -16,8 +16,10 @@ export * from './Providers';
 
 enum CONTROL_MSG {
 	CONNECTION_CLOSED = 'Connection closed',
-	TIMEOUT_DISCONNECT = 'Timeout disconnect',
+	CONNECTION_FAILED = 'Connection failed',
+	REALTIME_SUBSCRIPTION_INIT_ERROR = 'AppSync Realtime subscription init error',
 	SUBSCRIPTION_ACK = 'Subscription ack',
+	TIMEOUT_DISCONNECT = 'Timeout disconnect',
 }
 
 export { PubSub, CONTROL_MSG };
